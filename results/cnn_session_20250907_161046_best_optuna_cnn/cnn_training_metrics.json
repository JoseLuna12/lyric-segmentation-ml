{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.3842810256530799,
      "layer_dropout": 0.17675161631734992,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 221314,
      "cnn_params": 131840,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007771901374109088,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.030773269477316827,
        "ece_after": 0.03960214692857738,
        "improvement": -0.008828877451260552,
        "params": {
          "temperature": 0.9031705151612744
        }
      },
      "platt": {
        "ece_before": 0.030773269477316827,
        "ece_after": 0.03824643252055163,
        "improvement": -0.007473163043234806,
        "params": {
          "A": 1.063906032368212,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5027906215853162,
      "train_chorus_rate": 0.20027756753067175,
      "train_max_prob": 0.5561650296052297,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4965052753686905,
      "val_macro_f1": 0.5161117581576504,
      "val_verse_f1": 0.820443238353686,
      "val_chorus_f1": 0.21178027796161483,
      "val_chorus_rate": 0.07330343872308731,
      "val_max_prob": 0.5834184437990189,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.570605533590387e-05,
      "epoch_time": 45.26674699783325,
      "val_boundary_f1": 0.1085972850678733,
      "val_boundary_precision": 0.1506276150627615,
      "val_boundary_recall": 0.08490566037735849,
      "val_complete_segments": 0.04677489058074957,
      "val_avg_segment_overlap": 0.2634062828309135,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.3785156226147446,
      "val_pk_metric": 0.3218502573261526,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.68208556705051,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.48252666493256885,
      "train_chorus_rate": 0.2451624899274773,
      "train_max_prob": 0.5771591597133212,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47866808623075485,
      "val_macro_f1": 0.6392670269972964,
      "val_verse_f1": 0.7995238904948136,
      "val_chorus_f1": 0.4790101634997791,
      "val_chorus_rate": 0.2569810338318348,
      "val_max_prob": 0.5976522266864777,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.9447050175117956e-05,
      "epoch_time": 33.231929063797,
      "val_boundary_f1": 0.24068157614483496,
      "val_boundary_precision": 0.21941747572815534,
      "val_boundary_recall": 0.2665094339622642,
      "val_complete_segments": 0.13900376760822392,
      "val_avg_segment_overlap": 0.4580130036552432,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.3882531318475769,
      "val_pk_metric": 0.31372610766673825,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2466399603419833,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.46663110786014134,
      "train_chorus_rate": 0.261592539648215,
      "train_max_prob": 0.6253732475969527,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4676951915025711,
      "val_macro_f1": 0.6676563263067052,
      "val_verse_f1": 0.7719626168224298,
      "val_chorus_f1": 0.5633500357909808,
      "val_chorus_rate": 0.3875150978565216,
      "val_max_prob": 0.6191727817058563,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.197035744445357e-05,
      "epoch_time": 32.25508117675781,
      "val_boundary_f1": 0.21923076923076926,
      "val_boundary_precision": 0.18506493506493507,
      "val_boundary_recall": 0.2688679245283019,
      "val_complete_segments": 0.11995556566994005,
      "val_avg_segment_overlap": 0.5094599340460461,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.429142781246452,
      "val_pk_metric": 0.33551685948477106,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.1310088766945734,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4520487172736062,
      "train_chorus_rate": 0.3004518821835518,
      "train_max_prob": 0.6538382934199439,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46221528947353363,
      "val_macro_f1": 0.6600114535346318,
      "val_verse_f1": 0.734488315874295,
      "val_chorus_f1": 0.5855345911949685,
      "val_chorus_rate": 0.48140180855989456,
      "val_max_prob": 0.6464527994394302,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010271829097938047,
      "epoch_time": 32.036662101745605,
      "val_boundary_f1": 0.20248328557784145,
      "val_boundary_precision": 0.17014446227929375,
      "val_boundary_recall": 0.25,
      "val_complete_segments": 0.09771144810401265,
      "val_avg_segment_overlap": 0.5110704953961718,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.4500041000090702,
      "val_pk_metric": 0.3525468329188096,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.5094063248899248,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4372827029890484,
      "train_chorus_rate": 0.33080670568678117,
      "train_max_prob": 0.6750160025225745,
      "train_conf_over_90": 2.5391022467778788e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.45281071215867996,
      "val_macro_f1": 0.6746974550759843,
      "val_verse_f1": 0.752428146679881,
      "val_chorus_f1": 0.5969667634720877,
      "val_chorus_rate": 0.46039095520973206,
      "val_max_prob": 0.6784141510725021,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001409295195546374,
      "epoch_time": 32.52668118476868,
      "val_boundary_f1": 0.2774566473988439,
      "val_boundary_precision": 0.23452768729641693,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.1768148423994998,
      "val_avg_segment_overlap": 0.5488621308509735,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.42842127900943733,
      "val_pk_metric": 0.33540144504916247,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.5253550211588542,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.42126429577668506,
      "train_chorus_rate": 0.368677341275745,
      "train_max_prob": 0.6905546519491408,
      "train_conf_over_90": 0.00038708464772854414,
      "train_conf_over_95": 0.0,
      "val_loss": 0.44112690538167953,
      "val_macro_f1": 0.7043920145190563,
      "val_verse_f1": 0.7894736842105263,
      "val_chorus_f1": 0.6193103448275862,
      "val_chorus_rate": 0.411808542907238,
      "val_max_prob": 0.7073694318532944,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018565791775217231,
      "epoch_time": 32.38792395591736,
      "val_boundary_f1": 0.35294117647058826,
      "val_boundary_precision": 0.2891566265060241,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2528759907499356,
      "val_avg_segment_overlap": 0.5989725645276978,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4240075989066078,
      "val_pk_metric": 0.3104200193101106,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.126605894830492,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.40658484399318695,
      "train_chorus_rate": 0.3478018856710858,
      "train_max_prob": 0.7145712375640869,
      "train_conf_over_90": 0.005605101006545333,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4392009750008583,
      "val_macro_f1": 0.7046344993484807,
      "val_verse_f1": 0.7848590189262263,
      "val_chorus_f1": 0.624409979770735,
      "val_chorus_rate": 0.42915407568216324,
      "val_max_prob": 0.7328775227069855,
      "val_conf_over_90": 0.009909719228744507,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002357959924077685,
      "epoch_time": 31.695980072021484,
      "val_boundary_f1": 0.35036496350364965,
      "val_boundary_precision": 0.2857142857142857,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24544226295560703,
      "val_avg_segment_overlap": 0.6149664404586644,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4285509116120547,
      "val_pk_metric": 0.322241758347244,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.1050627761416965,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.3897047241528829,
      "train_chorus_rate": 0.35185805956522626,
      "train_max_prob": 0.737737798028522,
      "train_conf_over_90": 0.03266909669360353,
      "train_conf_over_95": 0.0,
      "val_loss": 0.435741126537323,
      "val_macro_f1": 0.6950193094494188,
      "val_verse_f1": 0.7668455575432319,
      "val_chorus_f1": 0.6231930613556056,
      "val_chorus_rate": 0.46460365504026413,
      "val_max_prob": 0.7241412848234177,
      "val_conf_over_90": 0.03531882632523775,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00029010230458809225,
      "epoch_time": 31.559582948684692,
      "val_boundary_f1": 0.35707678075855687,
      "val_boundary_precision": 0.2937595129375951,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2279389757806466,
      "val_avg_segment_overlap": 0.6066397739425322,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4381099937003737,
      "val_pk_metric": 0.33166585887914735,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.6394557787312403,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.37888940506511265,
      "train_chorus_rate": 0.34745776073800194,
      "train_max_prob": 0.7445195416609446,
      "train_conf_over_90": 0.07387169450521469,
      "train_conf_over_95": 3.6239763075071904e-05,
      "val_loss": 0.43995825946331024,
      "val_macro_f1": 0.7123342254687202,
      "val_verse_f1": 0.8184427700035882,
      "val_chorus_f1": 0.6062256809338522,
      "val_chorus_rate": 0.3290081098675728,
      "val_max_prob": 0.7499171793460846,
      "val_conf_over_90": 0.11517419293522835,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034723220811896325,
      "epoch_time": 31.218178033828735,
      "val_boundary_f1": 0.3658310120705664,
      "val_boundary_precision": 0.3016845329249617,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.25748194352495496,
      "val_avg_segment_overlap": 0.6104111374995123,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4289762210472343,
      "val_pk_metric": 0.3117062261679858,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.351371076371935,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.3678472638130188,
      "train_chorus_rate": 0.34385614345471066,
      "train_max_prob": 0.7584082285563151,
      "train_conf_over_90": 0.1260019631849395,
      "train_conf_over_95": 0.0023633840448585236,
      "val_loss": 0.4585694745182991,
      "val_macro_f1": 0.6706397784941682,
      "val_verse_f1": 0.7355897435897436,
      "val_chorus_f1": 0.6056898133985927,
      "val_chorus_rate": 0.5039175748825073,
      "val_max_prob": 0.7338795065879822,
      "val_conf_over_90": 0.0703667039051652,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004057711435664982,
      "epoch_time": 32.85026812553406,
      "val_boundary_f1": 0.3174603174603175,
      "val_boundary_precision": 0.2535211267605634,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.2009881638714186,
      "val_avg_segment_overlap": 0.5869402804164708,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4846172186170403,
      "val_pk_metric": 0.3826587481863839,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.105962554613749,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.3572496705585056,
      "train_chorus_rate": 0.3255481380555365,
      "train_max_prob": 0.7735886408223046,
      "train_conf_over_90": 0.17633618869715267,
      "train_conf_over_95": 0.005890155812570204,
      "val_loss": 0.4555649608373642,
      "val_macro_f1": 0.7089249786001328,
      "val_verse_f1": 0.7782625942086473,
      "val_chorus_f1": 0.6395873629916182,
      "val_chorus_rate": 0.4625019505620003,
      "val_max_prob": 0.7872745096683502,
      "val_conf_over_90": 0.2243613265454769,
      "val_conf_over_95": 0.00046678347280249,
      "learning_rate": 0.00046426966329873935,
      "epoch_time": 31.504460096359253,
      "val_boundary_f1": 0.36399217221135033,
      "val_boundary_precision": 0.3110367892976589,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21847553238442013,
      "val_avg_segment_overlap": 0.606390011703291,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.4231462919682005,
      "val_pk_metric": 0.33119319047114204,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.948564204904768,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.34682683812247384,
      "train_chorus_rate": 0.3374253610769908,
      "train_max_prob": 0.7815047535631392,
      "train_conf_over_90": 0.2074955188565784,
      "train_conf_over_95": 0.011904213849144677,
      "val_loss": 0.46608322858810425,
      "val_macro_f1": 0.6645703735264878,
      "val_verse_f1": 0.7158074137196422,
      "val_chorus_f1": 0.6133333333333334,
      "val_chorus_rate": 0.5461933761835098,
      "val_max_prob": 0.75508813560009,
      "val_conf_over_90": 0.12238131836056709,
      "val_conf_over_95": 0.0004338138969615102,
      "learning_rate": 0.0005212793203931269,
      "epoch_time": 31.717336177825928,
      "val_boundary_f1": 0.29848078641644327,
      "val_boundary_precision": 0.24028776978417266,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.1957483954908235,
      "val_avg_segment_overlap": 0.5846387579896283,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4745169293053628,
      "val_pk_metric": 0.36266974935018503,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.87027997440762,
      "cnn_effective_layers": 2
    }
  ]
}