{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.19540942269769568,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.23959115408009513,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 630531,
      "lstm_params": 489472,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 16,
      "learning_rate": 1.1934519910431985e-05,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 6,
      "validation_strategy": "composite",
      "weight_decay": 7.609729267120773e-05,
      "gradient_clip_norm": 1.879385956135002,
      "max_epochs": 25,
      "patience": 8
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07078659833063074,
        "ece_after": 0.05132600969556272,
        "improvement": 0.01946058863506802,
        "params": {
          "temperature": 0.24544067190401186
        }
      },
      "platt": {
        "ece_before": 0.07078659833063074,
        "ece_after": 0.021561380219600006,
        "improvement": 0.04922521811103073,
        "params": {
          "A": 0.9999270185348197,
          "B": 0.16276969154727947
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5663606493900983,
      "train_chorus_rate": 0.6592442378019675,
      "train_max_prob": 0.5235156951806484,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5864267721772194,
      "val_macro_f1": 0.48463850656541685,
      "val_verse_f1": 0.4666666666666667,
      "val_chorus_f1": 0.502610346464167,
      "val_chorus_rate": 0.7354710698127747,
      "val_max_prob": 0.5093252584338188,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1891408932693714e-05,
      "epoch_time": 71.43269991874695,
      "val_boundary_f1": 0.08951048951048952,
      "val_boundary_precision": 0.10996563573883161,
      "val_boundary_recall": 0.07547169811320754,
      "val_complete_segments": 0.02957932421421265,
      "val_avg_segment_overlap": 0.245409237414339,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.46267906906466316,
      "val_pk_metric": 0.43415561167819317
    },
    {
      "epoch": 2,
      "train_loss": 0.5566077553308927,
      "train_chorus_rate": 0.5092859413379278,
      "train_max_prob": 0.5222553916466541,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.584295317530632,
      "val_macro_f1": 0.5595499846308918,
      "val_verse_f1": 0.6223941543090479,
      "val_chorus_f1": 0.4967058149527357,
      "val_chorus_rate": 0.5578257888555527,
      "val_max_prob": 0.5129447057843208,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1762755885351078e-05,
      "epoch_time": 60.5558819770813,
      "val_boundary_f1": 0.1376281112737921,
      "val_boundary_precision": 0.18146718146718147,
      "val_boundary_recall": 0.11084905660377359,
      "val_complete_segments": 0.03598984319876467,
      "val_avg_segment_overlap": 0.28076229336415137,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.09595959595959595,
      "val_window_diff": 0.4410339965545672,
      "val_pk_metric": 0.4377901968316433
    },
    {
      "epoch": 3,
      "train_loss": 0.5592770721667852,
      "train_chorus_rate": 0.4560718307128319,
      "train_max_prob": 0.5247602309936132,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5824861079454422,
      "val_macro_f1": 0.574755278190191,
      "val_verse_f1": 0.6612244897959184,
      "val_chorus_f1": 0.4882860665844635,
      "val_chorus_rate": 0.4974076710641384,
      "val_max_prob": 0.5169110596179962,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.155058970381428e-05,
      "epoch_time": 54.64286279678345,
      "val_boundary_f1": 0.17176128093158663,
      "val_boundary_precision": 0.22433460076045628,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.051449853178072213,
      "val_avg_segment_overlap": 0.28173711994730544,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.4320973959562807,
      "val_pk_metric": 0.4154795125308878
    },
    {
      "epoch": 4,
      "train_loss": 0.5488621470255729,
      "train_chorus_rate": 0.3767303786216638,
      "train_max_prob": 0.529239860864786,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5807550847530365,
      "val_macro_f1": 0.5843701575377115,
      "val_verse_f1": 0.6830720381027982,
      "val_chorus_f1": 0.4856682769726249,
      "val_chorus_rate": 0.46339745447039604,
      "val_max_prob": 0.5213417261838913,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1258256375508084e-05,
      "epoch_time": 68.36310005187988,
      "val_boundary_f1": 0.1764705882352941,
      "val_boundary_precision": 0.21724137931034482,
      "val_boundary_recall": 0.14858490566037735,
      "val_complete_segments": 0.05099809195022316,
      "val_avg_segment_overlap": 0.28575048998907226,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.41543587675112925,
      "val_pk_metric": 0.40545186878416695
    },
    {
      "epoch": 5,
      "train_loss": 0.5483636107200232,
      "train_chorus_rate": 0.4440785952103444,
      "train_max_prob": 0.5316970424774365,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.578517310321331,
      "val_macro_f1": 0.581802912935373,
      "val_verse_f1": 0.6735146022155086,
      "val_chorus_f1": 0.4900912236552375,
      "val_chorus_rate": 0.481348879635334,
      "val_max_prob": 0.5266156792640686,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0890366171651349e-05,
      "epoch_time": 63.3253960609436,
      "val_boundary_f1": 0.17478510028653294,
      "val_boundary_precision": 0.22262773722627738,
      "val_boundary_recall": 0.14386792452830188,
      "val_complete_segments": 0.05825350614610875,
      "val_avg_segment_overlap": 0.289248568728358,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.4198022455039244,
      "val_pk_metric": 0.411281976303848
    },
    {
      "epoch": 6,
      "train_loss": 0.5449662819886819,
      "train_chorus_rate": 0.4138158903672145,
      "train_max_prob": 0.5356349073923551,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5761394798755646,
      "val_macro_f1": 0.579560953472642,
      "val_verse_f1": 0.6454352441613588,
      "val_chorus_f1": 0.5136866627839254,
      "val_chorus_rate": 0.5439708083868027,
      "val_max_prob": 0.5293377712368965,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0452720940525846e-05,
      "epoch_time": 71.86260104179382,
      "val_boundary_f1": 0.17119565217391303,
      "val_boundary_precision": 0.20192307692307693,
      "val_boundary_recall": 0.14858490566037735,
      "val_complete_segments": 0.05463349764042337,
      "val_avg_segment_overlap": 0.3060733780431926,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.4209782501299892,
      "val_pk_metric": 0.41433961778649864
    }
  ]
}