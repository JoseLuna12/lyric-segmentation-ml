{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.10396327827118965,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.21527202993006728,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2637315,
      "lstm_params": 2076672,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 16,
      "learning_rate": 0.00043285641363634665,
      "scheduler": "cosine_restarts",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "line_f1",
      "weight_decay": 1.0275733987754579e-05,
      "gradient_clip_norm": 1.429657961402908,
      "max_epochs": 25,
      "patience": 8
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.033373296260833726,
        "ece_after": 0.024609580343270817,
        "improvement": 0.00876371591756291,
        "params": {
          "temperature": 0.8593658202827441
        }
      },
      "platt": {
        "ece_before": 0.033373296260833726,
        "ece_after": 0.022118226732978218,
        "improvement": 0.011255069527855509,
        "params": {
          "A": 1.1101464639242813,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5522468181756827,
      "train_chorus_rate": 0.3609771433358009,
      "train_max_prob": 0.6041025320688883,
      "train_conf_over_90": 0.0029339306355000306,
      "train_conf_over_95": 0.0,
      "val_loss": 0.518138762563467,
      "val_macro_f1": 0.734237021517214,
      "val_verse_f1": 0.8305695746214853,
      "val_chorus_f1": 0.6379044684129429,
      "val_chorus_rate": 0.3368002511560917,
      "val_max_prob": 0.6272179409861565,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004222881349645247,
      "epoch_time": 1381.315975189209,
      "val_boundary_f1": 0.34979079497907944,
      "val_boundary_precision": 0.2710765239948119,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2353513349461243,
      "val_avg_segment_overlap": 0.6115146929977551,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.39976367463522844,
      "val_pk_metric": 0.29451383175509915
    },
    {
      "epoch": 2,
      "train_loss": 0.48189495694942963,
      "train_chorus_rate": 0.3518009951863533,
      "train_max_prob": 0.695102219398205,
      "train_conf_over_90": 0.04610148091645291,
      "train_conf_over_95": 0.003670472950220872,
      "val_loss": 0.4973002299666405,
      "val_macro_f1": 0.7430389629262121,
      "val_verse_f1": 0.8439428672191852,
      "val_chorus_f1": 0.6421350586332389,
      "val_chorus_rate": 0.30668756924569607,
      "val_max_prob": 0.7308966442942619,
      "val_conf_over_90": 0.051528666634112597,
      "val_conf_over_95": 0.0009876723343040794,
      "learning_rate": 0.00039161779569898394,
      "epoch_time": 1353.9965488910675,
      "val_boundary_f1": 0.39933993399339934,
      "val_boundary_precision": 0.30710659898477155,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.3189326185672118,
      "val_avg_segment_overlap": 0.6494197259383769,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.43669388718796404,
      "val_pk_metric": 0.29061028726543325
    },
    {
      "epoch": 3,
      "train_loss": 0.45684835161918247,
      "train_chorus_rate": 0.3712473442921272,
      "train_max_prob": 0.7247830491799575,
      "train_conf_over_90": 0.06913487379474995,
      "train_conf_over_95": 0.005021584632161718,
      "val_loss": 0.47447025030851364,
      "val_macro_f1": 0.7179862263261787,
      "val_verse_f1": 0.7847498014297061,
      "val_chorus_f1": 0.6512226512226512,
      "val_chorus_rate": 0.4629812240600586,
      "val_max_prob": 0.7381626293063164,
      "val_conf_over_90": 0.09691111417487264,
      "val_conf_over_95": 0.005378654372179881,
      "learning_rate": 0.00034384762233985466,
      "epoch_time": 1375.3502371311188,
      "val_boundary_f1": 0.2987124463519313,
      "val_boundary_precision": 0.23481781376518218,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.20073054581255004,
      "val_avg_segment_overlap": 0.5963124559594287,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.47353114569254523,
      "val_pk_metric": 0.3460859311828595
    },
    {
      "epoch": 4,
      "train_loss": 0.4288421021058009,
      "train_chorus_rate": 0.33234052742138886,
      "train_max_prob": 0.7501993637818557,
      "train_conf_over_90": 0.1072316030279184,
      "train_conf_over_95": 0.007741578568059664,
      "val_loss": 0.4569665156304836,
      "val_macro_f1": 0.7421055568750057,
      "val_verse_f1": 0.8106325184322856,
      "val_chorus_f1": 0.6735785953177257,
      "val_chorus_rate": 0.4342925623059273,
      "val_max_prob": 0.7171411961317062,
      "val_conf_over_90": 0.03966449905419722,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002836536922898973,
      "epoch_time": 663.645405292511,
      "val_boundary_f1": 0.35284139100932993,
      "val_boundary_precision": 0.27549668874172184,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.26939948189890883,
      "val_avg_segment_overlap": 0.6540111562743809,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4498936575717431,
      "val_pk_metric": 0.3100636351697662
    },
    {
      "epoch": 5,
      "train_loss": 0.42904711610231644,
      "train_chorus_rate": 0.3685388289965116,
      "train_max_prob": 0.7524644350394224,
      "train_conf_over_90": 0.11061329654871653,
      "train_conf_over_95": 0.011084377108953701,
      "val_loss": 0.45205068215727806,
      "val_macro_f1": 0.764604405596749,
      "val_verse_f1": 0.8449002014283098,
      "val_chorus_f1": 0.6843086097651883,
      "val_chorus_rate": 0.3572820648550987,
      "val_max_prob": 0.7587987557053566,
      "val_conf_over_90": 0.11098828841932118,
      "val_conf_over_95": 0.011255808029090986,
      "learning_rate": 0.0002169282068181733,
      "epoch_time": 1764.2033920288086,
      "val_boundary_f1": 0.4089219330855018,
      "val_boundary_precision": 0.3374233128834356,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.3190717802721297,
      "val_avg_segment_overlap": 0.6697209272819602,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3693245889775387,
      "val_pk_metric": 0.26244316413500784
    },
    {
      "epoch": 6,
      "train_loss": 0.4021415496483827,
      "train_chorus_rate": 0.3258077891973349,
      "train_max_prob": 0.7689575369541461,
      "train_conf_over_90": 0.1293319164751432,
      "train_conf_over_95": 0.01753832449993262,
      "val_loss": 0.4637700691819191,
      "val_macro_f1": 0.7843706317778896,
      "val_verse_f1": 0.8720097782434083,
      "val_chorus_f1": 0.6967314853123707,
      "val_chorus_rate": 0.29237030260264874,
      "val_max_prob": 0.802555225789547,
      "val_conf_over_90": 0.23381036147475243,
      "val_conf_over_95": 0.009740147506818175,
      "learning_rate": 0.0001502027213464494,
      "epoch_time": 1162.0579748153687,
      "val_boundary_f1": 0.463855421686747,
      "val_boundary_precision": 0.40384615384615385,
      "val_boundary_recall": 0.5448113207547169,
      "val_complete_segments": 0.3478430818901692,
      "val_avg_segment_overlap": 0.6698748624850879,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.31313679315109993,
      "val_pk_metric": 0.22765543636658672
    },
    {
      "epoch": 7,
      "train_loss": 0.4018929669490227,
      "train_chorus_rate": 0.31566908611701083,
      "train_max_prob": 0.7761036447989635,
      "train_conf_over_90": 0.14208373561119422,
      "train_conf_over_95": 0.013389988479992518,
      "val_loss": 0.4475562758743763,
      "val_macro_f1": 0.780106832510564,
      "val_verse_f1": 0.8630527817403708,
      "val_chorus_f1": 0.6971608832807571,
      "val_chorus_rate": 0.32182834297418594,
      "val_max_prob": 0.7708488777279854,
      "val_conf_over_90": 0.11919414298608899,
      "val_conf_over_95": 0.009007327549625188,
      "learning_rate": 9.000879129649202e-05,
      "epoch_time": 1305.723283290863,
      "val_boundary_f1": 0.4358974358974359,
      "val_boundary_precision": 0.37457627118644066,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.33084825895281866,
      "val_avg_segment_overlap": 0.6674862450084533,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3318576493310278,
      "val_pk_metric": 0.2384272589334636
    },
    {
      "epoch": 8,
      "train_loss": 0.39323586454758275,
      "train_chorus_rate": 0.31229130579875064,
      "train_max_prob": 0.779666617894784,
      "train_conf_over_90": 0.15147104400854844,
      "train_conf_over_95": 0.019209820595092308,
      "val_loss": 0.4521612338721752,
      "val_macro_f1": 0.7603170745903307,
      "val_verse_f1": 0.8293612964728313,
      "val_chorus_f1": 0.6912728527078302,
      "val_chorus_rate": 0.41189510002732277,
      "val_max_prob": 0.7695420011878014,
      "val_conf_over_90": 0.1669339658692479,
      "val_conf_over_95": 0.025750803702976555,
      "learning_rate": 4.223861793736273e-05,
      "epoch_time": 8415.431216955185,
      "val_boundary_f1": 0.39579684763572687,
      "val_boundary_precision": 0.3147632311977716,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.3123090356075088,
      "val_avg_segment_overlap": 0.6735860464341774,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.40050789878518667,
      "val_pk_metric": 0.2793762818426416
    },
    {
      "epoch": 9,
      "train_loss": 0.37633796685781234,
      "train_chorus_rate": 0.3089806120365094,
      "train_max_prob": 0.7878406154803741,
      "train_conf_over_90": 0.1737851836742499,
      "train_conf_over_95": 0.018396023493737746,
      "val_loss": 0.45012904703617096,
      "val_macro_f1": 0.7710012496820727,
      "val_verse_f1": 0.851589464123524,
      "val_chorus_f1": 0.6904130352406215,
      "val_chorus_rate": 0.34764382243156433,
      "val_max_prob": 0.7831094264984131,
      "val_conf_over_90": 0.18211401998996735,
      "val_conf_over_95": 0.020883951510768384,
      "learning_rate": 1.1568278671821984e-05,
      "epoch_time": 491.7702820301056,
      "val_boundary_f1": 0.41799437675726336,
      "val_boundary_precision": 0.3468118195956454,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.3145440309040298,
      "val_avg_segment_overlap": 0.6647005937379125,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3704350858700226,
      "val_pk_metric": 0.2578357239904729
    },
    {
      "epoch": 10,
      "train_loss": 0.373044015505375,
      "train_chorus_rate": 0.3021918840897389,
      "train_max_prob": 0.7928636777095306,
      "train_conf_over_90": 0.18366470837440246,
      "train_conf_over_95": 0.021627193728748422,
      "val_loss": 0.45152194425463676,
      "val_macro_f1": 0.7687789727844077,
      "val_verse_f1": 0.8490703609187022,
      "val_chorus_f1": 0.688487584650113,
      "val_chorus_rate": 0.352506335824728,
      "val_max_prob": 0.7881888449192047,
      "val_conf_over_90": 0.1964379558339715,
      "val_conf_over_95": 0.02364161895820871,
      "learning_rate": 0.00043285641363634665,
      "epoch_time": 528.3027050495148,
      "val_boundary_f1": 0.4265668849391955,
      "val_boundary_precision": 0.35348837209302325,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.329543382260914,
      "val_avg_segment_overlap": 0.6652741386925629,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.36300642397148275,
      "val_pk_metric": 0.25498368635825885
    },
    {
      "epoch": 11,
      "train_loss": 0.3901851979585794,
      "train_chorus_rate": 0.32538526906416965,
      "train_max_prob": 0.7851278904156808,
      "train_conf_over_90": 0.19956495211674616,
      "train_conf_over_95": 0.03301065815135072,
      "val_loss": 0.4755589924752712,
      "val_macro_f1": 0.7757076022266968,
      "val_verse_f1": 0.8687955570982299,
      "val_chorus_f1": 0.6826196473551637,
      "val_chorus_rate": 0.2840552479028702,
      "val_max_prob": 0.7960928231477737,
      "val_conf_over_90": 0.1664795344695449,
      "val_conf_over_95": 0.0027099678409285843,
      "learning_rate": 0.00043019797909809866,
      "epoch_time": 10329.535191059113,
      "val_boundary_f1": 0.4274809160305343,
      "val_boundary_precision": 0.3975659229208925,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.29808229033895206,
      "val_avg_segment_overlap": 0.6373661909476136,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.2915821983686254,
      "val_pk_metric": 0.22249188087577484
    },
    {
      "epoch": 12,
      "train_loss": 0.37881787541585094,
      "train_chorus_rate": 0.2894156128168106,
      "train_max_prob": 0.7884902663719959,
      "train_conf_over_90": 0.17854356037405056,
      "train_conf_over_95": 0.029057080511194773,
      "val_loss": 0.462234552949667,
      "val_macro_f1": 0.7840219362481305,
      "val_verse_f1": 0.8655971479500891,
      "val_chorus_f1": 0.702446724546172,
      "val_chorus_rate": 0.32124214619398117,
      "val_max_prob": 0.8177009895443916,
      "val_conf_over_90": 0.2788135204464197,
      "val_conf_over_95": 0.04161838837899268,
      "learning_rate": 0.0004222881349645247,
      "epoch_time": 1621.9086327552795,
      "val_boundary_f1": 0.43718079673135857,
      "val_boundary_precision": 0.3855855855855856,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.3155748187717852,
      "val_avg_segment_overlap": 0.6752050103524665,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.2922576943973732,
      "val_pk_metric": 0.21318103370785646
    },
    {
      "epoch": 13,
      "train_loss": 0.35164941350619,
      "train_chorus_rate": 0.29594181286983,
      "train_max_prob": 0.8128995482738202,
      "train_conf_over_90": 0.24530392388502756,
      "train_conf_over_95": 0.04551258626190993,
      "val_loss": 0.45750565826892853,
      "val_macro_f1": 0.7741391643751644,
      "val_verse_f1": 0.8510716248397142,
      "val_chorus_f1": 0.6972067039106146,
      "val_chorus_rate": 0.36022043973207474,
      "val_max_prob": 0.807897761464119,
      "val_conf_over_90": 0.2595255170017481,
      "val_conf_over_95": 0.08291599247604609,
      "learning_rate": 0.00040932164784946096,
      "epoch_time": 9342.245788097382,
      "val_boundary_f1": 0.45204178537511874,
      "val_boundary_precision": 0.3783783783783784,
      "val_boundary_recall": 0.5613207547169812,
      "val_complete_segments": 0.34212016483312924,
      "val_avg_segment_overlap": 0.672071299589811,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.3594394953698321,
      "val_pk_metric": 0.24291747966703275
    },
    {
      "epoch": 14,
      "train_loss": 0.35649998371417707,
      "train_chorus_rate": 0.3120256156111375,
      "train_max_prob": 0.8119114010761945,
      "train_conf_over_90": 0.25916099758484423,
      "train_conf_over_95": 0.04654908405604939,
      "val_loss": 0.46567245945334435,
      "val_macro_f1": 0.7730669850926815,
      "val_verse_f1": 0.8555475504322766,
      "val_chorus_f1": 0.6905864197530863,
      "val_chorus_rate": 0.33596161007881165,
      "val_max_prob": 0.8060336783528328,
      "val_conf_over_90": 0.23298116959631443,
      "val_conf_over_95": 0.09260731702670455,
      "learning_rate": 0.00039161779569898394,
      "epoch_time": 3515.0710792541504,
      "val_boundary_f1": 0.4511581067472306,
      "val_boundary_precision": 0.3936731107205624,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3181389041179012,
      "val_avg_segment_overlap": 0.6648068173731423,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3301821694251761,
      "val_pk_metric": 0.23927920320015025
    }
  ]
}