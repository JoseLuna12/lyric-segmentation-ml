{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.15344673956102925,
      "layer_dropout": 0.18231908435577487,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.10644680233790059,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1124099,
      "lstm_params": 983040,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00012315351056193518,
      "scheduler": "plateau",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 16,
      "validation_strategy": "line_f1",
      "weight_decay": 2.2255561728010985e-06,
      "gradient_clip_norm": 1.8862347155371426,
      "max_epochs": 25,
      "patience": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05359037347825899,
        "ece_after": 0.011362548880937736,
        "improvement": 0.04222782459732126,
        "params": {
          "temperature": 0.7253143294932424
        }
      },
      "platt": {
        "ece_before": 0.05359037347825899,
        "ece_after": 0.018500438959050493,
        "improvement": 0.0350899345192085,
        "params": {
          "A": 1.2833309792453431,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6110669404268265,
      "train_chorus_rate": 0.4092893501743674,
      "train_max_prob": 0.5380678117275238,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6494838744401932,
      "val_macro_f1": 0.4984530372795202,
      "val_verse_f1": 0.5373746581586144,
      "val_chorus_f1": 0.45953141640042594,
      "val_chorus_rate": 0.6231468766927719,
      "val_max_prob": 0.5390850007534027,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 689.5596837997437,
      "val_boundary_f1": 0.053763440860215055,
      "val_boundary_precision": 0.11194029850746269,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.01456539481459948,
      "val_avg_segment_overlap": 0.20642700708017284,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4063464184465975,
      "val_pk_metric": 0.39985780664680565
    },
    {
      "epoch": 2,
      "train_loss": 0.6204811751842498,
      "train_chorus_rate": 0.6125394195318222,
      "train_max_prob": 0.5536395847797394,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6484552472829819,
      "val_macro_f1": 0.5879995262144678,
      "val_verse_f1": 0.7500881212548467,
      "val_chorus_f1": 0.425910931174089,
      "val_chorus_rate": 0.3071046322584152,
      "val_max_prob": 0.547427698969841,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 619.9825987815857,
      "val_boundary_f1": 0.058519793459552494,
      "val_boundary_precision": 0.10828025477707007,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.04552366144359782,
      "val_avg_segment_overlap": 0.25563486540761615,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3745584651523187,
      "val_pk_metric": 0.36773413415019873
    },
    {
      "epoch": 3,
      "train_loss": 0.6017044305801391,
      "train_chorus_rate": 0.5640336714684964,
      "train_max_prob": 0.5627587795257568,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.653908759355545,
      "val_macro_f1": 0.554798938598504,
      "val_verse_f1": 0.7899726819861803,
      "val_chorus_f1": 0.3196251952108278,
      "val_chorus_rate": 0.17139174416661263,
      "val_max_prob": 0.5787787586450577,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 354.0827360153198,
      "val_boundary_f1": 0.045540796963946875,
      "val_boundary_precision": 0.11650485436893204,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.05505335664402472,
      "val_avg_segment_overlap": 0.22683430412468253,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3127002611265412,
      "val_pk_metric": 0.3005554219447663
    },
    {
      "epoch": 4,
      "train_loss": 0.5984670132398605,
      "train_chorus_rate": 0.4144877605140209,
      "train_max_prob": 0.5801534354686737,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6325098872184753,
      "val_macro_f1": 0.5311180345259254,
      "val_verse_f1": 0.5638200183654729,
      "val_chorus_f1": 0.49841605068637806,
      "val_chorus_rate": 0.6314229518175125,
      "val_max_prob": 0.5720667541027069,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 1052.2301850318909,
      "val_boundary_f1": 0.07130730050933785,
      "val_boundary_precision": 0.12727272727272726,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.03358592268984634,
      "val_avg_segment_overlap": 0.2475302741998408,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4028456032654718,
      "val_pk_metric": 0.40279755898516995
    },
    {
      "epoch": 5,
      "train_loss": 0.5660147249698639,
      "train_chorus_rate": 0.48894898891448973,
      "train_max_prob": 0.6001312106847763,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6219034492969513,
      "val_macro_f1": 0.6025796865885216,
      "val_verse_f1": 0.6740216486261449,
      "val_chorus_f1": 0.5311377245508981,
      "val_chorus_rate": 0.5224921554327011,
      "val_max_prob": 0.5675686448812485,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 337.6720108985901,
      "val_boundary_f1": 0.12138728323699421,
      "val_boundary_precision": 0.15671641791044777,
      "val_boundary_recall": 0.09905660377358491,
      "val_complete_segments": 0.05745309201035606,
      "val_avg_segment_overlap": 0.3295540598046633,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.415638624891262,
      "val_pk_metric": 0.3888984848255509
    },
    {
      "epoch": 6,
      "train_loss": 0.5697587102651596,
      "train_chorus_rate": 0.49517682790756223,
      "train_max_prob": 0.6108819603919983,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6228523701429367,
      "val_macro_f1": 0.6512632631912458,
      "val_verse_f1": 0.776130198915009,
      "val_chorus_f1": 0.5263963274674828,
      "val_chorus_rate": 0.3429463654756546,
      "val_max_prob": 0.605509415268898,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 285.4052309989929,
      "val_boundary_f1": 0.16172506738544473,
      "val_boundary_precision": 0.18867924528301888,
      "val_boundary_recall": 0.14150943396226415,
      "val_complete_segments": 0.07571232041009347,
      "val_avg_segment_overlap": 0.40379395858961636,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.12626262626262627,
      "val_window_diff": 0.3798390326166225,
      "val_pk_metric": 0.3500647449478435
    },
    {
      "epoch": 7,
      "train_loss": 0.569157961010933,
      "train_chorus_rate": 0.4569156542420387,
      "train_max_prob": 0.6336857795715332,
      "train_conf_over_90": 0.00010445682564750314,
      "train_conf_over_95": 0.0,
      "val_loss": 0.602942943572998,
      "val_macro_f1": 0.5978899454670958,
      "val_verse_f1": 0.6469687021230028,
      "val_chorus_f1": 0.5488111888111888,
      "val_chorus_rate": 0.5790366977453232,
      "val_max_prob": 0.6134652197360992,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 369.704176902771,
      "val_boundary_f1": 0.14842767295597484,
      "val_boundary_precision": 0.15902964959568733,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.054095594989020224,
      "val_avg_segment_overlap": 0.3685378313998204,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.45897360844238166,
      "val_pk_metric": 0.4112901708625234
    },
    {
      "epoch": 8,
      "train_loss": 0.5622515797615051,
      "train_chorus_rate": 0.4750985711812973,
      "train_max_prob": 0.6382052451372147,
      "train_conf_over_90": 0.0038701286888681353,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6007174551486969,
      "val_macro_f1": 0.6654162778641783,
      "val_verse_f1": 0.7534992223950233,
      "val_chorus_f1": 0.5773333333333334,
      "val_chorus_rate": 0.43829314410686493,
      "val_max_prob": 0.6156232059001923,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 658.2181470394135,
      "val_boundary_f1": 0.20160366552119127,
      "val_boundary_precision": 0.19599109131403117,
      "val_boundary_recall": 0.20754716981132076,
      "val_complete_segments": 0.10050937545635319,
      "val_avg_segment_overlap": 0.4772645198638693,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.17676767676767677,
      "val_window_diff": 0.4117802496560367,
      "val_pk_metric": 0.36010213379913003
    },
    {
      "epoch": 9,
      "train_loss": 0.5356552243232727,
      "train_chorus_rate": 0.3933145307004452,
      "train_max_prob": 0.6630232989788055,
      "train_conf_over_90": 0.00353273973450996,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5938557684421539,
      "val_macro_f1": 0.6461815559462867,
      "val_verse_f1": 0.7194303153611393,
      "val_chorus_f1": 0.5729327965314339,
      "val_chorus_rate": 0.4947047382593155,
      "val_max_prob": 0.6289705187082291,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 296.4248080253601,
      "val_boundary_f1": 0.20796460176991152,
      "val_boundary_precision": 0.19583333333333333,
      "val_boundary_recall": 0.22169811320754718,
      "val_complete_segments": 0.10070042963733314,
      "val_avg_segment_overlap": 0.4663137518350011,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.19696969696969696,
      "val_window_diff": 0.4137311540358878,
      "val_pk_metric": 0.3632983701300233
    },
    {
      "epoch": 10,
      "train_loss": 0.5346935883164405,
      "train_chorus_rate": 0.40043594092130663,
      "train_max_prob": 0.6586191207170486,
      "train_conf_over_90": 0.00394222387985792,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5944833904504776,
      "val_macro_f1": 0.6562087526810757,
      "val_verse_f1": 0.7433385579937304,
      "val_chorus_f1": 0.569078947368421,
      "val_chorus_rate": 0.44829297065734863,
      "val_max_prob": 0.6492960005998611,
      "val_conf_over_90": 0.0010146414279006422,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 360.75189685821533,
      "val_boundary_f1": 0.20594479830148618,
      "val_boundary_precision": 0.18725868725868725,
      "val_boundary_recall": 0.22877358490566038,
      "val_complete_segments": 0.0946586205202324,
      "val_avg_segment_overlap": 0.4966275702236386,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.4433569923684977,
      "val_pk_metric": 0.3688176342562399
    },
    {
      "epoch": 11,
      "train_loss": 0.5274117663502693,
      "train_chorus_rate": 0.4012372300028801,
      "train_max_prob": 0.6720102459192276,
      "train_conf_over_90": 0.008572483051102609,
      "train_conf_over_95": 2.788622514344752e-05,
      "val_loss": 0.598589614033699,
      "val_macro_f1": 0.6239276765740351,
      "val_verse_f1": 0.6934715025906735,
      "val_chorus_f1": 0.5543838505573968,
      "val_chorus_rate": 0.5170016959309578,
      "val_max_prob": 0.6505694687366486,
      "val_conf_over_90": 0.004481229902012274,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 342.20180892944336,
      "val_boundary_f1": 0.1714898177920686,
      "val_boundary_precision": 0.15717092337917485,
      "val_boundary_recall": 0.18867924528301888,
      "val_complete_segments": 0.08119386429301594,
      "val_avg_segment_overlap": 0.44578750448642424,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.46847780705581626,
      "val_pk_metric": 0.3833959180367312
    },
    {
      "epoch": 12,
      "train_loss": 0.5229198157787323,
      "train_chorus_rate": 0.4000979319214821,
      "train_max_prob": 0.6724151521921158,
      "train_conf_over_90": 0.008599173289258032,
      "train_conf_over_95": 6.738556548953056e-05,
      "val_loss": 0.5894273668527603,
      "val_macro_f1": 0.6656564510806797,
      "val_verse_f1": 0.7503918495297806,
      "val_chorus_f1": 0.5809210526315789,
      "val_chorus_rate": 0.4484478086233139,
      "val_max_prob": 0.6649974137544632,
      "val_conf_over_90": 0.004220524511765689,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 368.06053590774536,
      "val_boundary_f1": 0.2351716961498439,
      "val_boundary_precision": 0.21042830540037244,
      "val_boundary_recall": 0.2665094339622642,
      "val_complete_segments": 0.12489204474888463,
      "val_avg_segment_overlap": 0.51075989524914,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.44296601041435524,
      "val_pk_metric": 0.36003872483983723
    },
    {
      "epoch": 13,
      "train_loss": 0.5015943601727486,
      "train_chorus_rate": 0.3827319070696831,
      "train_max_prob": 0.6944943934679031,
      "train_conf_over_90": 0.02582241884083487,
      "train_conf_over_95": 0.0013851613679435105,
      "val_loss": 0.5889981985092163,
      "val_macro_f1": 0.6245605976443298,
      "val_verse_f1": 0.6751785327851115,
      "val_chorus_f1": 0.5739426625035482,
      "val_chorus_rate": 0.5671745538711548,
      "val_max_prob": 0.6710869371891022,
      "val_conf_over_90": 0.021469505270943046,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 350.23822379112244,
      "val_boundary_f1": 0.19155509783728114,
      "val_boundary_precision": 0.170018281535649,
      "val_boundary_recall": 0.21933962264150944,
      "val_complete_segments": 0.08956517303548056,
      "val_avg_segment_overlap": 0.47106600527325587,
      "val_verse_to_chorus_acc": 0.18141592920353983,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.5091705213333022,
      "val_pk_metric": 0.40955080311361874
    },
    {
      "epoch": 14,
      "train_loss": 0.5182618409395218,
      "train_chorus_rate": 0.3990946650505066,
      "train_max_prob": 0.6854468643665313,
      "train_conf_over_90": 0.016472157562384383,
      "train_conf_over_95": 0.0003362828283570707,
      "val_loss": 0.5864120274782181,
      "val_macro_f1": 0.6919825692707048,
      "val_verse_f1": 0.7900912646675358,
      "val_chorus_f1": 0.5938738738738738,
      "val_chorus_rate": 0.3831537812948227,
      "val_max_prob": 0.6694851368665695,
      "val_conf_over_90": 0.006737502641044557,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 883.4315819740295,
      "val_boundary_f1": 0.25699481865284973,
      "val_boundary_precision": 0.22920517560073936,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.1478466271149198,
      "val_avg_segment_overlap": 0.5466629221878698,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.39475433298232787,
      "val_pk_metric": 0.321101866425052
    },
    {
      "epoch": 15,
      "train_loss": 0.506569667160511,
      "train_chorus_rate": 0.39797631204128264,
      "train_max_prob": 0.6958340764045715,
      "train_conf_over_90": 0.028491063101682812,
      "train_conf_over_95": 0.0018885950790718197,
      "val_loss": 0.5841222852468491,
      "val_macro_f1": 0.6909604334070625,
      "val_verse_f1": 0.7873455634593785,
      "val_chorus_f1": 0.5945753033547466,
      "val_chorus_rate": 0.39013344049453735,
      "val_max_prob": 0.680478498339653,
      "val_conf_over_90": 0.01122918352484703,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 342.8849518299103,
      "val_boundary_f1": 0.2545090180360722,
      "val_boundary_precision": 0.22125435540069685,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.13925439225015046,
      "val_avg_segment_overlap": 0.5476353733202539,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.4139266374412268,
      "val_pk_metric": 0.33817501654804155
    },
    {
      "epoch": 16,
      "train_loss": 0.5100438192486763,
      "train_chorus_rate": 0.4014857649803162,
      "train_max_prob": 0.7020415782928466,
      "train_conf_over_90": 0.03380211973562837,
      "train_conf_over_95": 0.0024422251415671782,
      "val_loss": 0.5953738540410995,
      "val_macro_f1": 0.6895939452796968,
      "val_verse_f1": 0.7989831124023969,
      "val_chorus_f1": 0.5802047781569966,
      "val_chorus_rate": 0.3489767983555794,
      "val_max_prob": 0.6685553938150406,
      "val_conf_over_90": 0.010716983757447451,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012315351056193518,
      "epoch_time": 311.2683160305023,
      "val_boundary_f1": 0.2649402390438247,
      "val_boundary_precision": 0.2293103448275862,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.1439019954661524,
      "val_avg_segment_overlap": 0.5622950412548147,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.44178514652807094,
      "val_pk_metric": 0.3442460784875129
    }
  ]
}