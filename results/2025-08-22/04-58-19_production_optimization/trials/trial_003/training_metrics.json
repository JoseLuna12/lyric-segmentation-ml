{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.3594587638125827,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1278707165537482,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 704259,
      "lstm_params": 563200,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00019463967868936125,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.00013092513394063327,
      "gradient_clip_norm": 0.7207542939336038,
      "max_epochs": 30,
      "patience": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.023770972105632386,
        "ece_after": 0.021272547016092266,
        "improvement": 0.0024984250895401204,
        "params": {
          "temperature": 0.7149103093822643
        }
      },
      "platt": {
        "ece_before": 0.023770972105632386,
        "ece_after": 0.028241037883318252,
        "improvement": -0.004470065777685866,
        "params": {
          "A": 1.1747936969017325,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.571003657579422,
      "train_chorus_rate": 0.5738346226513386,
      "train_max_prob": 0.53896404504776,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6169652938842773,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.5459762215614319,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019410928947900412,
      "epoch_time": 162.36574506759644,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05860871647509579,
      "val_avg_segment_overlap": 0.16652069003437917,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26503295450423625,
      "val_pk_metric": 0.2713936688312747
    },
    {
      "epoch": 2,
      "train_loss": 0.581595242023468,
      "train_chorus_rate": 0.49000711664557456,
      "train_max_prob": 0.5430636703968048,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6041889190673828,
      "val_macro_f1": 0.31999511362995164,
      "val_verse_f1": 0.1715362865221489,
      "val_chorus_f1": 0.4684539407377544,
      "val_chorus_rate": 0.9184355139732361,
      "val_max_prob": 0.5521367788314819,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019252393290311248,
      "epoch_time": 126.30958580970764,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.10515100882777328,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.29782257582061733,
      "val_pk_metric": 0.297852606838677
    },
    {
      "epoch": 3,
      "train_loss": 0.5755608022212982,
      "train_chorus_rate": 0.6157393038272858,
      "train_max_prob": 0.5420509159564972,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6017832159996033,
      "val_macro_f1": 0.5060931592994107,
      "val_verse_f1": 0.5445431761221236,
      "val_chorus_f1": 0.46764314247669775,
      "val_chorus_rate": 0.6223640739917755,
      "val_max_prob": 0.5364044010639191,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018990097846008903,
      "epoch_time": 799.4724638462067,
      "val_boundary_f1": 0.07381370826010544,
      "val_boundary_precision": 0.14482758620689656,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.033045977011494254,
      "val_avg_segment_overlap": 0.22087034514215034,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4188549925806525,
      "val_pk_metric": 0.4212466179009766
    },
    {
      "epoch": 4,
      "train_loss": 0.5552970588207244,
      "train_chorus_rate": 0.5908597022294998,
      "train_max_prob": 0.5490612030029297,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5993739366531372,
      "val_macro_f1": 0.5265463615023473,
      "val_verse_f1": 0.5814260563380281,
      "val_chorus_f1": 0.4716666666666667,
      "val_chorus_rate": 0.5843528509140015,
      "val_max_prob": 0.5420721173286438,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018626916378769996,
      "epoch_time": 132.0933129787445,
      "val_boundary_f1": 0.07407407407407407,
      "val_boundary_precision": 0.12941176470588237,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.039990421455938695,
      "val_avg_segment_overlap": 0.23516147576608376,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3975377763214517,
      "val_pk_metric": 0.396319945775507
    },
    {
      "epoch": 5,
      "train_loss": 0.5584485411643982,
      "train_chorus_rate": 0.5757464498281479,
      "train_max_prob": 0.5659041166305542,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5966376066207886,
      "val_macro_f1": 0.5070206016830904,
      "val_verse_f1": 0.5200956937799043,
      "val_chorus_f1": 0.4939455095862765,
      "val_chorus_rate": 0.6736605763435364,
      "val_max_prob": 0.5644898116588593,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018166827980750216,
      "epoch_time": 128.66073083877563,
      "val_boundary_f1": 0.07868852459016394,
      "val_boundary_precision": 0.12903225806451613,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.040708812260536395,
      "val_avg_segment_overlap": 0.22833781998744543,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.41590441742310313,
      "val_pk_metric": 0.40518925656760035
    },
    {
      "epoch": 6,
      "train_loss": 0.5372291296720505,
      "train_chorus_rate": 0.5270721942186356,
      "train_max_prob": 0.5945501744747161,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5942496955394745,
      "val_macro_f1": 0.5826685704904004,
      "val_verse_f1": 0.6552301255230125,
      "val_chorus_f1": 0.5101070154577884,
      "val_chorus_rate": 0.5263654887676239,
      "val_max_prob": 0.568615198135376,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017614873476717944,
      "epoch_time": 125.41254210472107,
      "val_boundary_f1": 0.10810810810810811,
      "val_boundary_precision": 0.1487603305785124,
      "val_boundary_recall": 0.08490566037735849,
      "val_complete_segments": 0.06555316091954022,
      "val_avg_segment_overlap": 0.2730172154640714,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.0707070707070707,
      "val_window_diff": 0.37018309474480354,
      "val_pk_metric": 0.3484267193491062
    },
    {
      "epoch": 7,
      "train_loss": 0.5575395166873932,
      "train_chorus_rate": 0.5329832136631012,
      "train_max_prob": 0.5824460864067078,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5995333194732666,
      "val_macro_f1": 0.5808280544470251,
      "val_verse_f1": 0.7453262786596121,
      "val_chorus_f1": 0.41632983023443815,
      "val_chorus_rate": 0.30749280750751495,
      "val_max_prob": 0.5681317746639252,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016977100195723267,
      "epoch_time": 118.00513100624084,
      "val_boundary_f1": 0.13643410852713178,
      "val_boundary_precision": 0.19909502262443438,
      "val_boundary_recall": 0.10377358490566038,
      "val_complete_segments": 0.06800766283524903,
      "val_avg_segment_overlap": 0.28296406608558844,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.08585858585858586,
      "val_window_diff": 0.3399097675104252,
      "val_pk_metric": 0.30787257367265763
    },
    {
      "epoch": 8,
      "train_loss": 0.5530212223529816,
      "train_chorus_rate": 0.515669372677803,
      "train_max_prob": 0.5914341151714325,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5881987810134888,
      "val_macro_f1": 0.5843832275151661,
      "val_verse_f1": 0.6588921282798834,
      "val_chorus_f1": 0.5098743267504489,
      "val_chorus_rate": 0.5208311676979065,
      "val_max_prob": 0.5739467144012451,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016260495715295404,
      "epoch_time": 191.3587372303009,
      "val_boundary_f1": 0.1272475795297372,
      "val_boundary_precision": 0.15384615384615385,
      "val_boundary_recall": 0.10849056603773585,
      "val_complete_segments": 0.07147988505747127,
      "val_avg_segment_overlap": 0.29671158202112147,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.3782103960157318,
      "val_pk_metric": 0.34861444096160965
    }
  ]
}