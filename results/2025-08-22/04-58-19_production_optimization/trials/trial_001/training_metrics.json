{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.35679952889716116,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2043483753919857,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 298755,
      "lstm_params": 157696,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00016953740528513262,
      "scheduler": "plateau",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 4,
      "validation_strategy": "line_f1",
      "weight_decay": 6.096759145708966e-06,
      "gradient_clip_norm": 1.6701120339506819,
      "max_epochs": 27,
      "patience": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05200443226544002,
        "ece_after": 0.033338823580788726,
        "improvement": 0.018665608684651294,
        "params": {
          "temperature": 0.20464375881535074
        }
      },
      "platt": {
        "ece_before": 0.05200443226544002,
        "ece_after": 0.04690565953437376,
        "improvement": 0.0050987727310662576,
        "params": {
          "A": 2.5032781440175134,
          "B": -8.948412297811963e-05
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5432950973510742,
      "train_chorus_rate": 0.5378796577453613,
      "train_max_prob": 0.529804116487503,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5712014734745026,
      "val_macro_f1": 0.5354577315416094,
      "val_verse_f1": 0.6634578359645746,
      "val_chorus_f1": 0.4074576271186441,
      "val_chorus_rate": 0.4244653880596161,
      "val_max_prob": 0.5187252759933472,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016953740528513262,
      "epoch_time": 3005.0492780208588,
      "val_boundary_f1": 0.08348457350272231,
      "val_boundary_precision": 0.18110236220472442,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.02137212643678161,
      "val_avg_segment_overlap": 0.2121738904662999,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4093719794694401,
      "val_pk_metric": 0.4175735331143957
    },
    {
      "epoch": 2,
      "train_loss": 0.5314863920211792,
      "train_chorus_rate": 0.3847894877195358,
      "train_max_prob": 0.5388735353946685,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5680810511112213,
      "val_macro_f1": 0.4883207700699387,
      "val_verse_f1": 0.5339346110484781,
      "val_chorus_f1": 0.4427069290913993,
      "val_chorus_rate": 0.6110396981239319,
      "val_max_prob": 0.5334014296531677,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016953740528513262,
      "epoch_time": 2507.017729997635,
      "val_boundary_f1": 0.03669724770642203,
      "val_boundary_precision": 0.08264462809917356,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.005387931034482758,
      "val_avg_segment_overlap": 0.2011743465452036,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4303487303509579,
      "val_pk_metric": 0.4330759139738448
    },
    {
      "epoch": 3,
      "train_loss": 0.5239914447069168,
      "train_chorus_rate": 0.4107696533203125,
      "train_max_prob": 0.5502012133598327,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.566114068031311,
      "val_macro_f1": 0.4870373512489239,
      "val_verse_f1": 0.5020281555714626,
      "val_chorus_f1": 0.47204654692638515,
      "val_chorus_rate": 0.6709493696689606,
      "val_max_prob": 0.5435892939567566,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016953740528513262,
      "epoch_time": 1124.4773952960968,
      "val_boundary_f1": 0.04779411764705883,
      "val_boundary_precision": 0.10833333333333334,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.029394157088122604,
      "val_avg_segment_overlap": 0.21032228617333043,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42094615871150554,
      "val_pk_metric": 0.43239958865417416
    },
    {
      "epoch": 4,
      "train_loss": 0.5326649248600006,
      "train_chorus_rate": 0.4692823976278305,
      "train_max_prob": 0.5588501691818237,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5660922825336456,
      "val_macro_f1": 0.4839332024457771,
      "val_verse_f1": 0.49736716132120623,
      "val_chorus_f1": 0.470499243570348,
      "val_chorus_rate": 0.6741633415222168,
      "val_max_prob": 0.5553129017353058,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016953740528513262,
      "epoch_time": 323.79822993278503,
      "val_boundary_f1": 0.040740740740740744,
      "val_boundary_precision": 0.09482758620689655,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.02747844827586207,
      "val_avg_segment_overlap": 0.20645056766013753,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4098735360478209,
      "val_pk_metric": 0.42249282586088766
    }
  ]
}