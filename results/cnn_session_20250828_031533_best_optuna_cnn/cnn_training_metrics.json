{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.3842810256530799,
      "layer_dropout": 0.17675161631734992,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 221314,
      "cnn_params": 131840,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007771901374109088,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.023188316751791123,
        "ece_after": 0.018838332815933754,
        "improvement": 0.004349983935857369,
        "params": {
          "temperature": 0.9473971360648306
        }
      },
      "platt": {
        "ece_before": 0.023188316751791123,
        "ece_after": 0.02110074513202097,
        "improvement": 0.0020875716197701517,
        "params": {
          "A": 0.9582263215527819,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5821749998463525,
      "train_chorus_rate": 0.6011573142475553,
      "train_max_prob": 0.5364146067036523,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5868606567382812,
      "val_macro_f1": 0.5838461383708531,
      "val_verse_f1": 0.6505820105820105,
      "val_chorus_f1": 0.5171102661596958,
      "val_chorus_rate": 0.5413346588611603,
      "val_max_prob": 0.5407751500606537,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.570605533590387e-05,
      "epoch_time": 53.33346462249756,
      "val_boundary_f1": 0.17880794701986755,
      "val_boundary_precision": 0.12430939226519337,
      "val_boundary_recall": 0.31839622641509435,
      "val_complete_segments": 0.04462385983302071,
      "val_avg_segment_overlap": 0.43410352350197673,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.5301030600484682,
      "val_pk_metric": 0.41747092593066937,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.1399596863322787,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5603616204526689,
      "train_chorus_rate": 0.518197410636478,
      "train_max_prob": 0.5630585683716668,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5686188340187073,
      "val_macro_f1": 0.6384361953745515,
      "val_verse_f1": 0.7294486953109671,
      "val_chorus_f1": 0.547423695438136,
      "val_chorus_rate": 0.448203943669796,
      "val_max_prob": 0.5825299322605133,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.9447050175117956e-05,
      "epoch_time": 40.179826974868774,
      "val_boundary_f1": 0.18242122719734663,
      "val_boundary_precision": 0.14066496163682865,
      "val_boundary_recall": 0.25943396226415094,
      "val_complete_segments": 0.07928114310934568,
      "val_avg_segment_overlap": 0.4780574854168672,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.2878787878787879,
      "val_window_diff": 0.4880854281224376,
      "val_pk_metric": 0.38160615907345374,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2792380021678076,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.543573773569531,
      "train_chorus_rate": 0.43462929957442814,
      "train_max_prob": 0.604187140862147,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5543271154165268,
      "val_macro_f1": 0.6257974609817394,
      "val_verse_f1": 0.6806596701649176,
      "val_chorus_f1": 0.5709352517985611,
      "val_chorus_rate": 0.5531729161739349,
      "val_max_prob": 0.6143822520971298,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.197035744445357e-05,
      "epoch_time": 39.87275290489197,
      "val_boundary_f1": 0.18181818181818182,
      "val_boundary_precision": 0.1436388508891929,
      "val_boundary_recall": 0.24764150943396226,
      "val_complete_segments": 0.04653162814005664,
      "val_avg_segment_overlap": 0.4745414506218566,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.4926721189435379,
      "val_pk_metric": 0.39411672251760715,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2453634308444128,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5298652235004637,
      "train_chorus_rate": 0.4087527145942052,
      "train_max_prob": 0.6387268933984969,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5462616384029388,
      "val_macro_f1": 0.6234955695389752,
      "val_verse_f1": 0.6676923076923077,
      "val_chorus_f1": 0.5792988313856426,
      "val_chorus_rate": 0.584233283996582,
      "val_max_prob": 0.648942768573761,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010271829097938047,
      "epoch_time": 38.66146397590637,
      "val_boundary_f1": 0.19012115563839702,
      "val_boundary_precision": 0.15716486902927582,
      "val_boundary_recall": 0.24056603773584906,
      "val_complete_segments": 0.059997839199676335,
      "val_avg_segment_overlap": 0.4683261819502861,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.26262626262626265,
      "val_window_diff": 0.4812687183611562,
      "val_pk_metric": 0.38432692528740126,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.7537775966856215,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5131866617335213,
      "train_chorus_rate": 0.4255852566825019,
      "train_max_prob": 0.6610392431418101,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5404672771692276,
      "val_macro_f1": 0.6224557180944164,
      "val_verse_f1": 0.6637148549922516,
      "val_chorus_f1": 0.5811965811965812,
      "val_chorus_rate": 0.5908668637275696,
      "val_max_prob": 0.671656146645546,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001409295195546374,
      "epoch_time": 37.918940782547,
      "val_boundary_f1": 0.2177858439201452,
      "val_boundary_precision": 0.17699115044247787,
      "val_boundary_recall": 0.2830188679245283,
      "val_complete_segments": 0.0694550760417816,
      "val_avg_segment_overlap": 0.4972443937466322,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.47444712229198627,
      "val_pk_metric": 0.376798920114367,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.6508912079864078,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4939098623063829,
      "train_chorus_rate": 0.44977127181159127,
      "train_max_prob": 0.678523901436064,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5254814177751541,
      "val_macro_f1": 0.6931991932099337,
      "val_verse_f1": 0.768015794669299,
      "val_chorus_f1": 0.6183825917505683,
      "val_chorus_rate": 0.4556180238723755,
      "val_max_prob": 0.7028848528862,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018565791775217231,
      "epoch_time": 37.49856424331665,
      "val_boundary_f1": 0.3137931034482759,
      "val_boundary_precision": 0.24728260869565216,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.1909198113207547,
      "val_avg_segment_overlap": 0.5911234258518846,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4460878403052044,
      "val_pk_metric": 0.3354420880210104,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.7284151679939694,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.48069696459505296,
      "train_chorus_rate": 0.4230341762304306,
      "train_max_prob": 0.6941187845336066,
      "train_conf_over_90": 0.0008988504091070758,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5198920294642448,
      "val_macro_f1": 0.6928524437289798,
      "val_verse_f1": 0.7663958787398454,
      "val_chorus_f1": 0.6193090087181142,
      "val_chorus_rate": 0.46226276457309723,
      "val_max_prob": 0.7215541303157806,
      "val_conf_over_90": 0.0004139072843827307,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002357959924077685,
      "epoch_time": 36.49826979637146,
      "val_boundary_f1": 0.3013468013468013,
      "val_boundary_precision": 0.2342931937172775,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.1808581250689617,
      "val_avg_segment_overlap": 0.598055171510951,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4716025528063392,
      "val_pk_metric": 0.3606924171175617,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.4619574778609805,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4676184323098924,
      "train_chorus_rate": 0.3978053794966804,
      "train_max_prob": 0.7219497263431549,
      "train_conf_over_90": 0.007284485799674358,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5154047906398773,
      "val_macro_f1": 0.6896491355162755,
      "val_verse_f1": 0.7524509803921569,
      "val_chorus_f1": 0.6268472906403941,
      "val_chorus_rate": 0.4985407888889313,
      "val_max_prob": 0.7249945104122162,
      "val_conf_over_90": 0.0065050924313254654,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00029010230458809225,
      "epoch_time": 36.96081805229187,
      "val_boundary_f1": 0.33184656556645853,
      "val_boundary_precision": 0.266857962697274,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.20092322492552137,
      "val_avg_segment_overlap": 0.6015337557722756,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.439598406776449,
      "val_pk_metric": 0.31650004104871576,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.495291769504547,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4563861737648646,
      "train_chorus_rate": 0.40406058894263375,
      "train_max_prob": 0.7234024074342515,
      "train_conf_over_90": 0.013060217076498602,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5171002373099327,
      "val_macro_f1": 0.6869628133431815,
      "val_verse_f1": 0.7493857493857494,
      "val_chorus_f1": 0.6245398773006136,
      "val_chorus_rate": 0.5017370879650116,
      "val_max_prob": 0.7308279275894165,
      "val_conf_over_90": 0.017626065877266228,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034723220811896325,
      "epoch_time": 36.48684000968933,
      "val_boundary_f1": 0.3353605560382276,
      "val_boundary_precision": 0.265474552957359,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.21807515217551215,
      "val_avg_segment_overlap": 0.6124877874115203,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4491533403621569,
      "val_pk_metric": 0.33712586083666374,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.958919538391961,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.44606922898027634,
      "train_chorus_rate": 0.391486997405688,
      "train_max_prob": 0.7313197784953647,
      "train_conf_over_90": 0.026859073744465906,
      "train_conf_over_95": 2.8651653944204252e-05,
      "val_loss": 0.5240391790866852,
      "val_macro_f1": 0.6983444271205239,
      "val_verse_f1": 0.7720544701006512,
      "val_chorus_f1": 0.6246343841403965,
      "val_chorus_rate": 0.4552191272377968,
      "val_max_prob": 0.7377786636352539,
      "val_conf_over_90": 0.042698787059634924,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004057711435664982,
      "epoch_time": 38.2327401638031,
      "val_boundary_f1": 0.3625531914893617,
      "val_boundary_precision": 0.2836218375499334,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.2390541096583177,
      "val_avg_segment_overlap": 0.6247028739456165,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.449860102582448,
      "val_pk_metric": 0.33340076782153427,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.4070048994488187,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4287453525596195,
      "train_chorus_rate": 0.3700589057472017,
      "train_max_prob": 0.7496860126654307,
      "train_conf_over_90": 0.06251281437774499,
      "train_conf_over_95": 0.0009607352290509476,
      "val_loss": 0.5294923856854439,
      "val_macro_f1": 0.7078463478307198,
      "val_verse_f1": 0.7829654229341668,
      "val_chorus_f1": 0.6327272727272727,
      "val_chorus_rate": 0.44202564656734467,
      "val_max_prob": 0.7552411109209061,
      "val_conf_over_90": 0.08732415270060301,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00046426966329873935,
      "epoch_time": 38.012118101119995,
      "val_boundary_f1": 0.3565217391304348,
      "val_boundary_precision": 0.28236914600550966,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.25579485269778224,
      "val_avg_segment_overlap": 0.6287037699785347,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.42970109665835554,
      "val_pk_metric": 0.32494953408334637,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.1134861972596912,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.4145797010925081,
      "train_chorus_rate": 0.38329343911674285,
      "train_max_prob": 0.7615477012263404,
      "train_conf_over_90": 0.10027689838574992,
      "train_conf_over_95": 0.003943927301507857,
      "val_loss": 0.547175407409668,
      "val_macro_f1": 0.7253795320592963,
      "val_verse_f1": 0.8283622075370602,
      "val_chorus_f1": 0.6223968565815323,
      "val_chorus_rate": 0.3238631710410118,
      "val_max_prob": 0.7610192447900772,
      "val_conf_over_90": 0.08960080705583096,
      "val_conf_over_95": 0.0006208609556779265,
      "learning_rate": 0.0005212793203931269,
      "epoch_time": 39.047006130218506,
      "val_boundary_f1": 0.3704333050127443,
      "val_boundary_precision": 0.28950863213811423,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.24903051325903858,
      "val_avg_segment_overlap": 0.6144251132455072,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4412818957824619,
      "val_pk_metric": 0.31384301869909614,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.228824469778273,
      "cnn_effective_layers": 2
    }
  ]
}