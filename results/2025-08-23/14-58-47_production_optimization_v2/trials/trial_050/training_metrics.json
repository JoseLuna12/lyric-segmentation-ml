{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.172402491199137,
      "layer_dropout": 0.24803162539555432,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.13003509272023295,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008721397985287395,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.016705565500548785,
      "gradient_clip_norm": 0.42357560715593423,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14830338407476193,
        "ece_after": 0.020942723557850703,
        "improvement": 0.12736066051691122,
        "params": {
          "temperature": 0.4251008654994718
        }
      },
      "platt": {
        "ece_before": 0.14830338407476193,
        "ece_after": 0.042236941165797584,
        "improvement": 0.10606644290896435,
        "params": {
          "A": 1.93703884412917,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.614844673871994,
      "train_chorus_rate": 0.43096468825242484,
      "train_max_prob": 0.5900099605321885,
      "train_conf_over_90": 0.010701107233762741,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5920369178056717,
      "val_macro_f1": 0.5557002031214486,
      "val_verse_f1": 0.6393883033684645,
      "val_chorus_f1": 0.4720121028744327,
      "val_chorus_rate": 0.5131653323769569,
      "val_max_prob": 0.5410656780004501,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008626215511816785,
      "epoch_time": 70.77649688720703,
      "val_boundary_f1": 0.06568144499178984,
      "val_boundary_precision": 0.10810810810810811,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.05607976746629981,
      "val_avg_segment_overlap": 0.26118450055204123,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3744186912082265,
      "val_pk_metric": 0.3609532837629752
    },
    {
      "epoch": 2,
      "train_loss": 0.5648652508854866,
      "train_chorus_rate": 0.5444864762481302,
      "train_max_prob": 0.5836502611637115,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6041757315397263,
      "val_macro_f1": 0.4961289308491604,
      "val_verse_f1": 0.8021390374331551,
      "val_chorus_f1": 0.19011882426516571,
      "val_chorus_rate": 0.09269676730036736,
      "val_max_prob": 0.561440497636795,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008344828022231799,
      "epoch_time": 58.34705185890198,
      "val_boundary_f1": 0.05439330543933055,
      "val_boundary_precision": 0.24074074074074073,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.060683185457840814,
      "val_avg_segment_overlap": 0.1982292008635672,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.28411622368357103,
      "val_pk_metric": 0.28656591039363405
    },
    {
      "epoch": 3,
      "train_loss": 0.5764258563518524,
      "train_chorus_rate": 0.5456693643936887,
      "train_max_prob": 0.5765166312456131,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6018286347389221,
      "val_macro_f1": 0.5531905570043684,
      "val_verse_f1": 0.8027103687362117,
      "val_chorus_f1": 0.303670745272525,
      "val_chorus_rate": 0.1413486786186695,
      "val_max_prob": 0.5523778647184372,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007889533500074288,
      "epoch_time": 40.92368412017822,
      "val_boundary_f1": 0.11724137931034483,
      "val_boundary_precision": 0.21794871794871795,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.06435113912579449,
      "val_avg_segment_overlap": 0.2478143369011016,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.3206118667135527,
      "val_pk_metric": 0.30036770470595864
    },
    {
      "epoch": 4,
      "train_loss": 0.5614431202411652,
      "train_chorus_rate": 0.5467512264847756,
      "train_max_prob": 0.5698325067758561,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5805231332778931,
      "val_macro_f1": 0.49187672140607563,
      "val_verse_f1": 0.4887571040276748,
      "val_chorus_f1": 0.4949963387844765,
      "val_chorus_rate": 0.7091745287179947,
      "val_max_prob": 0.5780572891235352,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007280230500708042,
      "epoch_time": 48.81914806365967,
      "val_boundary_f1": 0.04173354735152489,
      "val_boundary_precision": 0.06532663316582915,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.02878245993304318,
      "val_avg_segment_overlap": 0.21485715793078025,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.43013354959950123,
      "val_pk_metric": 0.41536226307240587
    },
    {
      "epoch": 5,
      "train_loss": 0.5457643732428551,
      "train_chorus_rate": 0.45546508580446243,
      "train_max_prob": 0.6167730510234832,
      "train_conf_over_90": 9.920856100507081e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5439208298921585,
      "val_macro_f1": 0.6066029160917072,
      "val_verse_f1": 0.6504639858594785,
      "val_chorus_f1": 0.5627418463239359,
      "val_chorus_rate": 0.5889505967497826,
      "val_max_prob": 0.6412138491868973,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006543548488965546,
      "epoch_time": 47.32670712471008,
      "val_boundary_f1": 0.17710583153347734,
      "val_boundary_precision": 0.16334661354581673,
      "val_boundary_recall": 0.19339622641509435,
      "val_complete_segments": 0.06126974004757674,
      "val_avg_segment_overlap": 0.4446545382074636,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.49346550573235437,
      "val_pk_metric": 0.4085542032757948
    },
    {
      "epoch": 6,
      "train_loss": 0.5254770904779434,
      "train_chorus_rate": 0.4166856311261654,
      "train_max_prob": 0.6422950178384781,
      "train_conf_over_90": 0.005310158277279697,
      "train_conf_over_95": 3.20924271363765e-05,
      "val_loss": 0.5338734984397888,
      "val_macro_f1": 0.6432814224912007,
      "val_verse_f1": 0.6998728274692666,
      "val_chorus_f1": 0.5866900175131349,
      "val_chorus_rate": 0.542059138417244,
      "val_max_prob": 0.6751876622438431,
      "val_conf_over_90": 0.01389581395778805,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000571168400375244,
      "epoch_time": 40.70424675941467,
      "val_boundary_f1": 0.18811881188118812,
      "val_boundary_precision": 0.1621160409556314,
      "val_boundary_recall": 0.2240566037735849,
      "val_complete_segments": 0.06621449316306156,
      "val_avg_segment_overlap": 0.4967148714962314,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.24242424242424243,
      "val_window_diff": 0.5018090751789843,
      "val_pk_metric": 0.40147289279674253
    },
    {
      "epoch": 7,
      "train_loss": 0.5136221900582314,
      "train_chorus_rate": 0.38715130388736724,
      "train_max_prob": 0.6536446809768677,
      "train_conf_over_90": 0.010910651009180584,
      "train_conf_over_95": 0.0002575252467067912,
      "val_loss": 0.5169280171394348,
      "val_macro_f1": 0.6946212199101036,
      "val_verse_f1": 0.7688660608455156,
      "val_chorus_f1": 0.6203763789746918,
      "val_chorus_rate": 0.4581480547785759,
      "val_max_prob": 0.6571943908929825,
      "val_conf_over_90": 0.005663347139488906,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048209935148012104,
      "epoch_time": 82.73011708259583,
      "val_boundary_f1": 0.2536764705882353,
      "val_boundary_precision": 0.20783132530120482,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.14082617498577202,
      "val_avg_segment_overlap": 0.5869111091846759,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.4808955621187985,
      "val_pk_metric": 0.3640365465736719
    },
    {
      "epoch": 8,
      "train_loss": 0.4960901662707329,
      "train_chorus_rate": 0.39164578914642334,
      "train_max_prob": 0.6662902265787125,
      "train_conf_over_90": 0.012795010523404926,
      "train_conf_over_95": 0.0001176210178527981,
      "val_loss": 0.5257529392838478,
      "val_macro_f1": 0.7405077860907553,
      "val_verse_f1": 0.8334839992768034,
      "val_chorus_f1": 0.6475315729047072,
      "val_chorus_rate": 0.34247639775276184,
      "val_max_prob": 0.7289640456438065,
      "val_conf_over_90": 0.03396333381533623,
      "val_conf_over_95": 0.0004975080228177831,
      "learning_rate": 0.0003910404470486187,
      "epoch_time": 57.18944191932678,
      "val_boundary_f1": 0.3787575150300601,
      "val_boundary_precision": 0.32926829268292684,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.23036046954392658,
      "val_avg_segment_overlap": 0.6312753394708146,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3564607794847349,
      "val_pk_metric": 0.2668317468687953
    },
    {
      "epoch": 9,
      "train_loss": 0.4824201509356499,
      "train_chorus_rate": 0.32919157594442366,
      "train_max_prob": 0.6879660695791244,
      "train_conf_over_90": 0.018473648096551186,
      "train_conf_over_95": 0.0007230276474729181,
      "val_loss": 0.5156458020210266,
      "val_macro_f1": 0.6980167278381317,
      "val_verse_f1": 0.775366568914956,
      "val_chorus_f1": 0.6206668867613073,
      "val_chorus_rate": 0.44495997577905655,
      "val_max_prob": 0.6670120507478714,
      "val_conf_over_90": 0.013886001310311258,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003019713981534957,
      "epoch_time": 104.83361196517944,
      "val_boundary_f1": 0.23917137476459513,
      "val_boundary_precision": 0.19905956112852666,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.11649526552760912,
      "val_avg_segment_overlap": 0.5753485561834196,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3282828282828283,
      "val_window_diff": 0.4845739066938193,
      "val_pk_metric": 0.3651960083426272
    },
    {
      "epoch": 10,
      "train_loss": 0.4831561207771301,
      "train_chorus_rate": 0.34082513600587844,
      "train_max_prob": 0.6850099056959152,
      "train_conf_over_90": 0.020350501968641764,
      "train_conf_over_95": 0.0009265533706638962,
      "val_loss": 0.5096150860190392,
      "val_macro_f1": 0.7201570572822606,
      "val_verse_f1": 0.7994642173746651,
      "val_chorus_f1": 0.6408498971898561,
      "val_chorus_rate": 0.4173242971301079,
      "val_max_prob": 0.6930978447198868,
      "val_conf_over_90": 0.02504066890105605,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021878494963218498,
      "epoch_time": 81.9217438697815,
      "val_boundary_f1": 0.327683615819209,
      "val_boundary_precision": 0.2727272727272727,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.19925391798403463,
      "val_avg_segment_overlap": 0.6249034297449235,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.438162348197007,
      "val_pk_metric": 0.31539869536022774
    },
    {
      "epoch": 11,
      "train_loss": 0.48566615730524065,
      "train_chorus_rate": 0.3599337309598923,
      "train_max_prob": 0.6841755002737046,
      "train_conf_over_90": 0.01697153956920374,
      "train_conf_over_95": 9.746837604325264e-05,
      "val_loss": 0.5212688744068146,
      "val_macro_f1": 0.7673897877296825,
      "val_verse_f1": 0.8636442591627583,
      "val_chorus_f1": 0.6711353162966066,
      "val_chorus_rate": 0.2870084308087826,
      "val_max_prob": 0.6589355021715164,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014511674845793537,
      "epoch_time": 85.80651068687439,
      "val_boundary_f1": 0.43628950050968407,
      "val_boundary_precision": 0.38420107719928187,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.30865008509494196,
      "val_avg_segment_overlap": 0.6702202576757285,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.3057301377530897,
      "val_pk_metric": 0.22481746923238824
    },
    {
      "epoch": 12,
      "train_loss": 0.4830886751413345,
      "train_chorus_rate": 0.3400645427405834,
      "train_max_prob": 0.6800138294696808,
      "train_conf_over_90": 0.01399070783809293,
      "train_conf_over_95": 0.00010828246595337987,
      "val_loss": 0.5067810863256454,
      "val_macro_f1": 0.7535246786215535,
      "val_verse_f1": 0.8448028673835125,
      "val_chorus_f1": 0.6622464898595944,
      "val_chorus_rate": 0.330771267414093,
      "val_max_prob": 0.7063571810722351,
      "val_conf_over_90": 0.022939543705433607,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.418644852131075e-05,
      "epoch_time": 77.90968298912048,
      "val_boundary_f1": 0.37967401725790983,
      "val_boundary_precision": 0.3198707592891761,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.2536962560955138,
      "val_avg_segment_overlap": 0.6582784335535181,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.34474236966414906,
      "val_pk_metric": 0.24563848385006543
    },
    {
      "epoch": 13,
      "train_loss": 0.47629012912511826,
      "train_chorus_rate": 0.337246835231781,
      "train_max_prob": 0.6923390805721283,
      "train_conf_over_90": 0.019543218333274125,
      "train_conf_over_95": 0.00010320287547074258,
      "val_loss": 0.5012346729636192,
      "val_macro_f1": 0.7395380554702589,
      "val_verse_f1": 0.8224995343639411,
      "val_chorus_f1": 0.6565765765765765,
      "val_chorus_rate": 0.38247305899858475,
      "val_max_prob": 0.6951767057180405,
      "val_conf_over_90": 0.020828371169045568,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.865699630555948e-05,
      "epoch_time": 75.19583892822266,
      "val_boundary_f1": 0.3488805970149254,
      "val_boundary_precision": 0.28858024691358025,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2355036808509767,
      "val_avg_segment_overlap": 0.6450088562893086,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3931883018517334,
      "val_pk_metric": 0.28503571399908395
    },
    {
      "epoch": 14,
      "train_loss": 0.46847546100616455,
      "train_chorus_rate": 0.33881852254271505,
      "train_max_prob": 0.6987005114555359,
      "train_conf_over_90": 0.024870689678937196,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5023286566138268,
      "val_macro_f1": 0.7528020015652579,
      "val_verse_f1": 0.843862167982771,
      "val_chorus_f1": 0.6617418351477449,
      "val_chorus_rate": 0.33250635862350464,
      "val_max_prob": 0.6945939660072327,
      "val_conf_over_90": 0.013924942002631724,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0518247347061046e-05,
      "epoch_time": 80.74859404563904,
      "val_boundary_f1": 0.38814531548757164,
      "val_boundary_precision": 0.32636655948553056,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2568314110201703,
      "val_avg_segment_overlap": 0.6573519566246634,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.361481676383479,
      "val_pk_metric": 0.2511164910812095
    },
    {
      "epoch": 15,
      "train_loss": 0.47508721202611925,
      "train_chorus_rate": 0.33567408174276353,
      "train_max_prob": 0.6944445490837097,
      "train_conf_over_90": 0.021750641288235784,
      "train_conf_over_95": 3.1685677822679284e-05,
      "val_loss": 0.5013595595955849,
      "val_macro_f1": 0.7504576174850596,
      "val_verse_f1": 0.8390721275824574,
      "val_chorus_f1": 0.6618431073876617,
      "val_chorus_rate": 0.3457872197031975,
      "val_max_prob": 0.6937501579523087,
      "val_conf_over_90": 0.015382183133624494,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 80.9628541469574,
      "val_boundary_f1": 0.37653736991485337,
      "val_boundary_precision": 0.31437598736176936,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.25198118698914035,
      "val_avg_segment_overlap": 0.6559577802290388,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.368478005335805,
      "val_pk_metric": 0.2585249595323884
    }
  ]
}