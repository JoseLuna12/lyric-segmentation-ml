{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19488781278467865,
      "layer_dropout": 0.21839874218834,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.132087769936864,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009200039281019698,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015948432192361226,
      "gradient_clip_norm": 0.4513791836780742,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11608444997393079,
        "ece_after": 0.02166918997446071,
        "improvement": 0.09441525999947008,
        "params": {
          "temperature": 0.5161113480018517
        }
      },
      "platt": {
        "ece_before": 0.11608444997393079,
        "ece_after": 0.02342744685402086,
        "improvement": 0.09265700311990993,
        "params": {
          "A": 1.8897972934283709,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6072170227766037,
      "train_chorus_rate": 0.48698883547913285,
      "train_max_prob": 0.580572035908699,
      "train_conf_over_90": 0.014975400269031524,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6048033833503723,
      "val_macro_f1": 0.3823524422237723,
      "val_verse_f1": 0.2701080432172869,
      "val_chorus_f1": 0.4945968412302577,
      "val_chorus_rate": 0.8819011449813843,
      "val_max_prob": 0.6150157898664474,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009099627077199272,
      "epoch_time": 83.80702424049377,
      "val_boundary_f1": 0.054644808743169404,
      "val_boundary_precision": 0.12,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.023495962255241153,
      "val_avg_segment_overlap": 0.16823695822063148,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.41586793368382985,
      "val_pk_metric": 0.41433964687588026
    },
    {
      "epoch": 2,
      "train_loss": 0.57704017162323,
      "train_chorus_rate": 0.5203738063108176,
      "train_max_prob": 0.5851371884346008,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5924540460109711,
      "val_macro_f1": 0.5059683192326974,
      "val_verse_f1": 0.5467332123411978,
      "val_chorus_f1": 0.46520342612419696,
      "val_chorus_rate": 0.6182482838630676,
      "val_max_prob": 0.5693363845348358,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008802778960876157,
      "epoch_time": 72.88038396835327,
      "val_boundary_f1": 0.05444646098003629,
      "val_boundary_precision": 0.11811023622047244,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.013195652856310332,
      "val_avg_segment_overlap": 0.2075314116053289,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.45512317351854226,
      "val_pk_metric": 0.4639298413333135
    },
    {
      "epoch": 3,
      "train_loss": 0.5681938618421555,
      "train_chorus_rate": 0.5213876160793006,
      "train_max_prob": 0.588048779964447,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5869032144546509,
      "val_macro_f1": 0.41663881024661464,
      "val_verse_f1": 0.33684210526315794,
      "val_chorus_f1": 0.4964355152300713,
      "val_chorus_rate": 0.8377138078212738,
      "val_max_prob": 0.5891530960798264,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008322468619168978,
      "epoch_time": 50.664149045944214,
      "val_boundary_f1": 0.07567567567567568,
      "val_boundary_precision": 0.16030534351145037,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.03111354613210393,
      "val_avg_segment_overlap": 0.18639729641268032,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4085396903982319,
      "val_pk_metric": 0.4022554483873841
    },
    {
      "epoch": 4,
      "train_loss": 0.5604110404849052,
      "train_chorus_rate": 0.4757034622132778,
      "train_max_prob": 0.5893864691257477,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5710470527410507,
      "val_macro_f1": 0.6476100556181151,
      "val_verse_f1": 0.7503327628826774,
      "val_chorus_f1": 0.5448873483535529,
      "val_chorus_rate": 0.40997011959552765,
      "val_max_prob": 0.5828552097082138,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007679687918795067,
      "epoch_time": 58.15240025520325,
      "val_boundary_f1": 0.2591362126245847,
      "val_boundary_precision": 0.24425887265135698,
      "val_boundary_recall": 0.2759433962264151,
      "val_complete_segments": 0.102618528997108,
      "val_avg_segment_overlap": 0.47747443337152684,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.4392566335050193,
      "val_pk_metric": 0.37488355234233584
    },
    {
      "epoch": 5,
      "train_loss": 0.5183200851082802,
      "train_chorus_rate": 0.4282329581677914,
      "train_max_prob": 0.6514901727437973,
      "train_conf_over_90": 0.010174391153850593,
      "train_conf_over_95": 6.97836687322706e-05,
      "val_loss": 0.5104519054293633,
      "val_macro_f1": 0.7135399354622239,
      "val_verse_f1": 0.7933154053015752,
      "val_chorus_f1": 0.6337644656228727,
      "val_chorus_rate": 0.42250290513038635,
      "val_max_prob": 0.6762655824422836,
      "val_conf_over_90": 0.004652438859920949,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006902529460764774,
      "epoch_time": 58.11566781997681,
      "val_boundary_f1": 0.30614115490375804,
      "val_boundary_precision": 0.25037481259370314,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.1766326696337301,
      "val_avg_segment_overlap": 0.6055733564896567,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4548969218286444,
      "val_pk_metric": 0.3149733816894421
    },
    {
      "epoch": 6,
      "train_loss": 0.5074563786387444,
      "train_chorus_rate": 0.3871044583618641,
      "train_max_prob": 0.674995043873787,
      "train_conf_over_90": 0.014083682466298342,
      "train_conf_over_95": 0.00022036754235159605,
      "val_loss": 0.5308544784784317,
      "val_macro_f1": 0.5996511455260722,
      "val_verse_f1": 0.6262951876583007,
      "val_chorus_f1": 0.5730071033938436,
      "val_chorus_rate": 0.6340137422084808,
      "val_max_prob": 0.7102824300527573,
      "val_conf_over_90": 0.054392560850828886,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0006024958798914055,
      "epoch_time": 51.1658890247345,
      "val_boundary_f1": 0.17219917012448133,
      "val_boundary_precision": 0.1537037037037037,
      "val_boundary_recall": 0.1957547169811321,
      "val_complete_segments": 0.06095187939037355,
      "val_avg_segment_overlap": 0.45284846635848514,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.5180074627429148,
      "val_pk_metric": 0.425710317279017
    },
    {
      "epoch": 7,
      "train_loss": 0.49642929434776306,
      "train_chorus_rate": 0.38274579793214797,
      "train_max_prob": 0.6899851799011231,
      "train_conf_over_90": 0.038474543872871435,
      "train_conf_over_95": 0.0042399793397635225,
      "val_loss": 0.5046201646327972,
      "val_macro_f1": 0.7362344772745321,
      "val_verse_f1": 0.8236812984138694,
      "val_chorus_f1": 0.6487876561351947,
      "val_chorus_rate": 0.36909840255975723,
      "val_max_prob": 0.6716805696487427,
      "val_conf_over_90": 0.00438738038064912,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000508532998221703,
      "epoch_time": 104.30030512809753,
      "val_boundary_f1": 0.3440860215053763,
      "val_boundary_precision": 0.2774566473988439,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2176932992680607,
      "val_avg_segment_overlap": 0.6427695287160476,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.433591014152982,
      "val_pk_metric": 0.3018944426667303
    },
    {
      "epoch": 8,
      "train_loss": 0.4780412420630455,
      "train_chorus_rate": 0.37879975587129594,
      "train_max_prob": 0.6889376699924469,
      "train_conf_over_90": 0.026717177190585063,
      "train_conf_over_95": 0.0010445001942571252,
      "val_loss": 0.4935087114572525,
      "val_macro_f1": 0.7513146569089733,
      "val_verse_f1": 0.8402966178332429,
      "val_chorus_f1": 0.6623326959847037,
      "val_chorus_rate": 0.3429712727665901,
      "val_max_prob": 0.7188900858163834,
      "val_conf_over_90": 0.029953701188787818,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004124709298802671,
      "epoch_time": 73.65124797821045,
      "val_boundary_f1": 0.36345776031434185,
      "val_boundary_precision": 0.3114478114478115,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.23631873617292495,
      "val_avg_segment_overlap": 0.6472070211753312,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3555213416901326,
      "val_pk_metric": 0.25761742231727247
    },
    {
      "epoch": 9,
      "train_loss": 0.4613204672932625,
      "train_chorus_rate": 0.3092521488666534,
      "train_max_prob": 0.7141822874546051,
      "train_conf_over_90": 0.03445390237029642,
      "train_conf_over_95": 0.0035499818506650625,
      "val_loss": 0.49459221214056015,
      "val_macro_f1": 0.7241755936337377,
      "val_verse_f1": 0.8040373262235765,
      "val_chorus_f1": 0.644313861043899,
      "val_chorus_rate": 0.4115915074944496,
      "val_max_prob": 0.6861200779676437,
      "val_conf_over_90": 0.014748186396900564,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00031850804821056456,
      "epoch_time": 133.1426658630371,
      "val_boundary_f1": 0.2899353647276085,
      "val_boundary_precision": 0.23823975720789076,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.1636374709810553,
      "val_avg_segment_overlap": 0.6121400799116702,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4390618394744652,
      "val_pk_metric": 0.31430676151634096
    },
    {
      "epoch": 10,
      "train_loss": 0.458736053109169,
      "train_chorus_rate": 0.33615029603242874,
      "train_max_prob": 0.7168396949768067,
      "train_conf_over_90": 0.0408466117689386,
      "train_conf_over_95": 0.004854581470135599,
      "val_loss": 0.48767244070768356,
      "val_macro_f1": 0.7237536577313246,
      "val_verse_f1": 0.8018380241240666,
      "val_chorus_f1": 0.6456692913385826,
      "val_chorus_rate": 0.4180614799261093,
      "val_max_prob": 0.7051099538803101,
      "val_conf_over_90": 0.028210940770804882,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002307509820254926,
      "epoch_time": 103.3819432258606,
      "val_boundary_f1": 0.329935125115848,
      "val_boundary_precision": 0.2717557251908397,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.20760134282138526,
      "val_avg_segment_overlap": 0.6278274322767142,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.429781309738701,
      "val_pk_metric": 0.29769547877256003
    },
    {
      "epoch": 11,
      "train_loss": 0.4643516406416893,
      "train_chorus_rate": 0.34956970512866975,
      "train_max_prob": 0.7107572376728057,
      "train_conf_over_90": 0.032873983692843466,
      "train_conf_over_95": 0.0025687691260827704,
      "val_loss": 0.49741050601005554,
      "val_macro_f1": 0.7726653044450136,
      "val_verse_f1": 0.8643919510061242,
      "val_chorus_f1": 0.6809386578839028,
      "val_chorus_rate": 0.2976362630724907,
      "val_max_prob": 0.6935673952102661,
      "val_conf_over_90": 0.0007134274201234803,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015303513622246328,
      "epoch_time": 109.18800592422485,
      "val_boundary_f1": 0.4115822130299896,
      "val_boundary_precision": 0.3664825046040516,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.26767050719860896,
      "val_avg_segment_overlap": 0.6605677756948504,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3208721495102964,
      "val_pk_metric": 0.2343989740343273
    },
    {
      "epoch": 12,
      "train_loss": 0.4595350384712219,
      "train_chorus_rate": 0.32820988446474075,
      "train_max_prob": 0.7144822001457214,
      "train_conf_over_90": 0.02948868176608812,
      "train_conf_over_95": 0.0018056945380521938,
      "val_loss": 0.48419239372015,
      "val_macro_f1": 0.7509939712631906,
      "val_verse_f1": 0.8333640893153718,
      "val_chorus_f1": 0.6686238532110093,
      "val_chorus_rate": 0.3701646029949188,
      "val_max_prob": 0.719080775976181,
      "val_conf_over_90": 0.041240579448640347,
      "val_conf_over_95": 0.0009348820603918284,
      "learning_rate": 8.875706618507201e-05,
      "epoch_time": 97.34462213516235,
      "val_boundary_f1": 0.35477941176470584,
      "val_boundary_precision": 0.29066265060240964,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.23861636784489382,
      "val_avg_segment_overlap": 0.6601346445542241,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4066947662698639,
      "val_pk_metric": 0.2789330642432436
    },
    {
      "epoch": 13,
      "train_loss": 0.45298060327768325,
      "train_chorus_rate": 0.3234741486608982,
      "train_max_prob": 0.7197602361440658,
      "train_conf_over_90": 0.03464945894666016,
      "train_conf_over_95": 0.003138643514830619,
      "val_loss": 0.4806475341320038,
      "val_macro_f1": 0.7449524943803346,
      "val_verse_f1": 0.825876211782252,
      "val_chorus_f1": 0.6640287769784172,
      "val_chorus_rate": 0.38369889557361603,
      "val_max_prob": 0.7253031730651855,
      "val_conf_over_90": 0.050048746168613434,
      "val_conf_over_95": 0.0007134274201234803,
      "learning_rate": 4.0726032014353926e-05,
      "epoch_time": 97.58204865455627,
      "val_boundary_f1": 0.34944237918215615,
      "val_boundary_precision": 0.2883435582822086,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22559687584873164,
      "val_avg_segment_overlap": 0.6485500825213422,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.41665973700878167,
      "val_pk_metric": 0.28520702047992874
    },
    {
      "epoch": 14,
      "train_loss": 0.44492467641830447,
      "train_chorus_rate": 0.326944775134325,
      "train_max_prob": 0.7333084344863892,
      "train_conf_over_90": 0.046262727165594694,
      "train_conf_over_95": 0.0040036984864855185,
      "val_loss": 0.4821896478533745,
      "val_macro_f1": 0.7642467522710003,
      "val_verse_f1": 0.8499909958580947,
      "val_chorus_f1": 0.6785025086839058,
      "val_chorus_rate": 0.3373524844646454,
      "val_max_prob": 0.7235892564058304,
      "val_conf_over_90": 0.030974862165749073,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1041220382042591e-05,
      "epoch_time": 103.37594175338745,
      "val_boundary_f1": 0.39848197343453506,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2831743688848673,
      "val_avg_segment_overlap": 0.6730221491435295,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.35090787532153284,
      "val_pk_metric": 0.24378101214661246
    },
    {
      "epoch": 15,
      "train_loss": 0.4525659307837486,
      "train_chorus_rate": 0.33004639893770216,
      "train_max_prob": 0.725284531712532,
      "train_conf_over_90": 0.03681961153633893,
      "train_conf_over_95": 0.003019150378531776,
      "val_loss": 0.4815429225564003,
      "val_macro_f1": 0.7582448704767132,
      "val_verse_f1": 0.8435003631082063,
      "val_chorus_f1": 0.6729893778452201,
      "val_chorus_rate": 0.34863168001174927,
      "val_max_prob": 0.7200082540512085,
      "val_conf_over_90": 0.031145995017141104,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 103.03025388717651,
      "val_boundary_f1": 0.37746478873239436,
      "val_boundary_precision": 0.31357254290171604,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.25142392430303356,
      "val_avg_segment_overlap": 0.6634763916135847,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.37212157889349085,
      "val_pk_metric": 0.2602832002233824
    }
  ]
}