{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.24401736296647442,
      "layer_dropout": 0.22700574569049722,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.19909139018138775,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0008496187994948538,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "composite",
      "weight_decay": 0.018394556390922266,
      "gradient_clip_norm": 0.49076793806047053,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.04227119612494714,
        "ece_after": 0.030552880468911893,
        "improvement": 0.011718315656035247,
        "params": {
          "temperature": 0.6344828588934445
        }
      },
      "platt": {
        "ece_before": 0.04227119612494714,
        "ece_after": 0.030884429358663194,
        "improvement": 0.011386766766283946,
        "params": {
          "A": 1.4848881386397788,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.578920590877533,
      "train_chorus_rate": 0.4525878464861307,
      "train_max_prob": 0.5803737461566925,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5983060002326965,
      "val_macro_f1": 0.46877214835090975,
      "val_verse_f1": 0.47333820306793284,
      "val_chorus_f1": 0.46420609363388665,
      "val_chorus_rate": 0.6915484368801117,
      "val_max_prob": 0.5604011118412018,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008351608073006787,
      "epoch_time": 85.38729190826416,
      "val_boundary_f1": 0.04735883424408014,
      "val_boundary_precision": 0.104,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.018438697318007662,
      "val_avg_segment_overlap": 0.1972252707068598,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4274669258852102,
      "val_pk_metric": 0.42565045120191614
    },
    {
      "epoch": 2,
      "train_loss": 0.581977379322052,
      "train_chorus_rate": 0.42583810561336577,
      "train_max_prob": 0.5833517730236053,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.602168083190918,
      "val_macro_f1": 0.4116457159370033,
      "val_verse_f1": 0.8232914318740066,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0004950495203956962,
      "val_max_prob": 0.5487957000732422,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007927721189932251,
      "epoch_time": 63.990076780319214,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05860871647509579,
      "val_avg_segment_overlap": 0.166826488197893,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26590494613311666,
      "val_pk_metric": 0.2721064272061856
    },
    {
      "epoch": 3,
      "train_loss": 0.5611580014228821,
      "train_chorus_rate": 0.5282250218093395,
      "train_max_prob": 0.5730045974254608,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5964409112930298,
      "val_macro_f1": 0.4293167571516845,
      "val_verse_f1": 0.3822269807280514,
      "val_chorus_f1": 0.47640653357531765,
      "val_chorus_rate": 0.7828088402748108,
      "val_max_prob": 0.5624162554740906,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007253414536300259,
      "epoch_time": 128.07383799552917,
      "val_boundary_f1": 0.03616636528028933,
      "val_boundary_precision": 0.07751937984496124,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.012691570881226053,
      "val_avg_segment_overlap": 0.19174656889615194,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4392627503359774,
      "val_pk_metric": 0.4431063566483498
    },
    {
      "epoch": 4,
      "train_loss": 0.5646268129348755,
      "train_chorus_rate": 0.5967682003974915,
      "train_max_prob": 0.5778876900672912,
      "train_conf_over_90": 0.00010191358160227537,
      "train_conf_over_95": 0.0,
      "val_loss": 0.60051628947258,
      "val_macro_f1": 0.547390731728618,
      "val_verse_f1": 0.7547995958235096,
      "val_chorus_f1": 0.3399818676337262,
      "val_chorus_rate": 0.24205557256937027,
      "val_max_prob": 0.5423966944217682,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006374640996211404,
      "epoch_time": 75.21669411659241,
      "val_boundary_f1": 0.09665427509293681,
      "val_boundary_precision": 0.22807017543859648,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.06435584291187739,
      "val_avg_segment_overlap": 0.2382576046885727,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.29454504496203127,
      "val_pk_metric": 0.29471586485162254
    },
    {
      "epoch": 5,
      "train_loss": 0.554847925901413,
      "train_chorus_rate": 0.5396163076162338,
      "train_max_prob": 0.5667404413223267,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6017844676971436,
      "val_macro_f1": 0.5720699457317598,
      "val_verse_f1": 0.7431578947368421,
      "val_chorus_f1": 0.40098199672667756,
      "val_chorus_rate": 0.3003218322992325,
      "val_max_prob": 0.5622407793998718,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005351287534180797,
      "epoch_time": 1173.6270089149475,
      "val_boundary_f1": 0.11012433392539962,
      "val_boundary_precision": 0.22302158273381295,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.0676484674329502,
      "val_avg_segment_overlap": 0.25589220903172005,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.30029638337280967,
      "val_pk_metric": 0.30181690279347495
    },
    {
      "epoch": 6,
      "train_loss": 0.5584892809391022,
      "train_chorus_rate": 0.591792431473732,
      "train_max_prob": 0.5780375599861145,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5929689407348633,
      "val_macro_f1": 0.40207710758100035,
      "val_verse_f1": 0.3210227272727273,
      "val_chorus_f1": 0.4831314878892734,
      "val_chorus_rate": 0.83594611287117,
      "val_max_prob": 0.5980838537216187,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004253093997474269,
      "epoch_time": 2571.381654024124,
      "val_boundary_f1": 0.0718132854578097,
      "val_boundary_precision": 0.15037593984962405,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.029214559386973177,
      "val_avg_segment_overlap": 0.1806703694040711,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4259219696882756,
      "val_pk_metric": 0.42920480103101205
    },
    {
      "epoch": 7,
      "train_loss": 0.5679615616798401,
      "train_chorus_rate": 0.4844285728409886,
      "train_max_prob": 0.5843894600868225,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5913636088371277,
      "val_macro_f1": 0.3908281991043084,
      "val_verse_f1": 0.303012912482066,
      "val_chorus_f1": 0.47864348572655074,
      "val_chorus_rate": 0.8445631563663483,
      "val_max_prob": 0.5801934897899628,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00031549004607677415,
      "epoch_time": 49.50592017173767,
      "val_boundary_f1": 0.05839416058394161,
      "val_boundary_precision": 0.12903225806451613,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.025383141762452106,
      "val_avg_segment_overlap": 0.1704950834511516,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4126808437388405,
      "val_pk_metric": 0.4065672425508856
    },
    {
      "epoch": 8,
      "train_loss": 0.5643685817718506,
      "train_chorus_rate": 0.6059525549411774,
      "train_max_prob": 0.5599176526069641,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5902220606803894,
      "val_macro_f1": 0.548956656473514,
      "val_verse_f1": 0.6135338345864663,
      "val_chorus_f1": 0.4843794783605617,
      "val_chorus_rate": 0.5572018623352051,
      "val_max_prob": 0.5554058849811554,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021315469987371352,
      "epoch_time": 53.190619230270386,
      "val_boundary_f1": 0.07641196013289038,
      "val_boundary_precision": 0.12921348314606743,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.047473659003831416,
      "val_avg_segment_overlap": 0.25674212260082674,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3714807812625321,
      "val_pk_metric": 0.3582692294557758
    },
    {
      "epoch": 9,
      "train_loss": 0.5594655752182007,
      "train_chorus_rate": 0.700137597322464,
      "train_max_prob": 0.5729242861270905,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5885021984577179,
      "val_macro_f1": 0.5007422553079359,
      "val_verse_f1": 0.5163134079542748,
      "val_chorus_f1": 0.4851711026615969,
      "val_chorus_rate": 0.6692123711109161,
      "val_max_prob": 0.571701169013977,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001252773458648278,
      "epoch_time": 71.32772898674011,
      "val_boundary_f1": 0.09448818897637794,
      "val_boundary_precision": 0.14218009478672985,
      "val_boundary_recall": 0.07075471698113207,
      "val_complete_segments": 0.031130268199233715,
      "val_avg_segment_overlap": 0.22477022213627434,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.4708298285367468,
      "val_pk_metric": 0.4126619848135223
    },
    {
      "epoch": 10,
      "train_loss": 0.5434117257595062,
      "train_chorus_rate": 0.44700774252414704,
      "train_max_prob": 0.5787891924381257,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5871964395046234,
      "val_macro_f1": 0.5508720797895064,
      "val_verse_f1": 0.6021600176327969,
      "val_chorus_f1": 0.4995841419462157,
      "val_chorus_rate": 0.5862476527690887,
      "val_max_prob": 0.5727077126502991,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.7846680501628695e-05,
      "epoch_time": 79.63474988937378,
      "val_boundary_f1": 0.10558069381598792,
      "val_boundary_precision": 0.14644351464435146,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.05980603448275862,
      "val_avg_segment_overlap": 0.26988593409030054,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.41724751770801605,
      "val_pk_metric": 0.36393350728271484
    },
    {
      "epoch": 11,
      "train_loss": 0.5349378079175949,
      "train_chorus_rate": 0.5867865681648254,
      "train_max_prob": 0.5971680164337159,
      "train_conf_over_90": 5.7850542361848056e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5890444219112396,
      "val_macro_f1": 0.5964768083754496,
      "val_verse_f1": 0.6940874035989717,
      "val_chorus_f1": 0.4988662131519274,
      "val_chorus_rate": 0.4584650546312332,
      "val_max_prob": 0.5777804255485535,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.5457992194175024e-05,
      "epoch_time": 131.49006271362305,
      "val_boundary_f1": 0.14550641940085593,
      "val_boundary_precision": 0.18411552346570398,
      "val_boundary_recall": 0.12028301886792453,
      "val_complete_segments": 0.0693845785440613,
      "val_avg_segment_overlap": 0.3262354916053162,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.3694363393833957,
      "val_pk_metric": 0.34821577670305565
    },
    {
      "epoch": 12,
      "train_loss": 0.545286375284195,
      "train_chorus_rate": 0.5083537250757217,
      "train_max_prob": 0.5894673585891723,
      "train_conf_over_90": 7.018663745839149e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5870652794837952,
      "val_macro_f1": 0.5809406195327776,
      "val_verse_f1": 0.6666666666666667,
      "val_chorus_f1": 0.4952145723988886,
      "val_chorus_rate": 0.49580705165863037,
      "val_max_prob": 0.5783594846725464,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 94.85533499717712,
      "val_boundary_f1": 0.11713030746705712,
      "val_boundary_precision": 0.15444015444015444,
      "val_boundary_recall": 0.09433962264150944,
      "val_complete_segments": 0.059985632183908046,
      "val_avg_segment_overlap": 0.31464239278427253,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.3823183422617851,
      "val_pk_metric": 0.359601664749737
    }
  ]
}