{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19224039293560227,
      "layer_dropout": 0.21478134945376753,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 256,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 2180098,
      "lstm_params": 2179072,
      "attention_params": 0,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008918353165536,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.016016073524643366,
      "gradient_clip_norm": 0.3976727508029743,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10516167843388669,
        "ece_after": 0.014981159087716965,
        "improvement": 0.09018051934616972,
        "params": {
          "temperature": 0.4992970020581613
        }
      },
      "platt": {
        "ece_before": 0.10516167843388669,
        "ece_after": 0.018821637601772787,
        "improvement": 0.0863400408321139,
        "params": {
          "A": 1.8285086767178413,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5784509420394898,
      "train_chorus_rate": 0.5156258219620213,
      "train_max_prob": 0.553845363855362,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5986628979444504,
      "val_macro_f1": 0.5029382521725351,
      "val_verse_f1": 0.5412676698586412,
      "val_chorus_f1": 0.464608834486429,
      "val_chorus_rate": 0.6232174783945084,
      "val_max_prob": 0.5407721698284149,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008821018720447221,
      "epoch_time": 104.20631814002991,
      "val_boundary_f1": 0.07285974499089254,
      "val_boundary_precision": 0.16,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.021929178079761327,
      "val_avg_segment_overlap": 0.20947970325435142,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4415918894829369,
      "val_pk_metric": 0.44150412978223574
    },
    {
      "epoch": 2,
      "train_loss": 0.5607561111450196,
      "train_chorus_rate": 0.444631570763886,
      "train_max_prob": 0.5569390773773193,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5922797173261642,
      "val_macro_f1": 0.5176358528790318,
      "val_verse_f1": 0.539906103286385,
      "val_chorus_f1": 0.4953656024716786,
      "val_chorus_rate": 0.6555977910757065,
      "val_max_prob": 0.5444948077201843,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008533269367493749,
      "epoch_time": 163.11054587364197,
      "val_boundary_f1": 0.0547008547008547,
      "val_boundary_precision": 0.09937888198757763,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.010793921477908752,
      "val_avg_segment_overlap": 0.2302019149726337,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4498628203336715,
      "val_pk_metric": 0.4678846832249485
    },
    {
      "epoch": 3,
      "train_loss": 0.5696224391460418,
      "train_chorus_rate": 0.46803535968065263,
      "train_max_prob": 0.5658918231725693,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5904529243707657,
      "val_macro_f1": 0.47404749390820533,
      "val_verse_f1": 0.459322890348661,
      "val_chorus_f1": 0.48877209746774963,
      "val_chorus_rate": 0.7298041731119156,
      "val_max_prob": 0.5628949254751205,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008067681134174242,
      "epoch_time": 96.28197574615479,
      "val_boundary_f1": 0.0677361853832442,
      "val_boundary_precision": 0.1386861313868613,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.02014545980611728,
      "val_avg_segment_overlap": 0.2030043358647139,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.43307852244532274,
      "val_pk_metric": 0.43416976914296257
    },
    {
      "epoch": 4,
      "train_loss": 0.553710974752903,
      "train_chorus_rate": 0.5008575761690736,
      "train_max_prob": 0.5734474062919617,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5845556706190109,
      "val_macro_f1": 0.47305886192466995,
      "val_verse_f1": 0.441483803552769,
      "val_chorus_f1": 0.504633920296571,
      "val_chorus_rate": 0.7609622627496719,
      "val_max_prob": 0.5665864795446396,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000744460246042498,
      "epoch_time": 179.10184001922607,
      "val_boundary_f1": 0.055267702936096716,
      "val_boundary_precision": 0.1032258064516129,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.02161372287300177,
      "val_avg_segment_overlap": 0.22171549769521576,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4475207899472942,
      "val_pk_metric": 0.45035056131815626
    },
    {
      "epoch": 5,
      "train_loss": 0.566725555062294,
      "train_chorus_rate": 0.49655063524842263,
      "train_max_prob": 0.5776849508285522,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5804717391729355,
      "val_macro_f1": 0.5672895688975077,
      "val_verse_f1": 0.6029945553539019,
      "val_chorus_f1": 0.5315845824411135,
      "val_chorus_rate": 0.6195031106472015,
      "val_max_prob": 0.5543497055768967,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006691264874152001,
      "epoch_time": 116.63348603248596,
      "val_boundary_f1": 0.11156462585034013,
      "val_boundary_precision": 0.13183279742765272,
      "val_boundary_recall": 0.09669811320754718,
      "val_complete_segments": 0.03314806246937742,
      "val_avg_segment_overlap": 0.30476587972604063,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.08585858585858586,
      "val_window_diff": 0.45005436328096243,
      "val_pk_metric": 0.42646659736917825
    },
    {
      "epoch": 6,
      "train_loss": 0.5404589146375656,
      "train_chorus_rate": 0.4544498026371002,
      "train_max_prob": 0.583491662144661,
      "train_conf_over_90": 4.985044943168759e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5676657408475876,
      "val_macro_f1": 0.548710111681632,
      "val_verse_f1": 0.5758628677322214,
      "val_chorus_f1": 0.5215573556310426,
      "val_chorus_rate": 0.6420983225107193,
      "val_max_prob": 0.610235795378685,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005840592842790243,
      "epoch_time": 161.02011704444885,
      "val_boundary_f1": 0.0947075208913649,
      "val_boundary_precision": 0.11564625850340136,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.025606122331997196,
      "val_avg_segment_overlap": 0.29751798987067296,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.0707070707070707,
      "val_window_diff": 0.4430877736724396,
      "val_pk_metric": 0.4098849410516724
    },
    {
      "epoch": 7,
      "train_loss": 0.5419920027256012,
      "train_chorus_rate": 0.4212330535054207,
      "train_max_prob": 0.6337327301502228,
      "train_conf_over_90": 0.003401010378729552,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5423747599124908,
      "val_macro_f1": 0.6474048009303117,
      "val_verse_f1": 0.7156378600823045,
      "val_chorus_f1": 0.5791717417783191,
      "val_chorus_rate": 0.5080580338835716,
      "val_max_prob": 0.6344215422868729,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004929764816087509,
      "epoch_time": 131.87309217453003,
      "val_boundary_f1": 0.22535211267605634,
      "val_boundary_precision": 0.19649122807017544,
      "val_boundary_recall": 0.2641509433962264,
      "val_complete_segments": 0.09882018626716399,
      "val_avg_segment_overlap": 0.5106586853638166,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.48105803957523935,
      "val_pk_metric": 0.3948692385030102
    },
    {
      "epoch": 8,
      "train_loss": 0.5127491801977158,
      "train_chorus_rate": 0.3996061600744724,
      "train_max_prob": 0.6455019116401672,
      "train_conf_over_90": 0.001380049780709669,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5363660082221031,
      "val_macro_f1": 0.6984793349462217,
      "val_verse_f1": 0.8002203452074917,
      "val_chorus_f1": 0.5967383246849517,
      "val_chorus_rate": 0.36420804262161255,
      "val_max_prob": 0.6645968407392502,
      "val_conf_over_90": 0.0019200854003429413,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00039985883494484954,
      "epoch_time": 126.59727001190186,
      "val_boundary_f1": 0.3231046931407942,
      "val_boundary_precision": 0.26169590643274854,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.1748061821099997,
      "val_avg_segment_overlap": 0.602621673462525,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4476723434164651,
      "val_pk_metric": 0.3627099499625279
    },
    {
      "epoch": 9,
      "train_loss": 0.5206697255373001,
      "train_chorus_rate": 0.420451845228672,
      "train_max_prob": 0.656803521513939,
      "train_conf_over_90": 0.002846182859502733,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5316961482167244,
      "val_macro_f1": 0.715273746969344,
      "val_verse_f1": 0.8164522558434498,
      "val_chorus_f1": 0.614095238095238,
      "val_chorus_rate": 0.3460084870457649,
      "val_max_prob": 0.6570128798484802,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030877603227457605,
      "epoch_time": 149.72865414619446,
      "val_boundary_f1": 0.3574620196604111,
      "val_boundary_precision": 0.28776978417266186,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.20595391634628116,
      "val_avg_segment_overlap": 0.6318563723797851,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4318132146710997,
      "val_pk_metric": 0.3298608376083231
    },
    {
      "epoch": 10,
      "train_loss": 0.5011822074651718,
      "train_chorus_rate": 0.39606972187757494,
      "train_max_prob": 0.6627441197633743,
      "train_conf_over_90": 0.0023175919457571583,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5301696360111237,
      "val_macro_f1": 0.7185196413119249,
      "val_verse_f1": 0.8204111071042194,
      "val_chorus_f1": 0.6166281755196305,
      "val_chorus_rate": 0.3393252342939377,
      "val_max_prob": 0.6442078053951263,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002237088291384002,
      "epoch_time": 200.6518063545227,
      "val_boundary_f1": 0.3115942028985507,
      "val_boundary_precision": 0.2529411764705882,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.17724909616479073,
      "val_avg_segment_overlap": 0.6152484142457174,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4489769515594148,
      "val_pk_metric": 0.3309780992314403
    },
    {
      "epoch": 11,
      "train_loss": 0.49603268653154375,
      "train_chorus_rate": 0.37227657437324524,
      "train_max_prob": 0.6750063478946686,
      "train_conf_over_90": 0.0032639406534144657,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5209428742527962,
      "val_macro_f1": 0.7063560950226102,
      "val_verse_f1": 0.788564850345357,
      "val_chorus_f1": 0.6241473396998636,
      "val_chorus_rate": 0.4212990030646324,
      "val_max_prob": 0.6604279577732086,
      "val_conf_over_90": 0.0012710694136330858,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014837507051110232,
      "epoch_time": 127.7795979976654,
      "val_boundary_f1": 0.29602888086642604,
      "val_boundary_precision": 0.23976608187134502,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.1610273866503983,
      "val_avg_segment_overlap": 0.6007996249197274,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.47353129994849397,
      "val_pk_metric": 0.3617486720443532
    },
    {
      "epoch": 12,
      "train_loss": 0.5005343526601791,
      "train_chorus_rate": 0.39883317425847054,
      "train_max_prob": 0.6745595663785935,
      "train_conf_over_90": 0.004381924751214683,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5199014842510223,
      "val_macro_f1": 0.7009064017532625,
      "val_verse_f1": 0.781262098335269,
      "val_chorus_f1": 0.6205507051712559,
      "val_chorus_rate": 0.4324248731136322,
      "val_max_prob": 0.673127219080925,
      "val_conf_over_90": 0.0022311121283564717,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.60672031361759e-05,
      "epoch_time": 164.9702389240265,
      "val_boundary_f1": 0.2965174129353234,
      "val_boundary_precision": 0.25645438898450945,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.15756079136248807,
      "val_avg_segment_overlap": 0.5873764489970269,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4347174066470971,
      "val_pk_metric": 0.3425457526386714
    },
    {
      "epoch": 13,
      "train_loss": 0.4893472969532013,
      "train_chorus_rate": 0.38249965757131577,
      "train_max_prob": 0.6750802636146546,
      "train_conf_over_90": 0.0043191839009523395,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5195065811276436,
      "val_macro_f1": 0.7021309119513257,
      "val_verse_f1": 0.786766112067317,
      "val_chorus_f1": 0.6174957118353345,
      "val_chorus_rate": 0.41718319058418274,
      "val_max_prob": 0.6710638850927353,
      "val_conf_over_90": 0.0022660854447167367,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.95083798042251e-05,
      "epoch_time": 163.4985373020172,
      "val_boundary_f1": 0.302504816955684,
      "val_boundary_precision": 0.255700325732899,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.15820268837235962,
      "val_avg_segment_overlap": 0.5922325084685609,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.43561006842373834,
      "val_pk_metric": 0.33501721942947693
    },
    {
      "epoch": 14,
      "train_loss": 0.4933534637093544,
      "train_chorus_rate": 0.39525618106126786,
      "train_max_prob": 0.674921277165413,
      "train_conf_over_90": 0.0059535353779210706,
      "train_conf_over_95": 6.839945563115179e-05,
      "val_loss": 0.5178238153457642,
      "val_macro_f1": 0.7027356880019093,
      "val_verse_f1": 0.7835489476732961,
      "val_chorus_f1": 0.6219224283305227,
      "val_chorus_rate": 0.4293990880250931,
      "val_max_prob": 0.672636941075325,
      "val_conf_over_90": 0.0035371548729017377,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0733444508877938e-05,
      "epoch_time": 188.82760500907898,
      "val_boundary_f1": 0.2915057915057915,
      "val_boundary_precision": 0.24673202614379086,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.14706743177050705,
      "val_avg_segment_overlap": 0.5925288197385723,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.44556033574920595,
      "val_pk_metric": 0.34266804014771907
    }
  ]
}