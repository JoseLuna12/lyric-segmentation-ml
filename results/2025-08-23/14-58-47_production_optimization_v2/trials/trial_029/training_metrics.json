{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1950247640707211,
      "layer_dropout": 0.20334080170455726,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17048579147189177,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009438398288333236,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.008893229264907999,
      "gradient_clip_norm": 0.36951991400230977,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08888155956750766,
        "ece_after": 0.014367842940661188,
        "improvement": 0.07451371662684647,
        "params": {
          "temperature": 0.6150227685747701
        }
      },
      "platt": {
        "ece_before": 0.08888155956750766,
        "ece_after": 0.04030015539151045,
        "improvement": 0.04858140417599721,
        "params": {
          "A": 1.3535878076229,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6065271258354187,
      "train_chorus_rate": 0.5678366617881693,
      "train_max_prob": 0.5803316503763198,
      "train_conf_over_90": 0.01943419426679611,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5996642708778381,
      "val_macro_f1": 0.3703840063576776,
      "val_verse_f1": 0.2493159014898145,
      "val_chorus_f1": 0.49145211122554067,
      "val_chorus_rate": 0.8924540430307388,
      "val_max_prob": 0.6104374974966049,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009277765847786976,
      "epoch_time": 118.8915319442749,
      "val_boundary_f1": 0.0400728597449909,
      "val_boundary_precision": 0.088,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.016520275388249937,
      "val_avg_segment_overlap": 0.1592821319332631,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4140029965710106,
      "val_pk_metric": 0.4065661239497009
    },
    {
      "epoch": 2,
      "train_loss": 0.5747683197259903,
      "train_chorus_rate": 0.560889451391995,
      "train_max_prob": 0.5811113119125366,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6024082601070404,
      "val_macro_f1": 0.5546156496264549,
      "val_verse_f1": 0.7113533151680292,
      "val_chorus_f1": 0.3978779840848806,
      "val_chorus_rate": 0.3486550822854042,
      "val_max_prob": 0.5738063603639603,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008806815361513769,
      "epoch_time": 98.121013879776,
      "val_boundary_f1": 0.06473594548551959,
      "val_boundary_precision": 0.1165644171779141,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.010819801395093018,
      "val_avg_segment_overlap": 0.2240565085126523,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4295235193944833,
      "val_pk_metric": 0.4363565999980821
    },
    {
      "epoch": 3,
      "train_loss": 0.5749645978212357,
      "train_chorus_rate": 0.5405258077662438,
      "train_max_prob": 0.5742041140794754,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5863472372293472,
      "val_macro_f1": 0.43906871992721186,
      "val_verse_f1": 0.3919571045576407,
      "val_chorus_f1": 0.486180335296783,
      "val_chorus_rate": 0.7849241346120834,
      "val_max_prob": 0.5694260150194168,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008057641326870652,
      "epoch_time": 61.660202980041504,
      "val_boundary_f1": 0.0692167577413479,
      "val_boundary_precision": 0.152,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.029177550903425768,
      "val_avg_segment_overlap": 0.18619276439258586,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4219404222074599,
      "val_pk_metric": 0.41743743093912994
    },
    {
      "epoch": 4,
      "train_loss": 0.5603855609893799,
      "train_chorus_rate": 0.4743075050413609,
      "train_max_prob": 0.5861442357301712,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5682655721902847,
      "val_macro_f1": 0.5766653414413399,
      "val_verse_f1": 0.6197057512260365,
      "val_chorus_f1": 0.533624931656643,
      "val_chorus_rate": 0.6011810600757599,
      "val_max_prob": 0.5799413472414017,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007081298716249927,
      "epoch_time": 75.46615815162659,
      "val_boundary_f1": 0.14232209737827717,
      "val_boundary_precision": 0.15119363395225463,
      "val_boundary_recall": 0.13443396226415094,
      "val_complete_segments": 0.06839371184546159,
      "val_avg_segment_overlap": 0.3357959790829327,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.1111111111111111,
      "val_window_diff": 0.47967919431496875,
      "val_pk_metric": 0.4161718509804778
    },
    {
      "epoch": 5,
      "train_loss": 0.5423136427998543,
      "train_chorus_rate": 0.4846483275294304,
      "train_max_prob": 0.6173139274120331,
      "train_conf_over_90": 0.00048622367903590203,
      "train_conf_over_95": 0.0,
      "val_loss": 0.539725124835968,
      "val_macro_f1": 0.6984894389993541,
      "val_verse_f1": 0.7890462700661001,
      "val_chorus_f1": 0.6079326079326081,
      "val_chorus_rate": 0.40123771876096725,
      "val_max_prob": 0.6772066503763199,
      "val_conf_over_90": 0.013456327957101166,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005944323665082943,
      "epoch_time": 74.53796100616455,
      "val_boundary_f1": 0.32126276694521816,
      "val_boundary_precision": 0.2649310872894334,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.1735811424968371,
      "val_avg_segment_overlap": 0.5860628612196176,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4481215873380199,
      "val_pk_metric": 0.32862050670498777
    },
    {
      "epoch": 6,
      "train_loss": 0.5190900817513466,
      "train_chorus_rate": 0.4275277517735958,
      "train_max_prob": 0.649933499097824,
      "train_conf_over_90": 0.0038212549465242774,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5149412825703621,
      "val_macro_f1": 0.7040847352488566,
      "val_verse_f1": 0.7803163444639719,
      "val_chorus_f1": 0.6278531260337413,
      "val_chorus_rate": 0.4435267150402069,
      "val_max_prob": 0.6671691834926605,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004724199144166618,
      "epoch_time": 63.684767961502075,
      "val_boundary_f1": 0.30797773654916516,
      "val_boundary_precision": 0.25382262996941896,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.16813337727971875,
      "val_avg_segment_overlap": 0.6126157796289173,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4572829133941055,
      "val_pk_metric": 0.34927394458768646
    },
    {
      "epoch": 7,
      "train_loss": 0.5043748095631599,
      "train_chorus_rate": 0.3914221256971359,
      "train_max_prob": 0.6640093058347702,
      "train_conf_over_90": 0.00809081450861413,
      "train_conf_over_95": 3.8850039709359406e-05,
      "val_loss": 0.5140312165021896,
      "val_macro_f1": 0.7334397683025212,
      "val_verse_f1": 0.8133030990173847,
      "val_chorus_f1": 0.6535764375876577,
      "val_chorus_rate": 0.40145619958639145,
      "val_max_prob": 0.6692776381969452,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003504074623250294,
      "epoch_time": 152.71142601966858,
      "val_boundary_f1": 0.3161698283649503,
      "val_boundary_precision": 0.2562225475841874,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.18999390619220946,
      "val_avg_segment_overlap": 0.6321839932982602,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.42526533647828524,
      "val_pk_metric": 0.3108503837953044
    },
    {
      "epoch": 8,
      "train_loss": 0.49188753217458725,
      "train_chorus_rate": 0.38019436597824097,
      "train_max_prob": 0.669521164894104,
      "train_conf_over_90": 0.008620637477724813,
      "train_conf_over_95": 8.746355888433754e-05,
      "val_loss": 0.5070473253726959,
      "val_macro_f1": 0.7374340968079285,
      "val_verse_f1": 0.8243542435424354,
      "val_chorus_f1": 0.6505139500734215,
      "val_chorus_rate": 0.37005240470170975,
      "val_max_prob": 0.6740321964025497,
      "val_conf_over_90": 0.004829651617910713,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000236709957208331,
      "epoch_time": 98.7963809967041,
      "val_boundary_f1": 0.3292568203198495,
      "val_boundary_precision": 0.27386541471048514,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.21441043945020616,
      "val_avg_segment_overlap": 0.6329513046456625,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.40414680015601134,
      "val_pk_metric": 0.30155570311202184
    },
    {
      "epoch": 9,
      "train_loss": 0.4758684277534485,
      "train_chorus_rate": 0.3219036340713501,
      "train_max_prob": 0.6895596712827683,
      "train_conf_over_90": 0.013388479221612215,
      "train_conf_over_95": 0.00021317056962288916,
      "val_loss": 0.504585437476635,
      "val_macro_f1": 0.706999269473887,
      "val_verse_f1": 0.7790262172284644,
      "val_chorus_f1": 0.6349723217193096,
      "val_chorus_rate": 0.4553379416465759,
      "val_max_prob": 0.6766453087329865,
      "val_conf_over_90": 0.013543330656830221,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001390756961462584,
      "epoch_time": 199.0389688014984,
      "val_boundary_f1": 0.28597957288765086,
      "val_boundary_precision": 0.23583460949464014,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.1619980456141644,
      "val_avg_segment_overlap": 0.6027292254728075,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4626434438602439,
      "val_pk_metric": 0.3430549794091844
    },
    {
      "epoch": 10,
      "train_loss": 0.4759629189968109,
      "train_chorus_rate": 0.346501325070858,
      "train_max_prob": 0.6909961521625518,
      "train_conf_over_90": 0.019340630120132117,
      "train_conf_over_95": 0.0005734014383051544,
      "val_loss": 0.5046334341168404,
      "val_macro_f1": 0.7300743827735149,
      "val_verse_f1": 0.8094876660341557,
      "val_chorus_f1": 0.6506610995128741,
      "val_chorus_rate": 0.4064442291855812,
      "val_max_prob": 0.6849106103181839,
      "val_conf_over_90": 0.01645289669977501,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 6.415829268194673e-05,
      "epoch_time": 150.61021733283997,
      "val_boundary_f1": 0.3156917363045497,
      "val_boundary_precision": 0.26033690658499237,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.20681974202652886,
      "val_avg_segment_overlap": 0.6294988973356499,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4261602852662669,
      "val_pk_metric": 0.3059511000039476
    },
    {
      "epoch": 11,
      "train_loss": 0.4822277411818504,
      "train_chorus_rate": 0.3468513354659081,
      "train_max_prob": 0.6943531930446625,
      "train_conf_over_90": 0.022800555732101203,
      "train_conf_over_95": 0.0006408939836546779,
      "val_loss": 0.5051257163286209,
      "val_macro_f1": 0.7332978338196767,
      "val_verse_f1": 0.8150375939849624,
      "val_chorus_f1": 0.651558073654391,
      "val_chorus_rate": 0.39424528926610947,
      "val_max_prob": 0.6744610071182251,
      "val_conf_over_90": 0.006714453746099025,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.706324405462594e-05,
      "epoch_time": 158.61435914039612,
      "val_boundary_f1": 0.32159847764034255,
      "val_boundary_precision": 0.26953748006379585,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.21191318951128071,
      "val_avg_segment_overlap": 0.6296373614613977,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.41933788288679846,
      "val_pk_metric": 0.30136951784361476
    },
    {
      "epoch": 12,
      "train_loss": 0.4783443033695221,
      "train_chorus_rate": 0.37031403332948687,
      "train_max_prob": 0.6776289016008377,
      "train_conf_over_90": 0.010601825811318123,
      "train_conf_over_95": 0.0003119117813184857,
      "val_loss": 0.5060302242636681,
      "val_macro_f1": 0.747352084016406,
      "val_verse_f1": 0.8342773615932761,
      "val_chorus_f1": 0.6604268064395358,
      "val_chorus_rate": 0.3567521944642067,
      "val_max_prob": 0.6883625537157059,
      "val_conf_over_90": 0.009890260582324117,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 236.22179889678955,
      "val_boundary_f1": 0.3687258687258687,
      "val_boundary_precision": 0.31209150326797386,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.25724380076182835,
      "val_avg_segment_overlap": 0.654346890546193,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3764583321182576,
      "val_pk_metric": 0.2733322221550835
    }
  ]
}