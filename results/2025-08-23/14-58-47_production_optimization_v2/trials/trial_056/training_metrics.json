{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1734008689327779,
      "layer_dropout": 0.2697535268313576,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12671616781439018,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000742572091878156,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.019918534181750838,
      "gradient_clip_norm": 0.5867952976798732,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1289992445607785,
        "ece_after": 0.030909582416294608,
        "improvement": 0.09808966214448389,
        "params": {
          "temperature": 0.47502107882168093
        }
      },
      "platt": {
        "ece_before": 0.1289992445607785,
        "ece_after": 0.054891609343423825,
        "improvement": 0.07410763521735467,
        "params": {
          "A": 1.675641120432565,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5928121775388717,
      "train_chorus_rate": 0.5736561298370362,
      "train_max_prob": 0.5832145631313324,
      "train_conf_over_90": 0.00024600245524197817,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5910789966583252,
      "val_macro_f1": 0.33577733552009886,
      "val_verse_f1": 0.18864353312302842,
      "val_chorus_f1": 0.4829111379171693,
      "val_chorus_rate": 0.9217201918363571,
      "val_max_prob": 0.6119639128446579,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007344695271599618,
      "epoch_time": 67.09951496124268,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.13275619014985773,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40577687458963024,
      "val_pk_metric": 0.39196571469713404
    },
    {
      "epoch": 2,
      "train_loss": 0.5599433928728104,
      "train_chorus_rate": 0.5599818728864193,
      "train_max_prob": 0.5599341541528702,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5777433812618256,
      "val_macro_f1": 0.5000531870461749,
      "val_verse_f1": 0.5426567096628196,
      "val_chorus_f1": 0.45744966442953017,
      "val_chorus_rate": 0.6149447113275528,
      "val_max_prob": 0.5571353733539581,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007105159539639834,
      "epoch_time": 56.23041105270386,
      "val_boundary_f1": 0.0692167577413479,
      "val_boundary_precision": 0.152,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.01407377874769179,
      "val_avg_segment_overlap": 0.20829283081096958,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4509223218748187,
      "val_pk_metric": 0.4581950863056009
    },
    {
      "epoch": 3,
      "train_loss": 0.5654239892959595,
      "train_chorus_rate": 0.5242296658456326,
      "train_max_prob": 0.5723927617073059,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5855711400508881,
      "val_macro_f1": 0.4192139221094588,
      "val_verse_f1": 0.8238529454334925,
      "val_chorus_f1": 0.014574898785425103,
      "val_chorus_rate": 0.003482556203380227,
      "val_max_prob": 0.5486272722482681,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006717582583808821,
      "epoch_time": 39.96475791931152,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.16854330225923483,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.27336180986536973,
      "val_pk_metric": 0.27645067122204625
    },
    {
      "epoch": 4,
      "train_loss": 0.5556670695543289,
      "train_chorus_rate": 0.5572054905584082,
      "train_max_prob": 0.559805366396904,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5878100395202637,
      "val_macro_f1": 0.5398714340239196,
      "val_verse_f1": 0.8153609831029187,
      "val_chorus_f1": 0.26438188494492043,
      "val_chorus_rate": 0.10191639512777328,
      "val_max_prob": 0.5643322765827179,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006198903376876967,
      "epoch_time": 46.567352056503296,
      "val_boundary_f1": 0.16999999999999998,
      "val_boundary_precision": 0.2897727272727273,
      "val_boundary_recall": 0.12028301886792453,
      "val_complete_segments": 0.08591810072456944,
      "val_avg_segment_overlap": 0.2554627362628811,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.08585858585858586,
      "val_window_diff": 0.32387377914108473,
      "val_pk_metric": 0.30869238154178347
    },
    {
      "epoch": 5,
      "train_loss": 0.5552938193082809,
      "train_chorus_rate": 0.5884345347993076,
      "train_max_prob": 0.5721800118684769,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5852085798978806,
      "val_macro_f1": 0.5467105825785883,
      "val_verse_f1": 0.8220015278838808,
      "val_chorus_f1": 0.2714196372732958,
      "val_chorus_rate": 0.09314179606735706,
      "val_max_prob": 0.5692616701126099,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000557179068908617,
      "epoch_time": 45.61583495140076,
      "val_boundary_f1": 0.17886178861788618,
      "val_boundary_precision": 0.2879581151832461,
      "val_boundary_recall": 0.12971698113207547,
      "val_complete_segments": 0.07733286043201207,
      "val_avg_segment_overlap": 0.2659181680517793,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.33021103193056905,
      "val_pk_metric": 0.30711875906014624
    },
    {
      "epoch": 6,
      "train_loss": 0.5397914290428162,
      "train_chorus_rate": 0.5053326934576035,
      "train_max_prob": 0.5852143138647079,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5566587746143341,
      "val_macro_f1": 0.6245639629653779,
      "val_verse_f1": 0.7108626198083068,
      "val_chorus_f1": 0.538265306122449,
      "val_chorus_rate": 0.47194766998291016,
      "val_max_prob": 0.5857006460428238,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004863652354113431,
      "epoch_time": 40.687103033065796,
      "val_boundary_f1": 0.22172949002217296,
      "val_boundary_precision": 0.20920502092050208,
      "val_boundary_recall": 0.2358490566037736,
      "val_complete_segments": 0.06373612856910842,
      "val_avg_segment_overlap": 0.4439793031299383,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.4544955247126029,
      "val_pk_metric": 0.3924064547708941
    },
    {
      "epoch": 7,
      "train_loss": 0.51889588534832,
      "train_chorus_rate": 0.44221448600292207,
      "train_max_prob": 0.6256513208150863,
      "train_conf_over_90": 0.0008181130775483325,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5333945825695992,
      "val_macro_f1": 0.6474113406197373,
      "val_verse_f1": 0.7245617570018134,
      "val_chorus_f1": 0.5702609242376612,
      "val_chorus_rate": 0.4817716181278229,
      "val_max_prob": 0.628657653927803,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041054374152217946,
      "epoch_time": 81.19800996780396,
      "val_boundary_f1": 0.22597864768683273,
      "val_boundary_precision": 0.18142857142857144,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.09901023391214271,
      "val_avg_segment_overlap": 0.5333407337712742,
      "val_verse_to_chorus_acc": 0.20353982300884957,
      "val_chorus_to_verse_acc": 0.3282828282828283,
      "val_window_diff": 0.5210016181764803,
      "val_pk_metric": 0.39677395493782197
    },
    {
      "epoch": 8,
      "train_loss": 0.4959420919418335,
      "train_chorus_rate": 0.385361921787262,
      "train_max_prob": 0.6496248871088028,
      "train_conf_over_90": 0.0042094225180335345,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5306870862841606,
      "val_macro_f1": 0.7074659951472353,
      "val_verse_f1": 0.816735204720186,
      "val_chorus_f1": 0.5981967855742847,
      "val_chorus_rate": 0.32749043405056,
      "val_max_prob": 0.6766105145215988,
      "val_conf_over_90": 0.014408882008865476,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033302835035597673,
      "epoch_time": 56.49286699295044,
      "val_boundary_f1": 0.33751205400192863,
      "val_boundary_precision": 0.28548123980424145,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.19314305026128992,
      "val_avg_segment_overlap": 0.5840657770884493,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4021973196476887,
      "val_pk_metric": 0.29203256539371325
    },
    {
      "epoch": 9,
      "train_loss": 0.48139831721782683,
      "train_chorus_rate": 0.31498067677021024,
      "train_max_prob": 0.660835987329483,
      "train_conf_over_90": 0.01303762539755553,
      "train_conf_over_95": 0.0002071823226287961,
      "val_loss": 0.5246340036392212,
      "val_macro_f1": 0.6247799447864842,
      "val_verse_f1": 0.6854122621564482,
      "val_chorus_f1": 0.5641476274165202,
      "val_chorus_rate": 0.5393865555524826,
      "val_max_prob": 0.6390244960784912,
      "val_conf_over_90": 0.007235244906041771,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000257206856466813,
      "epoch_time": 104.69808006286621,
      "val_boundary_f1": 0.16307403936269915,
      "val_boundary_precision": 0.13530326594090203,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.04433507890559853,
      "val_avg_segment_overlap": 0.485755936662856,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.5282605348168857,
      "val_pk_metric": 0.4024998091216296
    },
    {
      "epoch": 10,
      "train_loss": 0.4858511656522751,
      "train_chorus_rate": 0.3691636249423027,
      "train_max_prob": 0.6622872322797775,
      "train_conf_over_90": 0.013734727236442267,
      "train_conf_over_95": 3.3624746720306575e-05,
      "val_loss": 0.524560384452343,
      "val_macro_f1": 0.6596881296467152,
      "val_verse_f1": 0.7376623376623378,
      "val_chorus_f1": 0.5817139216310927,
      "val_chorus_rate": 0.4712323546409607,
      "val_max_prob": 0.6863622963428497,
      "val_conf_over_90": 0.02291101310402155,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001863930229695391,
      "epoch_time": 80.8416121006012,
      "val_boundary_f1": 0.2645698427382054,
      "val_boundary_precision": 0.2176560121765601,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.11971005621588866,
      "val_avg_segment_overlap": 0.5521559295582207,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.47202657547433846,
      "val_pk_metric": 0.3475138213871547
    },
    {
      "epoch": 11,
      "train_loss": 0.48430319130420685,
      "train_chorus_rate": 0.37096808552742006,
      "train_max_prob": 0.6659882485866546,
      "train_conf_over_90": 0.012297687123646029,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5232362747192383,
      "val_macro_f1": 0.7308752689103782,
      "val_verse_f1": 0.8358947182476595,
      "val_chorus_f1": 0.625855819573097,
      "val_chorus_rate": 0.3107384219765663,
      "val_max_prob": 0.643075093626976,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001236817541904594,
      "epoch_time": 86.09222412109375,
      "val_boundary_f1": 0.3412228796844181,
      "val_boundary_precision": 0.29322033898305083,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.2094404035151649,
      "val_avg_segment_overlap": 0.5999188952859222,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3959451374997799,
      "val_pk_metric": 0.2865748356936409
    },
    {
      "epoch": 12,
      "train_loss": 0.4824988692998886,
      "train_chorus_rate": 0.32479419782757757,
      "train_max_prob": 0.6709591776132584,
      "train_conf_over_90": 0.011463682516478002,
      "train_conf_over_95": 7.55960267269984e-05,
      "val_loss": 0.514287956058979,
      "val_macro_f1": 0.6987104959435146,
      "val_verse_f1": 0.7892749244712991,
      "val_chorus_f1": 0.6081460674157303,
      "val_chorus_rate": 0.4003957137465477,
      "val_max_prob": 0.6725645959377289,
      "val_conf_over_90": 0.01365651423111558,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.181383349727397e-05,
      "epoch_time": 75.9732780456543,
      "val_boundary_f1": 0.266173752310536,
      "val_boundary_precision": 0.2188449848024316,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.14046196249271542,
      "val_avg_segment_overlap": 0.585567866135025,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.45112603170948834,
      "val_pk_metric": 0.33275321588878726
    },
    {
      "epoch": 13,
      "train_loss": 0.4795308694243431,
      "train_chorus_rate": 0.3425119638442993,
      "train_max_prob": 0.6632913708686828,
      "train_conf_over_90": 0.011461165157379582,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5145129710435867,
      "val_macro_f1": 0.6993896441932849,
      "val_verse_f1": 0.7887163953048087,
      "val_chorus_f1": 0.610062893081761,
      "val_chorus_rate": 0.40365706384181976,
      "val_max_prob": 0.6783024668693542,
      "val_conf_over_90": 0.011294139083474874,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.305613791417252e-05,
      "epoch_time": 75.7060718536377,
      "val_boundary_f1": 0.319626168224299,
      "val_boundary_precision": 0.2647058823529412,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.2022786610273355,
      "val_avg_segment_overlap": 0.6010647763080041,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4343528737685586,
      "val_pk_metric": 0.31202219089515176
    },
    {
      "epoch": 14,
      "train_loss": 0.47221641838550565,
      "train_chorus_rate": 0.3520628154277802,
      "train_max_prob": 0.684872567653656,
      "train_conf_over_90": 0.018879710900364444,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5128843933343887,
      "val_macro_f1": 0.7168027028371751,
      "val_verse_f1": 0.8134041384361839,
      "val_chorus_f1": 0.6202012672381663,
      "val_chorus_rate": 0.35960373282432556,
      "val_max_prob": 0.6642309427261353,
      "val_conf_over_90": 0.004571965895593166,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.1025647181942e-06,
      "epoch_time": 81.21481490135193,
      "val_boundary_f1": 0.29916897506925205,
      "val_boundary_precision": 0.24582701062215478,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.1959338845738634,
      "val_avg_segment_overlap": 0.6086955181852899,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4291653617639013,
      "val_pk_metric": 0.30921686018924255
    },
    {
      "epoch": 15,
      "train_loss": 0.4769509434700012,
      "train_chorus_rate": 0.341360741853714,
      "train_max_prob": 0.670061993598938,
      "train_conf_over_90": 0.010744520305888728,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5123605951666832,
      "val_macro_f1": 0.710380543765305,
      "val_verse_f1": 0.8055452865064696,
      "val_chorus_f1": 0.6152158010241405,
      "val_chorus_rate": 0.37227608263492584,
      "val_max_prob": 0.6670225709676743,
      "val_conf_over_90": 0.005591832741629332,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 80.87568402290344,
      "val_boundary_f1": 0.2788550323176362,
      "val_boundary_precision": 0.2291350531107739,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.1637664611286032,
      "val_avg_segment_overlap": 0.5962305502958152,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.43337513340406425,
      "val_pk_metric": 0.3137289171704638
    }
  ]
}