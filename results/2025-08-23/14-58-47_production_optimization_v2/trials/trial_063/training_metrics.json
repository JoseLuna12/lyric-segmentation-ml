{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.181284264780202,
      "layer_dropout": 0.2104329902087273,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12164971075373235,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009074320731580239,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.016277446533670036,
      "gradient_clip_norm": 0.33379973425786996,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1203955725157425,
        "ece_after": 0.024509496269619534,
        "improvement": 0.09588607624612297,
        "params": {
          "temperature": 0.5204161803771532
        }
      },
      "platt": {
        "ece_before": 0.1203955725157425,
        "ece_after": 0.050942743559366156,
        "improvement": 0.06945282895637633,
        "params": {
          "A": 1.499999495408395,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.606060266494751,
      "train_chorus_rate": 0.48531860345683525,
      "train_max_prob": 0.5898011237382889,
      "train_conf_over_90": 0.014114391803741456,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5876675546169281,
      "val_macro_f1": 0.41362770479154726,
      "val_verse_f1": 0.32650706662820883,
      "val_chorus_f1": 0.5007483429548857,
      "val_chorus_rate": 0.8487966954708099,
      "val_max_prob": 0.5659308433532715,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008975282153728572,
      "epoch_time": 79.96511721611023,
      "val_boundary_f1": 0.061930783242258654,
      "val_boundary_precision": 0.136,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.021886408829675005,
      "val_avg_segment_overlap": 0.1856000467254612,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42535731364161705,
      "val_pk_metric": 0.4287543979510682
    },
    {
      "epoch": 2,
      "train_loss": 0.5619971960783005,
      "train_chorus_rate": 0.4866661915555596,
      "train_max_prob": 0.5653713256120682,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6021283715963364,
      "val_macro_f1": 0.5329214134704703,
      "val_verse_f1": 0.8038545228473732,
      "val_chorus_f1": 0.26198830409356727,
      "val_chorus_rate": 0.11964971572160721,
      "val_max_prob": 0.5908887088298798,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008682494881265511,
      "epoch_time": 63.33272194862366,
      "val_boundary_f1": 0.09836065573770492,
      "val_boundary_precision": 0.216,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.05323976642905594,
      "val_avg_segment_overlap": 0.2238858781622939,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.32961197685808663,
      "val_pk_metric": 0.3062252948364168
    },
    {
      "epoch": 3,
      "train_loss": 0.5579523742198944,
      "train_chorus_rate": 0.5532293990254402,
      "train_max_prob": 0.5956201165914535,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6203816533088684,
      "val_macro_f1": 0.5257973289951574,
      "val_verse_f1": 0.8211259079903148,
      "val_chorus_f1": 0.23046874999999997,
      "val_chorus_rate": 0.0776332514360547,
      "val_max_prob": 0.6435340791940689,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008208755122946904,
      "epoch_time": 46.06756615638733,
      "val_boundary_f1": 0.1702838063439065,
      "val_boundary_precision": 0.2914285714285714,
      "val_boundary_recall": 0.12028301886792453,
      "val_complete_segments": 0.08562253739878342,
      "val_avg_segment_overlap": 0.2778947214200486,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.3310790407427226,
      "val_pk_metric": 0.29897044948068957
    },
    {
      "epoch": 4,
      "train_loss": 0.5376025274395942,
      "train_chorus_rate": 0.39252324420958756,
      "train_max_prob": 0.6346353441476822,
      "train_conf_over_90": 0.012583124957745894,
      "train_conf_over_95": 0.0009121587732806802,
      "val_loss": 0.5501249730587006,
      "val_macro_f1": 0.6604688214882926,
      "val_verse_f1": 0.7338449111470112,
      "val_chorus_f1": 0.5870927318295739,
      "val_chorus_rate": 0.4858861714601517,
      "val_max_prob": 0.5674699693918228,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007574767579466847,
      "epoch_time": 53.430476903915405,
      "val_boundary_f1": 0.20419847328244276,
      "val_boundary_precision": 0.17147435897435898,
      "val_boundary_recall": 0.25235849056603776,
      "val_complete_segments": 0.08239143741529743,
      "val_avg_segment_overlap": 0.5194944300971271,
      "val_verse_to_chorus_acc": 0.1902654867256637,
      "val_chorus_to_verse_acc": 0.2878787878787879,
      "val_window_diff": 0.49191852699792726,
      "val_pk_metric": 0.3964378594864933
    },
    {
      "epoch": 5,
      "train_loss": 0.5074899986386299,
      "train_chorus_rate": 0.4049143560230732,
      "train_max_prob": 0.6633389264345169,
      "train_conf_over_90": 0.013648054029908962,
      "train_conf_over_95": 7.032752910163254e-05,
      "val_loss": 0.504444882273674,
      "val_macro_f1": 0.7100572171905807,
      "val_verse_f1": 0.7925826801758747,
      "val_chorus_f1": 0.6275317542052866,
      "val_chorus_rate": 0.4168637618422508,
      "val_max_prob": 0.6811297237873077,
      "val_conf_over_90": 0.0070748538710176945,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006808240548685179,
      "epoch_time": 53.661412954330444,
      "val_boundary_f1": 0.33528265107212474,
      "val_boundary_precision": 0.2857142857142857,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.19345033376051404,
      "val_avg_segment_overlap": 0.600732421329168,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4267248339200362,
      "val_pk_metric": 0.32468503094127843
    },
    {
      "epoch": 6,
      "train_loss": 0.4956438556313515,
      "train_chorus_rate": 0.39955953806638717,
      "train_max_prob": 0.6786712318658829,
      "train_conf_over_90": 0.01454820268554613,
      "train_conf_over_95": 0.00047761166642885656,
      "val_loss": 0.4920601397752762,
      "val_macro_f1": 0.7318883809497233,
      "val_verse_f1": 0.8133358447918628,
      "val_chorus_f1": 0.6504409171075838,
      "val_chorus_rate": 0.3967596963047981,
      "val_max_prob": 0.691778153181076,
      "val_conf_over_90": 0.019859041669405997,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0005942674940051845,
      "epoch_time": 46.181161880493164,
      "val_boundary_f1": 0.3355576739752145,
      "val_boundary_precision": 0.2816,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.19467537337367663,
      "val_avg_segment_overlap": 0.6268208700443854,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4168802871519874,
      "val_pk_metric": 0.31274059353766476
    },
    {
      "epoch": 7,
      "train_loss": 0.481879235804081,
      "train_chorus_rate": 0.36274017095565797,
      "train_max_prob": 0.6869487345218659,
      "train_conf_over_90": 0.025301161740208043,
      "train_conf_over_95": 0.0022343375720083715,
      "val_loss": 0.4964038133621216,
      "val_macro_f1": 0.7527221662220933,
      "val_verse_f1": 0.842900845780097,
      "val_chorus_f1": 0.6625434866640897,
      "val_chorus_rate": 0.3361254185438156,
      "val_max_prob": 0.6978971362113953,
      "val_conf_over_90": 0.005438159103505313,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005015900124108728,
      "epoch_time": 88.57354998588562,
      "val_boundary_f1": 0.35283018867924526,
      "val_boundary_precision": 0.2940251572327044,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.21764785160861513,
      "val_avg_segment_overlap": 0.6475770688447741,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.40725560946336425,
      "val_pk_metric": 0.29736226891457734
    },
    {
      "epoch": 8,
      "train_loss": 0.4722195953130722,
      "train_chorus_rate": 0.3694573506712914,
      "train_max_prob": 0.6987600922584534,
      "train_conf_over_90": 0.021810291544534267,
      "train_conf_over_95": 0.00028062279452569785,
      "val_loss": 0.50250393897295,
      "val_macro_f1": 0.7606701782578937,
      "val_verse_f1": 0.8648186173853525,
      "val_chorus_f1": 0.6565217391304349,
      "val_chorus_rate": 0.2655044384300709,
      "val_max_prob": 0.707381010055542,
      "val_conf_over_90": 0.010289911646395922,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004068420607471514,
      "epoch_time": 63.2648708820343,
      "val_boundary_f1": 0.39258451472191924,
      "val_boundary_precision": 0.36511156186612576,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.22705514179533268,
      "val_avg_segment_overlap": 0.6301373627541145,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.30029809263020724,
      "val_pk_metric": 0.23389622525385856
    },
    {
      "epoch": 9,
      "train_loss": 0.4579613521695137,
      "train_chorus_rate": 0.30713106840848925,
      "train_max_prob": 0.7160939991474151,
      "train_conf_over_90": 0.03382340022362769,
      "train_conf_over_95": 0.0017289778799749911,
      "val_loss": 0.49240589886903763,
      "val_macro_f1": 0.7286860810760648,
      "val_verse_f1": 0.8130385912326714,
      "val_chorus_f1": 0.6443335709194582,
      "val_chorus_rate": 0.39001594483852386,
      "val_max_prob": 0.6835767030715942,
      "val_conf_over_90": 0.00809224514523521,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003141645791528396,
      "epoch_time": 111.50186610221863,
      "val_boundary_f1": 0.30999066293183947,
      "val_boundary_precision": 0.25656877897990726,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.14836212708694152,
      "val_avg_segment_overlap": 0.6207051524073822,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.42624222712916515,
      "val_pk_metric": 0.310894893843534
    },
    {
      "epoch": 10,
      "train_loss": 0.4564696863293648,
      "train_chorus_rate": 0.3284227080643177,
      "train_max_prob": 0.7113347798585892,
      "train_conf_over_90": 0.022878880496136844,
      "train_conf_over_95": 0.0009430316684301942,
      "val_loss": 0.48997894674539566,
      "val_macro_f1": 0.7311702472883803,
      "val_verse_f1": 0.8130999435347261,
      "val_chorus_f1": 0.6492405510420346,
      "val_chorus_rate": 0.39582546055316925,
      "val_max_prob": 0.7150726914405823,
      "val_conf_over_90": 0.047412119805812836,
      "val_conf_over_95": 0.0011563367443159223,
      "learning_rate": 0.0002276080182895061,
      "epoch_time": 88.44723391532898,
      "val_boundary_f1": 0.3311867525298988,
      "val_boundary_precision": 0.27149321266968324,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.1972292964074512,
      "val_avg_segment_overlap": 0.6399858602685693,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.42556846082296995,
      "val_pk_metric": 0.2983864724498345
    },
    {
      "epoch": 11,
      "train_loss": 0.4588719427585602,
      "train_chorus_rate": 0.3448086343705654,
      "train_max_prob": 0.7079366564750671,
      "train_conf_over_90": 0.029465448041446508,
      "train_conf_over_95": 0.0006143370788777247,
      "val_loss": 0.50290197879076,
      "val_macro_f1": 0.7762144171270149,
      "val_verse_f1": 0.8771157752200407,
      "val_chorus_f1": 0.6753130590339892,
      "val_chorus_rate": 0.24977324530482292,
      "val_max_prob": 0.7012041509151459,
      "val_conf_over_90": 0.0009348820603918284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015095531521133938,
      "epoch_time": 92.70421814918518,
      "val_boundary_f1": 0.4412733260153677,
      "val_boundary_precision": 0.4127310061601643,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2931522285048266,
      "val_avg_segment_overlap": 0.6504972323237496,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.26854110513150165,
      "val_pk_metric": 0.21037484995389244
    },
    {
      "epoch": 12,
      "train_loss": 0.45855548679828645,
      "train_chorus_rate": 0.32306398302316663,
      "train_max_prob": 0.7115433692932129,
      "train_conf_over_90": 0.01982795652584173,
      "train_conf_over_95": 0.00010426322114653885,
      "val_loss": 0.48416464030742645,
      "val_macro_f1": 0.7613689639006095,
      "val_verse_f1": 0.8518518518518519,
      "val_chorus_f1": 0.6708860759493671,
      "val_chorus_rate": 0.32139019668102264,
      "val_max_prob": 0.7136706709861755,
      "val_conf_over_90": 0.02249170048162341,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.755656086333352e-05,
      "epoch_time": 82.01701307296753,
      "val_boundary_f1": 0.3884615384615385,
      "val_boundary_precision": 0.32792207792207795,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26884979207354603,
      "val_avg_segment_overlap": 0.6704842921587488,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.34959955379047575,
      "val_pk_metric": 0.24583947191134256
    },
    {
      "epoch": 13,
      "train_loss": 0.44951789975166323,
      "train_chorus_rate": 0.3213855251669884,
      "train_max_prob": 0.716018146276474,
      "train_conf_over_90": 0.027609744016081093,
      "train_conf_over_95": 0.0002057117089862004,
      "val_loss": 0.47975514084100723,
      "val_macro_f1": 0.7497942186544668,
      "val_verse_f1": 0.831946755407654,
      "val_chorus_f1": 0.6676416819012797,
      "val_chorus_rate": 0.37232833355665207,
      "val_max_prob": 0.7148401141166687,
      "val_conf_over_90": 0.03265185956843197,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.01825850314727e-05,
      "epoch_time": 82.10319781303406,
      "val_boundary_f1": 0.37368922783603437,
      "val_boundary_precision": 0.3136,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.24166989099385705,
      "val_avg_segment_overlap": 0.6569675014088139,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.36394373586777584,
      "val_pk_metric": 0.26987611367947445
    },
    {
      "epoch": 14,
      "train_loss": 0.44374486356973647,
      "train_chorus_rate": 0.32383268177509306,
      "train_max_prob": 0.7303786516189575,
      "train_conf_over_90": 0.03516902991104871,
      "train_conf_over_95": 0.00041674978856462983,
      "val_loss": 0.4817799851298332,
      "val_macro_f1": 0.7724188204558755,
      "val_verse_f1": 0.8598296664300923,
      "val_chorus_f1": 0.6850079744816588,
      "val_chorus_rate": 0.3165876045823097,
      "val_max_prob": 0.709261104464531,
      "val_conf_over_90": 0.01606981153599918,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0903857785166699e-05,
      "epoch_time": 87.65581011772156,
      "val_boundary_f1": 0.4125122189638318,
      "val_boundary_precision": 0.35225375626043404,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.282680347367516,
      "val_avg_segment_overlap": 0.6835362631470988,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3270024305883902,
      "val_pk_metric": 0.23595490078048761
    },
    {
      "epoch": 15,
      "train_loss": 0.4490476593375206,
      "train_chorus_rate": 0.3256128132343292,
      "train_max_prob": 0.7184756219387054,
      "train_conf_over_90": 0.02580174575559795,
      "train_conf_over_95": 0.0002560101653216407,
      "val_loss": 0.4810457080602646,
      "val_macro_f1": 0.7686172366619529,
      "val_verse_f1": 0.8556130644297697,
      "val_chorus_f1": 0.6816214088941361,
      "val_chorus_rate": 0.3246476948261261,
      "val_max_prob": 0.7090122550725937,
      "val_conf_over_90": 0.019195297500118613,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 87.54278492927551,
      "val_boundary_f1": 0.4026974951830443,
      "val_boundary_precision": 0.34039087947882735,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2754080906387375,
      "val_avg_segment_overlap": 0.6784662980785026,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.33124465244285173,
      "val_pk_metric": 0.24157267015825012
    }
  ]
}