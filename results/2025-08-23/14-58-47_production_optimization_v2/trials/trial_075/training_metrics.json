{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.19102320532597297,
      "layer_dropout": 0.31528660790586926,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12637752511535214,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007825404786818741,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.014576114210494791,
      "gradient_clip_norm": 0.33330166843581366,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13303839668543727,
        "ece_after": 0.010961581570460448,
        "improvement": 0.12207681511497681,
        "params": {
          "temperature": 0.445536143165203
        }
      },
      "platt": {
        "ece_before": 0.13303839668543727,
        "ece_after": 0.022650692546063177,
        "improvement": 0.11038770413937408,
        "params": {
          "A": 2.026042820302624,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5846491366624832,
      "train_chorus_rate": 0.5837902831670363,
      "train_max_prob": 0.5610627621412277,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5993869006633759,
      "val_macro_f1": 0.5479959422689795,
      "val_verse_f1": 0.678979436405179,
      "val_chorus_f1": 0.4170124481327801,
      "val_chorus_rate": 0.4105822965502739,
      "val_max_prob": 0.5474461168050766,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007740012113904496,
      "epoch_time": 95.26612186431885,
      "val_boundary_f1": 0.0658578856152513,
      "val_boundary_precision": 0.12418300653594772,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.01892400277872176,
      "val_avg_segment_overlap": 0.2257929643615435,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4014561704746119,
      "val_pk_metric": 0.40568952762085286
    },
    {
      "epoch": 2,
      "train_loss": 0.5632931232452393,
      "train_chorus_rate": 0.5228938588872551,
      "train_max_prob": 0.5686858505010605,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5890763998031616,
      "val_macro_f1": 0.5163955064596781,
      "val_verse_f1": 0.5545185522422035,
      "val_chorus_f1": 0.4782724606771528,
      "val_chorus_rate": 0.6224973201751709,
      "val_max_prob": 0.5529945194721222,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000748756616472762,
      "epoch_time": 48.39701795578003,
      "val_boundary_f1": 0.05844155844155845,
      "val_boundary_precision": 0.09375,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.02504386108574868,
      "val_avg_segment_overlap": 0.22812434668379383,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4524124071280957,
      "val_pk_metric": 0.45520697906386365
    },
    {
      "epoch": 3,
      "train_loss": 0.5515163019299507,
      "train_chorus_rate": 0.4454755028709769,
      "train_max_prob": 0.5917680323123932,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5984218120574951,
      "val_macro_f1": 0.5442559294067264,
      "val_verse_f1": 0.8059282371294851,
      "val_chorus_f1": 0.2825836216839677,
      "val_chorus_rate": 0.12573233805596828,
      "val_max_prob": 0.5586562156677246,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007079100038637208,
      "epoch_time": 130.04804611206055,
      "val_boundary_f1": 0.11307420494699645,
      "val_boundary_precision": 0.22535211267605634,
      "val_boundary_recall": 0.07547169811320754,
      "val_complete_segments": 0.0676847522420163,
      "val_avg_segment_overlap": 0.2677974032660185,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0707070707070707,
      "val_window_diff": 0.3229884688415259,
      "val_pk_metric": 0.30331277868705786
    },
    {
      "epoch": 4,
      "train_loss": 0.5505645170807838,
      "train_chorus_rate": 0.41421001420821996,
      "train_max_prob": 0.6052365005016327,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5813190340995789,
      "val_macro_f1": 0.4970486772844165,
      "val_verse_f1": 0.4955665024630542,
      "val_chorus_f1": 0.4985308521057787,
      "val_chorus_rate": 0.7052953243255615,
      "val_max_prob": 0.5885501056909561,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006532465665381345,
      "epoch_time": 96.29233193397522,
      "val_boundary_f1": 0.06518010291595197,
      "val_boundary_precision": 0.11949685534591195,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.027709287836541287,
      "val_avg_segment_overlap": 0.22053328563248187,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.43173892806400094,
      "val_pk_metric": 0.4243531140337927
    },
    {
      "epoch": 5,
      "train_loss": 0.5517102956771851,
      "train_chorus_rate": 0.4782626494765282,
      "train_max_prob": 0.6083091825246811,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5714523792266846,
      "val_macro_f1": 0.6766238157214073,
      "val_verse_f1": 0.825684989073794,
      "val_chorus_f1": 0.5275626423690205,
      "val_chorus_rate": 0.2402636632323265,
      "val_max_prob": 0.6034442484378815,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005871553590114056,
      "epoch_time": 48.217605113983154,
      "val_boundary_f1": 0.2599009900990099,
      "val_boundary_precision": 0.2734375,
      "val_boundary_recall": 0.24764150943396226,
      "val_complete_segments": 0.12217185561565203,
      "val_avg_segment_overlap": 0.4770709000304231,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.19696969696969696,
      "val_window_diff": 0.33043510508210144,
      "val_pk_metric": 0.29662701624211874
    },
    {
      "epoch": 6,
      "train_loss": 0.523276786506176,
      "train_chorus_rate": 0.4019466586410999,
      "train_max_prob": 0.6465597838163376,
      "train_conf_over_90": 0.008575843326980248,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5375977382063866,
      "val_macro_f1": 0.7056735715494957,
      "val_verse_f1": 0.8075168764823938,
      "val_chorus_f1": 0.6038302666165978,
      "val_chorus_rate": 0.3554982542991638,
      "val_max_prob": 0.6902290731668472,
      "val_conf_over_90": 0.008517385052982718,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005125248841932522,
      "epoch_time": 50.04311203956604,
      "val_boundary_f1": 0.3109404990403071,
      "val_boundary_precision": 0.2621359223300971,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.16692290684867567,
      "val_avg_segment_overlap": 0.5821182867973572,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.43074738026408965,
      "val_pk_metric": 0.32620678432183114
    },
    {
      "epoch": 7,
      "train_loss": 0.48915902674198153,
      "train_chorus_rate": 0.39021398201584817,
      "train_max_prob": 0.6857807070016861,
      "train_conf_over_90": 0.009590160584775732,
      "train_conf_over_95": 0.0,
      "val_loss": 0.50956691801548,
      "val_macro_f1": 0.7019518457265344,
      "val_verse_f1": 0.7773422187377498,
      "val_chorus_f1": 0.6265614727153188,
      "val_chorus_rate": 0.44809118658304214,
      "val_max_prob": 0.6863884031772614,
      "val_conf_over_90": 0.01281244307756424,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043261685194997837,
      "epoch_time": 88.49870371818542,
      "val_boundary_f1": 0.2298424467099166,
      "val_boundary_precision": 0.18931297709923664,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.09769066521452523,
      "val_avg_segment_overlap": 0.5816272764665218,
      "val_verse_to_chorus_acc": 0.20353982300884957,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.49748679376599025,
      "val_pk_metric": 0.37898737867819443
    },
    {
      "epoch": 8,
      "train_loss": 0.4847412034869194,
      "train_chorus_rate": 0.3532544247806072,
      "train_max_prob": 0.6885490655899048,
      "train_conf_over_90": 0.010724325294722803,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5099543780088425,
      "val_macro_f1": 0.6775686416913796,
      "val_verse_f1": 0.7447154471544715,
      "val_chorus_f1": 0.6104218362282878,
      "val_chorus_rate": 0.49300675094127655,
      "val_max_prob": 0.6951926648616791,
      "val_conf_over_90": 0.036485057324171066,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003509236267318958,
      "epoch_time": 109.03161215782166,
      "val_boundary_f1": 0.22670509125840538,
      "val_boundary_precision": 0.1912479740680713,
      "val_boundary_recall": 0.2783018867924528,
      "val_complete_segments": 0.09742656040376083,
      "val_avg_segment_overlap": 0.5625815347051579,
      "val_verse_to_chorus_acc": 0.23008849557522124,
      "val_chorus_to_verse_acc": 0.2828282828282828,
      "val_window_diff": 0.48815196411496486,
      "val_pk_metric": 0.3838956777776338
    },
    {
      "epoch": 9,
      "train_loss": 0.4811547249555588,
      "train_chorus_rate": 0.37432985827326776,
      "train_max_prob": 0.6946658700704574,
      "train_conf_over_90": 0.019683632394298912,
      "train_conf_over_95": 3.132832061965018e-05,
      "val_loss": 0.5015780851244926,
      "val_macro_f1": 0.7373038810900083,
      "val_verse_f1": 0.8214285714285715,
      "val_chorus_f1": 0.6531791907514451,
      "val_chorus_rate": 0.380857951939106,
      "val_max_prob": 0.7190334051847458,
      "val_conf_over_90": 0.033953698351979256,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002710155944886219,
      "epoch_time": 67.27788710594177,
      "val_boundary_f1": 0.31578947368421056,
      "val_boundary_precision": 0.26570048309178745,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.14967352407702353,
      "val_avg_segment_overlap": 0.6253459655883785,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4231323616411935,
      "val_pk_metric": 0.3107217452419129
    },
    {
      "epoch": 10,
      "train_loss": 0.4763351038098335,
      "train_chorus_rate": 0.3621898278594017,
      "train_max_prob": 0.6975571662187576,
      "train_conf_over_90": 0.024965979787521065,
      "train_conf_over_95": 3.779289545491338e-05,
      "val_loss": 0.4977424144744873,
      "val_macro_f1": 0.7668322441342358,
      "val_verse_f1": 0.855873467211658,
      "val_chorus_f1": 0.6777910210568135,
      "val_chorus_rate": 0.3191095367074013,
      "val_max_prob": 0.7185139358043671,
      "val_conf_over_90": 0.018919243710115552,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001963851196704686,
      "epoch_time": 46.133338928222656,
      "val_boundary_f1": 0.38491295938104453,
      "val_boundary_precision": 0.3262295081967213,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.24984714300727023,
      "val_avg_segment_overlap": 0.6563709333341381,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3667906760152989,
      "val_pk_metric": 0.2583256004460645
    },
    {
      "epoch": 11,
      "train_loss": 0.47635404765605927,
      "train_chorus_rate": 0.3341767959296703,
      "train_max_prob": 0.7037599831819534,
      "train_conf_over_90": 0.02208363667305093,
      "train_conf_over_95": 0.0001332559040747583,
      "val_loss": 0.5065204203128815,
      "val_macro_f1": 0.7581445514252814,
      "val_verse_f1": 0.8579871371458369,
      "val_chorus_f1": 0.658301965704726,
      "val_chorus_rate": 0.2880714163184166,
      "val_max_prob": 0.668001115322113,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001302939121437398,
      "epoch_time": 41.85978126525879,
      "val_boundary_f1": 0.386904761904762,
      "val_boundary_precision": 0.3339041095890411,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2427580417108519,
      "val_avg_segment_overlap": 0.6379593582283519,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.35316298689928044,
      "val_pk_metric": 0.2562515985489047
    },
    {
      "epoch": 12,
      "train_loss": 0.47568886280059813,
      "train_chorus_rate": 0.3604110836982727,
      "train_max_prob": 0.701145687699318,
      "train_conf_over_90": 0.018932270698132924,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4944748654961586,
      "val_macro_f1": 0.7583414584713768,
      "val_verse_f1": 0.8481919083422843,
      "val_chorus_f1": 0.6684910086004692,
      "val_chorus_rate": 0.3291129544377327,
      "val_max_prob": 0.7011822760105133,
      "val_conf_over_90": 0.011828713759314269,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.563047481815333e-05,
      "epoch_time": 75.61924815177917,
      "val_boundary_f1": 0.37379576107899803,
      "val_boundary_precision": 0.31596091205211724,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.24121713745255635,
      "val_avg_segment_overlap": 0.6470079041912833,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.37070659645336745,
      "val_pk_metric": 0.2623349131771564
    },
    {
      "epoch": 13,
      "train_loss": 0.46389795243740084,
      "train_chorus_rate": 0.3513448193669319,
      "train_max_prob": 0.7078328758478165,
      "train_conf_over_90": 0.027964161382988094,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4907735362648964,
      "val_macro_f1": 0.7561367959106473,
      "val_verse_f1": 0.8423153692614771,
      "val_chorus_f1": 0.6699582225598176,
      "val_chorus_rate": 0.3475544974207878,
      "val_max_prob": 0.6977266818284988,
      "val_conf_over_90": 0.02142056415323168,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.4783862209111984e-05,
      "epoch_time": 51.627254009246826,
      "val_boundary_f1": 0.3733333333333333,
      "val_boundary_precision": 0.31309904153354634,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2449388469669488,
      "val_avg_segment_overlap": 0.6553555803401242,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.37913625488363145,
      "val_pk_metric": 0.26842123708425963
    }
  ]
}