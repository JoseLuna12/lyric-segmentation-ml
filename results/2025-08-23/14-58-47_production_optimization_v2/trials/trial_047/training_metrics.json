{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2249245181897882,
      "layer_dropout": 0.2139701856915581,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.10180546829024407,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00015515513149055022,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.022825874653793005,
      "gradient_clip_norm": 0.37748335366895036,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0865547709708598,
        "ece_after": 0.04539270946401039,
        "improvement": 0.04116206150684941,
        "params": {
          "temperature": 0.4623211704659652
        }
      },
      "platt": {
        "ece_before": 0.0865547709708598,
        "ece_after": 0.03601518308484013,
        "improvement": 0.05053958788601967,
        "params": {
          "A": 0.8505232635016445,
          "B": 0.40837997470607573
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5677757680416107,
      "train_chorus_rate": 0.524596955254674,
      "train_max_prob": 0.5490043729543685,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.600667804479599,
      "val_macro_f1": 0.5220876227374961,
      "val_verse_f1": 0.6081165452653486,
      "val_chorus_f1": 0.4360587002096436,
      "val_chorus_rate": 0.5204187482595444,
      "val_max_prob": 0.5475447177886963,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015347080174941814,
      "epoch_time": 42.130425214767456,
      "val_boundary_f1": 0.06204379562043795,
      "val_boundary_precision": 0.13709677419354838,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.011137252613922816,
      "val_avg_segment_overlap": 0.21879815672392416,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44067806976018986,
      "val_pk_metric": 0.460077496610918
    },
    {
      "epoch": 2,
      "train_loss": 0.5743326097726822,
      "train_chorus_rate": 0.4770529676228762,
      "train_max_prob": 0.5580303519964218,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6025378555059433,
      "val_macro_f1": 0.5056421179074854,
      "val_verse_f1": 0.5618522601984565,
      "val_chorus_f1": 0.4494319756165142,
      "val_chorus_rate": 0.5867902189493179,
      "val_max_prob": 0.5497866719961166,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001484914258180201,
      "epoch_time": 34.740854024887085,
      "val_boundary_f1": 0.06785714285714285,
      "val_boundary_precision": 0.13970588235294118,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.01635310511238401,
      "val_avg_segment_overlap": 0.2149346820033451,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4428378619435547,
      "val_pk_metric": 0.45087489194712815
    },
    {
      "epoch": 3,
      "train_loss": 0.5614990651607513,
      "train_chorus_rate": 0.48736704607435966,
      "train_max_prob": 0.5903307914733886,
      "train_conf_over_90": 3.2195751555264e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6132831573486328,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.5828834772109985,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014043462631825498,
      "epoch_time": 44.769230127334595,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 4,
      "train_loss": 0.5732937067747116,
      "train_chorus_rate": 0.4116341662447667,
      "train_max_prob": 0.582955539226532,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5992715209722519,
      "val_macro_f1": 0.550228960983727,
      "val_verse_f1": 0.6651017214397495,
      "val_chorus_f1": 0.4353562005277045,
      "val_chorus_rate": 0.4459430128335953,
      "val_max_prob": 0.5450655221939087,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001296525240490758,
      "epoch_time": 37.93574619293213,
      "val_boundary_f1": 0.09168081494057725,
      "val_boundary_precision": 0.16363636363636364,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.06452530397387238,
      "val_avg_segment_overlap": 0.2610967420029119,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.33732241065867496,
      "val_pk_metric": 0.3343721034279856
    },
    {
      "epoch": 5,
      "train_loss": 0.5583548650145531,
      "train_chorus_rate": 0.5209400933235884,
      "train_max_prob": 0.5768756687641143,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5947646796703339,
      "val_macro_f1": 0.48202992614815066,
      "val_verse_f1": 0.48673643222195184,
      "val_chorus_f1": 0.47732342007434947,
      "val_chorus_rate": 0.6914955526590347,
      "val_max_prob": 0.5572467297315598,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011661634861791265,
      "epoch_time": 45.882303953170776,
      "val_boundary_f1": 0.046017699115044254,
      "val_boundary_precision": 0.09219858156028368,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.024869696237670786,
      "val_avg_segment_overlap": 0.21039859100194458,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.40541961958149975,
      "val_pk_metric": 0.39446398245532316
    },
    {
      "epoch": 6,
      "train_loss": 0.5619726195931435,
      "train_chorus_rate": 0.5689639586955308,
      "train_max_prob": 0.5785708278417587,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5935986638069153,
      "val_macro_f1": 0.47568227879897584,
      "val_verse_f1": 0.4740083764474009,
      "val_chorus_f1": 0.47735618115055084,
      "val_chorus_rate": 0.70501908659935,
      "val_max_prob": 0.5634271651506424,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010189584344561743,
      "epoch_time": 43.23923993110657,
      "val_boundary_f1": 0.03839441535776615,
      "val_boundary_precision": 0.0738255033557047,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.01454151090948546,
      "val_avg_segment_overlap": 0.20549093407792035,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44821062737801765,
      "val_pk_metric": 0.4470557849645149
    },
    {
      "epoch": 7,
      "train_loss": 0.5630187869071961,
      "train_chorus_rate": 0.5750542517751456,
      "train_max_prob": 0.5723216742277145,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5901028215885162,
      "val_macro_f1": 0.44561731968732077,
      "val_verse_f1": 0.4079051383399209,
      "val_chorus_f1": 0.48332950103472067,
      "val_chorus_rate": 0.7681528031826019,
      "val_max_prob": 0.5697367191314697,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.613436524504025e-05,
      "epoch_time": 33.88967323303223,
      "val_boundary_f1": 0.024822695035460994,
      "val_boundary_precision": 0.05,
      "val_boundary_recall": 0.01650943396226415,
      "val_complete_segments": 0.012850325708226027,
      "val_avg_segment_overlap": 0.19901430720329236,
      "val_verse_to_chorus_acc": 0.017699115044247787,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.45269686001686016,
      "val_pk_metric": 0.4593424449578783
    },
    {
      "epoch": 8,
      "train_loss": 0.5699256092309952,
      "train_chorus_rate": 0.5768336370587349,
      "train_max_prob": 0.5806972563266755,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6051498353481293,
      "val_macro_f1": 0.5625531198263767,
      "val_verse_f1": 0.7088700772911298,
      "val_chorus_f1": 0.4162361623616236,
      "val_chorus_rate": 0.3656754270195961,
      "val_max_prob": 0.5618485659360886,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.002076624550999e-05,
      "epoch_time": 34.41847515106201,
      "val_boundary_f1": 0.10294117647058823,
      "val_boundary_precision": 0.13671875,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.04582422332952556,
      "val_avg_segment_overlap": 0.28557885395380816,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4072865347085466,
      "val_pk_metric": 0.359281733783744
    },
    {
      "epoch": 9,
      "train_loss": 0.5650782451033592,
      "train_chorus_rate": 0.5913727074861527,
      "train_max_prob": 0.5771355301141738,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5927035957574844,
      "val_macro_f1": 0.5477714509327881,
      "val_verse_f1": 0.6303986710963454,
      "val_chorus_f1": 0.4651442307692308,
      "val_chorus_rate": 0.5180971622467041,
      "val_max_prob": 0.5618699640035629,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.42592880449328e-05,
      "epoch_time": 36.92019581794739,
      "val_boundary_f1": 0.0676328502415459,
      "val_boundary_precision": 0.1065989847715736,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.05448909938570596,
      "val_avg_segment_overlap": 0.26621131425079075,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.369781676910106,
      "val_pk_metric": 0.33561568936703867
    },
    {
      "epoch": 10,
      "train_loss": 0.5517146304249764,
      "train_chorus_rate": 0.460293086618185,
      "train_max_prob": 0.5727827370166778,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6017052084207535,
      "val_macro_f1": 0.5622922533819018,
      "val_verse_f1": 0.7515858049031372,
      "val_chorus_f1": 0.37299870186066636,
      "val_chorus_rate": 0.2675914689898491,
      "val_max_prob": 0.558049663901329,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.9538782872637566e-05,
      "epoch_time": 37.52272701263428,
      "val_boundary_f1": 0.11678832116788321,
      "val_boundary_precision": 0.1532567049808429,
      "val_boundary_recall": 0.09433962264150944,
      "val_complete_segments": 0.05801576269497797,
      "val_avg_segment_overlap": 0.2994857532211491,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.37443680909481647,
      "val_pk_metric": 0.3320993575727784
    },
    {
      "epoch": 11,
      "train_loss": 0.5472385466098786,
      "train_chorus_rate": 0.5175179593265057,
      "train_max_prob": 0.5827585071325302,
      "train_conf_over_90": 2.5746654137037696e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5966672897338867,
      "val_macro_f1": 0.544539032343202,
      "val_verse_f1": 0.6212694409415722,
      "val_chorus_f1": 0.46780862374483173,
      "val_chorus_rate": 0.5332744121551514,
      "val_max_prob": 0.5671380907297134,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.6502607441474438e-05,
      "epoch_time": 45.2096381187439,
      "val_boundary_f1": 0.09302325581395349,
      "val_boundary_precision": 0.12121212121212122,
      "val_boundary_recall": 0.07547169811320754,
      "val_complete_segments": 0.04883139464263536,
      "val_avg_segment_overlap": 0.2884559176981108,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.4081338610775355,
      "val_pk_metric": 0.35892737453304635
    },
    {
      "epoch": 12,
      "train_loss": 0.5600002080202102,
      "train_chorus_rate": 0.4796371668577194,
      "train_max_prob": 0.5821146935224533,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5938672423362732,
      "val_macro_f1": 0.5396469781518963,
      "val_verse_f1": 0.6056701030927835,
      "val_chorus_f1": 0.47362385321100925,
      "val_chorus_rate": 0.557493045926094,
      "val_max_prob": 0.5658189207315445,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.572050517229524e-05,
      "epoch_time": 38.937325954437256,
      "val_boundary_f1": 0.06784660766961652,
      "val_boundary_precision": 0.09055118110236221,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.043984753197372495,
      "val_avg_segment_overlap": 0.2788986076943205,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.4087880987921185,
      "val_pk_metric": 0.3542520097402559
    },
    {
      "epoch": 13,
      "train_loss": 0.5563262969255447,
      "train_chorus_rate": 0.6098590016365051,
      "train_max_prob": 0.5753868222236633,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5949460864067078,
      "val_macro_f1": 0.5242345554218413,
      "val_verse_f1": 0.5729561149476498,
      "val_chorus_f1": 0.47551299589603274,
      "val_chorus_rate": 0.5988643318414688,
      "val_max_prob": 0.5698243826627731,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.663705672530094e-06,
      "epoch_time": 36.35250520706177,
      "val_boundary_f1": 0.07055214723926381,
      "val_boundary_precision": 0.10087719298245613,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.04254237004767228,
      "val_avg_segment_overlap": 0.2628385628677362,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.40604533696158296,
      "val_pk_metric": 0.3613918223419241
    },
    {
      "epoch": 14,
      "train_loss": 0.5592913076281547,
      "train_chorus_rate": 0.5942844539880753,
      "train_max_prob": 0.5809895664453506,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5937821865081787,
      "val_macro_f1": 0.5033324437947366,
      "val_verse_f1": 0.5290684099929955,
      "val_chorus_f1": 0.4775964775964776,
      "val_chorus_rate": 0.6494217216968536,
      "val_max_prob": 0.5729355663061142,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.684329741132093e-06,
      "epoch_time": 39.2774658203125,
      "val_boundary_f1": 0.056249999999999994,
      "val_boundary_precision": 0.08333333333333333,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.02545584138903333,
      "val_avg_segment_overlap": 0.2408032276090062,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.43918070907310097,
      "val_pk_metric": 0.38549653438365
    },
    {
      "epoch": 15,
      "train_loss": 0.5560387343168258,
      "train_chorus_rate": 0.6126020506024361,
      "train_max_prob": 0.5813451141119004,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5959784537553787,
      "val_macro_f1": 0.5403506869742609,
      "val_verse_f1": 0.6137229987293519,
      "val_chorus_f1": 0.46697837521917,
      "val_chorus_rate": 0.5416841059923172,
      "val_max_prob": 0.5669577270746231,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 37.34427094459534,
      "val_boundary_f1": 0.08516886930983848,
      "val_boundary_precision": 0.11284046692607004,
      "val_boundary_recall": 0.06839622641509434,
      "val_complete_segments": 0.04755618176880107,
      "val_avg_segment_overlap": 0.28134699012088193,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.41858935681180254,
      "val_pk_metric": 0.36304747704017437
    }
  ]
}