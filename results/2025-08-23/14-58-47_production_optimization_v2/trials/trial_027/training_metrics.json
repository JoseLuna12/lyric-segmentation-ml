{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1530911999257078,
      "layer_dropout": 0.2022654523490779,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17023808683417962,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009783359006686576,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01078198442448794,
      "gradient_clip_norm": 0.31655974005287124,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10205911133577407,
        "ece_after": 0.011978652774702092,
        "improvement": 0.09008045856107198,
        "params": {
          "temperature": 0.5501635669889609
        }
      },
      "platt": {
        "ece_before": 0.10205911133577407,
        "ece_after": 0.01250910193957609,
        "improvement": 0.08955000939619798,
        "params": {
          "A": 1.7210222365433687,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.615964138507843,
      "train_chorus_rate": 0.47039140939014035,
      "train_max_prob": 0.5978001803159714,
      "train_conf_over_90": 0.024876998364925386,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5903894603252411,
      "val_macro_f1": 0.5076870505992975,
      "val_verse_f1": 0.5168756027000965,
      "val_chorus_f1": 0.49849849849849853,
      "val_chorus_rate": 0.6817150115966797,
      "val_max_prob": 0.5453757494688034,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009676573335093591,
      "epoch_time": 85.73682713508606,
      "val_boundary_f1": 0.05246913580246913,
      "val_boundary_precision": 0.07589285714285714,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.04178506259630332,
      "val_avg_segment_overlap": 0.256707616863908,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4503105860729305,
      "val_pk_metric": 0.43032137328330194
    },
    {
      "epoch": 2,
      "train_loss": 0.5651760429143906,
      "train_chorus_rate": 0.49713417747989297,
      "train_max_prob": 0.5647225081920624,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5911962538957596,
      "val_macro_f1": 0.5002397287179716,
      "val_verse_f1": 0.538654503990878,
      "val_chorus_f1": 0.4618249534450652,
      "val_chorus_rate": 0.6231779009103775,
      "val_max_prob": 0.5731434971094131,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000936088336657775,
      "epoch_time": 75.90183210372925,
      "val_boundary_f1": 0.04308797127468582,
      "val_boundary_precision": 0.09022556390977443,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.017013887467227873,
      "val_avg_segment_overlap": 0.20556734739094612,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4482925780037177,
      "val_pk_metric": 0.4526706212280692
    },
    {
      "epoch": 3,
      "train_loss": 0.5736959367990494,
      "train_chorus_rate": 0.4366131915623555,
      "train_max_prob": 0.6094675362110138,
      "train_conf_over_90": 6.468305364251136e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5908505171537399,
      "val_macro_f1": 0.35638714687874806,
      "val_verse_f1": 0.22346022903125967,
      "val_chorus_f1": 0.4893140647262365,
      "val_chorus_rate": 0.9066701233386993,
      "val_max_prob": 0.5768187791109085,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008850086267611736,
      "epoch_time": 53.41461420059204,
      "val_boundary_f1": 0.007285974499089254,
      "val_boundary_precision": 0.016,
      "val_boundary_recall": 0.0047169811320754715,
      "val_complete_segments": 0.0037217095143924415,
      "val_avg_segment_overlap": 0.14777756702483183,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3991302801014729,
      "val_pk_metric": 0.38578532005943245
    },
    {
      "epoch": 4,
      "train_loss": 0.5541989639401436,
      "train_chorus_rate": 0.4302543152240105,
      "train_max_prob": 0.6014965623617172,
      "train_conf_over_90": 0.0007700149028096348,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5679440051317215,
      "val_macro_f1": 0.4535424213569295,
      "val_verse_f1": 0.39315295416896745,
      "val_chorus_f1": 0.5139318885448916,
      "val_chorus_rate": 0.8117196708917618,
      "val_max_prob": 0.6362094730138779,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008166506322496786,
      "epoch_time": 60.791548013687134,
      "val_boundary_f1": 0.06301369863013699,
      "val_boundary_precision": 0.07516339869281045,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.021437562012853635,
      "val_avg_segment_overlap": 0.23416775951078966,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.5101568665858693,
      "val_pk_metric": 0.47576479917719655
    },
    {
      "epoch": 5,
      "train_loss": 0.5223530903458595,
      "train_chorus_rate": 0.40776716992259027,
      "train_max_prob": 0.6610315889120102,
      "train_conf_over_90": 0.02919031917990651,
      "train_conf_over_95": 0.0033993760967859997,
      "val_loss": 0.5358369052410126,
      "val_macro_f1": 0.7274201844802471,
      "val_verse_f1": 0.8166512488436632,
      "val_chorus_f1": 0.638189120116831,
      "val_chorus_rate": 0.3734368160367012,
      "val_max_prob": 0.612757682800293,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007340019255014932,
      "epoch_time": 59.85442399978638,
      "val_boundary_f1": 0.31200701139351444,
      "val_boundary_precision": 0.2482566248256625,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.18603596779630716,
      "val_avg_segment_overlap": 0.6209316368333297,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.4176550830780627,
      "val_pk_metric": 0.29709923493624546
    },
    {
      "epoch": 6,
      "train_loss": 0.5055250585079193,
      "train_chorus_rate": 0.3891327105462551,
      "train_max_prob": 0.6657945543527604,
      "train_conf_over_90": 0.011375941871665417,
      "train_conf_over_95": 0.000128369708545506,
      "val_loss": 0.5230019390583038,
      "val_macro_f1": 0.6074425417029753,
      "val_verse_f1": 0.6421480144404332,
      "val_chorus_f1": 0.5727370689655173,
      "val_chorus_rate": 0.6126032769680023,
      "val_max_prob": 0.6477528661489487,
      "val_conf_over_90": 0.018718803068622947,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006406746515940093,
      "epoch_time": 55.879361152648926,
      "val_boundary_f1": 0.173828125,
      "val_boundary_precision": 0.14833333333333334,
      "val_boundary_recall": 0.2099056603773585,
      "val_complete_segments": 0.08261236353760215,
      "val_avg_segment_overlap": 0.43208788126965153,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.23232323232323232,
      "val_window_diff": 0.5145186059066948,
      "val_pk_metric": 0.39872093255170155
    },
    {
      "epoch": 7,
      "train_loss": 0.5000230073928833,
      "train_chorus_rate": 0.37680068239569664,
      "train_max_prob": 0.6826901495456695,
      "train_conf_over_90": 0.03585920662153512,
      "train_conf_over_95": 0.004025094443932176,
      "val_loss": 0.50746650993824,
      "val_macro_f1": 0.7138853871747711,
      "val_verse_f1": 0.7951807228915663,
      "val_chorus_f1": 0.632590051457976,
      "val_chorus_rate": 0.4162744805216789,
      "val_max_prob": 0.6720072627067566,
      "val_conf_over_90": 0.009566999797243625,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005407476602309303,
      "epoch_time": 1135.5917048454285,
      "val_boundary_f1": 0.3235800344234079,
      "val_boundary_precision": 0.25474254742547425,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22115921215868195,
      "val_avg_segment_overlap": 0.6420172359255283,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.45796637918788613,
      "val_pk_metric": 0.3361119381525694
    },
    {
      "epoch": 8,
      "train_loss": 0.4841982990503311,
      "train_chorus_rate": 0.38705129697918894,
      "train_max_prob": 0.6815261095762253,
      "train_conf_over_90": 0.021871957881376147,
      "train_conf_over_95": 0.0005160846776561812,
      "val_loss": 0.5193346813321114,
      "val_macro_f1": 0.7465360863640509,
      "val_verse_f1": 0.8550300945829751,
      "val_chorus_f1": 0.6380420781451266,
      "val_chorus_rate": 0.27282924950122833,
      "val_max_prob": 0.7092320770025253,
      "val_conf_over_90": 0.027056406252086163,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043858824043772757,
      "epoch_time": 77.69225406646729,
      "val_boundary_f1": 0.3889437314906219,
      "val_boundary_precision": 0.33446519524617996,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.26023466277973173,
      "val_avg_segment_overlap": 0.6325158853601316,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.32794757421196696,
      "val_pk_metric": 0.2373492031576575
    },
    {
      "epoch": 9,
      "train_loss": 0.46157378554344175,
      "train_chorus_rate": 0.31457367315888407,
      "train_max_prob": 0.7124501585960388,
      "train_conf_over_90": 0.03838846040889621,
      "train_conf_over_95": 0.0046138803591020405,
      "val_loss": 0.4972701370716095,
      "val_macro_f1": 0.7061732483554211,
      "val_verse_f1": 0.7789805156465262,
      "val_chorus_f1": 0.6333659810643161,
      "val_chorus_rate": 0.453198678791523,
      "val_max_prob": 0.689050480723381,
      "val_conf_over_90": 0.016706903115846217,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003386612490746486,
      "epoch_time": 135.95547890663147,
      "val_boundary_f1": 0.27927927927927926,
      "val_boundary_precision": 0.2259475218658892,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.16864729067804363,
      "val_avg_segment_overlap": 0.6033544936728696,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4525012811206504,
      "val_pk_metric": 0.33510092568712785
    },
    {
      "epoch": 10,
      "train_loss": 0.46103454679250716,
      "train_chorus_rate": 0.3461246483027935,
      "train_max_prob": 0.7166176408529281,
      "train_conf_over_90": 0.04011678216047585,
      "train_conf_over_95": 0.005373273219447583,
      "val_loss": 0.4983730912208557,
      "val_macro_f1": 0.6967877926957797,
      "val_verse_f1": 0.7661870503597124,
      "val_chorus_f1": 0.6273885350318471,
      "val_chorus_rate": 0.4717103838920593,
      "val_max_prob": 0.6923937052488327,
      "val_conf_over_90": 0.030861967243254185,
      "val_conf_over_95": 0.002793031555484049,
      "learning_rate": 0.00024533397516716455,
      "epoch_time": 108.01731395721436,
      "val_boundary_f1": 0.2720139494333043,
      "val_boundary_precision": 0.2157676348547718,
      "val_boundary_recall": 0.36792452830188677,
      "val_complete_segments": 0.1664476000769744,
      "val_avg_segment_overlap": 0.5981410496319126,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4767628174841906,
      "val_pk_metric": 0.34532047168548535
    },
    {
      "epoch": 11,
      "train_loss": 0.4635266214609146,
      "train_chorus_rate": 0.35038246810436247,
      "train_max_prob": 0.7086804687976838,
      "train_conf_over_90": 0.033447475277353075,
      "train_conf_over_95": 0.003546272448147647,
      "val_loss": 0.5065608993172646,
      "val_macro_f1": 0.7594492551715368,
      "val_verse_f1": 0.8592258288491582,
      "val_chorus_f1": 0.6596726814939153,
      "val_chorus_rate": 0.285725723952055,
      "val_max_prob": 0.6987835168838501,
      "val_conf_over_90": 0.003170271695125848,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001626852684189791,
      "epoch_time": 113.32689189910889,
      "val_boundary_f1": 0.40236686390532544,
      "val_boundary_precision": 0.34576271186440677,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2635145200495147,
      "val_avg_segment_overlap": 0.6579748851573771,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.31353664917152124,
      "val_pk_metric": 0.22901199297747518
    },
    {
      "epoch": 12,
      "train_loss": 0.4593167632818222,
      "train_chorus_rate": 0.331113713234663,
      "train_max_prob": 0.7191360682249069,
      "train_conf_over_90": 0.038977145703393036,
      "train_conf_over_95": 0.0039608719816897064,
      "val_loss": 0.4927341863512993,
      "val_macro_f1": 0.7384842300051705,
      "val_verse_f1": 0.8265980896399706,
      "val_chorus_f1": 0.6503703703703704,
      "val_chorus_rate": 0.3637656345963478,
      "val_max_prob": 0.703151136636734,
      "val_conf_over_90": 0.021571236895397305,
      "val_conf_over_95": 0.000979668096988462,
      "learning_rate": 9.432727390748406e-05,
      "epoch_time": 102.77284598350525,
      "val_boundary_f1": 0.3428047662694776,
      "val_boundary_precision": 0.280359820089955,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22972756311833725,
      "val_avg_segment_overlap": 0.6485101469527417,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3994990876602686,
      "val_pk_metric": 0.28877898531260954
    },
    {
      "epoch": 13,
      "train_loss": 0.45524554550647733,
      "train_chorus_rate": 0.3235268644988537,
      "train_max_prob": 0.7171585828065872,
      "train_conf_over_90": 0.035717493202537295,
      "train_conf_over_95": 0.004266276955604553,
      "val_loss": 0.4892978370189667,
      "val_macro_f1": 0.7316024955512066,
      "val_verse_f1": 0.8106980273141122,
      "val_chorus_f1": 0.6525069637883009,
      "val_chorus_rate": 0.4061307832598686,
      "val_max_prob": 0.7192420959472656,
      "val_conf_over_90": 0.04326550895348191,
      "val_conf_over_95": 0.0035218069097027183,
      "learning_rate": 4.324756401088259e-05,
      "epoch_time": 101.5678641796112,
      "val_boundary_f1": 0.32545454545454544,
      "val_boundary_precision": 0.26479289940828404,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.22113833080163936,
      "val_avg_segment_overlap": 0.6375193903993212,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.42682515447454333,
      "val_pk_metric": 0.3045851985836989
    },
    {
      "epoch": 14,
      "train_loss": 0.44723794758319857,
      "train_chorus_rate": 0.3268845170736313,
      "train_max_prob": 0.7365716814994812,
      "train_conf_over_90": 0.05239937137812376,
      "train_conf_over_95": 0.005942205479368567,
      "val_loss": 0.4918779581785202,
      "val_macro_f1": 0.7517373346808771,
      "val_verse_f1": 0.8414216128450298,
      "val_chorus_f1": 0.6620530565167244,
      "val_chorus_rate": 0.3394909054040909,
      "val_max_prob": 0.7102389186620712,
      "val_conf_over_90": 0.016264613543171436,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 1.1678567159298566e-05,
      "epoch_time": 107.53611397743225,
      "val_boundary_f1": 0.3677298311444652,
      "val_boundary_precision": 0.3052959501557632,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.26423006478679867,
      "val_avg_segment_overlap": 0.6602199696960711,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.36267099216700466,
      "val_pk_metric": 0.2620285763816468
    },
    {
      "epoch": 15,
      "train_loss": 0.45479018688201905,
      "train_chorus_rate": 0.3394164934754372,
      "train_max_prob": 0.7186742573976517,
      "train_conf_over_90": 0.03144251727499068,
      "train_conf_over_95": 0.0018528225627960637,
      "val_loss": 0.4901338070631027,
      "val_macro_f1": 0.7475453661504179,
      "val_verse_f1": 0.8341561528615834,
      "val_chorus_f1": 0.6609345794392524,
      "val_chorus_rate": 0.3576253429055214,
      "val_max_prob": 0.7066589742898941,
      "val_conf_over_90": 0.01670198776992038,
      "val_conf_over_95": 0.00048216007417067885,
      "learning_rate": 1e-06,
      "epoch_time": 106.92152404785156,
      "val_boundary_f1": 0.3527239150507849,
      "val_boundary_precision": 0.2898330804248862,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.25634678952547457,
      "val_avg_segment_overlap": 0.6540088975647741,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3805831246744858,
      "val_pk_metric": 0.26960659946674975
    }
  ]
}