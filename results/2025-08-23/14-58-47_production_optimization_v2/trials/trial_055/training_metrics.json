{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19737618628642584,
      "layer_dropout": 0.22638415442839951,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.11436697981057288,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006423385330761314,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.0185968658373227,
      "gradient_clip_norm": 0.45789576692620226,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14163123033135722,
        "ece_after": 0.025880040011729152,
        "improvement": 0.11575119031962806,
        "params": {
          "temperature": 0.4541087574961492
        }
      },
      "platt": {
        "ece_before": 0.14163123033135722,
        "ece_after": 0.04433417387584808,
        "improvement": 0.09729705645550914,
        "params": {
          "A": 1.8366993130663014,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.607604193687439,
      "train_chorus_rate": 0.4291177745908499,
      "train_max_prob": 0.6044861674308777,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.595798522233963,
      "val_macro_f1": 0.42642031837004507,
      "val_verse_f1": 0.8226579520697168,
      "val_chorus_f1": 0.030182684670373314,
      "val_chorus_rate": 0.009526876616291702,
      "val_max_prob": 0.5531957000494003,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006353311402313439,
      "epoch_time": 69.47818613052368,
      "val_boundary_f1": 0.009174311926605505,
      "val_boundary_precision": 0.16666666666666666,
      "val_boundary_recall": 0.0047169811320754715,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.1718761090270871,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.27436895089876046,
      "val_pk_metric": 0.2783398572168397
    },
    {
      "epoch": 2,
      "train_loss": 0.5620825245976449,
      "train_chorus_rate": 0.5040856565814466,
      "train_max_prob": 0.564196315407753,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5910411477088928,
      "val_macro_f1": 0.5223831184350232,
      "val_verse_f1": 0.5805604203152364,
      "val_chorus_f1": 0.46420581655480986,
      "val_chorus_rate": 0.578982338309288,
      "val_max_prob": 0.5527045130729675,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006146152183895001,
      "epoch_time": 56.81489109992981,
      "val_boundary_f1": 0.056761268781302165,
      "val_boundary_precision": 0.09714285714285714,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.02364624319820502,
      "val_avg_segment_overlap": 0.22572903035959765,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4526670242573657,
      "val_pk_metric": 0.45469636825577453
    },
    {
      "epoch": 3,
      "train_loss": 0.5630725592374801,
      "train_chorus_rate": 0.5679328823462129,
      "train_max_prob": 0.5740552395582199,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5806722790002823,
      "val_macro_f1": 0.4357184697726885,
      "val_verse_f1": 0.382089552238806,
      "val_chorus_f1": 0.48934738730657107,
      "val_chorus_rate": 0.7953181564807892,
      "val_max_prob": 0.5742592960596085,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005810961527411106,
      "epoch_time": 41.42734479904175,
      "val_boundary_f1": 0.05415162454873646,
      "val_boundary_precision": 0.11538461538461539,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.017917893275793594,
      "val_avg_segment_overlap": 0.19987988657096728,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42590376906593624,
      "val_pk_metric": 0.4284586979057758
    },
    {
      "epoch": 4,
      "train_loss": 0.5600987941026687,
      "train_chorus_rate": 0.5132846035063267,
      "train_max_prob": 0.5731247454881668,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5831503421068192,
      "val_macro_f1": 0.5620378456180765,
      "val_verse_f1": 0.6508779093507555,
      "val_chorus_f1": 0.47319778188539735,
      "val_chorus_rate": 0.49890368431806564,
      "val_max_prob": 0.5663827210664749,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005362388872973319,
      "epoch_time": 46.72660493850708,
      "val_boundary_f1": 0.11249999999999999,
      "val_boundary_precision": 0.16666666666666666,
      "val_boundary_recall": 0.08490566037735849,
      "val_complete_segments": 0.04729248639641004,
      "val_avg_segment_overlap": 0.2638345055560228,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.4316170391585585,
      "val_pk_metric": 0.4273962758596256
    },
    {
      "epoch": 5,
      "train_loss": 0.5429608657956123,
      "train_chorus_rate": 0.49605987071990965,
      "train_max_prob": 0.597093689441681,
      "train_conf_over_90": 3.287311119493097e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.562172144651413,
      "val_macro_f1": 0.6256145958698344,
      "val_verse_f1": 0.710568454763811,
      "val_chorus_f1": 0.5406607369758577,
      "val_chorus_rate": 0.4747702553868294,
      "val_max_prob": 0.6114146411418915,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048200389980709857,
      "epoch_time": 47.49146127700806,
      "val_boundary_f1": 0.19923371647509577,
      "val_boundary_precision": 0.21727019498607242,
      "val_boundary_recall": 0.18396226415094338,
      "val_complete_segments": 0.05690613352331274,
      "val_avg_segment_overlap": 0.3943747850915382,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.4452335873768951,
      "val_pk_metric": 0.40488998977721047
    },
    {
      "epoch": 6,
      "train_loss": 0.5254941195249557,
      "train_chorus_rate": 0.42143388092517853,
      "train_max_prob": 0.6355560451745987,
      "train_conf_over_90": 0.0024506675399607047,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5281936377286911,
      "val_macro_f1": 0.6963238062134849,
      "val_verse_f1": 0.7858903849800873,
      "val_chorus_f1": 0.6067572274468825,
      "val_chorus_rate": 0.4053787961602211,
      "val_max_prob": 0.6665198057889938,
      "val_conf_over_90": 0.006588434684090316,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042076151947207773,
      "epoch_time": 41.26559805870056,
      "val_boundary_f1": 0.29547738693467335,
      "val_boundary_precision": 0.2574430823117338,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.15090096914062978,
      "val_avg_segment_overlap": 0.5843527341492346,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.4294943977923808,
      "val_pk_metric": 0.33164555471811796
    },
    {
      "epoch": 7,
      "train_loss": 0.5076519280672074,
      "train_chorus_rate": 0.3882159672677517,
      "train_max_prob": 0.6545473337173462,
      "train_conf_over_90": 0.009934470505686476,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5164560973644257,
      "val_macro_f1": 0.7160414185893273,
      "val_verse_f1": 0.8102526276968467,
      "val_chorus_f1": 0.6218302094818081,
      "val_chorus_rate": 0.36953552067279816,
      "val_max_prob": 0.6627166569232941,
      "val_conf_over_90": 0.0028549674607347697,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00035518833218645536,
      "epoch_time": 82.11516284942627,
      "val_boundary_f1": 0.3013182674199623,
      "val_boundary_precision": 0.2507836990595611,
      "val_boundary_recall": 0.37735849056603776,
      "val_complete_segments": 0.15303659969619673,
      "val_avg_segment_overlap": 0.6141874307209156,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4493358059940521,
      "val_pk_metric": 0.3421638876137271
    },
    {
      "epoch": 8,
      "train_loss": 0.4899516060948372,
      "train_chorus_rate": 0.3908029817044735,
      "train_max_prob": 0.6705901384353637,
      "train_conf_over_90": 0.00750483289884869,
      "train_conf_over_95": 2.6028111460618674e-05,
      "val_loss": 0.5230152830481529,
      "val_macro_f1": 0.7518303350243123,
      "val_verse_f1": 0.85555940422584,
      "val_chorus_f1": 0.6481012658227847,
      "val_chorus_rate": 0.2831016853451729,
      "val_max_prob": 0.7100104689598083,
      "val_conf_over_90": 0.011719300178810954,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00028815020088967624,
      "epoch_time": 56.94176483154297,
      "val_boundary_f1": 0.3818181818181818,
      "val_boundary_precision": 0.3339222614840989,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.23361843892066586,
      "val_avg_segment_overlap": 0.6321770086442972,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3460271008575091,
      "val_pk_metric": 0.2512548858083351
    },
    {
      "epoch": 9,
      "train_loss": 0.47251775711774824,
      "train_chorus_rate": 0.32121183574199674,
      "train_max_prob": 0.6961510568857193,
      "train_conf_over_90": 0.019850326178129762,
      "train_conf_over_95": 0.00045323694357648494,
      "val_loss": 0.5085078552365303,
      "val_macro_f1": 0.7070284372321427,
      "val_verse_f1": 0.790128180600727,
      "val_chorus_f1": 0.6239286938635584,
      "val_chorus_rate": 0.4174008071422577,
      "val_max_prob": 0.6728810220956802,
      "val_conf_over_90": 0.0083576318284031,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002225770136040538,
      "epoch_time": 104.38005089759827,
      "val_boundary_f1": 0.2620169651272385,
      "val_boundary_precision": 0.21821036106750394,
      "val_boundary_recall": 0.3278301886792453,
      "val_complete_segments": 0.10935041237268173,
      "val_avg_segment_overlap": 0.5879675236038313,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.46078620927931496,
      "val_pk_metric": 0.3639429659516557
    },
    {
      "epoch": 10,
      "train_loss": 0.47340395897626875,
      "train_chorus_rate": 0.3402822554111481,
      "train_max_prob": 0.6902158439159394,
      "train_conf_over_90": 0.017540847265627234,
      "train_conf_over_95": 0.0002687152707949281,
      "val_loss": 0.5027948021888733,
      "val_macro_f1": 0.717763887488658,
      "val_verse_f1": 0.7981651376146788,
      "val_chorus_f1": 0.6373626373626374,
      "val_chorus_rate": 0.4157973527908325,
      "val_max_prob": 0.6937039643526077,
      "val_conf_over_90": 0.0241919350810349,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016133463326903293,
      "epoch_time": 80.29884195327759,
      "val_boundary_f1": 0.3423760523854069,
      "val_boundary_precision": 0.2837209302325581,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.204152319263666,
      "val_avg_segment_overlap": 0.6316990147277461,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.42949391302370205,
      "val_pk_metric": 0.31892884989307596
    },
    {
      "epoch": 11,
      "train_loss": 0.47897802889347074,
      "train_chorus_rate": 0.3586999990046024,
      "train_max_prob": 0.686215341091156,
      "train_conf_over_90": 0.01670148717239499,
      "train_conf_over_95": 0.0,
      "val_loss": 0.513712003827095,
      "val_macro_f1": 0.7608754548189056,
      "val_verse_f1": 0.861293670010377,
      "val_chorus_f1": 0.6604572396274343,
      "val_chorus_rate": 0.28100673109292984,
      "val_max_prob": 0.6614068001508713,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010709964577879957,
      "epoch_time": 84.57124781608582,
      "val_boundary_f1": 0.4135188866799205,
      "val_boundary_precision": 0.35738831615120276,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.28110955410796346,
      "val_avg_segment_overlap": 0.6631122476370646,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3381197654059883,
      "val_pk_metric": 0.24408644522970724
    },
    {
      "epoch": 12,
      "train_loss": 0.4743036851286888,
      "train_chorus_rate": 0.33373726680874827,
      "train_max_prob": 0.6866064041852951,
      "train_conf_over_90": 0.013126030514831655,
      "train_conf_over_95": 0.00010828246595337987,
      "val_loss": 0.5007393509149551,
      "val_macro_f1": 0.745093671916199,
      "val_verse_f1": 0.8393689494442452,
      "val_chorus_f1": 0.6508183943881528,
      "val_chorus_rate": 0.3312393128871918,
      "val_max_prob": 0.7010547071695328,
      "val_conf_over_90": 0.016442248364910483,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.22423803350209e-05,
      "epoch_time": 75.75102806091309,
      "val_boundary_f1": 0.36952380952380953,
      "val_boundary_precision": 0.30990415335463256,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.22727907046570886,
      "val_avg_segment_overlap": 0.6457020659811618,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3963405381006942,
      "val_pk_metric": 0.2727717313751783
    },
    {
      "epoch": 13,
      "train_loss": 0.46761308014392855,
      "train_chorus_rate": 0.3269935630261898,
      "train_max_prob": 0.6961041301488876,
      "train_conf_over_90": 0.01719134268350899,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49758380651474,
      "val_macro_f1": 0.7299997095332198,
      "val_verse_f1": 0.8140101142536055,
      "val_chorus_f1": 0.6459893048128342,
      "val_chorus_rate": 0.38970036059617996,
      "val_max_prob": 0.7057364284992218,
      "val_conf_over_90": 0.019200634909793735,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.8723314686631275e-05,
      "epoch_time": 74.76386380195618,
      "val_boundary_f1": 0.3526066350710901,
      "val_boundary_precision": 0.294770206022187,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21967006773475492,
      "val_avg_segment_overlap": 0.6366118869537551,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.42707924468768776,
      "val_pk_metric": 0.3052709665756159
    },
    {
      "epoch": 14,
      "train_loss": 0.46020213812589644,
      "train_chorus_rate": 0.33345068618655205,
      "train_max_prob": 0.7062917113304138,
      "train_conf_over_90": 0.021363397547975182,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49740374088287354,
      "val_macro_f1": 0.7436761737484441,
      "val_verse_f1": 0.8374685364976626,
      "val_chorus_f1": 0.6498838109992254,
      "val_chorus_rate": 0.3350693881511688,
      "val_max_prob": 0.6970988810062408,
      "val_conf_over_90": 0.011788937379606068,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.007392844787495e-06,
      "epoch_time": 79.66596007347107,
      "val_boundary_f1": 0.3758139534883721,
      "val_boundary_precision": 0.3102918586789555,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24157735792147245,
      "val_avg_segment_overlap": 0.6491123989850632,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4049060397432358,
      "val_pk_metric": 0.2783117007760005
    },
    {
      "epoch": 15,
      "train_loss": 0.46804273426532744,
      "train_chorus_rate": 0.32863788604736327,
      "train_max_prob": 0.6967018783092499,
      "train_conf_over_90": 0.017609522119164465,
      "train_conf_over_95": 0.0,
      "val_loss": 0.496475413441658,
      "val_macro_f1": 0.7444281038839384,
      "val_verse_f1": 0.8356858487151647,
      "val_chorus_f1": 0.653170359052712,
      "val_chorus_rate": 0.3439377024769783,
      "val_max_prob": 0.6963312327861786,
      "val_conf_over_90": 0.012020204798318446,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 79.56193494796753,
      "val_boundary_f1": 0.3843283582089552,
      "val_boundary_precision": 0.31790123456790126,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2490705407725556,
      "val_avg_segment_overlap": 0.6523357765548249,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4016625751520331,
      "val_pk_metric": 0.27670941700244567
    }
  ]
}