{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.16263444337136687,
      "layer_dropout": 0.24371826493802612,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.10493777970658193,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007882346102086158,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.02142362971656245,
      "gradient_clip_norm": 0.5179389848109701,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1519448313649839,
        "ece_after": 0.026540523340050956,
        "improvement": 0.12540430802493296,
        "params": {
          "temperature": 0.42240850526427565
        }
      },
      "platt": {
        "ece_before": 0.1519448313649839,
        "ece_after": 0.047364777030902666,
        "improvement": 0.10458005433408124,
        "params": {
          "A": 1.9505410816125242,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.606484904885292,
      "train_chorus_rate": 0.5512076817452908,
      "train_max_prob": 0.5837315559387207,
      "train_conf_over_90": 0.0007072570733726025,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6004465669393539,
      "val_macro_f1": 0.3504716676358468,
      "val_verse_f1": 0.2139303482587065,
      "val_chorus_f1": 0.48701298701298706,
      "val_chorus_rate": 0.9103581458330154,
      "val_max_prob": 0.602397695183754,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000779633127699393,
      "epoch_time": 71.81192803382874,
      "val_boundary_f1": 0.007285974499089254,
      "val_boundary_precision": 0.016,
      "val_boundary_recall": 0.0047169811320754715,
      "val_complete_segments": 0.003818234610917538,
      "val_avg_segment_overlap": 0.14412889191985312,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4093204044804065,
      "val_pk_metric": 0.3974906427576199
    },
    {
      "epoch": 2,
      "train_loss": 0.5702908873558045,
      "train_chorus_rate": 0.5625632613897323,
      "train_max_prob": 0.5604365587234497,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5980522334575653,
      "val_macro_f1": 0.523428132747006,
      "val_verse_f1": 0.621153454249032,
      "val_chorus_f1": 0.42570281124497994,
      "val_chorus_rate": 0.49543873220682144,
      "val_max_prob": 0.5634372383356094,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00075420460623187,
      "epoch_time": 57.66158318519592,
      "val_boundary_f1": 0.05454545454545455,
      "val_boundary_precision": 0.11904761904761904,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.01094220640880238,
      "val_avg_segment_overlap": 0.21008508034072423,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4632475384712821,
      "val_pk_metric": 0.47749283554209854
    },
    {
      "epoch": 3,
      "train_loss": 0.5776373475790024,
      "train_chorus_rate": 0.5416370791383087,
      "train_max_prob": 0.569644233584404,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6025557965040207,
      "val_macro_f1": 0.43621136276520717,
      "val_verse_f1": 0.8225007286505391,
      "val_chorus_f1": 0.049921996879875204,
      "val_chorus_rate": 0.015069955959916115,
      "val_max_prob": 0.5622812211513519,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007130603942137617,
      "epoch_time": 41.81828284263611,
      "val_boundary_f1": 0.013333333333333332,
      "val_boundary_precision": 0.11538461538461539,
      "val_boundary_recall": 0.007075471698113208,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.17277868727724188,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.2751312323485698,
      "val_pk_metric": 0.27858425090706807
    },
    {
      "epoch": 4,
      "train_loss": 0.5624302357435227,
      "train_chorus_rate": 0.5422442371491343,
      "train_max_prob": 0.5668412685394287,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5822106152772903,
      "val_macro_f1": 0.4232084836860556,
      "val_verse_f1": 0.36527436527436524,
      "val_chorus_f1": 0.481142602097746,
      "val_chorus_rate": 0.8015912622213364,
      "val_max_prob": 0.5736387372016907,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006579986911420931,
      "epoch_time": 47.7527232170105,
      "val_boundary_f1": 0.028268551236749113,
      "val_boundary_precision": 0.056338028169014086,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.016449630208909105,
      "val_avg_segment_overlap": 0.17748937554779298,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4263801955554939,
      "val_pk_metric": 0.4158954969200969
    },
    {
      "epoch": 5,
      "train_loss": 0.5477139681577683,
      "train_chorus_rate": 0.5185577906668186,
      "train_max_prob": 0.5997823685407638,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.549240231513977,
      "val_macro_f1": 0.6455295882653403,
      "val_verse_f1": 0.7180428134556576,
      "val_chorus_f1": 0.5730163630750231,
      "val_chorus_rate": 0.4969467446208,
      "val_max_prob": 0.6313030868768692,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005914259576564619,
      "epoch_time": 46.56552815437317,
      "val_boundary_f1": 0.21509824198552224,
      "val_boundary_precision": 0.19152854511970535,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.07177009421176972,
      "val_avg_segment_overlap": 0.49598117823651994,
      "val_verse_to_chorus_acc": 0.20353982300884957,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.4996521950684565,
      "val_pk_metric": 0.4103600796091422
    },
    {
      "epoch": 6,
      "train_loss": 0.5255984783172607,
      "train_chorus_rate": 0.44025871977210046,
      "train_max_prob": 0.6454399138689041,
      "train_conf_over_90": 0.0036727745115058496,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5532341748476028,
      "val_macro_f1": 0.5292239401736294,
      "val_verse_f1": 0.5293395531549226,
      "val_chorus_f1": 0.529108327192336,
      "val_chorus_rate": 0.7003901451826096,
      "val_max_prob": 0.6647428274154663,
      "val_conf_over_90": 0.003517219622153789,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005162517416616078,
      "epoch_time": 40.17216634750366,
      "val_boundary_f1": 0.11737629459148446,
      "val_boundary_precision": 0.1146067415730337,
      "val_boundary_recall": 0.12028301886792453,
      "val_complete_segments": 0.02761475875208643,
      "val_avg_segment_overlap": 0.3504524591735261,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.5157927574709277,
      "val_pk_metric": 0.4350966276880473
    },
    {
      "epoch": 7,
      "train_loss": 0.5207493633031846,
      "train_chorus_rate": 0.4139555662870407,
      "train_max_prob": 0.646146273612976,
      "train_conf_over_90": 0.008673875307431444,
      "train_conf_over_95": 0.0003462048887740821,
      "val_loss": 0.5224315971136093,
      "val_macro_f1": 0.6916010556855838,
      "val_verse_f1": 0.767867690490254,
      "val_chorus_f1": 0.6153344208809136,
      "val_chorus_rate": 0.45361538231372833,
      "val_max_prob": 0.6642356067895889,
      "val_conf_over_90": 0.01228153012925759,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043576151712241634,
      "epoch_time": 82.64380121231079,
      "val_boundary_f1": 0.29880843263061413,
      "val_boundary_precision": 0.24437781109445278,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1687995676330777,
      "val_avg_segment_overlap": 0.5997169537245963,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.46907314915681775,
      "val_pk_metric": 0.34760505743902265
    },
    {
      "epoch": 8,
      "train_loss": 0.5011632382869721,
      "train_chorus_rate": 0.3975073345005512,
      "train_max_prob": 0.657428628206253,
      "train_conf_over_90": 0.009737724828300997,
      "train_conf_over_95": 5.83090353757143e-05,
      "val_loss": 0.5291780009865761,
      "val_macro_f1": 0.745690299775678,
      "val_verse_f1": 0.8436170212765957,
      "val_chorus_f1": 0.6477635782747604,
      "val_chorus_rate": 0.31574902683496475,
      "val_max_prob": 0.7034707963466644,
      "val_conf_over_90": 0.017734201159328222,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0003534730930861996,
      "epoch_time": 57.46870708465576,
      "val_boundary_f1": 0.39014778325123156,
      "val_boundary_precision": 0.3350253807106599,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.23530762810985506,
      "val_avg_segment_overlap": 0.6383065808064345,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3657718081177306,
      "val_pk_metric": 0.26681894804930506
    },
    {
      "epoch": 9,
      "train_loss": 0.48632261604070665,
      "train_chorus_rate": 0.32506396174430846,
      "train_max_prob": 0.6816053658723831,
      "train_conf_over_90": 0.018205242120893673,
      "train_conf_over_95": 0.00035719291772693393,
      "val_loss": 0.5225788503885269,
      "val_macro_f1": 0.6950008560178051,
      "val_verse_f1": 0.7788906009244991,
      "val_chorus_f1": 0.611111111111111,
      "val_chorus_rate": 0.4260062128305435,
      "val_max_prob": 0.6623723953962326,
      "val_conf_over_90": 0.010377102298662066,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002729828685470081,
      "epoch_time": 104.61325120925903,
      "val_boundary_f1": 0.24903474903474906,
      "val_boundary_precision": 0.2107843137254902,
      "val_boundary_recall": 0.30424528301886794,
      "val_complete_segments": 0.1005840126598345,
      "val_avg_segment_overlap": 0.5708291428665668,
      "val_verse_to_chorus_acc": 0.21238938053097345,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.478783080613377,
      "val_pk_metric": 0.3715128041289882
    },
    {
      "epoch": 10,
      "train_loss": 0.4885358870029449,
      "train_chorus_rate": 0.3510312333703041,
      "train_max_prob": 0.6757324904203414,
      "train_conf_over_90": 0.016683371126418933,
      "train_conf_over_95": 0.0005831539863720536,
      "val_loss": 0.5186620876193047,
      "val_macro_f1": 0.7033307369073025,
      "val_verse_f1": 0.7829622458857697,
      "val_chorus_f1": 0.6236992279288353,
      "val_chorus_rate": 0.4321543723344803,
      "val_max_prob": 0.6795071959495544,
      "val_conf_over_90": 0.01987022440880537,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019780865255215402,
      "epoch_time": 81.98450422286987,
      "val_boundary_f1": 0.2999080036798528,
      "val_boundary_precision": 0.2458521870286576,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1554642109917826,
      "val_avg_segment_overlap": 0.6073120818667391,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.47425098169431146,
      "val_pk_metric": 0.34341120044638884
    },
    {
      "epoch": 11,
      "train_loss": 0.4920979171991348,
      "train_chorus_rate": 0.3595078088343143,
      "train_max_prob": 0.6748725831508636,
      "train_conf_over_90": 0.014973711167112925,
      "train_conf_over_95": 0.00013584740227088333,
      "val_loss": 0.5287423059344292,
      "val_macro_f1": 0.7600350441938313,
      "val_verse_f1": 0.8613365567259541,
      "val_chorus_f1": 0.6587335316617084,
      "val_chorus_rate": 0.27860599756240845,
      "val_max_prob": 0.6508980840444565,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013123591906652276,
      "epoch_time": 86.28010320663452,
      "val_boundary_f1": 0.41945288753799387,
      "val_boundary_precision": 0.36767317939609234,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28735181742869975,
      "val_avg_segment_overlap": 0.6582298641888037,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3204988859582869,
      "val_pk_metric": 0.2334902558009374
    },
    {
      "epoch": 12,
      "train_loss": 0.48924720138311384,
      "train_chorus_rate": 0.3348256066441536,
      "train_max_prob": 0.6733135342597961,
      "train_conf_over_90": 0.013910474817384966,
      "train_conf_over_95": 0.00010830662795342505,
      "val_loss": 0.5145939588546753,
      "val_macro_f1": 0.7366167832727202,
      "val_verse_f1": 0.8298875589408776,
      "val_chorus_f1": 0.6433460076045627,
      "val_chorus_rate": 0.34691108763217926,
      "val_max_prob": 0.6860978901386261,
      "val_conf_over_90": 0.015783420065417886,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.617421599485409e-05,
      "epoch_time": 76.86925005912781,
      "val_boundary_f1": 0.3520456707897241,
      "val_boundary_precision": 0.29505582137161085,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2104896917065528,
      "val_avg_segment_overlap": 0.6366029670280882,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4064641750045803,
      "val_pk_metric": 0.28320330377406566
    },
    {
      "epoch": 13,
      "train_loss": 0.48356050848960874,
      "train_chorus_rate": 0.3397241532802582,
      "train_max_prob": 0.68173888027668,
      "train_conf_over_90": 0.016968198434915392,
      "train_conf_over_95": 3.469812509138137e-05,
      "val_loss": 0.5112359672784805,
      "val_macro_f1": 0.7280780208438618,
      "val_verse_f1": 0.8138883703565429,
      "val_chorus_f1": 0.6422676713311806,
      "val_chorus_rate": 0.3853375241160393,
      "val_max_prob": 0.6921266615390778,
      "val_conf_over_90": 0.016099671833217144,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.503000397674564e-05,
      "epoch_time": 75.76818418502808,
      "val_boundary_f1": 0.34593572778827975,
      "val_boundary_precision": 0.2886435331230284,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.2173907413700627,
      "val_avg_segment_overlap": 0.6340555525611515,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.43104363697251,
      "val_pk_metric": 0.3116424756558651
    },
    {
      "epoch": 14,
      "train_loss": 0.47668435871601106,
      "train_chorus_rate": 0.34191973358392713,
      "train_max_prob": 0.6932224780321121,
      "train_conf_over_90": 0.020379586284980176,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5110651031136513,
      "val_macro_f1": 0.7421055413600517,
      "val_verse_f1": 0.8332426056976955,
      "val_chorus_f1": 0.650968477022408,
      "val_chorus_rate": 0.3476107567548752,
      "val_max_prob": 0.686911478638649,
      "val_conf_over_90": 0.011602765880525112,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.60148250922276e-06,
      "epoch_time": 80.98227405548096,
      "val_boundary_f1": 0.3726591760299625,
      "val_boundary_precision": 0.3090062111801242,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2475505178713026,
      "val_avg_segment_overlap": 0.6505272080456349,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3974903062823618,
      "val_pk_metric": 0.281569459432755
    },
    {
      "epoch": 15,
      "train_loss": 0.48324059396982194,
      "train_chorus_rate": 0.3435032725334167,
      "train_max_prob": 0.6851426541805268,
      "train_conf_over_90": 0.017329489579424262,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5107674151659012,
      "val_macro_f1": 0.7398135502209449,
      "val_verse_f1": 0.8311216142519542,
      "val_chorus_f1": 0.6485054861899356,
      "val_chorus_rate": 0.3501685783267021,
      "val_max_prob": 0.6847589164972305,
      "val_conf_over_90": 0.010396417521405965,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 79.97264409065247,
      "val_boundary_f1": 0.3677298311444652,
      "val_boundary_precision": 0.3052959501557632,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2394204365704896,
      "val_avg_segment_overlap": 0.6462011010264895,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.39942923810814707,
      "val_pk_metric": 0.2826753664176985
    }
  ]
}