{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2056727713621969,
      "layer_dropout": 0.2083665130723408,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.15125642633027458,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00010766201430837167,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.013735676623854649,
      "gradient_clip_norm": 0.4122428478855707,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.027307701968608062,
        "ece_after": 0.02623754228906219,
        "improvement": 0.001070159679545872,
        "params": {
          "temperature": 0.8533743969605473
        }
      },
      "platt": {
        "ece_before": 0.027307701968608062,
        "ece_after": 0.027308065158796215,
        "improvement": -3.6319018815317294e-07,
        "params": {
          "A": 0.9999892423285582,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5822899460792541,
      "train_chorus_rate": 0.5774105210904963,
      "train_max_prob": 0.5601604610681534,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5979556441307068,
      "val_macro_f1": 0.5176536007760183,
      "val_verse_f1": 0.5291436795394578,
      "val_chorus_f1": 0.5061635220125787,
      "val_chorus_rate": 0.6772117912769318,
      "val_max_prob": 0.5616867393255234,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010649660384677013,
      "epoch_time": 79.07588195800781,
      "val_boundary_f1": 0.07532956685499059,
      "val_boundary_precision": 0.18691588785046728,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.05079326978849778,
      "val_avg_segment_overlap": 0.2239736855069101,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.36006150150958405,
      "val_pk_metric": 0.3701575172061696
    },
    {
      "epoch": 2,
      "train_loss": 0.5660029411315918,
      "train_chorus_rate": 0.483905253559351,
      "train_max_prob": 0.5796844720840454,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.601364940404892,
      "val_macro_f1": 0.5278200727255647,
      "val_verse_f1": 0.5834797891036908,
      "val_chorus_f1": 0.47216035634743875,
      "val_chorus_rate": 0.5855974927544594,
      "val_max_prob": 0.5652119964361191,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010305130649139734,
      "epoch_time": 63.70855903625488,
      "val_boundary_f1": 0.033582089552238806,
      "val_boundary_precision": 0.08035714285714286,
      "val_boundary_recall": 0.02122641509433962,
      "val_complete_segments": 0.029396481013660228,
      "val_avg_segment_overlap": 0.21705623560556794,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3899093523604262,
      "val_pk_metric": 0.4011081311928705
    },
    {
      "epoch": 3,
      "train_loss": 0.572753244638443,
      "train_chorus_rate": 0.5595863074064255,
      "train_max_prob": 0.5814913958311081,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6231629103422165,
      "val_macro_f1": 0.4667576522349385,
      "val_verse_f1": 0.8156175771971497,
      "val_chorus_f1": 0.11789772727272728,
      "val_chorus_rate": 0.04559762589633465,
      "val_max_prob": 0.5934469401836395,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.747669826905407e-05,
      "epoch_time": 46.172882080078125,
      "val_boundary_f1": 0.017699115044247787,
      "val_boundary_precision": 0.14285714285714285,
      "val_boundary_recall": 0.009433962264150943,
      "val_complete_segments": 0.05527228675425919,
      "val_avg_segment_overlap": 0.1835149586272748,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.28498709158879815,
      "val_pk_metric": 0.28488607272930144
    },
    {
      "epoch": 4,
      "train_loss": 0.5642281979322433,
      "train_chorus_rate": 0.4915235599502921,
      "train_max_prob": 0.5836145520210266,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5988501608371735,
      "val_macro_f1": 0.5507040718491913,
      "val_verse_f1": 0.610617551462622,
      "val_chorus_f1": 0.4907905922357608,
      "val_chorus_rate": 0.5704641342163086,
      "val_max_prob": 0.5651884973049164,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.00164163089948e-05,
      "epoch_time": 52.53598093986511,
      "val_boundary_f1": 0.055658627087198514,
      "val_boundary_precision": 0.13043478260869565,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.04237519977180634,
      "val_avg_segment_overlap": 0.2200344701146565,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3639850111403172,
      "val_pk_metric": 0.3678511300161368
    },
    {
      "epoch": 5,
      "train_loss": 0.5616965740919113,
      "train_chorus_rate": 0.5595076888799667,
      "train_max_prob": 0.5915188938379288,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6025984585285187,
      "val_macro_f1": 0.5617231856086458,
      "val_verse_f1": 0.8056169138529504,
      "val_chorus_f1": 0.31782945736434104,
      "val_chorus_rate": 0.14479740150272846,
      "val_max_prob": 0.5691124498844147,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.099651073127876e-05,
      "epoch_time": 53.801143169403076,
      "val_boundary_f1": 0.08445297504798464,
      "val_boundary_precision": 0.2268041237113402,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.07265579471305877,
      "val_avg_segment_overlap": 0.24653120431711711,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.3015136378794393,
      "val_pk_metric": 0.30034015783105633
    },
    {
      "epoch": 6,
      "train_loss": 0.5560261517763138,
      "train_chorus_rate": 0.4798508666455746,
      "train_max_prob": 0.5910382598638535,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5909020602703094,
      "val_macro_f1": 0.5113966391045663,
      "val_verse_f1": 0.5290353164256933,
      "val_chorus_f1": 0.49375796178343945,
      "val_chorus_rate": 0.6666237711906433,
      "val_max_prob": 0.5883738696575165,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.081119469196117e-05,
      "epoch_time": 46.539443016052246,
      "val_boundary_f1": 0.04217926186291741,
      "val_boundary_precision": 0.08275862068965517,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.029522878051510076,
      "val_avg_segment_overlap": 0.22253463961213008,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4008509946330188,
      "val_pk_metric": 0.4008431371808903
    },
    {
      "epoch": 7,
      "train_loss": 0.5626323908567429,
      "train_chorus_rate": 0.4684127315878868,
      "train_max_prob": 0.6010211110115051,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.608731746673584,
      "val_macro_f1": 0.587994866164486,
      "val_verse_f1": 0.7641493204885601,
      "val_chorus_f1": 0.41184041184041187,
      "val_chorus_rate": 0.2732163220643997,
      "val_max_prob": 0.5863518267869949,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.990561537652913e-05,
      "epoch_time": 88.92159008979797,
      "val_boundary_f1": 0.07678244972577698,
      "val_boundary_precision": 0.17073170731707318,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.05767043554689366,
      "val_avg_segment_overlap": 0.24609441909287416,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.3263358193898388,
      "val_pk_metric": 0.3232353929471471
    },
    {
      "epoch": 8,
      "train_loss": 0.5477627217769623,
      "train_chorus_rate": 0.49409832060337067,
      "train_max_prob": 0.5948588430881501,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5935946404933929,
      "val_macro_f1": 0.6011770031394332,
      "val_verse_f1": 0.7082284607938045,
      "val_chorus_f1": 0.49412554548506205,
      "val_chorus_rate": 0.43382086604833603,
      "val_max_prob": 0.5821023732423782,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.8756398931842576e-05,
      "epoch_time": 63.80608677864075,
      "val_boundary_f1": 0.09461663947797715,
      "val_boundary_precision": 0.15343915343915343,
      "val_boundary_recall": 0.06839622641509434,
      "val_complete_segments": 0.06180811738871124,
      "val_avg_segment_overlap": 0.2895301718156361,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.3483934961708072,
      "val_pk_metric": 0.3462483055609562
    },
    {
      "epoch": 9,
      "train_loss": 0.526583768427372,
      "train_chorus_rate": 0.414778496325016,
      "train_max_prob": 0.6209779262542725,
      "train_conf_over_90": 0.000200803205370903,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5845717936754227,
      "val_macro_f1": 0.5258236490820074,
      "val_verse_f1": 0.549579045837231,
      "val_chorus_f1": 0.5020682523267839,
      "val_chorus_rate": 0.652612954378128,
      "val_max_prob": 0.5927693694829941,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.785081961641052e-05,
      "epoch_time": 112.94254207611084,
      "val_boundary_f1": 0.06745362563237775,
      "val_boundary_precision": 0.11834319526627218,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.05045352123825082,
      "val_avg_segment_overlap": 0.23753295403312927,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3905401624263267,
      "val_pk_metric": 0.3744536324737891
    },
    {
      "epoch": 10,
      "train_loss": 0.5380975514650345,
      "train_chorus_rate": 0.46785696744918825,
      "train_max_prob": 0.6176866978406906,
      "train_conf_over_90": 3.324467979837209e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5821897834539413,
      "val_macro_f1": 0.5582791679889672,
      "val_verse_f1": 0.6120840630472855,
      "val_chorus_f1": 0.5044742729306488,
      "val_chorus_rate": 0.580698162317276,
      "val_max_prob": 0.5905083119869232,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.7665503577092935e-05,
      "epoch_time": 89.44910788536072,
      "val_boundary_f1": 0.07631160572337044,
      "val_boundary_precision": 0.11707317073170732,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.05047740514336485,
      "val_avg_segment_overlap": 0.27312901321408456,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.39353013096484074,
      "val_pk_metric": 0.37006814355810963
    },
    {
      "epoch": 11,
      "train_loss": 0.5359175875782967,
      "train_chorus_rate": 0.4582520842552185,
      "train_max_prob": 0.6161492198705674,
      "train_conf_over_90": 0.0004530839069047943,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5842537134885788,
      "val_macro_f1": 0.5818658684852775,
      "val_verse_f1": 0.6553884711779449,
      "val_chorus_f1": 0.5083432657926101,
      "val_chorus_rate": 0.5268232300877571,
      "val_max_prob": 0.5954413414001465,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.864559799937688e-05,
      "epoch_time": 93.20430493354797,
      "val_boundary_f1": 0.08763693270735524,
      "val_boundary_precision": 0.13023255813953488,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.04966634184555712,
      "val_avg_segment_overlap": 0.2908576714517551,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.3959996502340768,
      "val_pk_metric": 0.3793783783534411
    },
    {
      "epoch": 12,
      "train_loss": 0.5368723019957542,
      "train_chorus_rate": 0.44738597720861434,
      "train_max_prob": 0.6159923285245895,
      "train_conf_over_90": 0.00021144588536117225,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5874287337064743,
      "val_macro_f1": 0.5819589640036031,
      "val_verse_f1": 0.6625488984970146,
      "val_chorus_f1": 0.5013690295101917,
      "val_chorus_rate": 0.509967491030693,
      "val_max_prob": 0.5980719327926636,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1185316039317597e-05,
      "epoch_time": 82.93661379814148,
      "val_boundary_f1": 0.10670731707317072,
      "val_boundary_precision": 0.15086206896551724,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.055394691767968546,
      "val_avg_segment_overlap": 0.29268183001257214,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.4049282229995929,
      "val_pk_metric": 0.38108765893402596
    },
    {
      "epoch": 13,
      "train_loss": 0.5291043490171432,
      "train_chorus_rate": 0.41853759810328484,
      "train_max_prob": 0.6229162991046906,
      "train_conf_over_90": 0.00015673980815336108,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5797503590583801,
      "val_macro_f1": 0.5868641768209812,
      "val_verse_f1": 0.6575802054938142,
      "val_chorus_f1": 0.5161481481481482,
      "val_chorus_rate": 0.5313612073659897,
      "val_max_prob": 0.5977272987365723,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.61070781697431e-06,
      "epoch_time": 83.54768323898315,
      "val_boundary_f1": 0.10287443267776096,
      "val_boundary_precision": 0.14345991561181434,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.05363485739943852,
      "val_avg_segment_overlap": 0.3085945420365611,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3985940986353702,
      "val_pk_metric": 0.3774092798019192
    }
  ]
}