{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.170045367776358,
      "layer_dropout": 0.22585202399152518,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.15619074422316837,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006302595919945073,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.015491878485274432,
      "gradient_clip_norm": 0.38662635206042656,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13365134598288417,
        "ece_after": 0.017451516405655496,
        "improvement": 0.11619982957722867,
        "params": {
          "temperature": 0.460443089533143
        }
      },
      "platt": {
        "ece_before": 0.13365134598288417,
        "ece_after": 0.02520327410552732,
        "improvement": 0.10844807187735685,
        "params": {
          "A": 1.9843408567675507,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5965329468250274,
      "train_chorus_rate": 0.525667457934469,
      "train_max_prob": 0.587273332476616,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6049273908138275,
      "val_macro_f1": 0.34799212533795004,
      "val_verse_f1": 0.2099688473520249,
      "val_chorus_f1": 0.48601540332387516,
      "val_chorus_rate": 0.9118405431509018,
      "val_max_prob": 0.6098253428936005,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006233841760713341,
      "epoch_time": 127.30714583396912,
      "val_boundary_f1": 0.003642987249544627,
      "val_boundary_precision": 0.008,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.0020325203252032522,
      "val_avg_segment_overlap": 0.14164350982384122,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4157574862498105,
      "val_pk_metric": 0.4046502561129324
    },
    {
      "epoch": 2,
      "train_loss": 0.5685438752174378,
      "train_chorus_rate": 0.5093105882406235,
      "train_max_prob": 0.5771963685750962,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5954605489969254,
      "val_macro_f1": 0.5180505964207884,
      "val_verse_f1": 0.5800696257615318,
      "val_chorus_f1": 0.4560315670800451,
      "val_chorus_rate": 0.572381965816021,
      "val_max_prob": 0.553265392780304,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006030584169695629,
      "epoch_time": 94.50135397911072,
      "val_boundary_f1": 0.04225352112676056,
      "val_boundary_precision": 0.08333333333333333,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.011630864692900748,
      "val_avg_segment_overlap": 0.2141422684442748,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4522907766493511,
      "val_pk_metric": 0.4639561381817321
    },
    {
      "epoch": 3,
      "train_loss": 0.5701951265335083,
      "train_chorus_rate": 0.5138897917233407,
      "train_max_prob": 0.5829850137233734,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.588283434510231,
      "val_macro_f1": 0.5960449457782896,
      "val_verse_f1": 0.7676663219579455,
      "val_chorus_f1": 0.4244235695986337,
      "val_chorus_rate": 0.27564919367432594,
      "val_max_prob": 0.54462631046772,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005701706478957547,
      "epoch_time": 58.60752010345459,
      "val_boundary_f1": 0.1484848484848485,
      "val_boundary_precision": 0.2076271186440678,
      "val_boundary_recall": 0.11556603773584906,
      "val_complete_segments": 0.06562635199962878,
      "val_avg_segment_overlap": 0.2990282594604714,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.3554486762336243,
      "val_pk_metric": 0.346277453440138
    },
    {
      "epoch": 4,
      "train_loss": 0.5523716509342194,
      "train_chorus_rate": 0.5223122194409371,
      "train_max_prob": 0.5777898639440536,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5770168900489807,
      "val_macro_f1": 0.4467710358430611,
      "val_verse_f1": 0.3842746400885935,
      "val_chorus_f1": 0.5092674315975286,
      "val_chorus_rate": 0.8150360137224197,
      "val_max_prob": 0.6076711267232895,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005261582221714598,
      "epoch_time": 74.61376881599426,
      "val_boundary_f1": 0.06293706293706293,
      "val_boundary_precision": 0.12162162162162163,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.023620363281020754,
      "val_avg_segment_overlap": 0.194347190894544,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.43435444638445253,
      "val_pk_metric": 0.43210912585973016
    },
    {
      "epoch": 5,
      "train_loss": 0.5487711071968079,
      "train_chorus_rate": 0.4484824424609542,
      "train_max_prob": 0.6103869616985321,
      "train_conf_over_90": 7.03234865795821e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5676967203617096,
      "val_macro_f1": 0.6721387353092239,
      "val_verse_f1": 0.819322033898305,
      "val_chorus_f1": 0.5249554367201426,
      "val_chorus_rate": 0.25269804894924164,
      "val_max_prob": 0.5933520197868347,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00047294469399588045,
      "epoch_time": 70.66075611114502,
      "val_boundary_f1": 0.28095238095238095,
      "val_boundary_precision": 0.28365384615384615,
      "val_boundary_recall": 0.2783018867924528,
      "val_complete_segments": 0.13365044335351864,
      "val_avg_segment_overlap": 0.47511492880029216,
      "val_verse_to_chorus_acc": 0.23008849557522124,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.3568122130373931,
      "val_pk_metric": 0.3005636779043929
    },
    {
      "epoch": 6,
      "train_loss": 0.5129690080881119,
      "train_chorus_rate": 0.4007192201912403,
      "train_max_prob": 0.6515530675649643,
      "train_conf_over_90": 0.007045944035053253,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5153747349977493,
      "val_macro_f1": 0.6882180000585401,
      "val_verse_f1": 0.7686902205738826,
      "val_chorus_f1": 0.6077457795431976,
      "val_chorus_rate": 0.4425588622689247,
      "val_max_prob": 0.6542980372905731,
      "val_conf_over_90": 0.004126036947127432,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041285574989712785,
      "epoch_time": 57.81698679924011,
      "val_boundary_f1": 0.25311601150527324,
      "val_boundary_precision": 0.21324717285945072,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.1384005597022564,
      "val_avg_segment_overlap": 0.5852692256173622,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.47494512387668575,
      "val_pk_metric": 0.3663698853895007
    },
    {
      "epoch": 7,
      "train_loss": 0.4923294007778168,
      "train_chorus_rate": 0.3718432329595089,
      "train_max_prob": 0.6826436072587967,
      "train_conf_over_90": 0.03160496195778251,
      "train_conf_over_95": 0.0011070653970818966,
      "val_loss": 0.5085946395993233,
      "val_macro_f1": 0.7100464794159103,
      "val_verse_f1": 0.7881601857225768,
      "val_chorus_f1": 0.6319327731092438,
      "val_chorus_rate": 0.43186552822589874,
      "val_max_prob": 0.7335257977247238,
      "val_conf_over_90": 0.0905192643404007,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00034851756507106195,
      "epoch_time": 148.11385583877563,
      "val_boundary_f1": 0.2710843373493976,
      "val_boundary_precision": 0.23601398601398602,
      "val_boundary_recall": 0.31839622641509435,
      "val_complete_segments": 0.13712734284049238,
      "val_avg_segment_overlap": 0.5898814072347691,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.45094663101594246,
      "val_pk_metric": 0.356992276740443
    },
    {
      "epoch": 8,
      "train_loss": 0.4810418516397476,
      "train_chorus_rate": 0.39183567762374877,
      "train_max_prob": 0.6973487436771393,
      "train_conf_over_90": 0.031518079366651366,
      "train_conf_over_95": 0.000716297747567296,
      "val_loss": 0.5095399096608162,
      "val_macro_f1": 0.7623039017187629,
      "val_verse_f1": 0.8630562262849258,
      "val_chorus_f1": 0.6615515771526002,
      "val_chorus_rate": 0.27729253470897675,
      "val_max_prob": 0.6924341022968292,
      "val_conf_over_90": 0.0007287753687705845,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002827420269234455,
      "epoch_time": 96.32581567764282,
      "val_boundary_f1": 0.38437170010559657,
      "val_boundary_precision": 0.3479923518164436,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.24811518456799475,
      "val_avg_segment_overlap": 0.6368977322747648,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.31380950907800703,
      "val_pk_metric": 0.23842069925854606
    },
    {
      "epoch": 9,
      "train_loss": 0.4585316523909569,
      "train_chorus_rate": 0.30800234377384184,
      "train_max_prob": 0.713544824719429,
      "train_conf_over_90": 0.024894310673698784,
      "train_conf_over_95": 0.0003074796579312533,
      "val_loss": 0.4993786886334419,
      "val_macro_f1": 0.7148165431082579,
      "val_verse_f1": 0.7956371986222732,
      "val_chorus_f1": 0.6339958875942426,
      "val_chorus_rate": 0.4179147556424141,
      "val_max_prob": 0.6881959438323975,
      "val_conf_over_90": 0.013000182574614882,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002184038420973795,
      "epoch_time": 205.8161699771881,
      "val_boundary_f1": 0.28267182962245885,
      "val_boundary_precision": 0.23973727422003285,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.16371011217246634,
      "val_avg_segment_overlap": 0.6039146464143184,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.4497808202045614,
      "val_pk_metric": 0.34101513327533123
    },
    {
      "epoch": 10,
      "train_loss": 0.4574419900774956,
      "train_chorus_rate": 0.32836144864559175,
      "train_max_prob": 0.7127849370241165,
      "train_conf_over_90": 0.02332836090354249,
      "train_conf_over_95": 0.0004899780004052445,
      "val_loss": 0.49225403368473053,
      "val_macro_f1": 0.7200123400628506,
      "val_verse_f1": 0.797847809377402,
      "val_chorus_f1": 0.6421768707482994,
      "val_chorus_rate": 0.4226470813155174,
      "val_max_prob": 0.7148984223604202,
      "val_conf_over_90": 0.027019302593544126,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001583148979986269,
      "epoch_time": 153.44678211212158,
      "val_boundary_f1": 0.32664756446991405,
      "val_boundary_precision": 0.27447833065810595,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.2077705091093214,
      "val_avg_segment_overlap": 0.6270851640325692,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.43795493936384533,
      "val_pk_metric": 0.3180963568919679
    },
    {
      "epoch": 11,
      "train_loss": 0.4658946141600609,
      "train_chorus_rate": 0.349578071385622,
      "train_max_prob": 0.7073333263397217,
      "train_conf_over_90": 0.025780566886533053,
      "train_conf_over_95": 0.0003210842434782535,
      "val_loss": 0.5012400522828102,
      "val_macro_f1": 0.7634877381062262,
      "val_verse_f1": 0.8583946722747984,
      "val_chorus_f1": 0.6685808039376538,
      "val_chorus_rate": 0.29969384521245956,
      "val_max_prob": 0.6679967790842056,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010510136982304755,
      "epoch_time": 155.77853989601135,
      "val_boundary_f1": 0.4115308151093439,
      "val_boundary_precision": 0.3556701030927835,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2624028948657793,
      "val_avg_segment_overlap": 0.6665846124500759,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.33689970422037807,
      "val_pk_metric": 0.24601695921257408
    },
    {
      "epoch": 12,
      "train_loss": 0.46140834242105483,
      "train_chorus_rate": 0.32544117271900175,
      "train_max_prob": 0.7088144421577454,
      "train_conf_over_90": 0.02173199233948253,
      "train_conf_over_95": 0.00046316808729898187,
      "val_loss": 0.4923030212521553,
      "val_macro_f1": 0.7553561185271815,
      "val_verse_f1": 0.8427718472950968,
      "val_chorus_f1": 0.6679403897592663,
      "val_chorus_rate": 0.34373481571674347,
      "val_max_prob": 0.7339154630899429,
      "val_conf_over_90": 0.032167277531698346,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.108894409875266e-05,
      "epoch_time": 135.33172297477722,
      "val_boundary_f1": 0.3902912621359223,
      "val_boundary_precision": 0.3316831683168317,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.25550285173827064,
      "val_avg_segment_overlap": 0.6703277198184758,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.37358342746178136,
      "val_pk_metric": 0.2678696789432238
    },
    {
      "epoch": 13,
      "train_loss": 0.4535493180155754,
      "train_chorus_rate": 0.3232771396636963,
      "train_max_prob": 0.7163199454545974,
      "train_conf_over_90": 0.022129907505586743,
      "train_conf_over_95": 0.0003641486313426867,
      "val_loss": 0.48386453092098236,
      "val_macro_f1": 0.7370567644924995,
      "val_verse_f1": 0.8180964895813779,
      "val_chorus_f1": 0.6560170394036209,
      "val_chorus_rate": 0.3929135128855705,
      "val_max_prob": 0.7200632095336914,
      "val_conf_over_90": 0.0232790419831872,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.820117502494438e-05,
      "epoch_time": 134.4771580696106,
      "val_boundary_f1": 0.36738703339882123,
      "val_boundary_precision": 0.3148148148148148,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.23350103246709825,
      "val_avg_segment_overlap": 0.6460305297278628,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.3959710674853153,
      "val_pk_metric": 0.2953920744828818
    },
    {
      "epoch": 14,
      "train_loss": 0.4438729524612427,
      "train_chorus_rate": 0.3221346251666546,
      "train_max_prob": 0.7296223312616348,
      "train_conf_over_90": 0.031680499529466034,
      "train_conf_over_95": 0.00024649882107041776,
      "val_loss": 0.48826613277196884,
      "val_macro_f1": 0.758887421352103,
      "val_verse_f1": 0.8472322070452912,
      "val_chorus_f1": 0.6705426356589147,
      "val_chorus_rate": 0.3345011919736862,
      "val_max_prob": 0.7202464640140533,
      "val_conf_over_90": 0.017150140833109617,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.875415923173252e-06,
      "epoch_time": 148.32569909095764,
      "val_boundary_f1": 0.39019607843137255,
      "val_boundary_precision": 0.3338926174496644,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2603962544577603,
      "val_avg_segment_overlap": 0.6694068717996544,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3636793106668807,
      "val_pk_metric": 0.26289548235944193
    },
    {
      "epoch": 15,
      "train_loss": 0.4517868831753731,
      "train_chorus_rate": 0.3279546007514,
      "train_max_prob": 0.7272412985563278,
      "train_conf_over_90": 0.027230207715183495,
      "train_conf_over_95": 0.0003166648675687611,
      "val_loss": 0.48573795706033707,
      "val_macro_f1": 0.7504639843120776,
      "val_verse_f1": 0.8362573099415205,
      "val_chorus_f1": 0.6646706586826348,
      "val_chorus_rate": 0.35714299976825714,
      "val_max_prob": 0.7195707559585571,
      "val_conf_over_90": 0.019315583631396294,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 147.0757691860199,
      "val_boundary_f1": 0.36100386100386106,
      "val_boundary_precision": 0.3055555555555556,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.24023390531874095,
      "val_avg_segment_overlap": 0.65884489224968,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3790750597725996,
      "val_pk_metric": 0.27903208697365434
    }
  ]
}