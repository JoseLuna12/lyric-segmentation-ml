{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1618579236987564,
      "layer_dropout": 0.23553445640916942,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.16586034010227074,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3550723,
      "lstm_params": 2990080,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000321806854161616,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.019705202719299823,
      "gradient_clip_norm": 0.4395742126050699,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06968349651643947,
        "ece_after": 0.02530496194226802,
        "improvement": 0.04437853457417145,
        "params": {
          "temperature": 0.694963239528752
        }
      },
      "platt": {
        "ece_before": 0.06968349651643947,
        "ece_after": 0.163902714219098,
        "improvement": -0.09421921770265852,
        "params": {
          "A": 0.4999997054989728,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5662844777107239,
      "train_chorus_rate": 0.5529484957456589,
      "train_max_prob": 0.5627236038446426,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5716917216777802,
      "val_macro_f1": 0.5906388746281905,
      "val_verse_f1": 0.6515604959384352,
      "val_chorus_f1": 0.5297172533179458,
      "val_chorus_rate": 0.5515518635511398,
      "val_max_prob": 0.5646868348121643,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003183016544293803,
      "epoch_time": 162.01223397254944,
      "val_boundary_f1": 0.09523809523809523,
      "val_boundary_precision": 0.15675675675675677,
      "val_boundary_recall": 0.06839622641509434,
      "val_complete_segments": 0.04613967853628511,
      "val_avg_segment_overlap": 0.2915164803183152,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.3889356970168654,
      "val_pk_metric": 0.39612356368914625
    },
    {
      "epoch": 2,
      "train_loss": 0.5390565544366837,
      "train_chorus_rate": 0.44922608491033317,
      "train_max_prob": 0.62275250852108,
      "train_conf_over_90": 0.007846484333276749,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5581300258636475,
      "val_macro_f1": 0.596605058468048,
      "val_verse_f1": 0.6525770972611602,
      "val_chorus_f1": 0.5406330196749358,
      "val_chorus_rate": 0.5628277584910393,
      "val_max_prob": 0.5933369100093842,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003079392492807863,
      "epoch_time": 207.01185703277588,
      "val_boundary_f1": 0.11310344827586208,
      "val_boundary_precision": 0.1362126245847176,
      "val_boundary_recall": 0.09669811320754718,
      "val_complete_segments": 0.05968065854067975,
      "val_avg_segment_overlap": 0.3486740338250123,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.42681119237855514,
      "val_pk_metric": 0.4071530734727806
    },
    {
      "epoch": 3,
      "train_loss": 0.5050642728805542,
      "train_chorus_rate": 0.4172756612300873,
      "train_max_prob": 0.6476657778024674,
      "train_conf_over_90": 0.004484679552842863,
      "train_conf_over_95": 3.075030690524727e-05,
      "val_loss": 0.5420535206794739,
      "val_macro_f1": 0.676582342403119,
      "val_verse_f1": 0.76657060518732,
      "val_chorus_f1": 0.5865940796189181,
      "val_chorus_rate": 0.42333022505044937,
      "val_max_prob": 0.6492375433444977,
      "val_conf_over_90": 0.000985221704468131,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002911725255451644,
      "epoch_time": 177.03186202049255,
      "val_boundary_f1": 0.24832214765100674,
      "val_boundary_precision": 0.23617021276595745,
      "val_boundary_recall": 0.2617924528301887,
      "val_complete_segments": 0.10234384702836453,
      "val_avg_segment_overlap": 0.5203204668718808,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.41666945939530897,
      "val_pk_metric": 0.361370583248948
    },
    {
      "epoch": 4,
      "train_loss": 0.4988230258226395,
      "train_chorus_rate": 0.4072701372206211,
      "train_max_prob": 0.6739402621984482,
      "train_conf_over_90": 0.007852383915451355,
      "train_conf_over_95": 3.584229270927608e-05,
      "val_loss": 0.5171279609203339,
      "val_macro_f1": 0.691788538413848,
      "val_verse_f1": 0.7597585513078472,
      "val_chorus_f1": 0.6238185255198488,
      "val_chorus_rate": 0.4808258041739464,
      "val_max_prob": 0.6645054370164871,
      "val_conf_over_90": 0.003974547260440886,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000268734269505428,
      "epoch_time": 131.8552758693695,
      "val_boundary_f1": 0.2545090180360722,
      "val_boundary_precision": 0.22125435540069685,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.13546403356848746,
      "val_avg_segment_overlap": 0.5689206396633363,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.46603376739196106,
      "val_pk_metric": 0.3769083702067636
    },
    {
      "epoch": 5,
      "train_loss": 0.47864079028367995,
      "train_chorus_rate": 0.3573161758482456,
      "train_max_prob": 0.6956865668296814,
      "train_conf_over_90": 0.013752011733595281,
      "train_conf_over_95": 0.00026200211723335085,
      "val_loss": 0.5069608315825462,
      "val_macro_f1": 0.7209117880384532,
      "val_verse_f1": 0.790889456116238,
      "val_chorus_f1": 0.6509341199606686,
      "val_chorus_rate": 0.4504227489233017,
      "val_max_prob": 0.6883956789970398,
      "val_conf_over_90": 0.024037039605900645,
      "val_conf_over_95": 0.0004975080228177831,
      "learning_rate": 0.000241605140621212,
      "epoch_time": 208.97697687149048,
      "val_boundary_f1": 0.29732225300092335,
      "val_boundary_precision": 0.24430955993930198,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.2027238228987964,
      "val_avg_segment_overlap": 0.6301759000554839,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4541598146513024,
      "val_pk_metric": 0.3342942827715904
    },
    {
      "epoch": 6,
      "train_loss": 0.4776526927947998,
      "train_chorus_rate": 0.38449264913797376,
      "train_max_prob": 0.7033396363258362,
      "train_conf_over_90": 0.028204016643576323,
      "train_conf_over_95": 0.0027029116346966474,
      "val_loss": 0.5036997422575951,
      "val_macro_f1": 0.703578652572241,
      "val_verse_f1": 0.7639257294429709,
      "val_chorus_f1": 0.6432315757015109,
      "val_chorus_rate": 0.4973103702068329,
      "val_max_prob": 0.6875197142362595,
      "val_conf_over_90": 0.028139830566942692,
      "val_conf_over_95": 0.0018501387676224113,
      "learning_rate": 0.00021097081200476035,
      "epoch_time": 108.94909691810608,
      "val_boundary_f1": 0.2798029556650246,
      "val_boundary_precision": 0.24027072758037224,
      "val_boundary_recall": 0.33490566037735847,
      "val_complete_segments": 0.16252584579731982,
      "val_avg_segment_overlap": 0.5975488199668137,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4431507635540307,
      "val_pk_metric": 0.3461344112523056
    },
    {
      "epoch": 7,
      "train_loss": 0.4844826564192772,
      "train_chorus_rate": 0.34769703820347786,
      "train_max_prob": 0.6985556870698929,
      "train_conf_over_90": 0.02136040446930565,
      "train_conf_over_95": 0.0016910634149098769,
      "val_loss": 0.5066917389631271,
      "val_macro_f1": 0.6977806276041305,
      "val_verse_f1": 0.7614604462474646,
      "val_chorus_f1": 0.6341008089607966,
      "val_chorus_rate": 0.49074702709913254,
      "val_max_prob": 0.6786767691373825,
      "val_conf_over_90": 0.019977197982370853,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00017817015081643,
      "epoch_time": 89.84693884849548,
      "val_boundary_f1": 0.2644964394710071,
      "val_boundary_precision": 0.23255813953488372,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.153868544351047,
      "val_avg_segment_overlap": 0.5806474941807562,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.4600226055611325,
      "val_pk_metric": 0.3650058065361502
    },
    {
      "epoch": 8,
      "train_loss": 0.4672229170799255,
      "train_chorus_rate": 0.3512565456330776,
      "train_max_prob": 0.7046871215105057,
      "train_conf_over_90": 0.029568348079919815,
      "train_conf_over_95": 0.003087661345489323,
      "val_loss": 0.49752965569496155,
      "val_macro_f1": 0.742509207044898,
      "val_verse_f1": 0.8156082631981637,
      "val_chorus_f1": 0.6694101508916324,
      "val_chorus_rate": 0.41759419441223145,
      "val_max_prob": 0.6908592134714127,
      "val_conf_over_90": 0.015872353804297745,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014463670334518606,
      "epoch_time": 140.88663601875305,
      "val_boundary_f1": 0.3301158301158301,
      "val_boundary_precision": 0.27941176470588236,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.20802430972102237,
      "val_avg_segment_overlap": 0.6221659934192626,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4223127515640804,
      "val_pk_metric": 0.3158173378481797
    },
    {
      "epoch": 9,
      "train_loss": 0.4580207899212837,
      "train_chorus_rate": 0.3637940868735313,
      "train_max_prob": 0.710248789191246,
      "train_conf_over_90": 0.0337998490780592,
      "train_conf_over_95": 0.003582476550946012,
      "val_loss": 0.497864730656147,
      "val_macro_f1": 0.7296660117878193,
      "val_verse_f1": 0.7972495088408644,
      "val_chorus_f1": 0.6620825147347742,
      "val_chorus_rate": 0.45129112154245377,
      "val_max_prob": 0.6998198479413986,
      "val_conf_over_90": 0.03830842161551118,
      "val_conf_over_95": 0.002578914165496826,
      "learning_rate": 0.00011183604215685569,
      "epoch_time": 194.35151600837708,
      "val_boundary_f1": 0.3404669260700389,
      "val_boundary_precision": 0.2897350993377483,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.22265035259467925,
      "val_avg_segment_overlap": 0.6371272893421974,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3966531570398167,
      "val_pk_metric": 0.29664069898226403
    },
    {
      "epoch": 10,
      "train_loss": 0.44190777987241747,
      "train_chorus_rate": 0.3368093311786652,
      "train_max_prob": 0.7280347734689713,
      "train_conf_over_90": 0.042264097929000856,
      "train_conf_over_95": 0.006618625990813598,
      "val_loss": 0.5007169917225838,
      "val_macro_f1": 0.7316569924057501,
      "val_verse_f1": 0.7979519495864512,
      "val_chorus_f1": 0.665362035225049,
      "val_chorus_rate": 0.4541066735982895,
      "val_max_prob": 0.7133000940084457,
      "val_conf_over_90": 0.06606946233659983,
      "val_conf_over_95": 0.008336204889928922,
      "learning_rate": 8.120171354040403e-05,
      "epoch_time": 218.06522226333618,
      "val_boundary_f1": 0.3410852713178295,
      "val_boundary_precision": 0.2894736842105263,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.23709634494364082,
      "val_avg_segment_overlap": 0.6357547726935682,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.41112511884617503,
      "val_pk_metric": 0.2956352366327573
    },
    {
      "epoch": 11,
      "train_loss": 0.43994362503290174,
      "train_chorus_rate": 0.36410444527864455,
      "train_max_prob": 0.7306908369064331,
      "train_conf_over_90": 0.0628292323090136,
      "train_conf_over_95": 0.010596430249279365,
      "val_loss": 0.4997248500585556,
      "val_macro_f1": 0.7390658751199861,
      "val_verse_f1": 0.8135269392434086,
      "val_chorus_f1": 0.6646048109965635,
      "val_chorus_rate": 0.4160882756114006,
      "val_max_prob": 0.7154016941785812,
      "val_conf_over_90": 0.06398740038275719,
      "val_conf_over_95": 0.009210952848661691,
      "learning_rate": 5.407258465618809e-05,
      "epoch_time": 133.7453260421753,
      "val_boundary_f1": 0.3391136801541426,
      "val_boundary_precision": 0.28664495114006516,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.21385749292695208,
      "val_avg_segment_overlap": 0.6357043552341349,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.39465563775524426,
      "val_pk_metric": 0.2924976482080896
    },
    {
      "epoch": 12,
      "train_loss": 0.4352943316102028,
      "train_chorus_rate": 0.33210462629795073,
      "train_max_prob": 0.7301731467247009,
      "train_conf_over_90": 0.050686107389628886,
      "train_conf_over_95": 0.007695695938309655,
      "val_loss": 0.4936758726835251,
      "val_macro_f1": 0.7359597868110872,
      "val_verse_f1": 0.8043690267212794,
      "val_chorus_f1": 0.667550546900895,
      "val_chorus_rate": 0.4419732838869095,
      "val_max_prob": 0.7146966606378555,
      "val_conf_over_90": 0.07047007698565722,
      "val_conf_over_95": 0.009201449749525636,
      "learning_rate": 3.163432861645167e-05,
      "epoch_time": 95.5896258354187,
      "val_boundary_f1": 0.3166986564299424,
      "val_boundary_precision": 0.2669902912621359,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.2089491968866306,
      "val_avg_segment_overlap": 0.6252826672840102,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.40891258126372665,
      "val_pk_metric": 0.30349441701906227
    },
    {
      "epoch": 13,
      "train_loss": 0.43577023446559904,
      "train_chorus_rate": 0.3551829755306244,
      "train_max_prob": 0.7310772269964219,
      "train_conf_over_90": 0.06571411304175853,
      "train_conf_over_95": 0.013434193574357777,
      "val_loss": 0.49659962952136993,
      "val_macro_f1": 0.7454699922517181,
      "val_verse_f1": 0.8189786585365854,
      "val_chorus_f1": 0.6719613259668509,
      "val_chorus_rate": 0.41267279535532,
      "val_max_prob": 0.7180021405220032,
      "val_conf_over_90": 0.06174860429018736,
      "val_conf_over_95": 0.007823348802048713,
      "learning_rate": 1.4867604880829681e-05,
      "epoch_time": 87.91822290420532,
      "val_boundary_f1": 0.3494208494208494,
      "val_boundary_precision": 0.2957516339869281,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.24116138559404732,
      "val_avg_segment_overlap": 0.6434466114050463,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.38669555332004807,
      "val_pk_metric": 0.288942729759462
    },
    {
      "epoch": 14,
      "train_loss": 0.4296096608042717,
      "train_chorus_rate": 0.32742787152528763,
      "train_max_prob": 0.7283566683530808,
      "train_conf_over_90": 0.04800418466329574,
      "train_conf_over_95": 0.009209532334352843,
      "val_loss": 0.49424001574516296,
      "val_macro_f1": 0.7591455638846412,
      "val_verse_f1": 0.8393515106853352,
      "val_chorus_f1": 0.678939617083947,
      "val_chorus_rate": 0.368530310690403,
      "val_max_prob": 0.7175882756710052,
      "val_conf_over_90": 0.04912539245560765,
      "val_conf_over_95": 0.006733844988048077,
      "learning_rate": 4.505199732235702e-06,
      "epoch_time": 177.8094129562378,
      "val_boundary_f1": 0.3468208092485549,
      "val_boundary_precision": 0.2931596091205212,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.22391799085860592,
      "val_avg_segment_overlap": 0.6437229089790284,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.37961249002884057,
      "val_pk_metric": 0.26818856721200685
    },
    {
      "epoch": 15,
      "train_loss": 0.43200387209653857,
      "train_chorus_rate": 0.33535265922546387,
      "train_max_prob": 0.7349918693304062,
      "train_conf_over_90": 0.05888677537441254,
      "train_conf_over_95": 0.011161919799633324,
      "val_loss": 0.49381123483181,
      "val_macro_f1": 0.7494138675533936,
      "val_verse_f1": 0.8260297160052661,
      "val_chorus_f1": 0.672798019101521,
      "val_chorus_rate": 0.3955557569861412,
      "val_max_prob": 0.7187843471765518,
      "val_conf_over_90": 0.0651281913742423,
      "val_conf_over_95": 0.009693422471173108,
      "learning_rate": 1e-06,
      "epoch_time": 130.72618293762207,
      "val_boundary_f1": 0.32790028763183127,
      "val_boundary_precision": 0.2762520193861066,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.219318155452832,
      "val_avg_segment_overlap": 0.6343912180522499,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.3879329103990402,
      "val_pk_metric": 0.27870009277944513
    }
  ]
}