{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.23448611782670412,
      "layer_dropout": 0.25755195308240275,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.15390526599912827,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000866023698521443,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.014865406545162288,
      "gradient_clip_norm": 0.3541741335212575,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12538286127252526,
        "ece_after": 0.02057594115057254,
        "improvement": 0.10480692012195272,
        "params": {
          "temperature": 0.48194994402321795
        }
      },
      "platt": {
        "ece_before": 0.12538286127252526,
        "ece_after": 0.029166007059496353,
        "improvement": 0.09621685421302892,
        "params": {
          "A": 1.9245800503748198,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6096656829118728,
      "train_chorus_rate": 0.5828799054026603,
      "train_max_prob": 0.5943206042051316,
      "train_conf_over_90": 0.009870848804712295,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5895456224679947,
      "val_macro_f1": 0.4362560189952759,
      "val_verse_f1": 0.369110677446334,
      "val_chorus_f1": 0.5034013605442177,
      "val_chorus_rate": 0.8192498981952667,
      "val_max_prob": 0.5436070412397385,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008565722769040377,
      "epoch_time": 110.32525300979614,
      "val_boundary_f1": 0.043715846994535526,
      "val_boundary_precision": 0.096,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.017917893275793594,
      "val_avg_segment_overlap": 0.19653412265634962,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43750726317125366,
      "val_pk_metric": 0.4429668462366625
    },
    {
      "epoch": 2,
      "train_loss": 0.5657454669475556,
      "train_chorus_rate": 0.533445615042001,
      "train_max_prob": 0.5607053607702255,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.602284386754036,
      "val_macro_f1": 0.5677113605559608,
      "val_verse_f1": 0.7894822269112156,
      "val_chorus_f1": 0.345940494200706,
      "val_chorus_rate": 0.18791943415999413,
      "val_max_prob": 0.5773001909255981,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008286310845294549,
      "epoch_time": 90.00661778450012,
      "val_boundary_f1": 0.08363636363636363,
      "val_boundary_precision": 0.18253968253968253,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.03821163801280451,
      "val_avg_segment_overlap": 0.23607004193987302,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3559295851931925,
      "val_pk_metric": 0.3552070581625291
    },
    {
      "epoch": 3,
      "train_loss": 0.568970188498497,
      "train_chorus_rate": 0.503319692259538,
      "train_max_prob": 0.5836171090602875,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5837452411651611,
      "val_macro_f1": 0.4587490263808459,
      "val_verse_f1": 0.43056994818652844,
      "val_chorus_f1": 0.48692810457516345,
      "val_chorus_rate": 0.7526833862066269,
      "val_max_prob": 0.5890878140926361,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007834212855811807,
      "epoch_time": 54.03081393241882,
      "val_boundary_f1": 0.05714285714285715,
      "val_boundary_precision": 0.11764705882352941,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.029372597108546207,
      "val_avg_segment_overlap": 0.20597706196553647,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.41611972292462746,
      "val_pk_metric": 0.41407592251157743
    },
    {
      "epoch": 4,
      "train_loss": 0.5551251828670501,
      "train_chorus_rate": 0.4435166895389557,
      "train_max_prob": 0.592759421467781,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5567735135555267,
      "val_macro_f1": 0.6347336803620697,
      "val_verse_f1": 0.7130434782608696,
      "val_chorus_f1": 0.5564238824632698,
      "val_chorus_rate": 0.4875340387225151,
      "val_max_prob": 0.5994517952203751,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007229187652139391,
      "epoch_time": 68.67501711845398,
      "val_boundary_f1": 0.18872549019607843,
      "val_boundary_precision": 0.19642857142857142,
      "val_boundary_recall": 0.18160377358490565,
      "val_complete_segments": 0.06734142110600223,
      "val_avg_segment_overlap": 0.41812294063191,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.16161616161616163,
      "val_window_diff": 0.43527302038139887,
      "val_pk_metric": 0.3694720382906928
    },
    {
      "epoch": 5,
      "train_loss": 0.5182655811309814,
      "train_chorus_rate": 0.4205621354281902,
      "train_max_prob": 0.6598276019096374,
      "train_conf_over_90": 0.006787224099389278,
      "train_conf_over_95": 3.48918343661353e-05,
      "val_loss": 0.5238068550825119,
      "val_macro_f1": 0.7093232040600461,
      "val_verse_f1": 0.7884169884169884,
      "val_chorus_f1": 0.6302294197031039,
      "val_chorus_rate": 0.4288756400346756,
      "val_max_prob": 0.6456984579563141,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006497677738910822,
      "epoch_time": 66.57590508460999,
      "val_boundary_f1": 0.2859866539561487,
      "val_boundary_precision": 0.24,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.14390798350236314,
      "val_avg_segment_overlap": 0.5984895922127487,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.4385409838683604,
      "val_pk_metric": 0.32472001258726835
    },
    {
      "epoch": 6,
      "train_loss": 0.5077594012022019,
      "train_chorus_rate": 0.35937915816903115,
      "train_max_prob": 0.6745657414197922,
      "train_conf_over_90": 0.011913264394388534,
      "train_conf_over_95": 0.000301709899213165,
      "val_loss": 0.518516406416893,
      "val_macro_f1": 0.7445085674854934,
      "val_verse_f1": 0.8386865243136551,
      "val_chorus_f1": 0.6503306106573318,
      "val_chorus_rate": 0.3325301557779312,
      "val_max_prob": 0.6844398230314255,
      "val_conf_over_90": 0.005951014987658709,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005671653609508199,
      "epoch_time": 55.1463840007782,
      "val_boundary_f1": 0.33090530697190434,
      "val_boundary_precision": 0.29608938547486036,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.18607914648476687,
      "val_avg_segment_overlap": 0.6127186349644892,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.35041023858417036,
      "val_pk_metric": 0.27120001935501115
    },
    {
      "epoch": 7,
      "train_loss": 0.499015074968338,
      "train_chorus_rate": 0.39683532118797304,
      "train_max_prob": 0.6707559525966644,
      "train_conf_over_90": 0.008027016933192499,
      "train_conf_over_95": 5.7670124806463716e-05,
      "val_loss": 0.5077528581023216,
      "val_macro_f1": 0.7319932595394696,
      "val_verse_f1": 0.8156466404641588,
      "val_chorus_f1": 0.6483398786147804,
      "val_chorus_rate": 0.3891229033470154,
      "val_max_prob": 0.6746983379125595,
      "val_conf_over_90": 0.0025936423917301,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004787216482089957,
      "epoch_time": 143.5245041847229,
      "val_boundary_f1": 0.33270676691729323,
      "val_boundary_precision": 0.2765625,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.1926109850950784,
      "val_avg_segment_overlap": 0.635447391075886,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4064026844245151,
      "val_pk_metric": 0.2982106465695376
    },
    {
      "epoch": 8,
      "train_loss": 0.48156929910182955,
      "train_chorus_rate": 0.3596536137163639,
      "train_max_prob": 0.6976060450077057,
      "train_conf_over_90": 0.01562879962148145,
      "train_conf_over_95": 5.881499673705548e-05,
      "val_loss": 0.5003758892416954,
      "val_macro_f1": 0.7507883546989307,
      "val_verse_f1": 0.8392242160594525,
      "val_chorus_f1": 0.6623524933384087,
      "val_chorus_rate": 0.34629326313734055,
      "val_max_prob": 0.7036605328321457,
      "val_conf_over_90": 0.008848675177432597,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003883020503124474,
      "epoch_time": 90.43836212158203,
      "val_boundary_f1": 0.34567901234567905,
      "val_boundary_precision": 0.30656934306569344,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.20938006253488756,
      "val_avg_segment_overlap": 0.6259602255282661,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.33129754398314515,
      "val_pk_metric": 0.25268338365943244
    },
    {
      "epoch": 9,
      "train_loss": 0.4718218415975571,
      "train_chorus_rate": 0.3287860378623009,
      "train_max_prob": 0.6969908714294434,
      "train_conf_over_90": 0.013283173207310029,
      "train_conf_over_95": 0.00013812155229970814,
      "val_loss": 0.502056397497654,
      "val_macro_f1": 0.7308550917570894,
      "val_verse_f1": 0.8129469326307865,
      "val_chorus_f1": 0.6487632508833923,
      "val_chorus_rate": 0.39599671959877014,
      "val_max_prob": 0.6906194090843201,
      "val_conf_over_90": 0.02319999597966671,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002998583375706231,
      "epoch_time": 191.0869312286377,
      "val_boundary_f1": 0.31460674157303375,
      "val_boundary_precision": 0.2608695652173913,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.1871503225691985,
      "val_avg_segment_overlap": 0.6318939993561261,
      "val_verse_to_chorus_acc": 0.29646017699115046,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4186567920975982,
      "val_pk_metric": 0.2950274109587358
    },
    {
      "epoch": 10,
      "train_loss": 0.46913855969905854,
      "train_chorus_rate": 0.337260876595974,
      "train_max_prob": 0.7089722514152527,
      "train_conf_over_90": 0.02384181324741803,
      "train_conf_over_95": 0.000373234468861483,
      "val_loss": 0.5001305639743805,
      "val_macro_f1": 0.7274542751158741,
      "val_verse_f1": 0.8087762436164176,
      "val_chorus_f1": 0.6461323066153307,
      "val_chorus_rate": 0.4025283306837082,
      "val_max_prob": 0.6945408880710602,
      "val_conf_over_90": 0.027879087952896953,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021725592463036085,
      "epoch_time": 142.79087495803833,
      "val_boundary_f1": 0.32112676056338035,
      "val_boundary_precision": 0.2667706708268331,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.20702809497878427,
      "val_avg_segment_overlap": 0.6338897477318,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.41241814130593735,
      "val_pk_metric": 0.29464228082871
    },
    {
      "epoch": 11,
      "train_loss": 0.46936028748750686,
      "train_chorus_rate": 0.3503520913422108,
      "train_max_prob": 0.7045752793550492,
      "train_conf_over_90": 0.019622228672960772,
      "train_conf_over_95": 9.432765073142945e-05,
      "val_loss": 0.5046427547931671,
      "val_macro_f1": 0.764183891660727,
      "val_verse_f1": 0.8586956521739131,
      "val_chorus_f1": 0.6696721311475409,
      "val_chorus_rate": 0.3002927154302597,
      "val_max_prob": 0.6767423450946808,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014410493330750397,
      "epoch_time": 151.02903509140015,
      "val_boundary_f1": 0.39794871794871794,
      "val_boundary_precision": 0.35208711433756806,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2548310827870743,
      "val_avg_segment_overlap": 0.6416783858589833,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3154543567104051,
      "val_pk_metric": 0.23788578406520214
    },
    {
      "epoch": 12,
      "train_loss": 0.4692711219191551,
      "train_chorus_rate": 0.33776653856039046,
      "train_max_prob": 0.7016601771116256,
      "train_conf_over_90": 0.007485654769698158,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4947764575481415,
      "val_macro_f1": 0.7527610641582609,
      "val_verse_f1": 0.8332715820674323,
      "val_chorus_f1": 0.6722505462490895,
      "val_chorus_rate": 0.37548790127038956,
      "val_max_prob": 0.71713687479496,
      "val_conf_over_90": 0.02968662464991212,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.360241294026228e-05,
      "epoch_time": 132.07494497299194,
      "val_boundary_f1": 0.35921421889616467,
      "val_boundary_precision": 0.29767441860465116,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2546191472490518,
      "val_avg_segment_overlap": 0.6659828825255785,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4002693083854436,
      "val_pk_metric": 0.2714394250151537
    },
    {
      "epoch": 13,
      "train_loss": 0.463200344145298,
      "train_chorus_rate": 0.33049224987626075,
      "train_max_prob": 0.7099975854158401,
      "train_conf_over_90": 0.01702450062148273,
      "train_conf_over_95": 6.939625018276274e-05,
      "val_loss": 0.4931054264307022,
      "val_macro_f1": 0.7426483890872193,
      "val_verse_f1": 0.8229127667540247,
      "val_chorus_f1": 0.6623840114204139,
      "val_chorus_rate": 0.3892332538962364,
      "val_max_prob": 0.7146997153759003,
      "val_conf_over_90": 0.024067717138677835,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.839261399198802e-05,
      "epoch_time": 144.5365068912506,
      "val_boundary_f1": 0.3694627709707823,
      "val_boundary_precision": 0.3076923076923077,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2464737631890336,
      "val_avg_segment_overlap": 0.6481504096551717,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.39994597441714874,
      "val_pk_metric": 0.2756742847455733
    },
    {
      "epoch": 14,
      "train_loss": 0.45575425773859024,
      "train_chorus_rate": 0.3399985797703266,
      "train_max_prob": 0.7225376754999161,
      "train_conf_over_90": 0.02203364532906562,
      "train_conf_over_95": 3.0413625063374637e-05,
      "val_loss": 0.49392136186361313,
      "val_macro_f1": 0.7631299879055715,
      "val_verse_f1": 0.8502692998204668,
      "val_chorus_f1": 0.6759906759906761,
      "val_chorus_rate": 0.33337341994047165,
      "val_max_prob": 0.6987971812486649,
      "val_conf_over_90": 0.008276614709757268,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0451421617405334e-05,
      "epoch_time": 155.27626991271973,
      "val_boundary_f1": 0.38212927756653986,
      "val_boundary_precision": 0.3200636942675159,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2644831830012106,
      "val_avg_segment_overlap": 0.6692629926734829,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3733360089074606,
      "val_pk_metric": 0.2588640371383564
    },
    {
      "epoch": 15,
      "train_loss": 0.45891982316970825,
      "train_chorus_rate": 0.34002757966518404,
      "train_max_prob": 0.7131810426712036,
      "train_conf_over_90": 0.013998564635403454,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4925091043114662,
      "val_macro_f1": 0.7611362329530413,
      "val_verse_f1": 0.8459586806814063,
      "val_chorus_f1": 0.6763137852246763,
      "val_chorus_rate": 0.34614695608615875,
      "val_max_prob": 0.7046413719654083,
      "val_conf_over_90": 0.013286048779264092,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 156.09955286979675,
      "val_boundary_f1": 0.36812144212523723,
      "val_boundary_precision": 0.30793650793650795,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2549365984678816,
      "val_avg_segment_overlap": 0.6671925472059899,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.37950363504624135,
      "val_pk_metric": 0.2635154252401278
    }
  ]
}