{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.20485090348167476,
      "layer_dropout": 0.2174324298954972,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.11816338984676697,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009834919452832741,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "line_f1",
      "weight_decay": 0.01771096959923938,
      "gradient_clip_norm": 0.47777295457070745,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09747578677939057,
        "ece_after": 0.019749784165140668,
        "improvement": 0.0777260026142499,
        "params": {
          "temperature": 0.5846591055717393
        }
      },
      "platt": {
        "ece_before": 0.09747578677939057,
        "ece_after": 0.030539944767951976,
        "improvement": 0.0669358420114386,
        "params": {
          "A": 1.587322555015611,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6074822217226028,
      "train_chorus_rate": 0.5709330007433892,
      "train_max_prob": 0.6073429137468338,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6401448249816895,
      "val_macro_f1": 0.5352270906392278,
      "val_verse_f1": 0.7343991748323878,
      "val_chorus_f1": 0.33605500644606784,
      "val_chorus_rate": 0.2720705196261406,
      "val_max_prob": 0.5939347445964813,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009727570421511992,
      "epoch_time": 37.9139130115509,
      "val_boundary_f1": 0.062271062271062265,
      "val_boundary_precision": 0.13934426229508196,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.05433881844274209,
      "val_avg_segment_overlap": 0.21771880608743155,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3388693658524283,
      "val_pk_metric": 0.3407214322433985
    },
    {
      "epoch": 2,
      "train_loss": 0.582557988166809,
      "train_chorus_rate": 0.5567267820239067,
      "train_max_prob": 0.5645718961954117,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.594304233789444,
      "val_macro_f1": 0.4353353638814508,
      "val_verse_f1": 0.38777152051488334,
      "val_chorus_f1": 0.4828992072480182,
      "val_chorus_rate": 0.7846657782793045,
      "val_max_prob": 0.5768623352050781,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000941021499533626,
      "epoch_time": 29.91836190223694,
      "val_boundary_f1": 0.05807622504537205,
      "val_boundary_precision": 0.12598425196850394,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.018016414384388935,
      "val_avg_segment_overlap": 0.19544337317497934,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4292508035918928,
      "val_pk_metric": 0.4305624613943515
    },
    {
      "epoch": 3,
      "train_loss": 0.5545428439974784,
      "train_chorus_rate": 0.5528721630573272,
      "train_max_prob": 0.5896214962005615,
      "train_conf_over_90": 9.908538195304572e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6204274594783783,
      "val_macro_f1": 0.6070989287905685,
      "val_verse_f1": 0.794479547721982,
      "val_chorus_f1": 0.41971830985915487,
      "val_chorus_rate": 0.2232062853872776,
      "val_max_prob": 0.6039451509714127,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008896723129269721,
      "epoch_time": 37.42176604270935,
      "val_boundary_f1": 0.17307692307692307,
      "val_boundary_precision": 0.27,
      "val_boundary_recall": 0.12735849056603774,
      "val_complete_segments": 0.09528221222282729,
      "val_avg_segment_overlap": 0.30454602790433305,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.2870416730610398,
      "val_pk_metric": 0.2748472596473263
    },
    {
      "epoch": 4,
      "train_loss": 0.5633605420589447,
      "train_chorus_rate": 0.5436290826648473,
      "train_max_prob": 0.5972693920135498,
      "train_conf_over_90": 8.138904231600464e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6081061214208603,
      "val_macro_f1": 0.6275760252147409,
      "val_verse_f1": 0.8419576059850372,
      "val_chorus_f1": 0.4131944444444445,
      "val_chorus_rate": 0.12510356679558754,
      "val_max_prob": 0.6327250897884369,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008209536881866829,
      "epoch_time": 32.08478307723999,
      "val_boundary_f1": 0.2535211267605634,
      "val_boundary_precision": 0.3146853146853147,
      "val_boundary_recall": 0.21226415094339623,
      "val_complete_segments": 0.1183775049098485,
      "val_avg_segment_overlap": 0.40872248483986084,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.2884370596495166,
      "val_pk_metric": 0.26468798911101565
    },
    {
      "epoch": 5,
      "train_loss": 0.5318564504384995,
      "train_chorus_rate": 0.44530314654111863,
      "train_max_prob": 0.6501490890979766,
      "train_conf_over_90": 0.01102475833031349,
      "train_conf_over_95": 0.0005615569680230692,
      "val_loss": 0.5450822487473488,
      "val_macro_f1": 0.7366422021401604,
      "val_verse_f1": 0.832943715159144,
      "val_chorus_f1": 0.6403406891211769,
      "val_chorus_rate": 0.33567188680171967,
      "val_max_prob": 0.6478084921836853,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007378689589624558,
      "epoch_time": 39.43911123275757,
      "val_boundary_f1": 0.35936030103480715,
      "val_boundary_precision": 0.29890453834115804,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.21206978262916756,
      "val_avg_segment_overlap": 0.6375691273779879,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4008431531640101,
      "val_pk_metric": 0.28918837779495477
    },
    {
      "epoch": 6,
      "train_loss": 0.5090027436614036,
      "train_chorus_rate": 0.428463114798069,
      "train_max_prob": 0.6658364593982696,
      "train_conf_over_90": 0.012288144408375955,
      "train_conf_over_95": 0.0007016640884103253,
      "val_loss": 0.5255571901798248,
      "val_macro_f1": 0.742279905588936,
      "val_verse_f1": 0.834178131788559,
      "val_chorus_f1": 0.6503816793893129,
      "val_chorus_rate": 0.3445786386728287,
      "val_max_prob": 0.6979462802410126,
      "val_conf_over_90": 0.017864206107333302,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0006440493266061536,
      "epoch_time": 33.333728075027466,
      "val_boundary_f1": 0.35921421889616467,
      "val_boundary_precision": 0.29767441860465116,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24362717701795114,
      "val_avg_segment_overlap": 0.6443664633774528,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.40162375189315147,
      "val_pk_metric": 0.28383098295240233
    },
    {
      "epoch": 7,
      "train_loss": 0.5068209961056709,
      "train_chorus_rate": 0.3950233444571495,
      "train_max_prob": 0.675648307800293,
      "train_conf_over_90": 0.02512484121543821,
      "train_conf_over_95": 0.004356667905813083,
      "val_loss": 0.5299875661730766,
      "val_macro_f1": 0.7489604102410594,
      "val_verse_f1": 0.8474157699770684,
      "val_chorus_f1": 0.6505050505050506,
      "val_chorus_rate": 0.3087081089615822,
      "val_max_prob": 0.6513217836618423,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005435951592482913,
      "epoch_time": 28.954145669937134,
      "val_boundary_f1": 0.3985102420856611,
      "val_boundary_precision": 0.3292307692307692,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.2773952486041563,
      "val_avg_segment_overlap": 0.6570697442904034,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.3890635564543358,
      "val_pk_metric": 0.2708930200898721
    },
    {
      "epoch": 8,
      "train_loss": 0.5033896550536155,
      "train_chorus_rate": 0.3669703796505928,
      "train_max_prob": 0.6708721607923508,
      "train_conf_over_90": 0.019054683338617907,
      "train_conf_over_95": 0.0015365275263320654,
      "val_loss": 0.5258737877011299,
      "val_macro_f1": 0.712726278543817,
      "val_verse_f1": 0.7978783860579656,
      "val_chorus_f1": 0.6275741710296684,
      "val_chorus_rate": 0.40455877780914307,
      "val_max_prob": 0.6625771224498749,
      "val_conf_over_90": 0.0045676883310079575,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004408967860349832,
      "epoch_time": 30.187339067459106,
      "val_boundary_f1": 0.3266856600189934,
      "val_boundary_precision": 0.27344992050874406,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.1905960365000662,
      "val_avg_segment_overlap": 0.6180681006707052,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4303807739833217,
      "val_pk_metric": 0.3197176727639005
    },
    {
      "epoch": 9,
      "train_loss": 0.5017880544066429,
      "train_chorus_rate": 0.3940733462572098,
      "train_max_prob": 0.680605810880661,
      "train_conf_over_90": 0.024572191981133074,
      "train_conf_over_95": 0.0007691871927818283,
      "val_loss": 0.5182994604110718,
      "val_macro_f1": 0.7357843651515088,
      "val_verse_f1": 0.8213689482470786,
      "val_chorus_f1": 0.650199782055939,
      "val_chorus_rate": 0.3769885301589966,
      "val_max_prob": 0.6636410504579544,
      "val_conf_over_90": 0.004717394418548793,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003404426186771209,
      "epoch_time": 35.83400297164917,
      "val_boundary_f1": 0.33079847908745247,
      "val_boundary_precision": 0.2770700636942675,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.194058946842616,
      "val_avg_segment_overlap": 0.6365654876894884,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.42148510583425525,
      "val_pk_metric": 0.2996634192894989
    },
    {
      "epoch": 10,
      "train_loss": 0.48395406305789945,
      "train_chorus_rate": 0.33899434506893156,
      "train_max_prob": 0.6861222952604293,
      "train_conf_over_90": 0.0243314232560806,
      "train_conf_over_95": 0.0014061669673537836,
      "val_loss": 0.518198661506176,
      "val_macro_f1": 0.7585112950429852,
      "val_verse_f1": 0.8538732394366197,
      "val_chorus_f1": 0.6631493506493507,
      "val_chorus_rate": 0.3056412860751152,
      "val_max_prob": 0.6962347328662872,
      "val_conf_over_90": 0.007888614141847938,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024662298632081875,
      "epoch_time": 42.83555197715759,
      "val_boundary_f1": 0.42156862745098034,
      "val_boundary_precision": 0.36073825503355705,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.30071264454880575,
      "val_avg_segment_overlap": 0.6658643181318507,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3401692551856749,
      "val_pk_metric": 0.24672130065027192
    },
    {
      "epoch": 11,
      "train_loss": 0.47602880746126175,
      "train_chorus_rate": 0.34272516518831253,
      "train_max_prob": 0.6959728091955185,
      "train_conf_over_90": 0.021293896494898944,
      "train_conf_over_95": 0.0001899646216770634,
      "val_loss": 0.5074690729379654,
      "val_macro_f1": 0.7564041208030025,
      "val_verse_f1": 0.8403944485025566,
      "val_chorus_f1": 0.6724137931034483,
      "val_chorus_rate": 0.35611139982938766,
      "val_max_prob": 0.7041681408882141,
      "val_conf_over_90": 0.038956594187766314,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016353825709659157,
      "epoch_time": 47.54922914505005,
      "val_boundary_f1": 0.39151398264223725,
      "val_boundary_precision": 0.33115823817292006,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2603043184830035,
      "val_avg_segment_overlap": 0.6642143044897744,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3694120429524641,
      "val_pk_metric": 0.26983141314066733
    },
    {
      "epoch": 12,
      "train_loss": 0.48323560655117037,
      "train_chorus_rate": 0.35913307815790174,
      "train_max_prob": 0.7003728598356247,
      "train_conf_over_90": 0.035367951611988246,
      "train_conf_over_95": 0.001158173763542436,
      "val_loss": 0.5114150494337082,
      "val_macro_f1": 0.7297876293426186,
      "val_verse_f1": 0.807626310772164,
      "val_chorus_f1": 0.6519489479130735,
      "val_chorus_rate": 0.41262322664260864,
      "val_max_prob": 0.705076277256012,
      "val_conf_over_90": 0.05990962265059352,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 9.481963235630225e-05,
      "epoch_time": 36.5845890045166,
      "val_boundary_f1": 0.33725490196078434,
      "val_boundary_precision": 0.28859060402684567,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.20272482943479764,
      "val_avg_segment_overlap": 0.6186998983854715,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4018103263509971,
      "val_pk_metric": 0.29772356475465434
    },
    {
      "epoch": 13,
      "train_loss": 0.48272617161273956,
      "train_chorus_rate": 0.3603156849741936,
      "train_max_prob": 0.6951060652732849,
      "train_conf_over_90": 0.021072010055650025,
      "train_conf_over_95": 0.0002245685114758089,
      "val_loss": 0.507250152528286,
      "val_macro_f1": 0.7525581444502862,
      "val_verse_f1": 0.8345323741007193,
      "val_chorus_f1": 0.6705839147998531,
      "val_chorus_rate": 0.369423545897007,
      "val_max_prob": 0.6881179362535477,
      "val_conf_over_90": 0.015754197374917567,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.34704457496481e-05,
      "epoch_time": 42.39521098136902,
      "val_boundary_f1": 0.3679694947569113,
      "val_boundary_precision": 0.3088,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.25081108035773997,
      "val_avg_segment_overlap": 0.6547953294605047,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3761496149857907,
      "val_pk_metric": 0.26551751671287827
    },
    {
      "epoch": 14,
      "train_loss": 0.4811063170433044,
      "train_chorus_rate": 0.36841085851192473,
      "train_max_prob": 0.6960616201162338,
      "train_conf_over_90": 0.031130169704556464,
      "train_conf_over_95": 0.0003295440837973729,
      "val_loss": 0.5071882680058479,
      "val_macro_f1": 0.7595161767699837,
      "val_verse_f1": 0.8423744292237442,
      "val_chorus_f1": 0.6766579243162233,
      "val_chorus_rate": 0.3562282472848892,
      "val_max_prob": 0.7010793089866638,
      "val_conf_over_90": 0.028682322474196553,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1734903132075023e-05,
      "epoch_time": 42.051530838012695,
      "val_boundary_f1": 0.3934740882917467,
      "val_boundary_precision": 0.33171521035598706,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.2720555921775434,
      "val_avg_segment_overlap": 0.6650478592260072,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.36013272223489456,
      "val_pk_metric": 0.2556987138299827
    },
    {
      "epoch": 15,
      "train_loss": 0.4791266143321991,
      "train_chorus_rate": 0.35245211571455004,
      "train_max_prob": 0.6975975304841995,
      "train_conf_over_90": 0.028545325575396418,
      "train_conf_over_95": 0.00046523905475623903,
      "val_loss": 0.5066844075918198,
      "val_macro_f1": 0.7636181847988335,
      "val_verse_f1": 0.8476173219786192,
      "val_chorus_f1": 0.6796190476190477,
      "val_chorus_rate": 0.34540849179029465,
      "val_max_prob": 0.6961818337440491,
      "val_conf_over_90": 0.021069742855615914,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 48.99156212806702,
      "val_boundary_f1": 0.4073359073359073,
      "val_boundary_precision": 0.34477124183006536,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.2895246386365156,
      "val_avg_segment_overlap": 0.6700401580728279,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.3503037694698285,
      "val_pk_metric": 0.2496067359885268
    }
  ]
}