{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.3437473263092687,
      "layer_dropout": 0.21943386388816866,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1982105741756588,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009939340466223016,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.0074743908728287225,
      "gradient_clip_norm": 0.41868489466375153,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10567436469737111,
        "ece_after": 0.022478677332401272,
        "improvement": 0.08319568736496984,
        "params": {
          "temperature": 0.5337267526161302
        }
      },
      "platt": {
        "ece_before": 0.10567436469737111,
        "ece_after": 0.027014624305464686,
        "improvement": 0.07865974039190643,
        "params": {
          "A": 1.6554291924137283,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6193912535905838,
      "train_chorus_rate": 0.5443377181421966,
      "train_max_prob": 0.5855358898639679,
      "train_conf_over_90": 0.02555350661277771,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6093429625034332,
      "val_macro_f1": 0.3520075017840308,
      "val_verse_f1": 0.21753951038115898,
      "val_chorus_f1": 0.4864754931869026,
      "val_chorus_rate": 0.9076151102781296,
      "val_max_prob": 0.6091989427804947,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009830850510064073,
      "epoch_time": 4917.075174808502,
      "val_boundary_f1": 0.014571948998178508,
      "val_boundary_precision": 0.032,
      "val_boundary_recall": 0.009433962264150943,
      "val_complete_segments": 0.005655708731000354,
      "val_avg_segment_overlap": 0.14621837435559354,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4117186103332927,
      "val_pk_metric": 0.4011839992511196
    },
    {
      "epoch": 2,
      "train_loss": 0.58545580804348,
      "train_chorus_rate": 0.6009658628841862,
      "train_max_prob": 0.5663262754678726,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6038307845592499,
      "val_macro_f1": 0.507121950738989,
      "val_verse_f1": 0.5775676837129351,
      "val_chorus_f1": 0.436676217765043,
      "val_chorus_rate": 0.5574062317609787,
      "val_max_prob": 0.5538049936294556,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009510122173263959,
      "epoch_time": 31877.569759845734,
      "val_boundary_f1": 0.0570409982174688,
      "val_boundary_precision": 0.11678832116788321,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.007194616977225673,
      "val_avg_segment_overlap": 0.2152210178450542,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.46271642419102277,
      "val_pk_metric": 0.4789611807999843
    },
    {
      "epoch": 3,
      "train_loss": 0.5812643766403198,
      "train_chorus_rate": 0.5619927105028182,
      "train_max_prob": 0.5696084678173066,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5973668992519379,
      "val_macro_f1": 0.3927667363821752,
      "val_verse_f1": 0.28867812685240074,
      "val_chorus_f1": 0.4968553459119497,
      "val_chorus_rate": 0.8716056644916534,
      "val_max_prob": 0.5746393501758575,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008991172823166151,
      "epoch_time": 226.81868386268616,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.02386517330843948,
      "val_avg_segment_overlap": 0.17422732423908968,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40538969334523933,
      "val_pk_metric": 0.39765317054137367
    },
    {
      "epoch": 4,
      "train_loss": 0.5764895617961884,
      "train_chorus_rate": 0.5430067710578441,
      "train_max_prob": 0.5654118955135345,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5956025123596191,
      "val_macro_f1": 0.6477937170647443,
      "val_verse_f1": 0.8147284238587138,
      "val_chorus_f1": 0.48085901027077493,
      "val_chorus_rate": 0.22727878019213676,
      "val_max_prob": 0.5650359094142914,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008296683036565186,
      "epoch_time": 473.961473941803,
      "val_boundary_f1": 0.3209302325581395,
      "val_boundary_precision": 0.3165137614678899,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.15988157336248537,
      "val_avg_segment_overlap": 0.4412304211428676,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.3766248177899761,
      "val_pk_metric": 0.3097991646309349
    },
    {
      "epoch": 5,
      "train_loss": 0.5532971948385239,
      "train_chorus_rate": 0.5030493643134832,
      "train_max_prob": 0.6029044926166535,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5565337389707565,
      "val_macro_f1": 0.6768164319552707,
      "val_verse_f1": 0.7565011820330969,
      "val_chorus_f1": 0.5971316818774446,
      "val_chorus_rate": 0.4544071778655052,
      "val_max_prob": 0.641844317317009,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007457005349667263,
      "epoch_time": 412.6292459964752,
      "val_boundary_f1": 0.3087378640776699,
      "val_boundary_precision": 0.2623762376237624,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.1450882578533692,
      "val_avg_segment_overlap": 0.5678981930368576,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.45030174200708906,
      "val_pk_metric": 0.34514055536032284
    },
    {
      "epoch": 6,
      "train_loss": 0.5322984248399735,
      "train_chorus_rate": 0.4083822049200535,
      "train_max_prob": 0.6559242606163025,
      "train_conf_over_90": 0.008337100970675238,
      "train_conf_over_95": 0.0,
      "val_loss": 0.623772531747818,
      "val_macro_f1": 0.44638477520542386,
      "val_verse_f1": 0.3865638766519824,
      "val_chorus_f1": 0.5062056737588653,
      "val_chorus_rate": 0.8087784051895142,
      "val_max_prob": 0.7249418348073959,
      "val_conf_over_90": 0.05099391005933285,
      "val_conf_over_95": 0.00047234738303814083,
      "learning_rate": 0.0006508837706610396,
      "epoch_time": 1110.1242308616638,
      "val_boundary_f1": 0.046783625730994156,
      "val_boundary_precision": 0.06153846153846154,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.01789201335860933,
      "val_avg_segment_overlap": 0.23717908665667334,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4636757710325717,
      "val_pk_metric": 0.4038494519868625
    },
    {
      "epoch": 7,
      "train_loss": 0.5361860290169715,
      "train_chorus_rate": 0.4634616933763027,
      "train_max_prob": 0.6624356776475906,
      "train_conf_over_90": 0.008116162737132981,
      "train_conf_over_95": 0.00024685234820935874,
      "val_loss": 0.5500505417585373,
      "val_macro_f1": 0.7415173145003633,
      "val_verse_f1": 0.8437170010559661,
      "val_chorus_f1": 0.6393176279447603,
      "val_chorus_rate": 0.3059162497520447,
      "val_max_prob": 0.6814973652362823,
      "val_conf_over_90": 0.005513331212569028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005493619583209318,
      "epoch_time": 6247.812462091446,
      "val_boundary_f1": 0.3775700934579439,
      "val_boundary_precision": 0.3126934984520124,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2563935507997014,
      "val_avg_segment_overlap": 0.6398341437670653,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.38486206944397805,
      "val_pk_metric": 0.2650153132906875
    },
    {
      "epoch": 8,
      "train_loss": 0.5072243839502335,
      "train_chorus_rate": 0.3788825735449791,
      "train_max_prob": 0.6724890738725662,
      "train_conf_over_90": 0.007151076698210091,
      "train_conf_over_95": 0.0,
      "val_loss": 0.526059091091156,
      "val_macro_f1": 0.7159980966177065,
      "val_verse_f1": 0.7980182926829268,
      "val_chorus_f1": 0.6339779005524863,
      "val_chorus_rate": 0.4119858518242836,
      "val_max_prob": 0.6858130842447281,
      "val_conf_over_90": 0.003065351746045053,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044557208830137005,
      "epoch_time": 659.5241949558258,
      "val_boundary_f1": 0.28377065111758987,
      "val_boundary_precision": 0.2413223140495868,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.1535451050960065,
      "val_avg_segment_overlap": 0.5919573547876166,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.42706259249486156,
      "val_pk_metric": 0.3076290030193725
    },
    {
      "epoch": 9,
      "train_loss": 0.49218703508377076,
      "train_chorus_rate": 0.34422829523682597,
      "train_max_prob": 0.6897118538618088,
      "train_conf_over_90": 0.009908755630021915,
      "train_conf_over_95": 0.00037285866565071044,
      "val_loss": 0.5244025141000748,
      "val_macro_f1": 0.7066553545787667,
      "val_verse_f1": 0.7878438161184843,
      "val_chorus_f1": 0.6254668930390491,
      "val_chorus_rate": 0.4238649532198906,
      "val_max_prob": 0.6683828085660934,
      "val_conf_over_90": 0.02186411153525114,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034405027596126213,
      "epoch_time": 1979.7029612064362,
      "val_boundary_f1": 0.3450834879406308,
      "val_boundary_precision": 0.28440366972477066,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.2051584287665942,
      "val_avg_segment_overlap": 0.6308369395616735,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4550122534522353,
      "val_pk_metric": 0.32591815311062533
    },
    {
      "epoch": 10,
      "train_loss": 0.4948118105530739,
      "train_chorus_rate": 0.35356310233473776,
      "train_max_prob": 0.6836635321378708,
      "train_conf_over_90": 0.015313996071927249,
      "train_conf_over_95": 0.00025583221286069603,
      "val_loss": 0.5245960429310799,
      "val_macro_f1": 0.7162281802969235,
      "val_verse_f1": 0.7999241418547317,
      "val_chorus_f1": 0.6325322187391152,
      "val_chorus_rate": 0.40556538105010986,
      "val_max_prob": 0.6977724879980087,
      "val_conf_over_90": 0.03155199903994799,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024923351165557556,
      "epoch_time": 1376.498944759369,
      "val_boundary_f1": 0.29899726526891524,
      "val_boundary_precision": 0.2436849925705795,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.17731574931999108,
      "val_avg_segment_overlap": 0.6185971517477437,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.43669812213450077,
      "val_pk_metric": 0.3047578287292544
    },
    {
      "epoch": 11,
      "train_loss": 0.49357433915138244,
      "train_chorus_rate": 0.37497754618525503,
      "train_max_prob": 0.6831884831190109,
      "train_conf_over_90": 0.00832587516924832,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5238255113363266,
      "val_macro_f1": 0.7473699035973447,
      "val_verse_f1": 0.8430988423864648,
      "val_chorus_f1": 0.6516409648082246,
      "val_chorus_rate": 0.3215663805603981,
      "val_max_prob": 0.6779680699110031,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016526574296578324,
      "epoch_time": 1502.2048859596252,
      "val_boundary_f1": 0.39729990356798456,
      "val_boundary_precision": 0.3360522022838499,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.25949325518519584,
      "val_avg_segment_overlap": 0.6509985577019617,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.34768959955819234,
      "val_pk_metric": 0.2490364498011592
    },
    {
      "epoch": 12,
      "train_loss": 0.4906170919537544,
      "train_chorus_rate": 0.35725825279951096,
      "train_max_prob": 0.6966499209403991,
      "train_conf_over_90": 0.007734377865563147,
      "train_conf_over_95": 0.0,
      "val_loss": 0.517110213637352,
      "val_macro_f1": 0.7458753244711482,
      "val_verse_f1": 0.83305906015725,
      "val_chorus_f1": 0.6586915887850466,
      "val_chorus_rate": 0.3576851636171341,
      "val_max_prob": 0.6942210644483566,
      "val_conf_over_90": 0.009472202160395682,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.581676430568666e-05,
      "epoch_time": 1213.9140198230743,
      "val_boundary_f1": 0.3584029712163417,
      "val_boundary_precision": 0.29555895865237364,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.24115938958197708,
      "val_avg_segment_overlap": 0.6540413219240471,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4011392841034623,
      "val_pk_metric": 0.27631042258644284
    },
    {
      "epoch": 13,
      "train_loss": 0.4844846710562706,
      "train_chorus_rate": 0.34969435855746267,
      "train_max_prob": 0.6924058705568313,
      "train_conf_over_90": 0.008636243687942625,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5150661766529083,
      "val_macro_f1": 0.7347334252263289,
      "val_verse_f1": 0.815512048192771,
      "val_chorus_f1": 0.6539548022598869,
      "val_chorus_rate": 0.3963175043463707,
      "val_max_prob": 0.712051197886467,
      "val_conf_over_90": 0.022622015327215195,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.392182929590569e-05,
      "epoch_time": 1152.0010449886322,
      "val_boundary_f1": 0.35654596100278557,
      "val_boundary_precision": 0.29402756508422667,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.23426134246653862,
      "val_avg_segment_overlap": 0.6498868138222849,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4147878096131521,
      "val_pk_metric": 0.28520641354634446
    },
    {
      "epoch": 14,
      "train_loss": 0.47610801458358765,
      "train_chorus_rate": 0.3527227520942688,
      "train_max_prob": 0.710626345872879,
      "train_conf_over_90": 0.01289561066078022,
      "train_conf_over_95": 3.878975985571742e-05,
      "val_loss": 0.5157283395528793,
      "val_macro_f1": 0.7466030180436978,
      "val_verse_f1": 0.8350928285402257,
      "val_chorus_f1": 0.6581132075471698,
      "val_chorus_rate": 0.3516114801168442,
      "val_max_prob": 0.6803205460309982,
      "val_conf_over_90": 0.0021108441869728267,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1848995615894267e-05,
      "epoch_time": 1329.3827011585236,
      "val_boundary_f1": 0.375,
      "val_boundary_precision": 0.3101851851851852,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2528440101213166,
      "val_avg_segment_overlap": 0.653862113765442,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.38399730906048873,
      "val_pk_metric": 0.26876229012865943
    },
    {
      "epoch": 15,
      "train_loss": 0.48239807337522506,
      "train_chorus_rate": 0.3614701047539711,
      "train_max_prob": 0.6937831193208694,
      "train_conf_over_90": 0.004739356663776562,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5149618908762932,
      "val_macro_f1": 0.7442918343856209,
      "val_verse_f1": 0.8308256880733945,
      "val_chorus_f1": 0.6577579806978471,
      "val_chorus_rate": 0.36244405061006546,
      "val_max_prob": 0.6867575496435165,
      "val_conf_over_90": 0.004522902541793883,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 1370.0074079036713,
      "val_boundary_f1": 0.3661971830985915,
      "val_boundary_precision": 0.3042121684867395,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.24855804334860537,
      "val_avg_segment_overlap": 0.6501703394100844,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3865863353756347,
      "val_pk_metric": 0.2748672763009954
    }
  ]
}