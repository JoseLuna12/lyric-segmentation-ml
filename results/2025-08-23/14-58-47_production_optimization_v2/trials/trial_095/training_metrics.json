{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.15930185923847273,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.18156313553304324,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007457853143047767,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "composite",
      "weight_decay": 0.01797948712859244,
      "gradient_clip_norm": 0.35021481928397497,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.15991891842986838,
        "ece_after": 0.02035412729547628,
        "improvement": 0.1395647911343921,
        "params": {
          "temperature": 0.3718145334959444
        }
      },
      "platt": {
        "ece_before": 0.15991891842986838,
        "ece_after": 0.10291181184161152,
        "improvement": 0.05700710658825686,
        "params": {
          "A": 1.499999829466501,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5704419046640397,
      "train_chorus_rate": 0.5665100052952766,
      "train_max_prob": 0.5758013784885406,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5891319066286087,
      "val_macro_f1": 0.3744216837928249,
      "val_verse_f1": 0.26058240768537977,
      "val_chorus_f1": 0.48826095990027013,
      "val_chorus_rate": 0.8823115080595016,
      "val_max_prob": 0.6125433444976807,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007376476412768836,
      "epoch_time": 65.17458820343018,
      "val_boundary_f1": 0.04347826086956522,
      "val_boundary_precision": 0.09375,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.020046938697521943,
      "val_avg_segment_overlap": 0.16389026835103698,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4109374229414467,
      "val_pk_metric": 0.40311232678429254
    },
    {
      "epoch": 2,
      "train_loss": 0.5569800943136215,
      "train_chorus_rate": 0.5591861253604293,
      "train_max_prob": 0.5737462788820267,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5777452886104584,
      "val_macro_f1": 0.44332001338222027,
      "val_verse_f1": 0.40148698884758366,
      "val_chorus_f1": 0.48515303791685693,
      "val_chorus_rate": 0.776040717959404,
      "val_max_prob": 0.5926032662391663,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000713590277553411,
      "epoch_time": 60.85650086402893,
      "val_boundary_f1": 0.08067226890756303,
      "val_boundary_precision": 0.14035087719298245,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.027243551686817857,
      "val_avg_segment_overlap": 0.2056289405092972,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4301042612104155,
      "val_pk_metric": 0.4201082299840169
    },
    {
      "epoch": 3,
      "train_loss": 0.5477787852287292,
      "train_chorus_rate": 0.5113708443939686,
      "train_max_prob": 0.5974338591098786,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5749304890632629,
      "val_macro_f1": 0.40963089823583976,
      "val_verse_f1": 0.32365622305260133,
      "val_chorus_f1": 0.49560557341907824,
      "val_chorus_rate": 0.8457791358232498,
      "val_max_prob": 0.6507695019245148,
      "val_conf_over_90": 0.0014673634141217917,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006746646453691138,
      "epoch_time": 53.234103202819824,
      "val_boundary_f1": 0.04388714733542319,
      "val_boundary_precision": 0.06542056074766354,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.005754229839595694,
      "val_avg_segment_overlap": 0.21046654657782005,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.41856572469227393,
      "val_pk_metric": 0.3896056755406228
    },
    {
      "epoch": 4,
      "train_loss": 0.5335494771599769,
      "train_chorus_rate": 0.5339563228189945,
      "train_max_prob": 0.6314286381006241,
      "train_conf_over_90": 0.0047426155622815715,
      "train_conf_over_95": 3.052503161597997e-05,
      "val_loss": 0.5474210381507874,
      "val_macro_f1": 0.7285327387438494,
      "val_verse_f1": 0.8221329437545655,
      "val_chorus_f1": 0.6349325337331334,
      "val_chorus_rate": 0.35684168338775635,
      "val_max_prob": 0.6635338962078094,
      "val_conf_over_90": 0.004140765173360705,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006225719816363523,
      "epoch_time": 53.94175696372986,
      "val_boundary_f1": 0.3821892393320965,
      "val_boundary_precision": 0.3149847094801223,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2470628938285354,
      "val_avg_segment_overlap": 0.6105834669379776,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3789720150631922,
      "val_pk_metric": 0.2727905465878651
    },
    {
      "epoch": 5,
      "train_loss": 0.5196952030062676,
      "train_chorus_rate": 0.4138307526707649,
      "train_max_prob": 0.6441145479679108,
      "train_conf_over_90": 0.007651605660794303,
      "train_conf_over_95": 0.00027669070987030865,
      "val_loss": 0.5391593873500824,
      "val_macro_f1": 0.5670269018071104,
      "val_verse_f1": 0.5696851354649743,
      "val_chorus_f1": 0.5643686681492464,
      "val_chorus_rate": 0.6939220279455185,
      "val_max_prob": 0.6245801746845245,
      "val_conf_over_90": 0.003407074313145131,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005595889857285825,
      "epoch_time": 47.00397491455078,
      "val_boundary_f1": 0.18658280922431864,
      "val_boundary_precision": 0.16792452830188678,
      "val_boundary_recall": 0.2099056603773585,
      "val_complete_segments": 0.07397836595874772,
      "val_avg_segment_overlap": 0.44845476706192267,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.4844467181679258,
      "val_pk_metric": 0.4032121270434542
    },
    {
      "epoch": 6,
      "train_loss": 0.5121950402855873,
      "train_chorus_rate": 0.3952320463955402,
      "train_max_prob": 0.6394572079181671,
      "train_conf_over_90": 0.005449800324277021,
      "train_conf_over_95": 0.00010621001711115241,
      "val_loss": 0.5581357032060623,
      "val_macro_f1": 0.7258292860813607,
      "val_verse_f1": 0.8227181999637089,
      "val_chorus_f1": 0.6289403721990124,
      "val_chorus_rate": 0.3483302816748619,
      "val_max_prob": 0.7104719281196594,
      "val_conf_over_90": 0.020013991044834256,
      "val_conf_over_95": 0.0014422027743421495,
      "learning_rate": 0.0004884683167929196,
      "epoch_time": 59.64784216880798,
      "val_boundary_f1": 0.3885350318471337,
      "val_boundary_precision": 0.3532818532818533,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.23627796293490885,
      "val_avg_segment_overlap": 0.6022267354449009,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3444399251949388,
      "val_pk_metric": 0.26284694415166665
    },
    {
      "epoch": 7,
      "train_loss": 0.5205146864056587,
      "train_chorus_rate": 0.36701443791389465,
      "train_max_prob": 0.665930762887001,
      "train_conf_over_90": 0.010035127948503942,
      "train_conf_over_95": 0.00013609076559077947,
      "val_loss": 0.5427686274051666,
      "val_macro_f1": 0.7430427011465501,
      "val_verse_f1": 0.8429985855728429,
      "val_chorus_f1": 0.6430868167202572,
      "val_chorus_rate": 0.31214895844459534,
      "val_max_prob": 0.6703982502222061,
      "val_conf_over_90": 0.004110688925720751,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041231828933668564,
      "epoch_time": 56.727712869644165,
      "val_boundary_f1": 0.40980392156862744,
      "val_boundary_precision": 0.35067114093959734,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2865533273009413,
      "val_avg_segment_overlap": 0.6405930296866844,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3451689658335495,
      "val_pk_metric": 0.25579203977228815
    },
    {
      "epoch": 8,
      "train_loss": 0.5036863967776298,
      "train_chorus_rate": 0.4077903896570206,
      "train_max_prob": 0.6475028723478318,
      "train_conf_over_90": 0.003859421462402679,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5307186022400856,
      "val_macro_f1": 0.7619050968381125,
      "val_verse_f1": 0.8544650751547304,
      "val_chorus_f1": 0.6693451185214947,
      "val_chorus_rate": 0.31245024502277374,
      "val_max_prob": 0.6380216926336288,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003344670249680911,
      "epoch_time": 65.6609537601471,
      "val_boundary_f1": 0.42165242165242167,
      "val_boundary_precision": 0.35294117647058826,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.31891978897546236,
      "val_avg_segment_overlap": 0.6611236465382042,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3390940931580979,
      "val_pk_metric": 0.24110263202748367
    },
    {
      "epoch": 9,
      "train_loss": 0.5150048390030861,
      "train_chorus_rate": 0.39732636213302613,
      "train_max_prob": 0.6482153117656708,
      "train_conf_over_90": 0.0034523450915003194,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5423164516687393,
      "val_macro_f1": 0.7510015259204741,
      "val_verse_f1": 0.8573395284804681,
      "val_chorus_f1": 0.64466352336048,
      "val_chorus_rate": 0.2742047496140003,
      "val_max_prob": 0.6299046277999878,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025831699751185705,
      "epoch_time": 49.5584032535553,
      "val_boundary_f1": 0.40674789128397376,
      "val_boundary_precision": 0.33748055987558323,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3101305118935023,
      "val_avg_segment_overlap": 0.6479182976351788,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.36671161433395694,
      "val_pk_metric": 0.2584522128274536
    },
    {
      "epoch": 10,
      "train_loss": 0.5065845355391503,
      "train_chorus_rate": 0.3804629772901535,
      "train_max_prob": 0.6551317274570465,
      "train_conf_over_90": 0.0023246297845616938,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5184841528534889,
      "val_macro_f1": 0.7372010869565216,
      "val_verse_f1": 0.8099999999999998,
      "val_chorus_f1": 0.6644021739130435,
      "val_chorus_rate": 0.42367251962423325,
      "val_max_prob": 0.6520244628190994,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001871963285761942,
      "epoch_time": 47.05133891105652,
      "val_boundary_f1": 0.3872778297474274,
      "val_boundary_precision": 0.3209302325581395,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28476162497901625,
      "val_avg_segment_overlap": 0.6643031125061581,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4012239967632337,
      "val_pk_metric": 0.29842117266717355
    },
    {
      "epoch": 11,
      "train_loss": 0.49970980882644656,
      "train_chorus_rate": 0.36421002745628356,
      "train_max_prob": 0.6550029247999192,
      "train_conf_over_90": 0.0002281194640090689,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5209679082036018,
      "val_macro_f1": 0.7387151789591739,
      "val_verse_f1": 0.8146879756468798,
      "val_chorus_f1": 0.6627423822714681,
      "val_chorus_rate": 0.4103883057832718,
      "val_max_prob": 0.6742693185806274,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001242133326684244,
      "epoch_time": 59.456350803375244,
      "val_boundary_f1": 0.3954154727793696,
      "val_boundary_precision": 0.33226324237560195,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2852552370579942,
      "val_avg_segment_overlap": 0.6599327676926432,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3979619046384139,
      "val_pk_metric": 0.2960302562681483
    },
    {
      "epoch": 12,
      "train_loss": 0.5022481739521026,
      "train_chorus_rate": 0.4213679522275925,
      "train_max_prob": 0.6646118521690368,
      "train_conf_over_90": 0.0004860718036070466,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5188635811209679,
      "val_macro_f1": 0.7432548777303205,
      "val_verse_f1": 0.8196100700359644,
      "val_chorus_f1": 0.6668996854246767,
      "val_chorus_rate": 0.40399134159088135,
      "val_max_prob": 0.659254789352417,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.212066893566286e-05,
      "epoch_time": 52.42763590812683,
      "val_boundary_f1": 0.4034749034749035,
      "val_boundary_precision": 0.3415032679738562,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.28982919254658385,
      "val_avg_segment_overlap": 0.6597153848163715,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3911441099666257,
      "val_pk_metric": 0.28448591929070366
    },
    {
      "epoch": 13,
      "train_loss": 0.49854595214128494,
      "train_chorus_rate": 0.40413986444473265,
      "train_max_prob": 0.6654616296291351,
      "train_conf_over_90": 0.0014684532798128203,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5173868387937546,
      "val_macro_f1": 0.7390250220199996,
      "val_verse_f1": 0.8095882466653781,
      "val_chorus_f1": 0.6684617973746213,
      "val_chorus_rate": 0.43052662909030914,
      "val_max_prob": 0.6719580590724945,
      "val_conf_over_90": 0.0019047374953515828,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.319503675136552e-05,
      "epoch_time": 54.901952028274536,
      "val_boundary_f1": 0.3972602739726027,
      "val_boundary_precision": 0.3394648829431438,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2925185032024905,
      "val_avg_segment_overlap": 0.6568798222499496,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3968266784407469,
      "val_pk_metric": 0.29256906924844106
    }
  ]
}