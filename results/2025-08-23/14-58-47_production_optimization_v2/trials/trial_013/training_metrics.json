{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.22268332173749755,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006085377933455069,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.011551517533142222,
      "gradient_clip_norm": 0.8137166547212907,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08780037245780874,
        "ece_after": 0.016484993892357712,
        "improvement": 0.07131537856545103,
        "params": {
          "temperature": 0.5952567078431916
        }
      },
      "platt": {
        "ece_before": 0.08780037245780874,
        "ece_after": 0.017170620719904033,
        "improvement": 0.0706297517379047,
        "params": {
          "A": 1.621765197728803,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5251828670501709,
      "train_chorus_rate": 0.4067015316337347,
      "train_max_prob": 0.5416193425655365,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5499710738658905,
      "val_macro_f1": 0.5847530969335001,
      "val_verse_f1": 0.7810571952642987,
      "val_chorus_f1": 0.38844899860270143,
      "val_chorus_rate": 0.22783766314387321,
      "val_max_prob": 0.5669301003217697,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006018997141307626,
      "epoch_time": 157.00208377838135,
      "val_boundary_f1": 0.14804469273743018,
      "val_boundary_precision": 0.1815068493150685,
      "val_boundary_recall": 0.125,
      "val_complete_segments": 0.02548571333035808,
      "val_avg_segment_overlap": 0.2801019234310292,
      "val_verse_to_chorus_acc": 0.11061946902654868,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.4187499323301723,
      "val_pk_metric": 0.40110473453748496
    },
    {
      "epoch": 2,
      "train_loss": 0.5235924825072289,
      "train_chorus_rate": 0.4046234667301178,
      "train_max_prob": 0.5636364817619324,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5289396196603775,
      "val_macro_f1": 0.6612193275353447,
      "val_verse_f1": 0.7767808093755721,
      "val_chorus_f1": 0.5456578456951173,
      "val_chorus_rate": 0.35953596234321594,
      "val_max_prob": 0.5642163008451462,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005822755924012519,
      "epoch_time": 93.72842502593994,
      "val_boundary_f1": 0.3063414634146342,
      "val_boundary_precision": 0.2612312811980033,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.1557225836653196,
      "val_avg_segment_overlap": 0.49471789089740115,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.43133488566208894,
      "val_pk_metric": 0.3552989403340631
    },
    {
      "epoch": 3,
      "train_loss": 0.4988104239106178,
      "train_chorus_rate": 0.43805770948529243,
      "train_max_prob": 0.5863053888082504,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5076459795236588,
      "val_macro_f1": 0.613756386220434,
      "val_verse_f1": 0.6548279689234184,
      "val_chorus_f1": 0.5726848035174498,
      "val_chorus_rate": 0.5942872613668442,
      "val_max_prob": 0.6060153841972351,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005505230964435384,
      "epoch_time": 117.50786590576172,
      "val_boundary_f1": 0.21538461538461537,
      "val_boundary_precision": 0.17474302496328928,
      "val_boundary_recall": 0.2806603773584906,
      "val_complete_segments": 0.10134132011120348,
      "val_avg_segment_overlap": 0.45818034312022027,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.49128432038753533,
      "val_pk_metric": 0.38915774200947756
    },
    {
      "epoch": 4,
      "train_loss": 0.4837042197585106,
      "train_chorus_rate": 0.3815210357308388,
      "train_max_prob": 0.6276591897010804,
      "train_conf_over_90": 0.00019797119894064962,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5036363378167152,
      "val_macro_f1": 0.7029288949951462,
      "val_verse_f1": 0.8148412415269355,
      "val_chorus_f1": 0.5910165484633569,
      "val_chorus_rate": 0.32460349053144455,
      "val_max_prob": 0.6319068521261215,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005080299626963543,
      "epoch_time": 99.39275217056274,
      "val_boundary_f1": 0.35135135135135137,
      "val_boundary_precision": 0.28425655976676384,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.23878220744604625,
      "val_avg_segment_overlap": 0.5837409746505544,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.43106782449926423,
      "val_pk_metric": 0.3159592696313428
    },
    {
      "epoch": 5,
      "train_loss": 0.4660980775952339,
      "train_chorus_rate": 0.3631853759288788,
      "train_max_prob": 0.6388187646865845,
      "train_conf_over_90": 0.001054491163813509,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4882546588778496,
      "val_macro_f1": 0.6961901225263207,
      "val_verse_f1": 0.780871903207221,
      "val_chorus_f1": 0.6115083418454205,
      "val_chorus_rate": 0.4225805848836899,
      "val_max_prob": 0.6464181840419769,
      "val_conf_over_90": 0.002437218849081546,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00045665334500913016,
      "epoch_time": 109.57892298698425,
      "val_boundary_f1": 0.3278969957081545,
      "val_boundary_precision": 0.25775978407557354,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.21548461808270927,
      "val_avg_segment_overlap": 0.605999765569064,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4420242145086909,
      "val_pk_metric": 0.3377138663509973
    },
    {
      "epoch": 6,
      "train_loss": 0.45705498456954957,
      "train_chorus_rate": 0.37510485351085665,
      "train_max_prob": 0.6592716127634048,
      "train_conf_over_90": 0.0052551899978425356,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48158373683691025,
      "val_macro_f1": 0.6721980012740882,
      "val_verse_f1": 0.7295150501672241,
      "val_chorus_f1": 0.6148809523809524,
      "val_chorus_rate": 0.5263038203120232,
      "val_max_prob": 0.6489669382572174,
      "val_conf_over_90": 0.005793661985080689,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003986386481071617,
      "epoch_time": 118.26519298553467,
      "val_boundary_f1": 0.25236051502145923,
      "val_boundary_precision": 0.19838056680161945,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.1276579886203428,
      "val_avg_segment_overlap": 0.5496526707982086,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.487552740231369,
      "val_pk_metric": 0.36412607670688024
    },
    {
      "epoch": 7,
      "train_loss": 0.46131438463926316,
      "train_chorus_rate": 0.4000987410545349,
      "train_max_prob": 0.6658947467803955,
      "train_conf_over_90": 0.012218730512540788,
      "train_conf_over_95": 0.0002557933825301006,
      "val_loss": 0.48198308050632477,
      "val_macro_f1": 0.7106471184452814,
      "val_verse_f1": 0.7971261107959918,
      "val_chorus_f1": 0.6241681260945711,
      "val_chorus_rate": 0.40217797458171844,
      "val_max_prob": 0.6612183749675751,
      "val_conf_over_90": 0.007175186590757221,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.000336521392630467,
      "epoch_time": 125.64507174491882,
      "val_boundary_f1": 0.3301805674978504,
      "val_boundary_precision": 0.2598105548037889,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.21551049799989352,
      "val_avg_segment_overlap": 0.6120377039468596,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4627916938228499,
      "val_pk_metric": 0.3317899773874407
    },
    {
      "epoch": 8,
      "train_loss": 0.45331448018550874,
      "train_chorus_rate": 0.38870165348052976,
      "train_max_prob": 0.6712012320756913,
      "train_conf_over_90": 0.012168914207722991,
      "train_conf_over_95": 0.00010971513111144305,
      "val_loss": 0.47591979801654816,
      "val_macro_f1": 0.7181548201987263,
      "val_verse_f1": 0.8020439061317184,
      "val_chorus_f1": 0.6342657342657343,
      "val_chorus_rate": 0.40375956147909164,
      "val_max_prob": 0.6728645265102386,
      "val_conf_over_90": 0.007100342831108719,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00027301640071504,
      "epoch_time": 107.24727392196655,
      "val_boundary_f1": 0.3551236749116608,
      "val_boundary_precision": 0.2838983050847458,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.24779732391079157,
      "val_avg_segment_overlap": 0.611658335129662,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.43465052372093294,
      "val_pk_metric": 0.3133798130980434
    },
    {
      "epoch": 9,
      "train_loss": 0.45184634774923327,
      "train_chorus_rate": 0.36568419113755224,
      "train_max_prob": 0.6764473706483841,
      "train_conf_over_90": 0.0122648372547701,
      "train_conf_over_95": 0.00043567701941356064,
      "val_loss": 0.47280240803956985,
      "val_macro_f1": 0.6818581563953924,
      "val_verse_f1": 0.7470959853270838,
      "val_chorus_f1": 0.616620327463701,
      "val_chorus_rate": 0.4956049472093582,
      "val_max_prob": 0.6700877696275711,
      "val_conf_over_90": 0.011909439344890416,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.00021089914523834524,
      "epoch_time": 108.72380805015564,
      "val_boundary_f1": 0.27792436235707996,
      "val_boundary_precision": 0.22159887798036465,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.17132329458681528,
      "val_avg_segment_overlap": 0.5738568772762414,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.48173613502064555,
      "val_pk_metric": 0.34941301485843784
    },
    {
      "epoch": 10,
      "train_loss": 0.4544803261756897,
      "train_chorus_rate": 0.4061742380261421,
      "train_max_prob": 0.6798272609710694,
      "train_conf_over_90": 0.01932994306553155,
      "train_conf_over_95": 0.0010712752991821617,
      "val_loss": 0.47324588149785995,
      "val_macro_f1": 0.7226196047677473,
      "val_verse_f1": 0.8032724505327244,
      "val_chorus_f1": 0.6419667590027701,
      "val_chorus_rate": 0.41033023595809937,
      "val_max_prob": 0.6692984253168106,
      "val_conf_over_90": 0.01025590451899916,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.00015288444833637678,
      "epoch_time": 103.29800295829773,
      "val_boundary_f1": 0.32895888013998253,
      "val_boundary_precision": 0.2614742698191933,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21308447327800456,
      "val_avg_segment_overlap": 0.6160040186145315,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.46315828421032823,
      "val_pk_metric": 0.3328986521198407
    },
    {
      "epoch": 11,
      "train_loss": 0.45660200715065,
      "train_chorus_rate": 0.3819485709071159,
      "train_max_prob": 0.674461716413498,
      "train_conf_over_90": 0.01799860771279782,
      "train_conf_over_95": 0.0009658508381107822,
      "val_loss": 0.46897973120212555,
      "val_macro_f1": 0.7353400259380374,
      "val_verse_f1": 0.8170388440607993,
      "val_chorus_f1": 0.6536412078152753,
      "val_chorus_rate": 0.39276669174432755,
      "val_max_prob": 0.6729331016540527,
      "val_conf_over_90": 0.008988878456875682,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010150783064915267,
      "epoch_time": 95.98639583587646,
      "val_boundary_f1": 0.34805653710247353,
      "val_boundary_precision": 0.2782485875706215,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2359306397747543,
      "val_avg_segment_overlap": 0.6187282040601236,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.43596167909082595,
      "val_pk_metric": 0.31430409283654864
    },
    {
      "epoch": 12,
      "train_loss": 0.4424000918865204,
      "train_chorus_rate": 0.371510899066925,
      "train_max_prob": 0.6788894295692444,
      "train_conf_over_90": 0.017486524023115634,
      "train_conf_over_95": 0.001497237227158621,
      "val_loss": 0.46801672130823135,
      "val_macro_f1": 0.7305495412989735,
      "val_verse_f1": 0.8107494322482968,
      "val_chorus_f1": 0.6503496503496503,
      "val_chorus_rate": 0.4035157635807991,
      "val_max_prob": 0.6741306930780411,
      "val_conf_over_90": 0.010094893863424659,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 5.90146969019685e-05,
      "epoch_time": 110.5120918750763,
      "val_boundary_f1": 0.3394575678040245,
      "val_boundary_precision": 0.2698191933240612,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2277295038562271,
      "val_avg_segment_overlap": 0.6158821569862614,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4458848977499752,
      "val_pk_metric": 0.3144959634599582
    },
    {
      "epoch": 13,
      "train_loss": 0.4387484848499298,
      "train_chorus_rate": 0.35408136397600176,
      "train_max_prob": 0.6843875080347062,
      "train_conf_over_90": 0.015644161455566064,
      "train_conf_over_95": 0.0008029787772102281,
      "val_loss": 0.4673217758536339,
      "val_macro_f1": 0.7287408680977412,
      "val_verse_f1": 0.8089461713419258,
      "val_chorus_f1": 0.6485355648535566,
      "val_chorus_rate": 0.405490443110466,
      "val_max_prob": 0.6769074499607086,
      "val_conf_over_90": 0.010788695653900504,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 2.726220094425493e-05,
      "epoch_time": 1036.8050508499146,
      "val_boundary_f1": 0.343915343915344,
      "val_boundary_precision": 0.2746478873239437,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2367397070604918,
      "val_avg_segment_overlap": 0.6111615256069299,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.44289596712407686,
      "val_pk_metric": 0.31032294917664854
    },
    {
      "epoch": 14,
      "train_loss": 0.44553846269845965,
      "train_chorus_rate": 0.3665419727563858,
      "train_max_prob": 0.6833847761154175,
      "train_conf_over_90": 0.019473699177615343,
      "train_conf_over_95": 0.0015878147358307614,
      "val_loss": 0.46708492189645767,
      "val_macro_f1": 0.7246568880111621,
      "val_verse_f1": 0.8040411742279833,
      "val_chorus_f1": 0.645272601794341,
      "val_chorus_rate": 0.4127211198210716,
      "val_max_prob": 0.6767456233501434,
      "val_conf_over_90": 0.011285893968306482,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 7.638079214744333e-06,
      "epoch_time": 99.78653502464294,
      "val_boundary_f1": 0.328042328042328,
      "val_boundary_precision": 0.2619718309859155,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.2179655757863605,
      "val_avg_segment_overlap": 0.6086788833276684,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4461336273654197,
      "val_pk_metric": 0.3176187288122947
    },
    {
      "epoch": 15,
      "train_loss": 0.43372473418712615,
      "train_chorus_rate": 0.3581874333322048,
      "train_max_prob": 0.6870860874652862,
      "train_conf_over_90": 0.02147460700944066,
      "train_conf_over_95": 0.0014504765160381794,
      "val_loss": 0.46737151592969894,
      "val_macro_f1": 0.7267949757008458,
      "val_verse_f1": 0.8068376068376069,
      "val_chorus_f1": 0.6467523445640848,
      "val_chorus_rate": 0.4081583097577095,
      "val_max_prob": 0.6776178181171417,
      "val_conf_over_90": 0.01197969599161297,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 1e-06,
      "epoch_time": 107.81330037117004,
      "val_boundary_f1": 0.3301141352063214,
      "val_boundary_precision": 0.2629370629370629,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22122154915102954,
      "val_avg_segment_overlap": 0.6090432061904409,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4464116378190744,
      "val_pk_metric": 0.3159918112765624
    }
  ]
}