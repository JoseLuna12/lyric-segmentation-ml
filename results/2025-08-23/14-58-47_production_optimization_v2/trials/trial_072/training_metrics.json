{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.18493020307967306,
      "layer_dropout": 0.22907614455699954,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.143589691271329,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009959599371340954,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01647732088150535,
      "gradient_clip_norm": 0.3815059945237017,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09915899463393132,
        "ece_after": 0.01883737814625496,
        "improvement": 0.08032161648767636,
        "params": {
          "temperature": 0.5602246556875882
        }
      },
      "platt": {
        "ece_before": 0.09915899463393132,
        "ece_after": 0.01551273877939211,
        "improvement": 0.08364625585453922,
        "params": {
          "A": 1.7470335380752962,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5870218575000763,
      "train_chorus_rate": 0.5857558886171319,
      "train_max_prob": 0.5643089085817337,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6248234808444977,
      "val_macro_f1": 0.43663581243497285,
      "val_verse_f1": 0.8195906432748536,
      "val_chorus_f1": 0.05368098159509203,
      "val_chorus_rate": 0.020455408608540893,
      "val_max_prob": 0.6002911329269409,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009850888062340345,
      "epoch_time": 102.33510780334473,
      "val_boundary_f1": 0.013513513513513514,
      "val_boundary_precision": 0.15,
      "val_boundary_recall": 0.007075471698113208,
      "val_complete_segments": 0.05889547516005629,
      "val_avg_segment_overlap": 0.17635192163793728,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.27204540173479697,
      "val_pk_metric": 0.27825045425660655
    },
    {
      "epoch": 2,
      "train_loss": 0.5655359655618668,
      "train_chorus_rate": 0.4837995732435957,
      "train_max_prob": 0.5798713713884354,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5914314538240433,
      "val_macro_f1": 0.5003218657268175,
      "val_verse_f1": 0.5348035837353549,
      "val_chorus_f1": 0.4658401477182801,
      "val_chorus_rate": 0.6321724951267242,
      "val_max_prob": 0.5471044033765793,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000952950534119658,
      "epoch_time": 50.65052103996277,
      "val_boundary_f1": 0.050520059435364036,
      "val_boundary_precision": 0.06827309236947791,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.02320439095359562,
      "val_avg_segment_overlap": 0.24011523161709775,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.5048544859084731,
      "val_pk_metric": 0.5055455840487817
    },
    {
      "epoch": 3,
      "train_loss": 0.5496187061071396,
      "train_chorus_rate": 0.3923657894134521,
      "train_max_prob": 0.5975724935531617,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.600134015083313,
      "val_macro_f1": 0.569886885487173,
      "val_verse_f1": 0.7500865351332642,
      "val_chorus_f1": 0.38968723584108195,
      "val_chorus_rate": 0.282359953969717,
      "val_max_prob": 0.5748170763254166,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009009497174989041,
      "epoch_time": 130.42610096931458,
      "val_boundary_f1": 0.10204081632653061,
      "val_boundary_precision": 0.18292682926829268,
      "val_boundary_recall": 0.07075471698113207,
      "val_complete_segments": 0.059582546870457796,
      "val_avg_segment_overlap": 0.24731569582885343,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.3677006170054957,
      "val_pk_metric": 0.34948362570948927
    },
    {
      "epoch": 4,
      "train_loss": 0.5419954851269722,
      "train_chorus_rate": 0.4437202931381762,
      "train_max_prob": 0.6094844400882721,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6005875915288925,
      "val_macro_f1": 0.5573908345805876,
      "val_verse_f1": 0.639021356002488,
      "val_chorus_f1": 0.4757603131586871,
      "val_chorus_rate": 0.5170078948140144,
      "val_max_prob": 0.6098746210336685,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008313590415857022,
      "epoch_time": 99.18647503852844,
      "val_boundary_f1": 0.08067226890756303,
      "val_boundary_precision": 0.14035087719298245,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.03987295127273918,
      "val_avg_segment_overlap": 0.23806611774984665,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.3926067916752179,
      "val_pk_metric": 0.36409539408144304
    },
    {
      "epoch": 5,
      "train_loss": 0.5489874497056008,
      "train_chorus_rate": 0.45835779160261153,
      "train_max_prob": 0.614521038532257,
      "train_conf_over_90": 0.0002677376149222255,
      "train_conf_over_95": 0.0,
      "val_loss": 0.554561585187912,
      "val_macro_f1": 0.6957403291477493,
      "val_verse_f1": 0.8285176953325356,
      "val_chorus_f1": 0.5629629629629631,
      "val_chorus_rate": 0.2650105655193329,
      "val_max_prob": 0.6374301612377167,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007472199528505717,
      "epoch_time": 50.077512979507446,
      "val_boundary_f1": 0.3183760683760684,
      "val_boundary_precision": 0.291015625,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.1691677721502748,
      "val_avg_segment_overlap": 0.5298202939556096,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.35978629366291326,
      "val_pk_metric": 0.2982289980363253
    },
    {
      "epoch": 6,
      "train_loss": 0.5044238865375519,
      "train_chorus_rate": 0.3875848062336445,
      "train_max_prob": 0.6697196900844574,
      "train_conf_over_90": 0.019784225500188768,
      "train_conf_over_95": 0.0009805295616388322,
      "val_loss": 0.5341435521841049,
      "val_macro_f1": 0.7359446863020369,
      "val_verse_f1": 0.8490371389270978,
      "val_chorus_f1": 0.622852233676976,
      "val_chorus_rate": 0.2724859192967415,
      "val_max_prob": 0.7263096123933792,
      "val_conf_over_90": 0.015432738233357668,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006522097332153803,
      "epoch_time": 51.55779004096985,
      "val_boundary_f1": 0.3553008595988539,
      "val_boundary_precision": 0.2985553772070626,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21255249341145416,
      "val_avg_segment_overlap": 0.6250361931546469,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.37502063910878847,
      "val_pk_metric": 0.275529935737608
    },
    {
      "epoch": 7,
      "train_loss": 0.47629875838756563,
      "train_chorus_rate": 0.3619905710220337,
      "train_max_prob": 0.7021930068731308,
      "train_conf_over_90": 0.02261027678614482,
      "train_conf_over_95": 0.00010210464388364926,
      "val_loss": 0.497151643037796,
      "val_macro_f1": 0.7427314953791595,
      "val_verse_f1": 0.8307410795974383,
      "val_chorus_f1": 0.6547219111608809,
      "val_chorus_rate": 0.35865896195173264,
      "val_max_prob": 0.7172026485204697,
      "val_conf_over_90": 0.034803652204573154,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0005504807851878019,
      "epoch_time": 89.7376081943512,
      "val_boundary_f1": 0.3264150943396226,
      "val_boundary_precision": 0.2720125786163522,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.16870503854862284,
      "val_avg_segment_overlap": 0.6408114546084392,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.39190808913872355,
      "val_pk_metric": 0.2885378420483722
    },
    {
      "epoch": 8,
      "train_loss": 0.4702024146914482,
      "train_chorus_rate": 0.3414752848446369,
      "train_max_prob": 0.7007204174995423,
      "train_conf_over_90": 0.02038687407039106,
      "train_conf_over_95": 0.00013934841845184565,
      "val_loss": 0.4972493648529053,
      "val_macro_f1": 0.7338000104732734,
      "val_verse_f1": 0.8219885629957572,
      "val_chorus_f1": 0.6456114579507897,
      "val_chorus_rate": 0.36983107775449753,
      "val_max_prob": 0.6984758526086807,
      "val_conf_over_90": 0.023603250738233328,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004464791519462939,
      "epoch_time": 109.06950378417969,
      "val_boundary_f1": 0.3435468895078923,
      "val_boundary_precision": 0.2833078101071976,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2089402063023484,
      "val_avg_segment_overlap": 0.6433823819349311,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.39227212384147553,
      "val_pk_metric": 0.28624910773910034
    },
    {
      "epoch": 9,
      "train_loss": 0.4676182195544243,
      "train_chorus_rate": 0.367472967505455,
      "train_max_prob": 0.7073003649711609,
      "train_conf_over_90": 0.027285268995910883,
      "train_conf_over_95": 0.00045703818323090674,
      "val_loss": 0.49468740075826645,
      "val_macro_f1": 0.7336593248730255,
      "val_verse_f1": 0.8186895011169024,
      "val_chorus_f1": 0.6486291486291487,
      "val_chorus_rate": 0.3815124109387398,
      "val_max_prob": 0.7372936904430389,
      "val_conf_over_90": 0.06296583823859692,
      "val_conf_over_95": 0.001387604046612978,
      "learning_rate": 0.00034475020391871547,
      "epoch_time": 69.16480922698975,
      "val_boundary_f1": 0.34449760765550247,
      "val_boundary_precision": 0.2898550724637681,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.17863572745598197,
      "val_avg_segment_overlap": 0.6208424999251139,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39165479474303744,
      "val_pk_metric": 0.2869735045377331
    },
    {
      "epoch": 10,
      "train_loss": 0.4656456962227821,
      "train_chorus_rate": 0.3510847441852093,
      "train_max_prob": 0.7090316444635392,
      "train_conf_over_90": 0.03463116271886975,
      "train_conf_over_95": 0.000751337080146186,
      "val_loss": 0.49799010902643204,
      "val_macro_f1": 0.7716878751009764,
      "val_verse_f1": 0.8731723903434205,
      "val_chorus_f1": 0.6702033598585323,
      "val_chorus_rate": 0.25623075291514397,
      "val_max_prob": 0.7185096740722656,
      "val_conf_over_90": 0.010694752563722432,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024973998428352406,
      "epoch_time": 47.50079679489136,
      "val_boundary_f1": 0.41666666666666663,
      "val_boundary_precision": 0.36607142857142855,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.2855770897393379,
      "val_avg_segment_overlap": 0.659445831602117,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.2972308373234402,
      "val_pk_metric": 0.22435213120756442
    },
    {
      "epoch": 11,
      "train_loss": 0.46647351384162905,
      "train_chorus_rate": 0.32908745259046557,
      "train_max_prob": 0.7108385175466537,
      "train_conf_over_90": 0.02726528955390677,
      "train_conf_over_95": 0.0007275925920112059,
      "val_loss": 0.5014138072729111,
      "val_macro_f1": 0.7629583560885406,
      "val_verse_f1": 0.8665185438386599,
      "val_chorus_f1": 0.6593981683384212,
      "val_chorus_rate": 0.26398416236042976,
      "val_max_prob": 0.6796169728040695,
      "val_conf_over_90": 0.0007036147289909422,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016560089554839354,
      "epoch_time": 42.57944917678833,
      "val_boundary_f1": 0.3927855711422846,
      "val_boundary_precision": 0.34146341463414637,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2561730341157701,
      "val_avg_segment_overlap": 0.6386068760108203,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3191480942295823,
      "val_pk_metric": 0.23717511476948583
    },
    {
      "epoch": 12,
      "train_loss": 0.4642702519893646,
      "train_chorus_rate": 0.35624960660934446,
      "train_max_prob": 0.7168617814779281,
      "train_conf_over_90": 0.03438920645276085,
      "train_conf_over_95": 0.0005040267977165058,
      "val_loss": 0.48759496212005615,
      "val_macro_f1": 0.7653647488043513,
      "val_verse_f1": 0.857847454641536,
      "val_chorus_f1": 0.6728820429671666,
      "val_chorus_rate": 0.30661357939243317,
      "val_max_prob": 0.7057311981916428,
      "val_conf_over_90": 0.013507719326298684,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.60102196351915e-05,
      "epoch_time": 75.90608716011047,
      "val_boundary_f1": 0.3892100192678227,
      "val_boundary_precision": 0.3289902280130293,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2740178767617792,
      "val_avg_segment_overlap": 0.6664433209456699,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3215330937258034,
      "val_pk_metric": 0.23780337202729673
    },
    {
      "epoch": 13,
      "train_loss": 0.4513930469751358,
      "train_chorus_rate": 0.35373666435480117,
      "train_max_prob": 0.7227290838956832,
      "train_conf_over_90": 0.03863756852224469,
      "train_conf_over_95": 0.00037300639087334275,
      "val_loss": 0.481942780315876,
      "val_macro_f1": 0.7691268973686913,
      "val_verse_f1": 0.8563279857397506,
      "val_chorus_f1": 0.6819258089976322,
      "val_chorus_rate": 0.3231120854616165,
      "val_max_prob": 0.7104301899671555,
      "val_conf_over_90": 0.02784926421009004,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.4009403014437366e-05,
      "epoch_time": 52.14320373535156,
      "val_boundary_f1": 0.39101964452759586,
      "val_boundary_precision": 0.324031007751938,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.27260336954133346,
      "val_avg_segment_overlap": 0.6786416027499941,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.33495229418977496,
      "val_pk_metric": 0.24294510789313248
    },
    {
      "epoch": 14,
      "train_loss": 0.458895443379879,
      "train_chorus_rate": 0.3154706835746765,
      "train_max_prob": 0.7104293137788773,
      "train_conf_over_90": 0.02732174675911665,
      "train_conf_over_95": 0.0005033788678701967,
      "val_loss": 0.48017194867134094,
      "val_macro_f1": 0.7614713139283279,
      "val_verse_f1": 0.8454132606721163,
      "val_chorus_f1": 0.6775293671845395,
      "val_chorus_rate": 0.34879472106695175,
      "val_max_prob": 0.715205043554306,
      "val_conf_over_90": 0.04003049759194255,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1871130900060926e-05,
      "epoch_time": 128.38702607154846,
      "val_boundary_f1": 0.37934272300469485,
      "val_boundary_precision": 0.31513260530421217,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26333936572536787,
      "val_avg_segment_overlap": 0.6715828796404686,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.35135582827488543,
      "val_pk_metric": 0.254714561144349
    },
    {
      "epoch": 15,
      "train_loss": 0.43943254351615907,
      "train_chorus_rate": 0.3608217388391495,
      "train_max_prob": 0.7284769982099533,
      "train_conf_over_90": 0.04697517836466432,
      "train_conf_over_95": 0.0004649917304050177,
      "val_loss": 0.4802611321210861,
      "val_macro_f1": 0.7621545367672868,
      "val_verse_f1": 0.8474331164135936,
      "val_chorus_f1": 0.67687595712098,
      "val_chorus_rate": 0.3422026187181473,
      "val_max_prob": 0.7168229222297668,
      "val_conf_over_90": 0.039558460004627705,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 171.9604721069336,
      "val_boundary_f1": 0.37969924812030076,
      "val_boundary_precision": 0.315625,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.27073801949199616,
      "val_avg_segment_overlap": 0.6724652391731379,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.35095783194817404,
      "val_pk_metric": 0.2532323505800024
    }
  ]
}