{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.17838393662713092,
      "layer_dropout": 0.20164101099213905,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.14595318754902248,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3501571,
      "lstm_params": 2940928,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008611881434604822,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.018080548606693288,
      "gradient_clip_norm": 0.36187942494870406,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08130443907088523,
        "ece_after": 0.02790914451033756,
        "improvement": 0.053395294560547674,
        "params": {
          "temperature": 0.47800996802348916
        }
      },
      "platt": {
        "ece_before": 0.08130443907088523,
        "ece_after": 0.04835753911312059,
        "improvement": 0.03294689995776465,
        "params": {
          "A": 1.4999989870426838,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6017899602651596,
      "train_chorus_rate": 0.4733628362417221,
      "train_max_prob": 0.6048429638147355,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6051365435123444,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.5921021401882172,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008284491816562521,
      "epoch_time": 173.27692103385925,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 2,
      "train_loss": 0.5625200927257538,
      "train_chorus_rate": 0.4016079716879176,
      "train_max_prob": 0.5522895604372025,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5803139060735703,
      "val_macro_f1": 0.48510012609277947,
      "val_verse_f1": 0.49964174826845004,
      "val_chorus_f1": 0.4705585039171089,
      "val_chorus_rate": 0.6719724088907242,
      "val_max_prob": 0.5488160997629166,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007352165063988279,
      "epoch_time": 150.74514365196228,
      "val_boundary_f1": 0.025500910746812384,
      "val_boundary_precision": 0.056,
      "val_boundary_recall": 0.01650943396226415,
      "val_complete_segments": 0.005629828813816089,
      "val_avg_segment_overlap": 0.20726067879031962,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43675994551415126,
      "val_pk_metric": 0.4438867040588553
    },
    {
      "epoch": 3,
      "train_loss": 0.5747004270553588,
      "train_chorus_rate": 0.6259262681473047,
      "train_max_prob": 0.56849125623703,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5799111276865005,
      "val_macro_f1": 0.4138020983129267,
      "val_verse_f1": 0.3272832036876981,
      "val_chorus_f1": 0.5003209929381554,
      "val_chorus_rate": 0.847747728228569,
      "val_max_prob": 0.5510728657245636,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005956839473398469,
      "epoch_time": 154.91465878486633,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.02203469376056863,
      "val_avg_segment_overlap": 0.18689231805999318,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.423500754171928,
      "val_pk_metric": 0.4242656548146415
    },
    {
      "epoch": 4,
      "train_loss": 0.5426976308226585,
      "train_chorus_rate": 0.27897034663474185,
      "train_max_prob": 0.5502879947423935,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5937508791685104,
      "val_macro_f1": 0.48915922538915496,
      "val_verse_f1": 0.804796599878567,
      "val_chorus_f1": 0.17352185089974292,
      "val_chorus_rate": 0.08335711061954498,
      "val_max_prob": 0.5627638697624207,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004310940717302411,
      "epoch_time": 218.40555596351624,
      "val_boundary_f1": 0.05185185185185184,
      "val_boundary_precision": 0.1206896551724138,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.05688883475203731,
      "val_avg_segment_overlap": 0.23741309220321402,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.30660202974864575,
      "val_pk_metric": 0.2907948907340622
    },
    {
      "epoch": 5,
      "train_loss": 0.5547562390565872,
      "train_chorus_rate": 0.5704936135560275,
      "train_max_prob": 0.5568133771419526,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5775924175977707,
      "val_macro_f1": 0.5179437643666682,
      "val_verse_f1": 0.5465924895688457,
      "val_chorus_f1": 0.48929503916449085,
      "val_chorus_rate": 0.6414979100227356,
      "val_max_prob": 0.554520383477211,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00026650419612063534,
      "epoch_time": 163.6973021030426,
      "val_boundary_f1": 0.06593406593406594,
      "val_boundary_precision": 0.14754098360655737,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.05586042791769197,
      "val_avg_segment_overlap": 0.22653939077208873,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3302320204659399,
      "val_pk_metric": 0.3328539091011725
    },
    {
      "epoch": 6,
      "train_loss": 0.5544210329651833,
      "train_chorus_rate": 0.6751574784517288,
      "train_max_prob": 0.5735700309276581,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5929334312677383,
      "val_macro_f1": 0.540594282813183,
      "val_verse_f1": 0.7768407395394096,
      "val_chorus_f1": 0.3043478260869565,
      "val_chorus_rate": 0.18722204491496086,
      "val_max_prob": 0.5807146281003952,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012697163706165424,
      "epoch_time": 145.87271976470947,
      "val_boundary_f1": 0.08261617900172116,
      "val_boundary_precision": 0.15286624203821655,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.05301884030675123,
      "val_avg_segment_overlap": 0.2314273107457712,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.31892880219744435,
      "val_pk_metric": 0.30135258712347
    },
    {
      "epoch": 7,
      "train_loss": 0.542812143266201,
      "train_chorus_rate": 0.4887113496661186,
      "train_max_prob": 0.5813496053218842,
      "train_conf_over_90": 2.4330899759661406e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5804861932992935,
      "val_macro_f1": 0.5090000900254527,
      "val_verse_f1": 0.5443298969072166,
      "val_chorus_f1": 0.4736702831436888,
      "val_chorus_rate": 0.6281289607286453,
      "val_max_prob": 0.5749986171722412,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.3738961804230126e-05,
      "epoch_time": 155.6812720298767,
      "val_boundary_f1": 0.08156028368794327,
      "val_boundary_precision": 0.16428571428571428,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.056545503616023236,
      "val_avg_segment_overlap": 0.21748176042615552,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.33856075363940197,
      "val_pk_metric": 0.3315613968646567
    },
    {
      "epoch": 8,
      "train_loss": 0.5269485875964165,
      "train_chorus_rate": 0.5057746499776841,
      "train_max_prob": 0.587585735321045,
      "train_conf_over_90": 2.60960339801386e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5807375460863113,
      "val_macro_f1": 0.5166143523609202,
      "val_verse_f1": 0.5657601426660722,
      "val_chorus_f1": 0.4674685620557682,
      "val_chorus_rate": 0.598456472158432,
      "val_max_prob": 0.5751448422670364,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 182.75313591957092,
      "val_boundary_f1": 0.054844606946983544,
      "val_boundary_precision": 0.12195121951219512,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.04951805691466349,
      "val_avg_segment_overlap": 0.2197677932599066,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.3311706345408133,
      "val_pk_metric": 0.3279133819176083
    }
  ]
}