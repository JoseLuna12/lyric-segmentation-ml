{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.24077489450702996,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2863488160022229,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1867010,
      "lstm_params": 1339392,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007437435052705635,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.02382538338379597,
      "gradient_clip_norm": 0.35726807842921304,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09120283281697739,
        "ece_after": 0.02694173313838326,
        "improvement": 0.06426109967859413,
        "params": {
          "temperature": 0.6177254049849297
        }
      },
      "platt": {
        "ece_before": 0.09120283281697739,
        "ece_after": 0.03684059053308136,
        "improvement": 0.05436224228389602,
        "params": {
          "A": 1.4999998276180042,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5852993726730347,
      "train_chorus_rate": 0.4966963772661984,
      "train_max_prob": 0.6064233630895615,
      "train_conf_over_90": 3.320053219795227e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5657413154840469,
      "val_macro_f1": 0.579146892286488,
      "val_verse_f1": 0.6296864722648542,
      "val_chorus_f1": 0.5286073123081217,
      "val_chorus_rate": 0.5809430032968521,
      "val_max_prob": 0.5455882400274277,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000735628141455791,
      "epoch_time": 148.5858838558197,
      "val_boundary_f1": 0.16326530612244897,
      "val_boundary_precision": 0.16625916870415647,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.048419414339350715,
      "val_avg_segment_overlap": 0.3628836784753427,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.4698819777457297,
      "val_pk_metric": 0.4407821396775041
    },
    {
      "epoch": 2,
      "train_loss": 0.536104941368103,
      "train_chorus_rate": 0.42782553620636465,
      "train_max_prob": 0.5825838029384613,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5524686872959137,
      "val_macro_f1": 0.6834771138787805,
      "val_verse_f1": 0.7928454097463041,
      "val_chorus_f1": 0.574108818011257,
      "val_chorus_rate": 0.3556126803159714,
      "val_max_prob": 0.5813924074172974,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000711636730352015,
      "epoch_time": 149.8562560081482,
      "val_boundary_f1": 0.3088803088803089,
      "val_boundary_precision": 0.26143790849673204,
      "val_boundary_recall": 0.37735849056603776,
      "val_complete_segments": 0.1818660768024501,
      "val_avg_segment_overlap": 0.5344871359221924,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.427642815585297,
      "val_pk_metric": 0.33153905982309173
    },
    {
      "epoch": 3,
      "train_loss": 0.5255503714084625,
      "train_chorus_rate": 0.5095719873905182,
      "train_max_prob": 0.6457885384559632,
      "train_conf_over_90": 0.004045374915585853,
      "train_conf_over_95": 0.0,
      "val_loss": 0.520288735628128,
      "val_macro_f1": 0.6945605441816882,
      "val_verse_f1": 0.7609441194270727,
      "val_chorus_f1": 0.6281769689363038,
      "val_chorus_rate": 0.4834744855761528,
      "val_max_prob": 0.6347781866788864,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006728178117480338,
      "epoch_time": 147.09140014648438,
      "val_boundary_f1": 0.2966175195143105,
      "val_boundary_precision": 0.2345679012345679,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.15988988154947859,
      "val_avg_segment_overlap": 0.585419890571515,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4668074611534876,
      "val_pk_metric": 0.35696837905231094
    },
    {
      "epoch": 4,
      "train_loss": 0.4996132552623749,
      "train_chorus_rate": 0.4043935343623161,
      "train_max_prob": 0.6579667776823044,
      "train_conf_over_90": 0.0037418864783830942,
      "train_conf_over_95": 0.0,
      "val_loss": 0.557101234793663,
      "val_macro_f1": 0.48755548162868667,
      "val_verse_f1": 0.44174757281553395,
      "val_chorus_f1": 0.5333633904418394,
      "val_chorus_rate": 0.7897560596466064,
      "val_max_prob": 0.6831009685993195,
      "val_conf_over_90": 0.01363354071509093,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006208679586606797,
      "epoch_time": 142.9616961479187,
      "val_boundary_f1": 0.06561360874848116,
      "val_boundary_precision": 0.06766917293233082,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.01796265853795016,
      "val_avg_segment_overlap": 0.32619177751555295,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.45606970700479355,
      "val_pk_metric": 0.38760475262142813
    },
    {
      "epoch": 5,
      "train_loss": 0.5006828710436821,
      "train_chorus_rate": 0.45676776170730593,
      "train_max_prob": 0.6591351866722107,
      "train_conf_over_90": 0.005929192382609472,
      "train_conf_over_95": 3.3715442987158896e-05,
      "val_loss": 0.5057632476091385,
      "val_macro_f1": 0.7199348864540649,
      "val_verse_f1": 0.7929086304305475,
      "val_chorus_f1": 0.6469611424775822,
      "val_chorus_rate": 0.4407675787806511,
      "val_max_prob": 0.6870786994695663,
      "val_conf_over_90": 0.011517161154188216,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005580576289529226,
      "epoch_time": 142.7749891281128,
      "val_boundary_f1": 0.3441441441441441,
      "val_boundary_precision": 0.2784256559766764,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.20304627267776792,
      "val_avg_segment_overlap": 0.6256132708165355,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.42943212711023804,
      "val_pk_metric": 0.3172629272742196
    },
    {
      "epoch": 6,
      "train_loss": 0.48548117876052854,
      "train_chorus_rate": 0.3579547770321369,
      "train_max_prob": 0.6628472238779068,
      "train_conf_over_90": 0.0037599317904096095,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4985792115330696,
      "val_macro_f1": 0.7433029714837056,
      "val_verse_f1": 0.8183200304066895,
      "val_chorus_f1": 0.6682859125607218,
      "val_chorus_rate": 0.4088197350502014,
      "val_max_prob": 0.6708875298500061,
      "val_conf_over_90": 0.006065437861252576,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048713193543039294,
      "epoch_time": 132.59369707107544,
      "val_boundary_f1": 0.37927844588344123,
      "val_boundary_precision": 0.3120243531202435,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.27940248610980317,
      "val_avg_segment_overlap": 0.6446574344194257,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.42126938590546553,
      "val_pk_metric": 0.3085798432620288
    },
    {
      "epoch": 7,
      "train_loss": 0.4760460421442986,
      "train_chorus_rate": 0.3915626540780067,
      "train_max_prob": 0.6813229620456696,
      "train_conf_over_90": 0.01129437576746568,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5003740265965462,
      "val_macro_f1": 0.7384892876439126,
      "val_verse_f1": 0.8161333080855898,
      "val_chorus_f1": 0.6608452672022355,
      "val_chorus_rate": 0.4041648507118225,
      "val_max_prob": 0.6900759786367416,
      "val_conf_over_90": 0.021470997715368867,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004111906712392629,
      "epoch_time": 150.02554607391357,
      "val_boundary_f1": 0.39548022598870053,
      "val_boundary_precision": 0.329153605015674,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.3090736490922069,
      "val_avg_segment_overlap": 0.6557036878286394,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.40740245266696057,
      "val_pk_metric": 0.29271873347937705
    },
    {
      "epoch": 8,
      "train_loss": 0.48053248822689054,
      "train_chorus_rate": 0.3551058940589428,
      "train_max_prob": 0.6847563713788987,
      "train_conf_over_90": 0.011980001229676417,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49942299723625183,
      "val_macro_f1": 0.7198625094562828,
      "val_verse_f1": 0.7823293172690763,
      "val_chorus_f1": 0.6573957016434894,
      "val_chorus_rate": 0.478115975856781,
      "val_max_prob": 0.6885077953338623,
      "val_conf_over_90": 0.004040742409415543,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033355283403130065,
      "epoch_time": 134.85922479629517,
      "val_boundary_f1": 0.3921182266009852,
      "val_boundary_precision": 0.33671742808798644,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2759027092537167,
      "val_avg_segment_overlap": 0.6351070024640681,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.41874881015239107,
      "val_pk_metric": 0.3033778691560153
    },
    {
      "epoch": 9,
      "train_loss": 0.4833444133400917,
      "train_chorus_rate": 0.3945278748869896,
      "train_max_prob": 0.6761571884155273,
      "train_conf_over_90": 0.005136135488282889,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4961445480585098,
      "val_macro_f1": 0.7402923564665145,
      "val_verse_f1": 0.8092373374733165,
      "val_chorus_f1": 0.6713473754597123,
      "val_chorus_rate": 0.4357895031571388,
      "val_max_prob": 0.7002547681331635,
      "val_conf_over_90": 0.031561304815113544,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025761156984017053,
      "epoch_time": 139.66958904266357,
      "val_boundary_f1": 0.3859981078524125,
      "val_boundary_precision": 0.3222748815165877,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2876493938264882,
      "val_avg_segment_overlap": 0.6609832813523197,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.41302494919016663,
      "val_pk_metric": 0.3015104709624213
    },
    {
      "epoch": 10,
      "train_loss": 0.45826464593410493,
      "train_chorus_rate": 0.3589092940092087,
      "train_max_prob": 0.6983540624380111,
      "train_conf_over_90": 0.02058363563846797,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5049140453338623,
      "val_macro_f1": 0.72338664693267,
      "val_verse_f1": 0.7930154993133216,
      "val_chorus_f1": 0.6537577945520184,
      "val_chorus_rate": 0.4492829963564873,
      "val_max_prob": 0.7056558430194855,
      "val_conf_over_90": 0.05337760737165809,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018668587631764092,
      "epoch_time": 151.1987988948822,
      "val_boundary_f1": 0.38169425511197663,
      "val_boundary_precision": 0.3250414593698176,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.25918039308813434,
      "val_avg_segment_overlap": 0.6375388288100166,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.43385504220450305,
      "val_pk_metric": 0.32436385789349076
    },
    {
      "epoch": 11,
      "train_loss": 0.4736739441752434,
      "train_chorus_rate": 0.37822928130626676,
      "train_max_prob": 0.6834386348724365,
      "train_conf_over_90": 0.018709377199411393,
      "train_conf_over_95": 3.486750356387347e-05,
      "val_loss": 0.5032973885536194,
      "val_macro_f1": 0.7610407530940934,
      "val_verse_f1": 0.8548756833010052,
      "val_chorus_f1": 0.6672058228871816,
      "val_chorus_rate": 0.3083702176809311,
      "val_max_prob": 0.6942829787731171,
      "val_conf_over_90": 0.005562704522162676,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012387554660988386,
      "epoch_time": 142.13489508628845,
      "val_boundary_f1": 0.4270109235352532,
      "val_boundary_precision": 0.3687821612349914,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.3342866764658917,
      "val_avg_segment_overlap": 0.6571913646661912,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3493215366021697,
      "val_pk_metric": 0.2511882615360911
    },
    {
      "epoch": 12,
      "train_loss": 0.4657524526119232,
      "train_chorus_rate": 0.33932688310742376,
      "train_max_prob": 0.6879127502441407,
      "train_conf_over_90": 0.007986344303935767,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4950295388698578,
      "val_macro_f1": 0.7493758383965912,
      "val_verse_f1": 0.8215102974828375,
      "val_chorus_f1": 0.6772413793103449,
      "val_chorus_rate": 0.41330521553754807,
      "val_max_prob": 0.7084139585494995,
      "val_conf_over_90": 0.025324328802525997,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.192569352252966e-05,
      "epoch_time": 149.97844576835632,
      "val_boundary_f1": 0.4243027888446215,
      "val_boundary_precision": 0.36724137931034484,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.3084516439633089,
      "val_avg_segment_overlap": 0.6641564768349796,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3883967859915955,
      "val_pk_metric": 0.2868831490837871
    },
    {
      "epoch": 13,
      "train_loss": 0.45531318336725235,
      "train_chorus_rate": 0.339996062964201,
      "train_max_prob": 0.6977629125118255,
      "train_conf_over_90": 0.018595030531287193,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49274057894945145,
      "val_macro_f1": 0.7556575204918852,
      "val_verse_f1": 0.8311444652908067,
      "val_chorus_f1": 0.6801705756929638,
      "val_chorus_rate": 0.3921092227101326,
      "val_max_prob": 0.6904100626707077,
      "val_conf_over_90": 0.00847165088634938,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.310677491854847e-05,
      "epoch_time": 164.65220522880554,
      "val_boundary_f1": 0.4326450344149459,
      "val_boundary_precision": 0.37099494097807756,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.31412424202721123,
      "val_avg_segment_overlap": 0.6724597214067937,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3738119586875708,
      "val_pk_metric": 0.27365510657010644
    },
    {
      "epoch": 14,
      "train_loss": 0.4598461776971817,
      "train_chorus_rate": 0.36686288714408877,
      "train_max_prob": 0.6985011458396911,
      "train_conf_over_90": 0.020704785292036832,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49352964013814926,
      "val_macro_f1": 0.7458184377882989,
      "val_verse_f1": 0.8137957760124007,
      "val_chorus_f1": 0.6778410995641971,
      "val_chorus_rate": 0.43347568809986115,
      "val_max_prob": 0.7033757418394089,
      "val_conf_over_90": 0.02772595454007387,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.115363814772526e-06,
      "epoch_time": 140.62211418151855,
      "val_boundary_f1": 0.41276171485543367,
      "val_boundary_precision": 0.35751295336787564,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.30378116337819416,
      "val_avg_segment_overlap": 0.6638820026548995,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.38790475856556667,
      "val_pk_metric": 0.2884443319885162
    },
    {
      "epoch": 15,
      "train_loss": 0.45555838048458097,
      "train_chorus_rate": 0.36590601280331614,
      "train_max_prob": 0.7033464401960373,
      "train_conf_over_90": 0.025201056501828134,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4926157146692276,
      "val_macro_f1": 0.7589008873296734,
      "val_verse_f1": 0.8357541899441341,
      "val_chorus_f1": 0.6820475847152127,
      "val_chorus_rate": 0.3823155239224434,
      "val_max_prob": 0.6923909336328506,
      "val_conf_over_90": 0.011140155256725848,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 159.15786814689636,
      "val_boundary_f1": 0.4435721295387635,
      "val_boundary_precision": 0.3798319327731092,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.3233772592468244,
      "val_avg_segment_overlap": 0.6771717551277652,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.35367124992866955,
      "val_pk_metric": 0.26640038411352807
    }
  ]
}