{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.21347224231704243,
      "layer_dropout": 0.2380910615689722,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1902249800522923,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006710555368483188,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01470691043045413,
      "gradient_clip_norm": 0.3953661890526009,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12764911720993946,
        "ece_after": 0.020110962828273616,
        "improvement": 0.10753815438166585,
        "params": {
          "temperature": 0.4855160159368984
        }
      },
      "platt": {
        "ece_before": 0.12764911720993946,
        "ece_after": 0.025706204367995512,
        "improvement": 0.10194291284194396,
        "params": {
          "A": 1.9268231992050389,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6037841945886612,
      "train_chorus_rate": 0.5064010968199,
      "train_max_prob": 0.5884931266307831,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6102218478918076,
      "val_macro_f1": 0.3407730517401246,
      "val_verse_f1": 0.19717425431711144,
      "val_chorus_f1": 0.48437184916313775,
      "val_chorus_rate": 0.9179612249135971,
      "val_max_prob": 0.616491824388504,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000663734376287452,
      "epoch_time": 564.2724449634552,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.13520014437559946,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4148026722328004,
      "val_pk_metric": 0.40213540932247616
    },
    {
      "epoch": 2,
      "train_loss": 0.5781117647886276,
      "train_chorus_rate": 0.4545816439349437,
      "train_max_prob": 0.5827616930007935,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5945271402597427,
      "val_macro_f1": 0.4921091656665494,
      "val_verse_f1": 0.5148095909732017,
      "val_chorus_f1": 0.46940874035989716,
      "val_chorus_rate": 0.6558010578155518,
      "val_max_prob": 0.5516369342803955,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006420908644521873,
      "epoch_time": 943.6382768154144,
      "val_boundary_f1": 0.05828779599271403,
      "val_boundary_precision": 0.128,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.016572035222618468,
      "val_avg_segment_overlap": 0.20668314811037197,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43590011307055176,
      "val_pk_metric": 0.4369561823500305
    },
    {
      "epoch": 3,
      "train_loss": 0.5726073861122132,
      "train_chorus_rate": 0.5898828064091504,
      "train_max_prob": 0.5728818863630295,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5916891545057297,
      "val_macro_f1": 0.4225100039793923,
      "val_verse_f1": 0.35457834678541605,
      "val_chorus_f1": 0.49044166117336857,
      "val_chorus_rate": 0.8188815861940384,
      "val_max_prob": 0.5583681017160416,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006070709266668187,
      "epoch_time": 51.1553590297699,
      "val_boundary_f1": 0.05695142378559464,
      "val_boundary_precision": 0.09826589595375723,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.025211031361614608,
      "val_avg_segment_overlap": 0.19562932413998596,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.42824161465256105,
      "val_pk_metric": 0.4230313026899027
    },
    {
      "epoch": 4,
      "train_loss": 0.5673398435115814,
      "train_chorus_rate": 0.5058878149837256,
      "train_max_prob": 0.5750976353883743,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5895848721265793,
      "val_macro_f1": 0.5540968977079311,
      "val_verse_f1": 0.6271365266933953,
      "val_chorus_f1": 0.48105726872246696,
      "val_chorus_rate": 0.5376709476113319,
      "val_max_prob": 0.5659133642911911,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005602051022568723,
      "epoch_time": 60.043030977249146,
      "val_boundary_f1": 0.09582689335394126,
      "val_boundary_precision": 0.13901345291479822,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.03228324332513092,
      "val_avg_segment_overlap": 0.2499680144707768,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.4460260240869825,
      "val_pk_metric": 0.43240471645650874
    },
    {
      "epoch": 5,
      "train_loss": 0.5491521090269089,
      "train_chorus_rate": 0.46682246662676335,
      "train_max_prob": 0.6126302897930145,
      "train_conf_over_90": 0.00030595912830904125,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5595213323831558,
      "val_macro_f1": 0.5585676869067843,
      "val_verse_f1": 0.5780809031044215,
      "val_chorus_f1": 0.539054470709147,
      "val_chorus_rate": 0.6565573066473007,
      "val_max_prob": 0.6209725886583328,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000503541652636239,
      "epoch_time": 59.25090312957764,
      "val_boundary_f1": 0.1395348837209302,
      "val_boundary_precision": 0.1450381679389313,
      "val_boundary_recall": 0.13443396226415094,
      "val_complete_segments": 0.04775622653406322,
      "val_avg_segment_overlap": 0.35439386962494834,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.5114523635124448,
      "val_pk_metric": 0.4246447959938084
    },
    {
      "epoch": 6,
      "train_loss": 0.5326125651597977,
      "train_chorus_rate": 0.45292682349681856,
      "train_max_prob": 0.6364284038543702,
      "train_conf_over_90": 0.0053718676790595055,
      "train_conf_over_95": 0.00011918951058760285,
      "val_loss": 0.5297930091619492,
      "val_macro_f1": 0.7070605497160349,
      "val_verse_f1": 0.7922374429223745,
      "val_chorus_f1": 0.6218836565096952,
      "val_chorus_rate": 0.41066448390483856,
      "val_max_prob": 0.639815166592598,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043955704245473903,
      "epoch_time": 52.32903814315796,
      "val_boundary_f1": 0.2806673209028459,
      "val_boundary_precision": 0.24033613445378152,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.1677522754537601,
      "val_avg_segment_overlap": 0.589442378470864,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.4275501268513402,
      "val_pk_metric": 0.3293015553911739
    },
    {
      "epoch": 7,
      "train_loss": 0.5044708654284478,
      "train_chorus_rate": 0.37188313603401185,
      "train_max_prob": 0.6742953538894654,
      "train_conf_over_90": 0.021518046464188957,
      "train_conf_over_95": 0.0010359469015384093,
      "val_loss": 0.5166022330522537,
      "val_macro_f1": 0.6997714369977144,
      "val_verse_f1": 0.7777777777777778,
      "val_chorus_f1": 0.6217650962176509,
      "val_chorus_rate": 0.4409765675663948,
      "val_max_prob": 0.6845157146453857,
      "val_conf_over_90": 0.010587486322037876,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003710477062095281,
      "epoch_time": 107.15403270721436,
      "val_boundary_f1": 0.2657091561938959,
      "val_boundary_precision": 0.2144927536231884,
      "val_boundary_recall": 0.3490566037735849,
      "val_complete_segments": 0.15032099968473245,
      "val_avg_segment_overlap": 0.5961011378638659,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.500418956456138,
      "val_pk_metric": 0.37746504873956255
    },
    {
      "epoch": 8,
      "train_loss": 0.4943875312805176,
      "train_chorus_rate": 0.40152806639671323,
      "train_max_prob": 0.6762101918458938,
      "train_conf_over_90": 0.013988189958035946,
      "train_conf_over_95": 0.00020516340155154466,
      "val_loss": 0.5257958248257637,
      "val_macro_f1": 0.7589795099508607,
      "val_verse_f1": 0.8637452927079767,
      "val_chorus_f1": 0.6542137271937446,
      "val_chorus_rate": 0.2661619856953621,
      "val_max_prob": 0.7086503058671951,
      "val_conf_over_90": 0.008732122310902923,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003010078306387908,
      "epoch_time": 74.85255312919617,
      "val_boundary_f1": 0.3916666666666667,
      "val_boundary_precision": 0.35074626865671643,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.2534743234372079,
      "val_avg_segment_overlap": 0.6432665040155685,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3300418899474378,
      "val_pk_metric": 0.23694103179138115
    },
    {
      "epoch": 9,
      "train_loss": 0.47623037695884707,
      "train_chorus_rate": 0.31074933111667635,
      "train_max_prob": 0.7023592233657837,
      "train_conf_over_90": 0.02773690237663686,
      "train_conf_over_95": 0.001465013882261701,
      "val_loss": 0.5112314224243164,
      "val_macro_f1": 0.7140221208455153,
      "val_verse_f1": 0.7954892966360856,
      "val_chorus_f1": 0.6325549450549449,
      "val_chorus_rate": 0.41612088680267334,
      "val_max_prob": 0.6843731105327606,
      "val_conf_over_90": 0.014788056898396462,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023249849439357977,
      "epoch_time": 133.95215797424316,
      "val_boundary_f1": 0.27669452181987003,
      "val_boundary_precision": 0.22817764165390506,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.15342669210643758,
      "val_avg_segment_overlap": 0.6047585089444811,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.46943582314369453,
      "val_pk_metric": 0.3399285218156917
    },
    {
      "epoch": 10,
      "train_loss": 0.47270784676074984,
      "train_chorus_rate": 0.3364343523979187,
      "train_max_prob": 0.7032080739736557,
      "train_conf_over_90": 0.02623237184016034,
      "train_conf_over_95": 0.0018914841493824497,
      "val_loss": 0.506614126265049,
      "val_macro_f1": 0.7127868315564321,
      "val_verse_f1": 0.7913613575009641,
      "val_chorus_f1": 0.6342123056118999,
      "val_chorus_rate": 0.42686744034290314,
      "val_max_prob": 0.6958252638578415,
      "val_conf_over_90": 0.021308710449375212,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 0.00016851388421207977,
      "epoch_time": 106.08188486099243,
      "val_boundary_f1": 0.32656826568265684,
      "val_boundary_precision": 0.2681818181818182,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.20625548476821012,
      "val_avg_segment_overlap": 0.6195085247910922,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.45758397844380944,
      "val_pk_metric": 0.3301926073727459
    },
    {
      "epoch": 11,
      "train_loss": 0.4800917193293571,
      "train_chorus_rate": 0.35436765402555465,
      "train_max_prob": 0.693712106347084,
      "train_conf_over_90": 0.024186812876723706,
      "train_conf_over_95": 0.0010937494807876647,
      "val_loss": 0.5190838128328323,
      "val_macro_f1": 0.7611112848018937,
      "val_verse_f1": 0.8603158077390248,
      "val_chorus_f1": 0.6619067618647626,
      "val_chorus_rate": 0.28576134145259857,
      "val_max_prob": 0.6746441721916199,
      "val_conf_over_90": 0.00048216007417067885,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011185043459144658,
      "epoch_time": 110.19995188713074,
      "val_boundary_f1": 0.39513677811550146,
      "val_boundary_precision": 0.3463587921847247,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2574876042532458,
      "val_avg_segment_overlap": 0.6596268144720105,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.32852478218944287,
      "val_pk_metric": 0.23721969774224963
    },
    {
      "epoch": 12,
      "train_loss": 0.47560258507728576,
      "train_chorus_rate": 0.3311051234602928,
      "train_max_prob": 0.7013892620801926,
      "train_conf_over_90": 0.021317466162145138,
      "train_conf_over_95": 0.0007961764000356198,
      "val_loss": 0.5080961883068085,
      "val_macro_f1": 0.7511515246007527,
      "val_verse_f1": 0.8420863309352516,
      "val_chorus_f1": 0.6602167182662538,
      "val_chorus_rate": 0.335493303835392,
      "val_max_prob": 0.7067131102085114,
      "val_conf_over_90": 0.015530940727330744,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.498461018150005e-05,
      "epoch_time": 127.05705189704895,
      "val_boundary_f1": 0.3586854460093896,
      "val_boundary_precision": 0.29797191887675506,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.23629285625574067,
      "val_avg_segment_overlap": 0.661783086969085,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.40174629478402646,
      "val_pk_metric": 0.2814069435430852
    },
    {
      "epoch": 13,
      "train_loss": 0.4714047074317932,
      "train_chorus_rate": 0.32440095692873,
      "train_max_prob": 0.7039870023727417,
      "train_conf_over_90": 0.02275763303041458,
      "train_conf_over_95": 0.0006122468243120238,
      "val_loss": 0.5017021223902702,
      "val_macro_f1": 0.7343914412228296,
      "val_verse_f1": 0.8189269746646795,
      "val_chorus_f1": 0.6498559077809799,
      "val_chorus_rate": 0.38259824365377426,
      "val_max_prob": 0.7058465331792831,
      "val_conf_over_90": 0.02075598482042551,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.9964672396131354e-05,
      "epoch_time": 919.6294882297516,
      "val_boundary_f1": 0.34200743494423785,
      "val_boundary_precision": 0.2822085889570552,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.2230763220423878,
      "val_avg_segment_overlap": 0.6399584487980997,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.43251997882656973,
      "val_pk_metric": 0.30579018535010216
    },
    {
      "epoch": 14,
      "train_loss": 0.4623482942581177,
      "train_chorus_rate": 0.32856507375836375,
      "train_max_prob": 0.7168186843395233,
      "train_conf_over_90": 0.030841407598927617,
      "train_conf_over_95": 0.000696812616661191,
      "val_loss": 0.5028984546661377,
      "val_macro_f1": 0.7496248357781169,
      "val_verse_f1": 0.8392114306384518,
      "val_chorus_f1": 0.660038240917782,
      "val_chorus_rate": 0.3430801033973694,
      "val_max_prob": 0.7046478688716888,
      "val_conf_over_90": 0.013877405785024166,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.321160560866818e-06,
      "epoch_time": 104.44701910018921,
      "val_boundary_f1": 0.3719626168224299,
      "val_boundary_precision": 0.3080495356037152,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2525235563544153,
      "val_avg_segment_overlap": 0.6647064602776802,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.39324187290424817,
      "val_pk_metric": 0.27601800081482475
    },
    {
      "epoch": 15,
      "train_loss": 0.46994821578264234,
      "train_chorus_rate": 0.3338694527745247,
      "train_max_prob": 0.7086552262306214,
      "train_conf_over_90": 0.025263851135969163,
      "train_conf_over_95": 0.0008650160394608975,
      "val_loss": 0.502477191388607,
      "val_macro_f1": 0.746796145065552,
      "val_verse_f1": 0.8360268748865081,
      "val_chorus_f1": 0.6575654152445961,
      "val_chorus_rate": 0.3485870435833931,
      "val_max_prob": 0.7009289413690567,
      "val_conf_over_90": 0.013877405785024166,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 103.75396776199341,
      "val_boundary_f1": 0.36380597014925375,
      "val_boundary_precision": 0.30092592592592593,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.24123602279752865,
      "val_avg_segment_overlap": 0.6612761354932306,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39871248711338614,
      "val_pk_metric": 0.28191437990685747
    }
  ]
}