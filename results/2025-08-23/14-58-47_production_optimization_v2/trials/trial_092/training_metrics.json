{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.15483714680482114,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.18135374424857145,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008015491830329894,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "composite",
      "weight_decay": 0.015264940210488848,
      "gradient_clip_norm": 0.30009814876609925,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10313950388276975,
        "ece_after": 0.018182564885419587,
        "improvement": 0.08495693899735017,
        "params": {
          "temperature": 0.5507268176392076
        }
      },
      "platt": {
        "ece_before": 0.10313950388276975,
        "ece_after": 0.018372239219299223,
        "improvement": 0.08476726466347054,
        "params": {
          "A": 1.7232283954055894,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5723644018173217,
      "train_chorus_rate": 0.5091551545832772,
      "train_max_prob": 0.5988431602716446,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5901133567094803,
      "val_macro_f1": 0.3866930507755398,
      "val_verse_f1": 0.2773460848774656,
      "val_chorus_f1": 0.49604001667361397,
      "val_chorus_rate": 0.8784741163253784,
      "val_max_prob": 0.6228287816047668,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007928022228430581,
      "epoch_time": 90.25014519691467,
      "val_boundary_f1": 0.06909090909090909,
      "val_boundary_precision": 0.15079365079365079,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.030840860175430695,
      "val_avg_segment_overlap": 0.17272346042245168,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4122488762723606,
      "val_pk_metric": 0.40580381779596675
    },
    {
      "epoch": 2,
      "train_loss": 0.5453034117817879,
      "train_chorus_rate": 0.4120394483674318,
      "train_max_prob": 0.582934558391571,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5778349488973618,
      "val_macro_f1": 0.6250074981940968,
      "val_verse_f1": 0.7670110438190237,
      "val_chorus_f1": 0.48300395256916995,
      "val_chorus_rate": 0.3226029500365257,
      "val_max_prob": 0.5896142870187759,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007669436264061359,
      "epoch_time": 71.86644411087036,
      "val_boundary_f1": 0.2670025188916877,
      "val_boundary_precision": 0.2864864864864865,
      "val_boundary_recall": 0.25,
      "val_complete_segments": 0.11217610012678941,
      "val_avg_segment_overlap": 0.40638943224766433,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.39616468886994644,
      "val_pk_metric": 0.3759788825821836
    },
    {
      "epoch": 3,
      "train_loss": 0.5328202337026596,
      "train_chorus_rate": 0.40874967332929374,
      "train_max_prob": 0.6186914801597595,
      "train_conf_over_90": 0.0007030104025034234,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5655933022499084,
      "val_macro_f1": 0.4374515303964843,
      "val_verse_f1": 0.37127748399666016,
      "val_chorus_f1": 0.5036255767963085,
      "val_chorus_rate": 0.8180297911167145,
      "val_max_prob": 0.6598938852548599,
      "val_conf_over_90": 0.004040742409415543,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007251035384698291,
      "epoch_time": 63.508806228637695,
      "val_boundary_f1": 0.050746268656716415,
      "val_boundary_precision": 0.06910569105691057,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.009377418245392795,
      "val_avg_segment_overlap": 0.23410165768158364,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.43080954058966126,
      "val_pk_metric": 0.3911877044523288
    },
    {
      "epoch": 4,
      "train_loss": 0.5223232075572014,
      "train_chorus_rate": 0.46326802894473074,
      "train_max_prob": 0.6543545693159103,
      "train_conf_over_90": 0.002589215518673882,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5326706394553185,
      "val_macro_f1": 0.7170439822110165,
      "val_verse_f1": 0.8143274853801169,
      "val_chorus_f1": 0.6197604790419161,
      "val_chorus_rate": 0.35797278583049774,
      "val_max_prob": 0.6954861432313919,
      "val_conf_over_90": 0.00707090477226302,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006691105716479711,
      "epoch_time": 72.54892897605896,
      "val_boundary_f1": 0.37921077959576516,
      "val_boundary_precision": 0.3203252032520325,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.21755258894707463,
      "val_avg_segment_overlap": 0.5991660062968146,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3875741020244198,
      "val_pk_metric": 0.28832351571650544
    },
    {
      "epoch": 5,
      "train_loss": 0.48925165832042694,
      "train_chorus_rate": 0.3796115040779114,
      "train_max_prob": 0.6832572758197785,
      "train_conf_over_90": 0.017079739831387997,
      "train_conf_over_95": 0.000540979445213452,
      "val_loss": 0.508488342165947,
      "val_macro_f1": 0.6454268962247912,
      "val_verse_f1": 0.688007016005262,
      "val_chorus_f1": 0.6028467764443204,
      "val_chorus_rate": 0.5806771665811539,
      "val_max_prob": 0.6524874269962311,
      "val_conf_over_90": 0.009271320945117623,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006014118872747421,
      "epoch_time": 63.02532505989075,
      "val_boundary_f1": 0.22157434402332363,
      "val_boundary_precision": 0.1884297520661157,
      "val_boundary_recall": 0.2688679245283019,
      "val_complete_segments": 0.11069586098748346,
      "val_avg_segment_overlap": 0.5329655221143285,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.507284646637333,
      "val_pk_metric": 0.405398393944753
    },
    {
      "epoch": 6,
      "train_loss": 0.47769412845373155,
      "train_chorus_rate": 0.34278200566768646,
      "train_max_prob": 0.6764402598142624,
      "train_conf_over_90": 0.01391205055406317,
      "train_conf_over_95": 0.0016794235183624552,
      "val_loss": 0.5642545595765114,
      "val_macro_f1": 0.7179123498004734,
      "val_verse_f1": 0.821755519655358,
      "val_chorus_f1": 0.6140691799455888,
      "val_chorus_rate": 0.33333301544189453,
      "val_max_prob": 0.7756988853216171,
      "val_conf_over_90": 0.1506005860865116,
      "val_conf_over_95": 0.009225586778484285,
      "learning_rate": 0.0005249662427115818,
      "epoch_time": 73.69572305679321,
      "val_boundary_f1": 0.36188436830835113,
      "val_boundary_precision": 0.33137254901960783,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.23070188996753152,
      "val_avg_segment_overlap": 0.5816860838422039,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.3444234786109783,
      "val_pk_metric": 0.2758356908779418
    },
    {
      "epoch": 7,
      "train_loss": 0.4922921180725098,
      "train_chorus_rate": 0.3390675872564316,
      "train_max_prob": 0.7045671880245209,
      "train_conf_over_90": 0.046233038237551226,
      "train_conf_over_95": 0.003114119291421957,
      "val_loss": 0.5017339214682579,
      "val_macro_f1": 0.7451236569735518,
      "val_verse_f1": 0.8328156404165906,
      "val_chorus_f1": 0.6574316735305129,
      "val_chorus_rate": 0.35689210146665573,
      "val_max_prob": 0.7155821919441223,
      "val_conf_over_90": 0.027198155410587788,
      "val_conf_over_95": 0.0009250693838112056,
      "learning_rate": 0.00044311467945280173,
      "epoch_time": 69.85403084754944,
      "val_boundary_f1": 0.4109055501460565,
      "val_boundary_precision": 0.34991708126036486,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3046748479277641,
      "val_avg_segment_overlap": 0.651580665299594,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3638558414196963,
      "val_pk_metric": 0.26158206345387663
    },
    {
      "epoch": 8,
      "train_loss": 0.4638360381126404,
      "train_chorus_rate": 0.345292529463768,
      "train_max_prob": 0.6877251088619232,
      "train_conf_over_90": 0.023483533394755795,
      "train_conf_over_95": 0.0008989290188765153,
      "val_loss": 0.4911246821284294,
      "val_macro_f1": 0.753261525274117,
      "val_verse_f1": 0.8321548195013025,
      "val_chorus_f1": 0.6743682310469314,
      "val_chorus_rate": 0.38126491755247116,
      "val_max_prob": 0.6467478722333908,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00035943450358018797,
      "epoch_time": 76.34600281715393,
      "val_boundary_f1": 0.4064885496183206,
      "val_boundary_precision": 0.34134615384615385,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.3022864232964975,
      "val_avg_segment_overlap": 0.6687952483389945,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.3674361320829179,
      "val_pk_metric": 0.2668982790832012
    },
    {
      "epoch": 9,
      "train_loss": 0.47795170545578003,
      "train_chorus_rate": 0.3586163081228733,
      "train_max_prob": 0.6917584121227265,
      "train_conf_over_90": 0.01665765034267679,
      "train_conf_over_95": 0.000141132902354002,
      "val_loss": 0.4947422072291374,
      "val_macro_f1": 0.7537003141405316,
      "val_verse_f1": 0.8420101229211859,
      "val_chorus_f1": 0.6653905053598774,
      "val_chorus_rate": 0.3425806984305382,
      "val_max_prob": 0.6646024584770203,
      "val_conf_over_90": 0.0009348820603918284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00027758294032140783,
      "epoch_time": 55.7683539390564,
      "val_boundary_f1": 0.4147465437788018,
      "val_boundary_precision": 0.340393343419062,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.32795887464498286,
      "val_avg_segment_overlap": 0.6686372784689907,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3827385071944558,
      "val_pk_metric": 0.2654738737744989
    },
    {
      "epoch": 10,
      "train_loss": 0.46813124865293504,
      "train_chorus_rate": 0.3652672581374645,
      "train_max_prob": 0.6955258876085282,
      "train_conf_over_90": 0.027313635585596786,
      "train_conf_over_95": 0.0005826286127557978,
      "val_loss": 0.4867604896426201,
      "val_macro_f1": 0.7635581083961311,
      "val_verse_f1": 0.8486818345973276,
      "val_chorus_f1": 0.6784343821949347,
      "val_chorus_rate": 0.3411535248160362,
      "val_max_prob": 0.6912049353122711,
      "val_conf_over_90": 0.004798955749720335,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020113729575824748,
      "epoch_time": 56.17208290100098,
      "val_boundary_f1": 0.4347826086956523,
      "val_boundary_precision": 0.3627760252365931,
      "val_boundary_recall": 0.5424528301886793,
      "val_complete_segments": 0.3455543181418049,
      "val_avg_segment_overlap": 0.6868664660712399,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.3512594256787796,
      "val_pk_metric": 0.25021507991656367
    },
    {
      "epoch": 11,
      "train_loss": 0.46132459342479704,
      "train_chorus_rate": 0.3356519117951393,
      "train_max_prob": 0.6969549596309662,
      "train_conf_over_90": 0.009502413892187178,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48416174203157425,
      "val_macro_f1": 0.7516443514241415,
      "val_verse_f1": 0.8294689603590127,
      "val_chorus_f1": 0.6738197424892703,
      "val_chorus_rate": 0.3877449110150337,
      "val_max_prob": 0.7102463841438293,
      "val_conf_over_90": 0.017892133560962975,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013343861138501845,
      "epoch_time": 70.24311995506287,
      "val_boundary_f1": 0.4087452471482889,
      "val_boundary_precision": 0.34235668789808915,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.30924481139221327,
      "val_avg_segment_overlap": 0.677039419640539,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3750398691283052,
      "val_pk_metric": 0.27062268210066565
    },
    {
      "epoch": 12,
      "train_loss": 0.46412293612957,
      "train_chorus_rate": 0.384913769364357,
      "train_max_prob": 0.7038520932197571,
      "train_conf_over_90": 0.016923409351147712,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48138327896595,
      "val_macro_f1": 0.7540024284939875,
      "val_verse_f1": 0.8342899463062395,
      "val_chorus_f1": 0.6737149106817353,
      "val_chorus_rate": 0.37513526529073715,
      "val_max_prob": 0.6977484226226807,
      "val_conf_over_90": 0.010477030999027193,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.744564456316036e-05,
      "epoch_time": 61.06367492675781,
      "val_boundary_f1": 0.4227799227799228,
      "val_boundary_precision": 0.35784313725490197,
      "val_boundary_recall": 0.5165094339622641,
      "val_complete_segments": 0.32285285399018165,
      "val_avg_segment_overlap": 0.6772530724251203,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.3646725659415283,
      "val_pk_metric": 0.26473731086966795
    },
    {
      "epoch": 13,
      "train_loss": 0.4595219627022743,
      "train_chorus_rate": 0.3715086102485657,
      "train_max_prob": 0.7034579128026962,
      "train_conf_over_90": 0.02776056150905788,
      "train_conf_over_95": 0.00014487477601505817,
      "val_loss": 0.4793360233306885,
      "val_macro_f1": 0.7514166966996203,
      "val_verse_f1": 0.8252224957394432,
      "val_chorus_f1": 0.6776108976597974,
      "val_chorus_rate": 0.40408360213041306,
      "val_max_prob": 0.7182544320821762,
      "val_conf_over_90": 0.04480562265962362,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.560555662685338e-05,
      "epoch_time": 64.42889904975891,
      "val_boundary_f1": 0.4096618357487923,
      "val_boundary_precision": 0.3469721767594108,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.30984984188854814,
      "val_avg_segment_overlap": 0.6734647906627123,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.38341854127124947,
      "val_pk_metric": 0.27060053884334867
    }
  ]
}