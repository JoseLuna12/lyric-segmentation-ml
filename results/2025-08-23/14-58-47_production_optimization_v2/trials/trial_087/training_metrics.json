{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.18846526869816876,
      "layer_dropout": 0.2146160531549492,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.23372379035592697,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3517698,
      "lstm_params": 2990080,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009468786539653119,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01759056186308215,
      "gradient_clip_norm": 0.4270817695044167,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07723279546192444,
        "ece_after": 0.018494361085718426,
        "improvement": 0.05873843437620601,
        "params": {
          "temperature": 0.6264539142879214
        }
      },
      "platt": {
        "ece_before": 0.07723279546192444,
        "ece_after": 0.025307764575500175,
        "improvement": 0.051925030886424264,
        "params": {
          "A": 1.4999998213641785,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5952226132154464,
      "train_chorus_rate": 0.48784544062800705,
      "train_max_prob": 0.5895940512418747,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5894130617380142,
      "val_macro_f1": 0.43788642531659294,
      "val_verse_f1": 0.40696465696465695,
      "val_chorus_f1": 0.4688081936685289,
      "val_chorus_rate": 0.7555400878190994,
      "val_max_prob": 0.5414925068616867,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009365437949634016,
      "epoch_time": 165.9451630115509,
      "val_boundary_f1": 0.05839416058394161,
      "val_boundary_precision": 0.12903225806451613,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.02526279119598314,
      "val_avg_segment_overlap": 0.1907843510446777,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4254501035275358,
      "val_pk_metric": 0.4213659006717879
    },
    {
      "epoch": 2,
      "train_loss": 0.5544200584292411,
      "train_chorus_rate": 0.5041803235188127,
      "train_max_prob": 0.5630900442600251,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6004941314458847,
      "val_macro_f1": 0.5250342635523285,
      "val_verse_f1": 0.8012422360248448,
      "val_chorus_f1": 0.24882629107981222,
      "val_chorus_rate": 0.11928515415638685,
      "val_max_prob": 0.5715979635715485,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009059909008882099,
      "epoch_time": 155.68424606323242,
      "val_boundary_f1": 0.09594095940959409,
      "val_boundary_precision": 0.22033898305084745,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.07385096238489663,
      "val_avg_segment_overlap": 0.23245880874572622,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.28325120664951325,
      "val_pk_metric": 0.28442675703508524
    },
    {
      "epoch": 3,
      "train_loss": 0.5654000133275986,
      "train_chorus_rate": 0.5124943435192109,
      "train_max_prob": 0.5840299099683761,
      "train_conf_over_90": 0.0008557111024856568,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5821945071220398,
      "val_macro_f1": 0.4179808471103912,
      "val_verse_f1": 0.3525179856115107,
      "val_chorus_f1": 0.4834437086092716,
      "val_chorus_rate": 0.8127555102109909,
      "val_max_prob": 0.5724996030330658,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008565552798198747,
      "epoch_time": 80.52536988258362,
      "val_boundary_f1": 0.0510948905109489,
      "val_boundary_precision": 0.11290322580645161,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.017847248096452762,
      "val_avg_segment_overlap": 0.1848226875806811,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4361682893378688,
      "val_pk_metric": 0.43469528798335844
    },
    {
      "epoch": 4,
      "train_loss": 0.5537269368767739,
      "train_chorus_rate": 0.5266712637385353,
      "train_max_prob": 0.6035880476236344,
      "train_conf_over_90": 5.1519833505153656e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5812737196683884,
      "val_macro_f1": 0.5652736889921106,
      "val_verse_f1": 0.6201482773658963,
      "val_chorus_f1": 0.5103991006183249,
      "val_chorus_rate": 0.5757802352309227,
      "val_max_prob": 0.5514522343873978,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007903975056175107,
      "epoch_time": 181.60219168663025,
      "val_boundary_f1": 0.14435695538057744,
      "val_boundary_precision": 0.16272189349112426,
      "val_boundary_recall": 0.12971698113207547,
      "val_complete_segments": 0.045723706208859974,
      "val_avg_segment_overlap": 0.33376230492631986,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.13636363636363635,
      "val_window_diff": 0.4837042467563982,
      "val_pk_metric": 0.42579417671699904
    },
    {
      "epoch": 5,
      "train_loss": 0.5495035246014595,
      "train_chorus_rate": 0.4680803583934903,
      "train_max_prob": 0.6239073514938355,
      "train_conf_over_90": 3.10945266392082e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5648246705532074,
      "val_macro_f1": 0.4881084337589576,
      "val_verse_f1": 0.46736626567698997,
      "val_chorus_f1": 0.5088506018409252,
      "val_chorus_rate": 0.7410780936479568,
      "val_max_prob": 0.584557518362999,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007104089904739838,
      "epoch_time": 171.80700635910034,
      "val_boundary_f1": 0.12112676056338026,
      "val_boundary_precision": 0.15034965034965034,
      "val_boundary_recall": 0.10141509433962265,
      "val_complete_segments": 0.036762260290892315,
      "val_avg_segment_overlap": 0.28729492736103623,
      "val_verse_to_chorus_acc": 0.10619469026548672,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.48479364871701247,
      "val_pk_metric": 0.4413711061484581
    },
    {
      "epoch": 6,
      "train_loss": 0.5156232044100761,
      "train_chorus_rate": 0.41467595733702184,
      "train_max_prob": 0.6575054079294205,
      "train_conf_over_90": 0.0032127075450262056,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5455936044454575,
      "val_macro_f1": 0.7283341116819,
      "val_verse_f1": 0.8412836079791847,
      "val_chorus_f1": 0.6153846153846154,
      "val_chorus_rate": 0.28544778376817703,
      "val_max_prob": 0.6487313807010651,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006200856163285467,
      "epoch_time": 101.15165400505066,
      "val_boundary_f1": 0.36958614051973054,
      "val_boundary_precision": 0.3121951219512195,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24058423102696697,
      "val_avg_segment_overlap": 0.617336877730806,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.33662822270013887,
      "val_pk_metric": 0.2551699766080946
    },
    {
      "epoch": 7,
      "train_loss": 0.5094072967767715,
      "train_chorus_rate": 0.3816516578197479,
      "train_max_prob": 0.6611405044794083,
      "train_conf_over_90": 0.0012219421711051836,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5288169384002686,
      "val_macro_f1": 0.6216979930043676,
      "val_verse_f1": 0.6543070314266335,
      "val_chorus_f1": 0.5890889545821015,
      "val_chorus_rate": 0.614751324057579,
      "val_max_prob": 0.6986128985881805,
      "val_conf_over_90": 0.03122575208544731,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005233749480509913,
      "epoch_time": 98.32571697235107,
      "val_boundary_f1": 0.17522658610271902,
      "val_boundary_precision": 0.15289982425307558,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.07252540565106842,
      "val_avg_segment_overlap": 0.4797935641993575,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.520062626479368,
      "val_pk_metric": 0.418698519834924
    },
    {
      "epoch": 8,
      "train_loss": 0.49737886637449263,
      "train_chorus_rate": 0.3968489818274975,
      "train_max_prob": 0.6822916179895401,
      "train_conf_over_90": 0.0157021387363784,
      "train_conf_over_95": 0.0001285347039811313,
      "val_loss": 0.5045036822557449,
      "val_macro_f1": 0.7167692878572383,
      "val_verse_f1": 0.7933500869901412,
      "val_chorus_f1": 0.6401884887243353,
      "val_chorus_rate": 0.4304702430963516,
      "val_max_prob": 0.6670379340648651,
      "val_conf_over_90": 0.009718890534713864,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042450370591432077,
      "epoch_time": 124.3987979888916,
      "val_boundary_f1": 0.31401869158878504,
      "val_boundary_precision": 0.26006191950464397,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.19450380163529687,
      "val_avg_segment_overlap": 0.6202658020685246,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.42293886730892694,
      "val_pk_metric": 0.3296788390026509
    },
    {
      "epoch": 9,
      "train_loss": 0.4879336550831795,
      "train_chorus_rate": 0.3968080922961235,
      "train_max_prob": 0.6877649754285813,
      "train_conf_over_90": 0.016937434452120214,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5050247311592102,
      "val_macro_f1": 0.7404758521862327,
      "val_verse_f1": 0.8260066494274104,
      "val_chorus_f1": 0.654945054945055,
      "val_chorus_rate": 0.3716370090842247,
      "val_max_prob": 0.7013516873121262,
      "val_conf_over_90": 0.005563050974160433,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032779303763676523,
      "epoch_time": 117.77976322174072,
      "val_boundary_f1": 0.3733862959285005,
      "val_boundary_precision": 0.32246998284734135,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.24331131237281822,
      "val_avg_segment_overlap": 0.6243112486001896,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.37697527744165954,
      "val_pk_metric": 0.28064053968983355
    },
    {
      "epoch": 10,
      "train_loss": 0.4702826917171478,
      "train_chorus_rate": 0.3620807006955147,
      "train_max_prob": 0.7055278301239014,
      "train_conf_over_90": 0.019206889544148,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49989035725593567,
      "val_macro_f1": 0.7431229327010136,
      "val_verse_f1": 0.8241224794622853,
      "val_chorus_f1": 0.6621233859397417,
      "val_chorus_rate": 0.3857971578836441,
      "val_max_prob": 0.6711753606796265,
      "val_conf_over_90": 0.0014425310073420405,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002374696634913281,
      "epoch_time": 122.71553206443787,
      "val_boundary_f1": 0.3585271317829457,
      "val_boundary_precision": 0.3042763157894737,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2280469550750569,
      "val_avg_segment_overlap": 0.6338296149728969,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.3934850679241765,
      "val_pk_metric": 0.2849031556613696
    },
    {
      "epoch": 11,
      "train_loss": 0.46201605200767515,
      "train_chorus_rate": 0.3618745721876621,
      "train_max_prob": 0.7093943983316422,
      "train_conf_over_90": 0.02472171870758757,
      "train_conf_over_95": 0.00012037281994707883,
      "val_loss": 0.5040702000260353,
      "val_macro_f1": 0.7517926938763897,
      "val_verse_f1": 0.8379216043755697,
      "val_chorus_f1": 0.6656637833772096,
      "val_chorus_rate": 0.35437703132629395,
      "val_max_prob": 0.7311755418777466,
      "val_conf_over_90": 0.05408588331192732,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001574811483478012,
      "epoch_time": 117.24258303642273,
      "val_boundary_f1": 0.38549618320610685,
      "val_boundary_precision": 0.32371794871794873,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2661221989297281,
      "val_avg_segment_overlap": 0.6422473275544837,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3908486952247566,
      "val_pk_metric": 0.2693249333283601
    },
    {
      "epoch": 12,
      "train_loss": 0.46015416383743285,
      "train_chorus_rate": 0.3506481200456619,
      "train_max_prob": 0.7098435014486313,
      "train_conf_over_90": 0.03299952943343669,
      "train_conf_over_95": 0.0001395801460603252,
      "val_loss": 0.49587249755859375,
      "val_macro_f1": 0.731144917798483,
      "val_verse_f1": 0.8089887640449439,
      "val_chorus_f1": 0.6533010715520221,
      "val_chorus_rate": 0.41149817407131195,
      "val_max_prob": 0.7249718904495239,
      "val_conf_over_90": 0.07094256952404976,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 9.132337414543719e-05,
      "epoch_time": 126.62460207939148,
      "val_boundary_f1": 0.3320754716981132,
      "val_boundary_precision": 0.27672955974842767,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.20280105321197578,
      "val_avg_segment_overlap": 0.6246556464494145,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.420686528331843,
      "val_pk_metric": 0.3041132376422744
    },
    {
      "epoch": 13,
      "train_loss": 0.44960565119981766,
      "train_chorus_rate": 0.3350061632692814,
      "train_max_prob": 0.7293716937303543,
      "train_conf_over_90": 0.04905587853863835,
      "train_conf_over_95": 0.001226732155191712,
      "val_loss": 0.49559320509433746,
      "val_macro_f1": 0.7471047984131978,
      "val_verse_f1": 0.8329972502291475,
      "val_chorus_f1": 0.661212346597248,
      "val_chorus_rate": 0.3614005297422409,
      "val_max_prob": 0.6989698708057404,
      "val_conf_over_90": 0.02503240341320634,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.188775307710181e-05,
      "epoch_time": 148.75107192993164,
      "val_boundary_f1": 0.3878550440744368,
      "val_boundary_precision": 0.3316582914572864,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.24308997681214015,
      "val_avg_segment_overlap": 0.642987679784255,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.3835788421940857,
      "val_pk_metric": 0.27186224707428064
    },
    {
      "epoch": 14,
      "train_loss": 0.44873146861791613,
      "train_chorus_rate": 0.3301190331578255,
      "train_max_prob": 0.7210083097219467,
      "train_conf_over_90": 0.03476314791478217,
      "train_conf_over_95": 3.48918343661353e-05,
      "val_loss": 0.4990440830588341,
      "val_macro_f1": 0.7466450747692027,
      "val_verse_f1": 0.8325692279479185,
      "val_chorus_f1": 0.6607209215904869,
      "val_chorus_rate": 0.361663393676281,
      "val_max_prob": 0.7259675115346909,
      "val_conf_over_90": 0.05645847413688898,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1334859001910224e-05,
      "epoch_time": 107.12733578681946,
      "val_boundary_f1": 0.3846153846153846,
      "val_boundary_precision": 0.3305084745762712,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.23728598315024613,
      "val_avg_segment_overlap": 0.6297027846269805,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.38660289289471833,
      "val_pk_metric": 0.2754623314646608
    },
    {
      "epoch": 15,
      "train_loss": 0.44397556930780413,
      "train_chorus_rate": 0.321994686871767,
      "train_max_prob": 0.7254046231508255,
      "train_conf_over_90": 0.04435121163260192,
      "train_conf_over_95": 0.00021796606306452305,
      "val_loss": 0.49585143476724625,
      "val_macro_f1": 0.7472951303729278,
      "val_verse_f1": 0.8328747018895616,
      "val_chorus_f1": 0.6617155588562942,
      "val_chorus_rate": 0.3621765673160553,
      "val_max_prob": 0.7123230397701263,
      "val_conf_over_90": 0.04341933224350214,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 171.92049312591553,
      "val_boundary_f1": 0.38085742771684944,
      "val_boundary_precision": 0.3298791018998273,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.23368667864956305,
      "val_avg_segment_overlap": 0.631595029706091,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.3744147770041076,
      "val_pk_metric": 0.27411517725226137
    }
  ]
}