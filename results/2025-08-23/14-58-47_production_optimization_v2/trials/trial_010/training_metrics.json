{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.20753313636115833,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0005117016497617105,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.024646043909594528,
      "gradient_clip_norm": 0.6913246654073905,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07920571274630915,
        "ece_after": 0.020689699030344046,
        "improvement": 0.058516013715965105,
        "params": {
          "temperature": 0.6286703618669199
        }
      },
      "platt": {
        "ece_before": 0.07920571274630915,
        "ece_after": 0.021533711193118466,
        "improvement": 0.05767200155319069,
        "params": {
          "A": 1.4910616302655677,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5292881548404693,
      "train_chorus_rate": 0.33940537422313355,
      "train_max_prob": 0.5407690376043319,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5575514286756516,
      "val_macro_f1": 0.5860219314985142,
      "val_verse_f1": 0.775118004045853,
      "val_chorus_f1": 0.3969258589511754,
      "val_chorus_rate": 0.24379778653383255,
      "val_max_prob": 0.5629479289054871,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000506121621583462,
      "epoch_time": 408.06810426712036,
      "val_boundary_f1": 0.15886524822695036,
      "val_boundary_precision": 0.199288256227758,
      "val_boundary_recall": 0.1320754716981132,
      "val_complete_segments": 0.025459833413173816,
      "val_avg_segment_overlap": 0.2844335363227327,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.42637860162087265,
      "val_pk_metric": 0.4133056971279313
    },
    {
      "epoch": 2,
      "train_loss": 0.5292759016156197,
      "train_chorus_rate": 0.37131434828042986,
      "train_max_prob": 0.5613047838211059,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5426327586174011,
      "val_macro_f1": 0.6272133266317226,
      "val_verse_f1": 0.7912687585266029,
      "val_chorus_f1": 0.46315789473684216,
      "val_chorus_rate": 0.26118582487106323,
      "val_max_prob": 0.5658474862575531,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004896254110560518,
      "epoch_time": 6906.211376905441,
      "val_boundary_f1": 0.2685589519650655,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.29009433962264153,
      "val_complete_segments": 0.10771197648185984,
      "val_avg_segment_overlap": 0.4017542336399958,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.21717171717171718,
      "val_window_diff": 0.41321353176297526,
      "val_pk_metric": 0.3550608315196858
    },
    {
      "epoch": 3,
      "train_loss": 0.5031582444906235,
      "train_chorus_rate": 0.3947008304297924,
      "train_max_prob": 0.5816337317228317,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5171763896942139,
      "val_macro_f1": 0.5947183249889759,
      "val_verse_f1": 0.6362218756961461,
      "val_chorus_f1": 0.5532147742818058,
      "val_chorus_rate": 0.5984340310096741,
      "val_max_prob": 0.5969408005475998,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00046293398173712834,
      "epoch_time": 182.0836741924286,
      "val_boundary_f1": 0.20335820895522388,
      "val_boundary_precision": 0.16820987654320987,
      "val_boundary_recall": 0.25707547169811323,
      "val_complete_segments": 0.0806077191416534,
      "val_avg_segment_overlap": 0.4270290785503125,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.49061666772703494,
      "val_pk_metric": 0.41268062759913154
    },
    {
      "epoch": 4,
      "train_loss": 0.48550324589014054,
      "train_chorus_rate": 0.369705218821764,
      "train_max_prob": 0.6202417850494385,
      "train_conf_over_90": 0.00012644933012779803,
      "train_conf_over_95": 0.0,
      "val_loss": 0.51722202450037,
      "val_macro_f1": 0.6830144730537578,
      "val_verse_f1": 0.8196327441221898,
      "val_chorus_f1": 0.5463962019853259,
      "val_chorus_rate": 0.2705033980309963,
      "val_max_prob": 0.6302977204322815,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042721387716761655,
      "epoch_time": 194.23345303535461,
      "val_boundary_f1": 0.3320825515947467,
      "val_boundary_precision": 0.2757009345794392,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.19488498876091664,
      "val_avg_segment_overlap": 0.545759793190771,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.41386876767373126,
      "val_pk_metric": 0.31921870242949224
    },
    {
      "epoch": 5,
      "train_loss": 0.46373810768127444,
      "train_chorus_rate": 0.3303400881588459,
      "train_max_prob": 0.6401225686073303,
      "train_conf_over_90": 0.0015246083115926013,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4898989126086235,
      "val_macro_f1": 0.6942125949354272,
      "val_verse_f1": 0.7868049010367577,
      "val_chorus_f1": 0.6016202888340966,
      "val_chorus_rate": 0.3982560336589813,
      "val_max_prob": 0.6462337970733643,
      "val_conf_over_90": 0.0025323261215817183,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003840262373212829,
      "epoch_time": 1167.7935781478882,
      "val_boundary_f1": 0.3274021352313167,
      "val_boundary_precision": 0.26285714285714284,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.19811608874440262,
      "val_avg_segment_overlap": 0.5884620996052434,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4310299426624119,
      "val_pk_metric": 0.33373189822253785
    },
    {
      "epoch": 6,
      "train_loss": 0.4494228005409241,
      "train_chorus_rate": 0.3546206563711166,
      "train_max_prob": 0.6633713036775589,
      "train_conf_over_90": 0.007517656497657299,
      "train_conf_over_95": 9.598856267984956e-05,
      "val_loss": 0.48034198582172394,
      "val_macro_f1": 0.6693697968231435,
      "val_verse_f1": 0.7279933249895704,
      "val_chorus_f1": 0.6107462686567166,
      "val_chorus_rate": 0.5236812978982925,
      "val_max_prob": 0.6496719270944595,
      "val_conf_over_90": 0.005331437103450298,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003352585692967007,
      "epoch_time": 195.66494512557983,
      "val_boundary_f1": 0.2508532423208191,
      "val_boundary_precision": 0.196524064171123,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.10782139888714651,
      "val_avg_segment_overlap": 0.5438943897490982,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4881846033032476,
      "val_pk_metric": 0.3732816023568237
    },
    {
      "epoch": 7,
      "train_loss": 0.45149950832128527,
      "train_chorus_rate": 0.3931337743997574,
      "train_max_prob": 0.671832075715065,
      "train_conf_over_90": 0.0156771823996678,
      "train_conf_over_95": 0.00023003870737738907,
      "val_loss": 0.4805038794875145,
      "val_macro_f1": 0.713460705851815,
      "val_verse_f1": 0.8075429839156959,
      "val_chorus_f1": 0.6193784277879342,
      "val_chorus_rate": 0.3726987764239311,
      "val_max_prob": 0.6668334156274796,
      "val_conf_over_90": 0.009657519636675715,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0002830422541997788,
      "epoch_time": 736.1824917793274,
      "val_boundary_f1": 0.3402777777777778,
      "val_boundary_precision": 0.2692307692307692,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.22537294717835546,
      "val_avg_segment_overlap": 0.6126771373922623,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.44460233315422926,
      "val_pk_metric": 0.32655212738973527
    },
    {
      "epoch": 8,
      "train_loss": 0.4445293486118317,
      "train_chorus_rate": 0.3727592431008816,
      "train_max_prob": 0.6825592070817947,
      "train_conf_over_90": 0.022347137751057743,
      "train_conf_over_95": 0.0004374128053314053,
      "val_loss": 0.47447311133146286,
      "val_macro_f1": 0.7208420830589537,
      "val_verse_f1": 0.8125693160813309,
      "val_chorus_f1": 0.6291148500365764,
      "val_chorus_rate": 0.37266071885824203,
      "val_max_prob": 0.685504600405693,
      "val_conf_over_90": 0.018342107068747282,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00022965939556193182,
      "epoch_time": 281.1693341732025,
      "val_boundary_f1": 0.34934497816593885,
      "val_boundary_precision": 0.27739251040221913,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2425367061501738,
      "val_avg_segment_overlap": 0.6073929241877764,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4339996348998041,
      "val_pk_metric": 0.31487713769209114
    },
    {
      "epoch": 9,
      "train_loss": 0.44234358221292497,
      "train_chorus_rate": 0.3548765778541565,
      "train_max_prob": 0.6872318387031555,
      "train_conf_over_90": 0.022885205782949926,
      "train_conf_over_95": 0.0005327330203726887,
      "val_loss": 0.46162205189466476,
      "val_macro_f1": 0.7177481316600036,
      "val_verse_f1": 0.7942028985507247,
      "val_chorus_f1": 0.6412933647692826,
      "val_chorus_rate": 0.4302312135696411,
      "val_max_prob": 0.6798600554466248,
      "val_conf_over_90": 0.017703195102512836,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.00017744308046500985,
      "epoch_time": 1076.247740983963,
      "val_boundary_f1": 0.3278969957081545,
      "val_boundary_precision": 0.25775978407557354,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.20040831241785645,
      "val_avg_segment_overlap": 0.6021786212366791,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.454102092123527,
      "val_pk_metric": 0.32863218432897157
    },
    {
      "epoch": 10,
      "train_loss": 0.44409735649824145,
      "train_chorus_rate": 0.3922504723072052,
      "train_max_prob": 0.6902639150619507,
      "train_conf_over_90": 0.02978175166063011,
      "train_conf_over_95": 0.0015722941723652184,
      "val_loss": 0.46703168749809265,
      "val_macro_f1": 0.7290462954871779,
      "val_verse_f1": 0.8135529764133282,
      "val_chorus_f1": 0.6445396145610277,
      "val_chorus_rate": 0.3892868608236313,
      "val_max_prob": 0.6823454052209854,
      "val_conf_over_90": 0.01890368014574051,
      "val_conf_over_95": 0.001166149420896545,
      "learning_rate": 0.00012867541244042767,
      "epoch_time": 231.315190076828,
      "val_boundary_f1": 0.3324584426946632,
      "val_boundary_precision": 0.26425591098748263,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.21458061227414355,
      "val_avg_segment_overlap": 0.6189355285144511,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4547507144921665,
      "val_pk_metric": 0.3240970509113582
    },
    {
      "epoch": 11,
      "train_loss": 0.44759640097618103,
      "train_chorus_rate": 0.3754700630903244,
      "train_max_prob": 0.6869814455509186,
      "train_conf_over_90": 0.03130828151479363,
      "train_conf_over_95": 0.0023529400117695332,
      "val_loss": 0.4633370414376259,
      "val_macro_f1": 0.7363938287244318,
      "val_verse_f1": 0.8205510052122115,
      "val_chorus_f1": 0.6522366522366523,
      "val_chorus_rate": 0.38206540793180466,
      "val_max_prob": 0.6857783645391464,
      "val_conf_over_90": 0.02122565871104598,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 8.548777259409402e-05,
      "epoch_time": 4821.899913072586,
      "val_boundary_f1": 0.3460869565217391,
      "val_boundary_precision": 0.2741046831955923,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.24241471057483782,
      "val_avg_segment_overlap": 0.6213275190552892,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4381668879111715,
      "val_pk_metric": 0.31073716316434147
    },
    {
      "epoch": 12,
      "train_loss": 0.43116944581270217,
      "train_chorus_rate": 0.3560122147202492,
      "train_max_prob": 0.691165080666542,
      "train_conf_over_90": 0.030282055540010334,
      "train_conf_over_95": 0.001844666973920539,
      "val_loss": 0.4615055248141289,
      "val_macro_f1": 0.7304797127066606,
      "val_verse_f1": 0.8116270290675727,
      "val_chorus_f1": 0.6493323963457485,
      "val_chorus_rate": 0.40005991607904434,
      "val_max_prob": 0.6830724030733109,
      "val_conf_over_90": 0.021155383670702577,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 4.9767668024582204e-05,
      "epoch_time": 202.98549699783325,
      "val_boundary_f1": 0.3382997370727432,
      "val_boundary_precision": 0.2691771269177127,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.21852125189877047,
      "val_avg_segment_overlap": 0.6172572968344944,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.44806804263453226,
      "val_pk_metric": 0.31692688658888224
    },
    {
      "epoch": 13,
      "train_loss": 0.425746750831604,
      "train_chorus_rate": 0.34472124129533765,
      "train_max_prob": 0.6960115939378738,
      "train_conf_over_90": 0.03255416764877737,
      "train_conf_over_95": 0.0012387154769385234,
      "val_loss": 0.4629247337579727,
      "val_macro_f1": 0.7278740026400625,
      "val_verse_f1": 0.8120780195048762,
      "val_chorus_f1": 0.6436699857752489,
      "val_chorus_rate": 0.39189305901527405,
      "val_max_prob": 0.6882356405258179,
      "val_conf_over_90": 0.02362790424376726,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 2.3076238705658678e-05,
      "epoch_time": 2672.923087120056,
      "val_boundary_f1": 0.33333333333333326,
      "val_boundary_precision": 0.2661971830985915,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.22902559808710393,
      "val_avg_segment_overlap": 0.6135752995568694,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.43646462014082177,
      "val_pk_metric": 0.3116216075080963
    },
    {
      "epoch": 14,
      "train_loss": 0.43527251929044725,
      "train_chorus_rate": 0.3531294584274292,
      "train_max_prob": 0.695808219909668,
      "train_conf_over_90": 0.033502067998051645,
      "train_conf_over_95": 0.002132823076681234,
      "val_loss": 0.46209975332021713,
      "val_macro_f1": 0.7239052958551045,
      "val_verse_f1": 0.8063540090771559,
      "val_chorus_f1": 0.6414565826330532,
      "val_chorus_rate": 0.4026514068245888,
      "val_max_prob": 0.6879231333732605,
      "val_conf_over_90": 0.025105080101639032,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 6.580028178248513e-06,
      "epoch_time": 1258.291498184204,
      "val_boundary_f1": 0.329246935201401,
      "val_boundary_precision": 0.2618384401114206,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21820380067994066,
      "val_avg_segment_overlap": 0.6086586822600146,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.43791087684205937,
      "val_pk_metric": 0.3156445332001674
    },
    {
      "epoch": 15,
      "train_loss": 0.4210173040628433,
      "train_chorus_rate": 0.3471469976007938,
      "train_max_prob": 0.6991597026586532,
      "train_conf_over_90": 0.03761959113180637,
      "train_conf_over_95": 0.002367756178136915,
      "val_loss": 0.462311215698719,
      "val_macro_f1": 0.7249424694183901,
      "val_verse_f1": 0.8075542965061379,
      "val_chorus_f1": 0.6423306423306424,
      "val_chorus_rate": 0.40090277045965195,
      "val_max_prob": 0.6883547455072403,
      "val_conf_over_90": 0.025351385585963726,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 1e-06,
      "epoch_time": 1145.029571056366,
      "val_boundary_f1": 0.329246935201401,
      "val_boundary_precision": 0.2618384401114206,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21820380067994066,
      "val_avg_segment_overlap": 0.6093107885044596,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4382070343675696,
      "val_pk_metric": 0.31551878120446253
    }
  ]
}