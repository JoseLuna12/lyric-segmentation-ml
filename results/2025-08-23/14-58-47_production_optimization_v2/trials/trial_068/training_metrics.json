{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.1781005424552315,
      "layer_dropout": 0.20063642858300298,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.13908544361773534,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009957326365946562,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01652720849883863,
      "gradient_clip_norm": 0.4145617252456276,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09548140223520445,
        "ece_after": 0.01794253807873529,
        "improvement": 0.07753886415646916,
        "params": {
          "temperature": 0.5772354929664252
        }
      },
      "platt": {
        "ece_before": 0.09548140223520445,
        "ece_after": 0.01997340406146641,
        "improvement": 0.07550799817373804,
        "params": {
          "A": 1.5921947470431879,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5799610912799835,
      "train_chorus_rate": 0.5799179267836735,
      "train_max_prob": 0.5639465600252151,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6089190095663071,
      "val_macro_f1": 0.4540922305491328,
      "val_verse_f1": 0.814321645213789,
      "val_chorus_f1": 0.09386281588447654,
      "val_chorus_rate": 0.040224953554570675,
      "val_max_prob": 0.5874025970697403,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000984863989225666,
      "epoch_time": 131.06562995910645,
      "val_boundary_f1": 0.026666666666666665,
      "val_boundary_precision": 0.23076923076923078,
      "val_boundary_recall": 0.014150943396226415,
      "val_complete_segments": 0.060707069362954835,
      "val_avg_segment_overlap": 0.18021623046701818,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.27413439223330077,
      "val_pk_metric": 0.2800928923714718
    },
    {
      "epoch": 2,
      "train_loss": 0.5559955775737763,
      "train_chorus_rate": 0.45605076416395607,
      "train_max_prob": 0.5705292254686356,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6013276129961014,
      "val_macro_f1": 0.5338508180888211,
      "val_verse_f1": 0.7994367959949938,
      "val_chorus_f1": 0.2682648401826484,
      "val_chorus_rate": 0.129794180393219,
      "val_max_prob": 0.5857201218605042,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009527330591622762,
      "epoch_time": 80.56779098510742,
      "val_boundary_f1": 0.0749063670411985,
      "val_boundary_precision": 0.18181818181818182,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.06038262357191307,
      "val_avg_segment_overlap": 0.2239865548192006,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.31164684120058417,
      "val_pk_metric": 0.3087057525970771
    },
    {
      "epoch": 3,
      "train_loss": 0.5377206847071647,
      "train_chorus_rate": 0.3706024502404034,
      "train_max_prob": 0.5963864237070083,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5846183896064758,
      "val_macro_f1": 0.5920326328093318,
      "val_verse_f1": 0.7516328331862312,
      "val_chorus_f1": 0.43243243243243246,
      "val_chorus_rate": 0.3102930635213852,
      "val_max_prob": 0.5659508109092712,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000900744122229566,
      "epoch_time": 174.09603023529053,
      "val_boundary_f1": 0.11363636363636363,
      "val_boundary_precision": 0.18229166666666666,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.067339425093932,
      "val_avg_segment_overlap": 0.29177891699438824,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.3578383189120958,
      "val_pk_metric": 0.3366386972826528
    },
    {
      "epoch": 4,
      "train_loss": 0.5313710868358612,
      "train_chorus_rate": 0.43642525300383567,
      "train_max_prob": 0.6064239382743836,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5746756196022034,
      "val_macro_f1": 0.605435030055786,
      "val_verse_f1": 0.6893479141352774,
      "val_chorus_f1": 0.5215221459762945,
      "val_chorus_rate": 0.48899441212415695,
      "val_max_prob": 0.6410414576530457,
      "val_conf_over_90": 0.001231527072377503,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008311693444420922,
      "epoch_time": 129.9702000617981,
      "val_boundary_f1": 0.13095238095238093,
      "val_boundary_precision": 0.1774193548387097,
      "val_boundary_recall": 0.10377358490566038,
      "val_complete_segments": 0.06665634540767096,
      "val_avg_segment_overlap": 0.32907466234712196,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.08585858585858586,
      "val_window_diff": 0.38579568369841305,
      "val_pk_metric": 0.34966402763345705
    },
    {
      "epoch": 5,
      "train_loss": 0.5181766837835312,
      "train_chorus_rate": 0.3866883836686611,
      "train_max_prob": 0.6599515378475189,
      "train_conf_over_90": 0.00847116028307937,
      "train_conf_over_95": 3.3467201865278186e-05,
      "val_loss": 0.521185040473938,
      "val_macro_f1": 0.7379396755968655,
      "val_verse_f1": 0.8403954802259888,
      "val_chorus_f1": 0.6354838709677421,
      "val_chorus_rate": 0.31039297580718994,
      "val_max_prob": 0.7062775492668152,
      "val_conf_over_90": 0.028940390795469284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007470494774459923,
      "epoch_time": 79.86031222343445,
      "val_boundary_f1": 0.3968095712861416,
      "val_boundary_precision": 0.3436960276338515,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2528052328953707,
      "val_avg_segment_overlap": 0.6241195877149499,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3605580874111481,
      "val_pk_metric": 0.2681089173856521
    },
    {
      "epoch": 6,
      "train_loss": 0.48794222474098203,
      "train_chorus_rate": 0.36060483381152153,
      "train_max_prob": 0.6895759850740433,
      "train_conf_over_90": 0.024707228073384612,
      "train_conf_over_95": 0.002346738267806359,
      "val_loss": 0.5215958878397942,
      "val_macro_f1": 0.7534841387142296,
      "val_verse_f1": 0.8612440191387559,
      "val_chorus_f1": 0.6457242582897033,
      "val_chorus_rate": 0.2637637071311474,
      "val_max_prob": 0.7143918424844742,
      "val_conf_over_90": 0.005477100086864084,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000652060963080902,
      "epoch_time": 81.80268883705139,
      "val_boundary_f1": 0.3798219584569733,
      "val_boundary_precision": 0.3270868824531516,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2512836234204209,
      "val_avg_segment_overlap": 0.6346804015162915,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.34251005525820927,
      "val_pk_metric": 0.2520670700413435
    },
    {
      "epoch": 7,
      "train_loss": 0.47012747675180433,
      "train_chorus_rate": 0.3642500787973404,
      "train_max_prob": 0.7065308511257171,
      "train_conf_over_90": 0.02842989129712805,
      "train_conf_over_95": 0.0006591665762243793,
      "val_loss": 0.4905145764350891,
      "val_macro_f1": 0.7454853472875869,
      "val_verse_f1": 0.8333029030491146,
      "val_chorus_f1": 0.6576677915260593,
      "val_chorus_rate": 0.3560730218887329,
      "val_max_prob": 0.6949164718389511,
      "val_conf_over_90": 0.015410982770845294,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005503552552300386,
      "epoch_time": 127.20919108390808,
      "val_boundary_f1": 0.3305322128851541,
      "val_boundary_precision": 0.2735703245749614,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.18069612371043972,
      "val_avg_segment_overlap": 0.6497029084481005,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.40925387067571434,
      "val_pk_metric": 0.29226124015749777
    },
    {
      "epoch": 8,
      "train_loss": 0.4671808809041977,
      "train_chorus_rate": 0.3396958872675896,
      "train_max_prob": 0.6987948417663574,
      "train_conf_over_90": 0.019970871647819875,
      "train_conf_over_95": 0.0002196956193074584,
      "val_loss": 0.4854341149330139,
      "val_macro_f1": 0.7349745106562278,
      "val_verse_f1": 0.8165258215962442,
      "val_chorus_f1": 0.6534231997162114,
      "val_chorus_rate": 0.39351988583803177,
      "val_max_prob": 0.6914723217487335,
      "val_conf_over_90": 0.02420442085713148,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000446377381364618,
      "epoch_time": 144.041668176651,
      "val_boundary_f1": 0.3153070577451879,
      "val_boundary_precision": 0.25787106446776614,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.1725726275434653,
      "val_avg_segment_overlap": 0.6341814299736652,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.41960407589233184,
      "val_pk_metric": 0.3113092488182408
    },
    {
      "epoch": 9,
      "train_loss": 0.46204113215208054,
      "train_chorus_rate": 0.36435793042182923,
      "train_max_prob": 0.710193732380867,
      "train_conf_over_90": 0.03664803321007639,
      "train_conf_over_95": 0.001207397924736142,
      "val_loss": 0.49687496572732925,
      "val_macro_f1": 0.7231613477402346,
      "val_verse_f1": 0.8010732081257187,
      "val_chorus_f1": 0.6452494873547505,
      "val_chorus_rate": 0.419184610247612,
      "val_max_prob": 0.7480730414390564,
      "val_conf_over_90": 0.1219317652285099,
      "val_conf_over_95": 0.004699261218775064,
      "learning_rate": 0.00034467167351375454,
      "epoch_time": 104.93389964103699,
      "val_boundary_f1": 0.29296875,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.13928817091595458,
      "val_avg_segment_overlap": 0.6005507026761085,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.426798720941256,
      "val_pk_metric": 0.3203439893268235
    },
    {
      "epoch": 10,
      "train_loss": 0.4618057727813721,
      "train_chorus_rate": 0.35571173280477525,
      "train_max_prob": 0.7098554074764252,
      "train_conf_over_90": 0.038662407314404845,
      "train_conf_over_95": 0.001957533834502101,
      "val_loss": 0.4921715706586838,
      "val_macro_f1": 0.7798767587800578,
      "val_verse_f1": 0.8772348033373063,
      "val_chorus_f1": 0.6825187142228093,
      "val_chorus_rate": 0.2585331089794636,
      "val_max_prob": 0.7271954566240311,
      "val_conf_over_90": 0.009192415629513562,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024968315914866425,
      "epoch_time": 79.2552740573883,
      "val_boundary_f1": 0.42736842105263156,
      "val_boundary_precision": 0.38593155893536124,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.29504504504504503,
      "val_avg_segment_overlap": 0.657398539504455,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.28347250207826435,
      "val_pk_metric": 0.2163721707144296
    },
    {
      "epoch": 11,
      "train_loss": 0.4626476690173149,
      "train_chorus_rate": 0.32949194088578226,
      "train_max_prob": 0.7130910009145737,
      "train_conf_over_90": 0.021051518907188437,
      "train_conf_over_95": 0.00010038279287982732,
      "val_loss": 0.49244798719882965,
      "val_macro_f1": 0.7663802361860824,
      "val_verse_f1": 0.8663800515907136,
      "val_chorus_f1": 0.6663804207814512,
      "val_chorus_rate": 0.2728292904794216,
      "val_max_prob": 0.6792294234037399,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016556329215256427,
      "epoch_time": 76.9104871749878,
      "val_boundary_f1": 0.40081799591002043,
      "val_boundary_precision": 0.35379061371841153,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.25122986757398214,
      "val_avg_segment_overlap": 0.6419115384204869,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3271318928370151,
      "val_pk_metric": 0.23956376634858775
    },
    {
      "epoch": 12,
      "train_loss": 0.46134397983551023,
      "train_chorus_rate": 0.3561758242547512,
      "train_max_prob": 0.7125250458717346,
      "train_conf_over_90": 0.029531494015827775,
      "train_conf_over_95": 0.00017855910991784185,
      "val_loss": 0.4781498908996582,
      "val_macro_f1": 0.7711508528808979,
      "val_verse_f1": 0.8610719322990127,
      "val_chorus_f1": 0.6812297734627831,
      "val_chorus_rate": 0.3078411892056465,
      "val_max_prob": 0.7104718685150146,
      "val_conf_over_90": 0.0158348111435771,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.598851436509036e-05,
      "epoch_time": 114.0899031162262,
      "val_boundary_f1": 0.3869693978282329,
      "val_boundary_precision": 0.33276740237691,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.26435246980050797,
      "val_avg_segment_overlap": 0.6590410085916261,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.32462578627176164,
      "val_pk_metric": 0.23290942911235205
    },
    {
      "epoch": 13,
      "train_loss": 0.4477768510580063,
      "train_chorus_rate": 0.34889495819807054,
      "train_max_prob": 0.7190875560045242,
      "train_conf_over_90": 0.03545057885348797,
      "train_conf_over_95": 0.00013410160900093616,
      "val_loss": 0.4744142219424248,
      "val_macro_f1": 0.7695846660152696,
      "val_verse_f1": 0.8557640750670241,
      "val_chorus_f1": 0.6834052569635151,
      "val_chorus_rate": 0.32682009786367416,
      "val_max_prob": 0.7085875868797302,
      "val_conf_over_90": 0.030110978288576007,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.3999577432379964e-05,
      "epoch_time": 85.79654598236084,
      "val_boundary_f1": 0.37790697674418605,
      "val_boundary_precision": 0.3207236842105263,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2529872964920685,
      "val_avg_segment_overlap": 0.6688499648138111,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3295922830935899,
      "val_pk_metric": 0.23797593445259552
    }
  ]
}