{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.1589194994273726,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0004923017246485956,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.005029274469936654,
      "gradient_clip_norm": 0.7059952252310515,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07780909394819752,
        "ece_after": 0.013074568452675812,
        "improvement": 0.06473452549552171,
        "params": {
          "temperature": 0.634555265316118
        }
      },
      "platt": {
        "ece_before": 0.07780909394819752,
        "ece_after": 0.015828194561430874,
        "improvement": 0.06198089938676664,
        "params": {
          "A": 1.4999981522949728,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5243826374411583,
      "train_chorus_rate": 0.3179531301488169,
      "train_max_prob": 0.5410491824150085,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5519872307777405,
      "val_macro_f1": 0.5878832682085402,
      "val_verse_f1": 0.7745098039215687,
      "val_chorus_f1": 0.40125673249551164,
      "val_chorus_rate": 0.24770113080739975,
      "val_max_prob": 0.562009260058403,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004869336639250001,
      "epoch_time": 4077.565703868866,
      "val_boundary_f1": 0.16571428571428573,
      "val_boundary_precision": 0.21014492753623187,
      "val_boundary_recall": 0.13679245283018868,
      "val_complete_segments": 0.02714902260236301,
      "val_avg_segment_overlap": 0.28675486046832604,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.08585858585858586,
      "val_window_diff": 0.4255475819248825,
      "val_pk_metric": 0.41730433437557723
    },
    {
      "epoch": 2,
      "train_loss": 0.5243024110794068,
      "train_chorus_rate": 0.35586537793278694,
      "train_max_prob": 0.5612979501485824,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5382384210824966,
      "val_macro_f1": 0.6202781982825214,
      "val_verse_f1": 0.7900899372136434,
      "val_chorus_f1": 0.45046645935139934,
      "val_chorus_rate": 0.2540507912635803,
      "val_max_prob": 0.5658487975597382,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004710640917666479,
      "epoch_time": 97.26357293128967,
      "val_boundary_f1": 0.26440677966101694,
      "val_boundary_precision": 0.25379609544468545,
      "val_boundary_recall": 0.2759433962264151,
      "val_complete_segments": 0.11099183375164287,
      "val_avg_segment_overlap": 0.39221265792198196,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.4094002909274004,
      "val_pk_metric": 0.35574618577880357
    },
    {
      "epoch": 3,
      "train_loss": 0.49847174286842344,
      "train_chorus_rate": 0.38861600309610367,
      "train_max_prob": 0.5812035858631134,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5132089853286743,
      "val_macro_f1": 0.5903522429293876,
      "val_verse_f1": 0.6330071174377224,
      "val_chorus_f1": 0.5476973684210528,
      "val_chorus_rate": 0.5966860055923462,
      "val_max_prob": 0.5943190455436707,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004453865846275152,
      "epoch_time": 116.32398986816406,
      "val_boundary_f1": 0.20018709073900845,
      "val_boundary_precision": 0.16589147286821707,
      "val_boundary_recall": 0.25235849056603776,
      "val_complete_segments": 0.08065947897602192,
      "val_avg_segment_overlap": 0.4203705132285799,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.4955207797552581,
      "val_pk_metric": 0.41833236906455384
    },
    {
      "epoch": 4,
      "train_loss": 0.4808266893029213,
      "train_chorus_rate": 0.36321036219596864,
      "train_max_prob": 0.6190286159515381,
      "train_conf_over_90": 0.00012868668127339334,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5137543752789497,
      "val_macro_f1": 0.6768533595362254,
      "val_verse_f1": 0.818507768482158,
      "val_chorus_f1": 0.5351989505902929,
      "val_chorus_rate": 0.2631573937833309,
      "val_max_prob": 0.6303671449422836,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004110233727839316,
      "epoch_time": 99.28018522262573,
      "val_boundary_f1": 0.33209647495361777,
      "val_boundary_precision": 0.27370030581039756,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.20113083466742004,
      "val_avg_segment_overlap": 0.5418810089675151,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.408730669904563,
      "val_pk_metric": 0.32042455101195105
    },
    {
      "epoch": 5,
      "train_loss": 0.4587215885519981,
      "train_chorus_rate": 0.3226293295621872,
      "train_max_prob": 0.6396390348672867,
      "train_conf_over_90": 0.0013562932377681135,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4853530600667,
      "val_macro_f1": 0.696401270847079,
      "val_verse_f1": 0.7910894795956571,
      "val_chorus_f1": 0.6017130620985011,
      "val_chorus_rate": 0.3892653211951256,
      "val_max_prob": 0.6449349820613861,
      "val_conf_over_90": 0.0025375515106134117,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003694762934864467,
      "epoch_time": 108.00269675254822,
      "val_boundary_f1": 0.32737030411449014,
      "val_boundary_precision": 0.26368876080691644,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.19840965605811844,
      "val_avg_segment_overlap": 0.5890885151974032,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4307905672280224,
      "val_pk_metric": 0.3336800138472084
    },
    {
      "epoch": 6,
      "train_loss": 0.4434963807463646,
      "train_chorus_rate": 0.3472489908337593,
      "train_max_prob": 0.663374799489975,
      "train_conf_over_90": 0.0067930595192592595,
      "train_conf_over_95": 6.564875657204539e-05,
      "val_loss": 0.47480079531669617,
      "val_macro_f1": 0.6651307268098187,
      "val_verse_f1": 0.7214631070002101,
      "val_chorus_f1": 0.6087983466194272,
      "val_chorus_rate": 0.5326461642980576,
      "val_max_prob": 0.648124024271965,
      "val_conf_over_90": 0.004326608381234109,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032256115346536635,
      "epoch_time": 117.69876408576965,
      "val_boundary_f1": 0.2451063829787234,
      "val_boundary_precision": 0.19174434087882822,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.10667058703909181,
      "val_avg_segment_overlap": 0.5362904344602505,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.49114979852440666,
      "val_pk_metric": 0.3788680425154475
    },
    {
      "epoch": 7,
      "train_loss": 0.4446194738149643,
      "train_chorus_rate": 0.39598928689956664,
      "train_max_prob": 0.6713136315345765,
      "train_conf_over_90": 0.014884979953058064,
      "train_conf_over_95": 0.00020901080570183693,
      "val_loss": 0.47504308074712753,
      "val_macro_f1": 0.7117435550684343,
      "val_verse_f1": 0.8075930704017693,
      "val_chorus_f1": 0.6158940397350993,
      "val_chorus_rate": 0.3687285855412483,
      "val_max_prob": 0.6662445962429047,
      "val_conf_over_90": 0.00940109184011817,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0002723283694634306,
      "epoch_time": 123.38956212997437,
      "val_boundary_f1": 0.3471365638766519,
      "val_boundary_precision": 0.2770745428973277,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.21690311732729547,
      "val_avg_segment_overlap": 0.6117271389626426,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4442948845082772,
      "val_pk_metric": 0.32669394838803967
    },
    {
      "epoch": 8,
      "train_loss": 0.4381454631686211,
      "train_chorus_rate": 0.3751845985651016,
      "train_max_prob": 0.6826803922653198,
      "train_conf_over_90": 0.022533604595810174,
      "train_conf_over_95": 0.00029102046974003313,
      "val_loss": 0.4660981521010399,
      "val_macro_f1": 0.7211106845476472,
      "val_verse_f1": 0.8135030437188712,
      "val_chorus_f1": 0.628718325376423,
      "val_chorus_rate": 0.36977415531873703,
      "val_max_prob": 0.6860059052705765,
      "val_conf_over_90": 0.019638646859675646,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0002209733551851651,
      "epoch_time": 1007.7771110534668,
      "val_boundary_f1": 0.35870516185476814,
      "val_boundary_precision": 0.2851182197496523,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.23837713641531244,
      "val_avg_segment_overlap": 0.6133274483118538,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.43046306718513117,
      "val_pk_metric": 0.3163221599363035
    },
    {
      "epoch": 9,
      "train_loss": 0.4350366860628128,
      "train_chorus_rate": 0.3488224811851978,
      "train_max_prob": 0.6884874016046524,
      "train_conf_over_90": 0.02382516728248447,
      "train_conf_over_95": 0.0005700286419596523,
      "val_loss": 0.45788588374853134,
      "val_macro_f1": 0.698702587964351,
      "val_verse_f1": 0.773139031114612,
      "val_chorus_f1": 0.62426614481409,
      "val_chorus_rate": 0.45389890670776367,
      "val_max_prob": 0.6783803105354309,
      "val_conf_over_90": 0.01818599342368543,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.00017074057118322933,
      "epoch_time": 106.52265119552612,
      "val_boundary_f1": 0.3106457242582897,
      "val_boundary_precision": 0.24653739612188366,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.19274396726676685,
      "val_avg_segment_overlap": 0.5877674884438673,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4640341402482263,
      "val_pk_metric": 0.3329303160927217
    },
    {
      "epoch": 10,
      "train_loss": 0.43750769048929217,
      "train_chorus_rate": 0.3879731595516205,
      "train_max_prob": 0.6903786659240723,
      "train_conf_over_90": 0.030797321628779174,
      "train_conf_over_95": 0.0013514652731828392,
      "val_loss": 0.4591381698846817,
      "val_macro_f1": 0.7239907304794482,
      "val_verse_f1": 0.8087185268695979,
      "val_chorus_f1": 0.6392629340892985,
      "val_chorus_rate": 0.3943103402853012,
      "val_max_prob": 0.6809818148612976,
      "val_conf_over_90": 0.021707490785047412,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.00012382543116214897,
      "epoch_time": 101.69155669212341,
      "val_boundary_f1": 0.33362598770851626,
      "val_boundary_precision": 0.26573426573426573,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.21066585256670095,
      "val_avg_segment_overlap": 0.6200301382477318,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4514931791417778,
      "val_pk_metric": 0.32716282993017687
    },
    {
      "epoch": 11,
      "train_loss": 0.4415871426463127,
      "train_chorus_rate": 0.37759439647197723,
      "train_max_prob": 0.6890506088733673,
      "train_conf_over_90": 0.0348783484660089,
      "train_conf_over_95": 0.00181141949724406,
      "val_loss": 0.4589617997407913,
      "val_macro_f1": 0.7364958146931269,
      "val_verse_f1": 0.82534435261708,
      "val_chorus_f1": 0.6476472767691737,
      "val_chorus_rate": 0.364215187728405,
      "val_max_prob": 0.6889398097991943,
      "val_conf_over_90": 0.027120620012283325,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 8.227835186466409e-05,
      "epoch_time": 94.93260478973389,
      "val_boundary_f1": 0.35469710272168575,
      "val_boundary_precision": 0.28251748251748254,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24419842884848186,
      "val_avg_segment_overlap": 0.6262996849581369,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.42912228603073405,
      "val_pk_metric": 0.3072461886049367
    },
    {
      "epoch": 12,
      "train_loss": 0.4233070656657219,
      "train_chorus_rate": 0.3530761495232582,
      "train_max_prob": 0.6948378443717956,
      "train_conf_over_90": 0.035782876517623664,
      "train_conf_over_95": 0.0018774125230265782,
      "val_loss": 0.4564153477549553,
      "val_macro_f1": 0.726610930831082,
      "val_verse_f1": 0.8106686701728024,
      "val_chorus_f1": 0.6425531914893616,
      "val_chorus_rate": 0.39367230236530304,
      "val_max_prob": 0.6844534575939178,
      "val_conf_over_90": 0.023612865712493658,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 4.7915140021080394e-05,
      "epoch_time": 108.17230319976807,
      "val_boundary_f1": 0.32692307692307687,
      "val_boundary_precision": 0.25972222222222224,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.21245156685241523,
      "val_avg_segment_overlap": 0.6157151541338922,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4510773831375386,
      "val_pk_metric": 0.3237637286116212
    },
    {
      "epoch": 13,
      "train_loss": 0.41855592131614683,
      "train_chorus_rate": 0.33944593369960785,
      "train_max_prob": 0.6984689712524415,
      "train_conf_over_90": 0.036673917341977356,
      "train_conf_over_95": 0.001595955333323218,
      "val_loss": 0.4578908905386925,
      "val_macro_f1": 0.7248254170689719,
      "val_verse_f1": 0.8108512628624884,
      "val_chorus_f1": 0.6387995712754554,
      "val_chorus_rate": 0.3886355385184288,
      "val_max_prob": 0.6891822814941406,
      "val_conf_over_90": 0.026809264440089464,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 2.2237632881947597e-05,
      "epoch_time": 104.05758118629456,
      "val_boundary_f1": 0.3307223672758921,
      "val_boundary_precision": 0.2620689655172414,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.2225847059754801,
      "val_avg_segment_overlap": 0.6135052995547428,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.437498604674707,
      "val_pk_metric": 0.31396858063024163
    },
    {
      "epoch": 14,
      "train_loss": 0.42734437584877016,
      "train_chorus_rate": 0.3556110441684723,
      "train_max_prob": 0.6967911422252655,
      "train_conf_over_90": 0.03593883281573653,
      "train_conf_over_95": 0.0020927087141899394,
      "val_loss": 0.4569620117545128,
      "val_macro_f1": 0.7215159872718864,
      "val_verse_f1": 0.806251176802862,
      "val_chorus_f1": 0.6367807977409107,
      "val_chorus_rate": 0.3969223350286484,
      "val_max_prob": 0.6889176815748215,
      "val_conf_over_90": 0.027316585183143616,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 6.3680607235954845e-06,
      "epoch_time": 96.80757021903992,
      "val_boundary_f1": 0.3286713286713287,
      "val_boundary_precision": 0.2611111111111111,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21582794921872336,
      "val_avg_segment_overlap": 0.6091102603381571,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.43887481190771316,
      "val_pk_metric": 0.3171959101369706
    },
    {
      "epoch": 15,
      "train_loss": 0.4125630959868431,
      "train_chorus_rate": 0.34289353862404826,
      "train_max_prob": 0.7016008406877517,
      "train_conf_over_90": 0.04180669542402029,
      "train_conf_over_95": 0.0024492845288477836,
      "val_loss": 0.4572620093822479,
      "val_macro_f1": 0.7224035810896046,
      "val_verse_f1": 0.8079594518490708,
      "val_chorus_f1": 0.6368477103301384,
      "val_chorus_rate": 0.392997145652771,
      "val_max_prob": 0.6894625127315521,
      "val_conf_over_90": 0.027547852136194706,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 1e-06,
      "epoch_time": 137.26768589019775,
      "val_boundary_f1": 0.3286467486818981,
      "val_boundary_precision": 0.2619047619047619,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.21200971460780582,
      "val_avg_segment_overlap": 0.6099072981089693,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.43726591251993463,
      "val_pk_metric": 0.3150847555272908
    }
  ]
}