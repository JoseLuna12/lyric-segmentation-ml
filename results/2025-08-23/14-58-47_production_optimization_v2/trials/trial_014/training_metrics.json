{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.228366385076347,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 526850,
      "lstm_params": 526336,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0003899270654258322,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.02464466980779403,
      "gradient_clip_norm": 0.99103766838987,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10847799001309165,
        "ece_after": 0.018989229834618426,
        "improvement": 0.08948876017847322,
        "params": {
          "temperature": 0.505522646669437
        }
      },
      "platt": {
        "ece_before": 0.10847799001309165,
        "ece_after": 0.028450622847248874,
        "improvement": 0.08002736716584277,
        "params": {
          "A": 1.760170877861868,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5340236827731133,
      "train_chorus_rate": 0.41699427966959773,
      "train_max_prob": 0.5384035229682922,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5514469295740128,
      "val_macro_f1": 0.5535698013486423,
      "val_verse_f1": 0.7281073446327685,
      "val_chorus_f1": 0.37903225806451607,
      "val_chorus_rate": 0.3095039054751396,
      "val_max_prob": 0.5367092937231064,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00038567757066627494,
      "epoch_time": 11623.105945110321,
      "val_boundary_f1": 0.10291595197255575,
      "val_boundary_precision": 0.18867924528301888,
      "val_boundary_recall": 0.07075471698113207,
      "val_complete_segments": 0.009694869464222593,
      "val_avg_segment_overlap": 0.23603406557054668,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.44636778248710257,
      "val_pk_metric": 0.4639262053721793
    },
    {
      "epoch": 2,
      "train_loss": 0.5215780168771744,
      "train_chorus_rate": 0.39231552481651305,
      "train_max_prob": 0.5465240806341172,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5500616878271103,
      "val_macro_f1": 0.5677160707110488,
      "val_verse_f1": 0.7529654461062403,
      "val_chorus_f1": 0.3824666953158573,
      "val_chorus_rate": 0.27204085141420364,
      "val_max_prob": 0.5630878359079361,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003731148096999339,
      "epoch_time": 1575.059496164322,
      "val_boundary_f1": 0.1818181818181818,
      "val_boundary_precision": 0.26222222222222225,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.023672123115389285,
      "val_avg_segment_overlap": 0.2705312808433428,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.416799089591472,
      "val_pk_metric": 0.4241273999210927
    },
    {
      "epoch": 3,
      "train_loss": 0.5154596403241157,
      "train_chorus_rate": 0.3525303456932306,
      "train_max_prob": 0.5700013965368271,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.544344112277031,
      "val_macro_f1": 0.570650347135316,
      "val_verse_f1": 0.7213233957462281,
      "val_chorus_f1": 0.4199772985244041,
      "val_chorus_rate": 0.3500191494822502,
      "val_max_prob": 0.5713873654603958,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003527878354638538,
      "epoch_time": 181.97080087661743,
      "val_boundary_f1": 0.19653179190751444,
      "val_boundary_precision": 0.2537313432835821,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.0425941298820408,
      "val_avg_segment_overlap": 0.28351616673752184,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.4300369862841513,
      "val_pk_metric": 0.4299595683304689
    },
    {
      "epoch": 4,
      "train_loss": 0.5116158962249756,
      "train_chorus_rate": 0.4428771287202835,
      "train_max_prob": 0.5735458254814148,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5320581346750259,
      "val_macro_f1": 0.5758347687221722,
      "val_verse_f1": 0.6355220667384285,
      "val_chorus_f1": 0.5161474707059159,
      "val_chorus_rate": 0.5604509115219116,
      "val_max_prob": 0.5644404739141464,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032558503427179534,
      "epoch_time": 281.4210379123688,
      "val_boundary_f1": 0.19897959183673466,
      "val_boundary_precision": 0.21666666666666667,
      "val_boundary_recall": 0.18396226415094338,
      "val_complete_segments": 0.0719239577405007,
      "val_avg_segment_overlap": 0.32897942101386296,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.17676767676767677,
      "val_window_diff": 0.4238123974545117,
      "val_pk_metric": 0.40675244752269757
    },
    {
      "epoch": 5,
      "train_loss": 0.48657336384058,
      "train_chorus_rate": 0.4016311004757881,
      "train_max_prob": 0.6007430464029312,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5198964774608612,
      "val_macro_f1": 0.6154855434333153,
      "val_verse_f1": 0.6812080536912751,
      "val_chorus_f1": 0.5497630331753556,
      "val_chorus_rate": 0.5306472256779671,
      "val_max_prob": 0.5778606086969376,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002926952990693742,
      "epoch_time": 172.8347887992859,
      "val_boundary_f1": 0.2449438202247191,
      "val_boundary_precision": 0.23390557939914164,
      "val_boundary_recall": 0.25707547169811323,
      "val_complete_segments": 0.11898693686869721,
      "val_avg_segment_overlap": 0.4150801364435968,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.43939672039741134,
      "val_pk_metric": 0.3855635593129782
    },
    {
      "epoch": 6,
      "train_loss": 0.47704286128282547,
      "train_chorus_rate": 0.34625557735562323,
      "train_max_prob": 0.6063261896371841,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5126520618796349,
      "val_macro_f1": 0.6780992608088134,
      "val_verse_f1": 0.7992863514719002,
      "val_chorus_f1": 0.5569121701457266,
      "val_chorus_rate": 0.3249516114592552,
      "val_max_prob": 0.6078928411006927,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025555606910739574,
      "epoch_time": 1377.868098974228,
      "val_boundary_f1": 0.3556910569105691,
      "val_boundary_precision": 0.3125,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.21649930873154627,
      "val_avg_segment_overlap": 0.5301923627798396,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.39301841261287496,
      "val_pk_metric": 0.3197058794509766
    },
    {
      "epoch": 7,
      "train_loss": 0.4674998387694359,
      "train_chorus_rate": 0.3831896960735321,
      "train_max_prob": 0.6228428393602371,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4993864893913269,
      "val_macro_f1": 0.6933856534650819,
      "val_verse_f1": 0.7966195112989161,
      "val_chorus_f1": 0.5901517956312476,
      "val_chorus_rate": 0.3647853061556816,
      "val_max_prob": 0.621339350938797,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002157905069489963,
      "epoch_time": 1125.1668779850006,
      "val_boundary_f1": 0.35328753680078506,
      "val_boundary_precision": 0.3025210084033613,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.2135207469247766,
      "val_avg_segment_overlap": 0.5630679922587003,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4139561582224896,
      "val_pk_metric": 0.3186921483447393
    },
    {
      "epoch": 8,
      "train_loss": 0.4481985464692116,
      "train_chorus_rate": 0.38641671985387804,
      "train_max_prob": 0.6463744074106217,
      "train_conf_over_90": 0.0014876800443744287,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4876580759882927,
      "val_macro_f1": 0.6979302917776415,
      "val_verse_f1": 0.7845008589425463,
      "val_chorus_f1": 0.6113597246127367,
      "val_chorus_rate": 0.41476937383413315,
      "val_max_prob": 0.6343396455049515,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017513655847683598,
      "epoch_time": 179.66290402412415,
      "val_boundary_f1": 0.3396584440227704,
      "val_boundary_precision": 0.2841269841269841,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.19656261131605776,
      "val_avg_segment_overlap": 0.5715075055262991,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4279847542585439,
      "val_pk_metric": 0.3248687493880828
    },
    {
      "epoch": 9,
      "train_loss": 0.4484014749526978,
      "train_chorus_rate": 0.3386814758181572,
      "train_max_prob": 0.6534737318754196,
      "train_conf_over_90": 0.0015107805025763809,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4862014725804329,
      "val_macro_f1": 0.714156341718554,
      "val_verse_f1": 0.8150299509892902,
      "val_chorus_f1": 0.6132827324478178,
      "val_chorus_rate": 0.3485029265284538,
      "val_max_prob": 0.6412651240825653,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013537099631843655,
      "epoch_time": 2463.92711186409,
      "val_boundary_f1": 0.3649906890130354,
      "val_boundary_precision": 0.30153846153846153,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.24416954638322613,
      "val_avg_segment_overlap": 0.6010213357956826,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.41900025369826827,
      "val_pk_metric": 0.3055667132292269
    },
    {
      "epoch": 10,
      "train_loss": 0.4451286613941193,
      "train_chorus_rate": 0.37151932045817376,
      "train_max_prob": 0.654419231414795,
      "train_conf_over_90": 0.004916244861669838,
      "train_conf_over_95": 3.215433971490711e-05,
      "val_loss": 0.48176538199186325,
      "val_macro_f1": 0.7082931081831134,
      "val_verse_f1": 0.798197859958701,
      "val_chorus_f1": 0.6183883564075258,
      "val_chorus_rate": 0.3931736499071121,
      "val_max_prob": 0.6474999189376831,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.823176635645811e-05,
      "epoch_time": 1128.8045959472656,
      "val_boundary_f1": 0.34604651162790695,
      "val_boundary_precision": 0.2857142857142857,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.23432739852411116,
      "val_avg_segment_overlap": 0.6062698156762606,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.43158654831479326,
      "val_pk_metric": 0.3151026163134307
    },
    {
      "epoch": 11,
      "train_loss": 0.4372671902179718,
      "train_chorus_rate": 0.3221158511936665,
      "train_max_prob": 0.6675099849700927,
      "train_conf_over_90": 0.007707375960308127,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4771854802966118,
      "val_macro_f1": 0.7024876467127318,
      "val_verse_f1": 0.7846834712334039,
      "val_chorus_f1": 0.6202918221920597,
      "val_chorus_rate": 0.4250056520104408,
      "val_max_prob": 0.648248553276062,
      "val_conf_over_90": 0.0009446947660762817,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.534203115403696e-05,
      "epoch_time": 193.50564289093018,
      "val_boundary_f1": 0.319926873857404,
      "val_boundary_precision": 0.26119402985074625,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.21299234964399336,
      "val_avg_segment_overlap": 0.5932623774092889,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.44891966931434485,
      "val_pk_metric": 0.3240724775766045
    },
    {
      "epoch": 12,
      "train_loss": 0.44388013482093813,
      "train_chorus_rate": 0.35666357129812243,
      "train_max_prob": 0.6612573593854905,
      "train_conf_over_90": 0.005419598356820643,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47802822291851044,
      "val_macro_f1": 0.7170037593620397,
      "val_verse_f1": 0.8084632516703786,
      "val_chorus_f1": 0.6255442670537009,
      "val_chorus_rate": 0.37798555940389633,
      "val_max_prob": 0.6525214314460754,
      "val_conf_over_90": 0.0007036147289909422,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.813922996197847e-05,
      "epoch_time": 655.3779799938202,
      "val_boundary_f1": 0.35401459854014594,
      "val_boundary_precision": 0.28869047619047616,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.23275761180055984,
      "val_avg_segment_overlap": 0.6091201398823496,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.42639293819026153,
      "val_pk_metric": 0.31219714497711787
    },
    {
      "epoch": 13,
      "train_loss": 0.44016244560480117,
      "train_chorus_rate": 0.35640943571925165,
      "train_max_prob": 0.6658265501260757,
      "train_conf_over_90": 0.007338089653057977,
      "train_conf_over_95": 0.00010171711328439414,
      "val_loss": 0.4770147204399109,
      "val_macro_f1": 0.705734498307277,
      "val_verse_f1": 0.789996181748759,
      "val_chorus_f1": 0.621472814865795,
      "val_chorus_rate": 0.4150986671447754,
      "val_max_prob": 0.6543717980384827,
      "val_conf_over_90": 0.0014320802583824843,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.781225572589826e-05,
      "epoch_time": 1407.9624300003052,
      "val_boundary_f1": 0.332420091324201,
      "val_boundary_precision": 0.27123695976154993,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.2196674746250568,
      "val_avg_segment_overlap": 0.6015775045090246,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.44268783124064487,
      "val_pk_metric": 0.3241522807966867
    },
    {
      "epoch": 14,
      "train_loss": 0.44509012550115584,
      "train_chorus_rate": 0.3851580426096916,
      "train_max_prob": 0.6625712513923645,
      "train_conf_over_90": 0.007282145001227036,
      "train_conf_over_95": 3.615329042077065e-05,
      "val_loss": 0.4767453148961067,
      "val_macro_f1": 0.7056484918708275,
      "val_verse_f1": 0.7892119357306809,
      "val_chorus_f1": 0.6220850480109739,
      "val_chorus_rate": 0.4175316393375397,
      "val_max_prob": 0.6528793275356293,
      "val_conf_over_90": 0.0016633475897833705,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.249494759557282e-06,
      "epoch_time": 870.6501269340515,
      "val_boundary_f1": 0.325497287522604,
      "val_boundary_precision": 0.26392961876832843,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.20831088246252616,
      "val_avg_segment_overlap": 0.5985929263299608,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.44829330743972173,
      "val_pk_metric": 0.3261823575040631
    },
    {
      "epoch": 15,
      "train_loss": 0.43111743181943896,
      "train_chorus_rate": 0.3632409080862999,
      "train_max_prob": 0.6700171560049057,
      "train_conf_over_90": 0.010911638761172071,
      "train_conf_over_95": 6.516316207125784e-05,
      "val_loss": 0.47802726179361343,
      "val_macro_f1": 0.710547448191122,
      "val_verse_f1": 0.8008236615499813,
      "val_chorus_f1": 0.6202712348322627,
      "val_chorus_rate": 0.3893610015511513,
      "val_max_prob": 0.6558723747730255,
      "val_conf_over_90": 0.0014320802583824843,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 1617.4417583942413,
      "val_boundary_f1": 0.33393177737881513,
      "val_boundary_precision": 0.26956521739130435,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.22219161101716775,
      "val_avg_segment_overlap": 0.6069056271246418,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.43610841325611943,
      "val_pk_metric": 0.3180782357231408
    }
  ]
}