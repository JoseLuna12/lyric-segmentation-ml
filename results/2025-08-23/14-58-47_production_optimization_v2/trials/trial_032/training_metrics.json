{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.21039335400166245,
      "layer_dropout": 0.20102670418053087,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18917418644264852,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000986803300794772,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015365065869208066,
      "gradient_clip_norm": 0.30039111561526755,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08535275715156244,
        "ece_after": 0.012995770980543608,
        "improvement": 0.07235698617101884,
        "params": {
          "temperature": 0.6240807777424082
        }
      },
      "platt": {
        "ece_before": 0.08535275715156244,
        "ece_after": 0.012207684032106697,
        "improvement": 0.07314507311945574,
        "params": {
          "A": 1.529117286280043,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6172618687152862,
      "train_chorus_rate": 0.4871322038641665,
      "train_max_prob": 0.5937922567129135,
      "train_conf_over_90": 0.02626076340675354,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5933494865894318,
      "val_macro_f1": 0.4644845906137016,
      "val_verse_f1": 0.4308176100628931,
      "val_chorus_f1": 0.4981515711645101,
      "val_chorus_rate": 0.7631624341011047,
      "val_max_prob": 0.5502889007329941,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009760322171313223,
      "epoch_time": 82.39067101478577,
      "val_boundary_f1": 0.06676783004552352,
      "val_boundary_precision": 0.09361702127659574,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.038159878178435976,
      "val_avg_segment_overlap": 0.22954615967668673,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4750066623412083,
      "val_pk_metric": 0.4672354599939229
    },
    {
      "epoch": 2,
      "train_loss": 0.5705651551485061,
      "train_chorus_rate": 0.49473240403458474,
      "train_max_prob": 0.5664717078208923,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6156530529260635,
      "val_macro_f1": 0.5467144293452488,
      "val_verse_f1": 0.8171050607598831,
      "val_chorus_f1": 0.2763237979306147,
      "val_chorus_rate": 0.10418194718658924,
      "val_max_prob": 0.5900246500968933,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009441897141824593,
      "epoch_time": 72.05358290672302,
      "val_boundary_f1": 0.09611829944547136,
      "val_boundary_precision": 0.2222222222222222,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.04920060569583369,
      "val_avg_segment_overlap": 0.2281941636279301,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.3103842538277132,
      "val_pk_metric": 0.3074150550166251
    },
    {
      "epoch": 3,
      "train_loss": 0.5723068088293075,
      "train_chorus_rate": 0.4962112441135105,
      "train_max_prob": 0.5867024809122086,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.586728423833847,
      "val_macro_f1": 0.4505332107582407,
      "val_verse_f1": 0.4064085447263017,
      "val_chorus_f1": 0.49465787679017964,
      "val_chorus_rate": 0.7809006720781326,
      "val_max_prob": 0.5761310458183289,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008926674621243304,
      "epoch_time": 82.21250295639038,
      "val_boundary_f1": 0.07815275310834814,
      "val_boundary_precision": 0.15827338129496402,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.034466044593298044,
      "val_avg_segment_overlap": 0.19848309624069693,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4022228786591938,
      "val_pk_metric": 0.39723184607459183
    },
    {
      "epoch": 4,
      "train_loss": 0.5526521772146225,
      "train_chorus_rate": 0.43141986019909384,
      "train_max_prob": 0.6145323753356934,
      "train_conf_over_90": 0.004731582442764193,
      "train_conf_over_95": 6.242900271899999e-05,
      "val_loss": 0.5479158014059067,
      "val_macro_f1": 0.701066515194898,
      "val_verse_f1": 0.7965754699423041,
      "val_chorus_f1": 0.6055575604474919,
      "val_chorus_rate": 0.3824116364121437,
      "val_max_prob": 0.6087430864572525,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008237172306030709,
      "epoch_time": 363.7241699695587,
      "val_boundary_f1": 0.32037914691943126,
      "val_boundary_precision": 0.26782884310618066,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.180576124147174,
      "val_avg_segment_overlap": 0.5916636269690767,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4069789095565325,
      "val_pk_metric": 0.3161947019294631
    },
    {
      "epoch": 5,
      "train_loss": 0.5259129539132118,
      "train_chorus_rate": 0.3983502138406038,
      "train_max_prob": 0.672547310590744,
      "train_conf_over_90": 0.034529492747969924,
      "train_conf_over_95": 0.0019030272291274742,
      "val_loss": 0.5355983600020409,
      "val_macro_f1": 0.7033722990641342,
      "val_verse_f1": 0.7983630952380951,
      "val_chorus_f1": 0.6083815028901733,
      "val_chorus_rate": 0.380819670855999,
      "val_max_prob": 0.6750110238790512,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000740352475596079,
      "epoch_time": 58.06428122520447,
      "val_boundary_f1": 0.35649546827794565,
      "val_boundary_precision": 0.3110720562390158,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.19282559904246013,
      "val_avg_segment_overlap": 0.5882407486830781,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3705459866699187,
      "val_pk_metric": 0.2985614436896657
    },
    {
      "epoch": 6,
      "train_loss": 0.5113285586237908,
      "train_chorus_rate": 0.39951956644654274,
      "train_max_prob": 0.6668450981378555,
      "train_conf_over_90": 0.005754183768294752,
      "train_conf_over_95": 0.00014992091746535152,
      "val_loss": 0.511449858546257,
      "val_macro_f1": 0.6818659060197565,
      "val_verse_f1": 0.7421020028907702,
      "val_chorus_f1": 0.6216298091487428,
      "val_chorus_rate": 0.5115966200828552,
      "val_max_prob": 0.6997693479061127,
      "val_conf_over_90": 0.02226019895169884,
      "val_conf_over_95": 0.001296230053412728,
      "learning_rate": 0.0006462166369256374,
      "epoch_time": 51.295082330703735,
      "val_boundary_f1": 0.2706766917293233,
      "val_boundary_precision": 0.225,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.14426062936137168,
      "val_avg_segment_overlap": 0.5714006954065747,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.4746327925443323,
      "val_pk_metric": 0.35769008399176994
    },
    {
      "epoch": 7,
      "train_loss": 0.4976611629128456,
      "train_chorus_rate": 0.37786352559924125,
      "train_max_prob": 0.6978276908397675,
      "train_conf_over_90": 0.027459311560960487,
      "train_conf_over_95": 0.0011889272514963522,
      "val_loss": 0.5239470675587654,
      "val_macro_f1": 0.755068199127605,
      "val_verse_f1": 0.8541958041958042,
      "val_chorus_f1": 0.6559405940594059,
      "val_chorus_rate": 0.29617467522621155,
      "val_max_prob": 0.6921205073595047,
      "val_conf_over_90": 0.0009401074494235218,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000545423902455515,
      "epoch_time": 103.15822505950928,
      "val_boundary_f1": 0.373066424021838,
      "val_boundary_precision": 0.3037037037037037,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.27967257895677833,
      "val_avg_segment_overlap": 0.6719813988870831,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.35320833607552116,
      "val_pk_metric": 0.24914184973811476
    },
    {
      "epoch": 8,
      "train_loss": 0.4893901154398918,
      "train_chorus_rate": 0.3772832669317722,
      "train_max_prob": 0.6763437867164612,
      "train_conf_over_90": 0.006561138643883168,
      "train_conf_over_95": 2.915451768785715e-05,
      "val_loss": 0.5129106119275093,
      "val_macro_f1": 0.7645671338020625,
      "val_verse_f1": 0.8575954937511002,
      "val_chorus_f1": 0.6715387738530247,
      "val_chorus_rate": 0.3055955171585083,
      "val_max_prob": 0.7158120274543762,
      "val_conf_over_90": 0.01736482430715114,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004423793983392572,
      "epoch_time": 73.79774117469788,
      "val_boundary_f1": 0.41735537190082644,
      "val_boundary_precision": 0.3713235294117647,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.27034292852161357,
      "val_avg_segment_overlap": 0.6545973957545541,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.2957468427093755,
      "val_pk_metric": 0.22814764448329802
    },
    {
      "epoch": 9,
      "train_loss": 0.4733357220888138,
      "train_chorus_rate": 0.3225782707333565,
      "train_max_prob": 0.7076105386018753,
      "train_conf_over_90": 0.03028662661090493,
      "train_conf_over_95": 0.003340209258021787,
      "val_loss": 0.5024429634213448,
      "val_macro_f1": 0.7075220183240675,
      "val_verse_f1": 0.7794204612655233,
      "val_chorus_f1": 0.6356235753826116,
      "val_chorus_rate": 0.45541786402463913,
      "val_max_prob": 0.6936197727918625,
      "val_conf_over_90": 0.025036917766556144,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0003415866638691348,
      "epoch_time": 132.88380789756775,
      "val_boundary_f1": 0.3096539162112933,
      "val_boundary_precision": 0.2522255192878338,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.1714272236939257,
      "val_avg_segment_overlap": 0.611288680993558,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.44806367495660404,
      "val_pk_metric": 0.3384153024260269
    },
    {
      "epoch": 10,
      "train_loss": 0.46911233067512514,
      "train_chorus_rate": 0.3465270221233368,
      "train_max_prob": 0.7147207617759704,
      "train_conf_over_90": 0.03549054167233408,
      "train_conf_over_95": 0.003103093948448077,
      "val_loss": 0.5026083514094353,
      "val_macro_f1": 0.7235019317038245,
      "val_verse_f1": 0.8062748062748063,
      "val_chorus_f1": 0.6407290571328427,
      "val_chorus_rate": 0.40164124965667725,
      "val_max_prob": 0.6941068917512894,
      "val_conf_over_90": 0.03392213303595781,
      "val_conf_over_95": 0.0011563367443159223,
      "learning_rate": 0.00024745082519869315,
      "epoch_time": 103.23266100883484,
      "val_boundary_f1": 0.33604336043360433,
      "val_boundary_precision": 0.27232796486090777,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21995805645063332,
      "val_avg_segment_overlap": 0.6433563014777994,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4294233116033327,
      "val_pk_metric": 0.2944570453683076
    },
    {
      "epoch": 11,
      "train_loss": 0.46900216192007066,
      "train_chorus_rate": 0.3605488508939743,
      "train_max_prob": 0.7029067516326905,
      "train_conf_over_90": 0.02179781460436061,
      "train_conf_over_95": 0.0009372602362418547,
      "val_loss": 0.509565457701683,
      "val_macro_f1": 0.7640227383579525,
      "val_verse_f1": 0.857845721314356,
      "val_chorus_f1": 0.6701997554015492,
      "val_chorus_rate": 0.30309488624334335,
      "val_max_prob": 0.6911499053239822,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001640860701917013,
      "epoch_time": 109.47883701324463,
      "val_boundary_f1": 0.39587628865979385,
      "val_boundary_precision": 0.3516483516483517,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2499526586880776,
      "val_avg_segment_overlap": 0.6513901157890125,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.31857570663192797,
      "val_pk_metric": 0.23963858830014165
    },
    {
      "epoch": 12,
      "train_loss": 0.4663869947195053,
      "train_chorus_rate": 0.335021947324276,
      "train_max_prob": 0.7134231299161911,
      "train_conf_over_90": 0.02121190099278465,
      "train_conf_over_95": 0.0007191063545178622,
      "val_loss": 0.49596529453992844,
      "val_macro_f1": 0.7569694778067362,
      "val_verse_f1": 0.8432118905202102,
      "val_chorus_f1": 0.6707270650932623,
      "val_chorus_rate": 0.3457811325788498,
      "val_max_prob": 0.7084012478590012,
      "val_conf_over_90": 0.02368492423556745,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 9.513583867044169e-05,
      "epoch_time": 96.27991890907288,
      "val_boundary_f1": 0.3725671918443003,
      "val_boundary_precision": 0.3068702290076336,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.267305885267179,
      "val_avg_segment_overlap": 0.6729344808200167,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3764190945678971,
      "val_pk_metric": 0.25787545588083743
    },
    {
      "epoch": 13,
      "train_loss": 0.4603562533855438,
      "train_chorus_rate": 0.32762758284807203,
      "train_max_prob": 0.7143046855926514,
      "train_conf_over_90": 0.029474206222221255,
      "train_conf_over_95": 0.0018988009833265096,
      "val_loss": 0.4918361008167267,
      "val_macro_f1": 0.7526121919415723,
      "val_verse_f1": 0.8356013240161824,
      "val_chorus_f1": 0.6696230598669622,
      "val_chorus_rate": 0.3655863553285599,
      "val_max_prob": 0.7127951830625534,
      "val_conf_over_90": 0.03298204392194748,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 4.3613586612312684e-05,
      "epoch_time": 97.25190019607544,
      "val_boundary_f1": 0.35754189944134074,
      "val_boundary_precision": 0.2953846153846154,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24600802703931018,
      "val_avg_segment_overlap": 0.6629812302941644,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3648348626963836,
      "val_pk_metric": 0.26483669932565684
    },
    {
      "epoch": 14,
      "train_loss": 0.45436593145132065,
      "train_chorus_rate": 0.32962006852030756,
      "train_max_prob": 0.7264909982681275,
      "train_conf_over_90": 0.03632592619396746,
      "train_conf_over_95": 0.0015572591655654833,
      "val_loss": 0.4940694570541382,
      "val_macro_f1": 0.762192431216125,
      "val_verse_f1": 0.8494430470715054,
      "val_chorus_f1": 0.6749418153607447,
      "val_chorus_rate": 0.33404096961021423,
      "val_max_prob": 0.712178185582161,
      "val_conf_over_90": 0.0241575816180557,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1.1771083663449803e-05,
      "epoch_time": 102.06575894355774,
      "val_boundary_f1": 0.3840304182509506,
      "val_boundary_precision": 0.321656050955414,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.264105663761019,
      "val_avg_segment_overlap": 0.6691704653992583,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.33387939848671033,
      "val_pk_metric": 0.241025828646884
    },
    {
      "epoch": 15,
      "train_loss": 0.4618216440081596,
      "train_chorus_rate": 0.3407144546508789,
      "train_max_prob": 0.7188927143812179,
      "train_conf_over_90": 0.03027619943022728,
      "train_conf_over_95": 0.0013150898506864906,
      "val_loss": 0.493672639131546,
      "val_macro_f1": 0.7595473878244772,
      "val_verse_f1": 0.8465284039675383,
      "val_chorus_f1": 0.672566371681416,
      "val_chorus_rate": 0.33918166160583496,
      "val_max_prob": 0.7076219916343689,
      "val_conf_over_90": 0.02245372603647411,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1e-06,
      "epoch_time": 102.60901689529419,
      "val_boundary_f1": 0.38185255198487716,
      "val_boundary_precision": 0.3186119873817035,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26182633739632677,
      "val_avg_segment_overlap": 0.66628742092641,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3401500290687887,
      "val_pk_metric": 0.2460735256069266
    }
  ]
}