{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.17850535298375542,
      "layer_dropout": 0.2348174435251224,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18030291174228788,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3526147,
      "lstm_params": 2965504,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009986852960962886,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01835838612008037,
      "gradient_clip_norm": 0.3617185411801002,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09776455553318056,
        "ece_after": 0.022519233565199363,
        "improvement": 0.0752453219679812,
        "params": {
          "temperature": 0.5743262016448908
        }
      },
      "platt": {
        "ece_before": 0.09776455553318056,
        "ece_after": 0.03553310417238997,
        "improvement": 0.062231451360790585,
        "params": {
          "A": 1.5253990300640592,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5995463013648987,
      "train_chorus_rate": 0.44825460771098735,
      "train_max_prob": 0.5980533927679061,
      "train_conf_over_90": 0.0034246575087308884,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5877898931503296,
      "val_macro_f1": 0.443285683082651,
      "val_verse_f1": 0.4103367267032106,
      "val_chorus_f1": 0.4762346394620914,
      "val_chorus_rate": 0.7596021294593811,
      "val_max_prob": 0.5545642524957657,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000987784387380135,
      "epoch_time": 229.58003306388855,
      "val_boundary_f1": 0.053859964093357277,
      "val_boundary_precision": 0.11278195488721804,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.022053579105540927,
      "val_avg_segment_overlap": 0.19826449486705433,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4127441401622939,
      "val_pk_metric": 0.4067968695822604
    },
    {
      "epoch": 2,
      "train_loss": 0.5496187552809715,
      "train_chorus_rate": 0.42556661698035897,
      "train_max_prob": 0.5860845535993576,
      "train_conf_over_90": 0.0021463414654135705,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5760286599397659,
      "val_macro_f1": 0.6346830486776195,
      "val_verse_f1": 0.8330415406652874,
      "val_chorus_f1": 0.4363245566899516,
      "val_chorus_rate": 0.15791076235473156,
      "val_max_prob": 0.5876788049936295,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009555580832509333,
      "epoch_time": 206.88750410079956,
      "val_boundary_f1": 0.25060827250608275,
      "val_boundary_precision": 0.25879396984924624,
      "val_boundary_recall": 0.2429245283018868,
      "val_complete_segments": 0.12284362456684832,
      "val_avg_segment_overlap": 0.4051941243336571,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.1414141414141414,
      "val_window_diff": 0.2848296313682064,
      "val_pk_metric": 0.2681838823381311
    },
    {
      "epoch": 3,
      "train_loss": 0.535475404560566,
      "train_chorus_rate": 0.4330793496221304,
      "train_max_prob": 0.6358021557331085,
      "train_conf_over_90": 0.0002917361329309642,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5280955135822296,
      "val_macro_f1": 0.724284284719805,
      "val_verse_f1": 0.8169117647058823,
      "val_chorus_f1": 0.6316568047337278,
      "val_chorus_rate": 0.3650917261838913,
      "val_max_prob": 0.651168629527092,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009034148278380939,
      "epoch_time": 152.50139904022217,
      "val_boundary_f1": 0.35852372583479786,
      "val_boundary_precision": 0.2857142857142857,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.21709557042271782,
      "val_avg_segment_overlap": 0.6130029515107739,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.44079600163957977,
      "val_pk_metric": 0.31520701630403775
    },
    {
      "epoch": 4,
      "train_loss": 0.5045100674033165,
      "train_chorus_rate": 0.3937184177339077,
      "train_max_prob": 0.6571197956800461,
      "train_conf_over_90": 0.0013842740911059082,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5122262537479401,
      "val_macro_f1": 0.7426659865065881,
      "val_verse_f1": 0.8236832274934629,
      "val_chorus_f1": 0.6616487455197133,
      "val_chorus_rate": 0.386013500392437,
      "val_max_prob": 0.6419310122728348,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008336335316142578,
      "epoch_time": 124.99653100967407,
      "val_boundary_f1": 0.3473861720067454,
      "val_boundary_precision": 0.27034120734908135,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.22322791660013291,
      "val_avg_segment_overlap": 0.6469664494595747,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4462005941405071,
      "val_pk_metric": 0.3141779441288004
    },
    {
      "epoch": 5,
      "train_loss": 0.48579968214035035,
      "train_chorus_rate": 0.38099258840084077,
      "train_max_prob": 0.676010611653328,
      "train_conf_over_90": 0.00711172515002545,
      "train_conf_over_95": 0.0008160237222909928,
      "val_loss": 0.5043899491429329,
      "val_macro_f1": 0.7517693158626731,
      "val_verse_f1": 0.8430879712746859,
      "val_chorus_f1": 0.6604506604506604,
      "val_chorus_rate": 0.33251845836639404,
      "val_max_prob": 0.6960235387086868,
      "val_conf_over_90": 0.005748641648096964,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007492639720722167,
      "epoch_time": 166.47254180908203,
      "val_boundary_f1": 0.3752417794970987,
      "val_boundary_precision": 0.3180327868852459,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.22238107862445083,
      "val_avg_segment_overlap": 0.6431316685284729,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3469329961657561,
      "val_pk_metric": 0.2584370456178448
    },
    {
      "epoch": 6,
      "train_loss": 0.48453587740659715,
      "train_chorus_rate": 0.3663559965789318,
      "train_max_prob": 0.6920119017362595,
      "train_conf_over_90": 0.013686743180733174,
      "train_conf_over_95": 0.0003175250923959538,
      "val_loss": 0.48670899868011475,
      "val_macro_f1": 0.7323567781761509,
      "val_verse_f1": 0.7961126537088458,
      "val_chorus_f1": 0.6686009026434558,
      "val_chorus_rate": 0.46282751113176346,
      "val_max_prob": 0.7102347612380981,
      "val_conf_over_90": 0.02766282018274069,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006539935038140218,
      "epoch_time": 140.29420399665833,
      "val_boundary_f1": 0.3583406884377758,
      "val_boundary_precision": 0.2863187588152327,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.23866312911912063,
      "val_avg_segment_overlap": 0.6465477865695799,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.44296616899565405,
      "val_pk_metric": 0.3112035834029055
    },
    {
      "epoch": 7,
      "train_loss": 0.46259114146232605,
      "train_chorus_rate": 0.3532907240092754,
      "train_max_prob": 0.7062103003263474,
      "train_conf_over_90": 0.021719354853848925,
      "train_conf_over_95": 0.001292758871568367,
      "val_loss": 0.5020400211215019,
      "val_macro_f1": 0.7028410377714589,
      "val_verse_f1": 0.7632653061224491,
      "val_chorus_f1": 0.6424167694204687,
      "val_chorus_rate": 0.49736231565475464,
      "val_max_prob": 0.7135637551546097,
      "val_conf_over_90": 0.07107758149504662,
      "val_conf_over_95": 0.0004975080228177831,
      "learning_rate": 0.0005519859034609839,
      "epoch_time": 157.22913312911987,
      "val_boundary_f1": 0.27978339350180503,
      "val_boundary_precision": 0.22660818713450293,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.16489497564524075,
      "val_avg_segment_overlap": 0.5843174042536292,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.468935393543352,
      "val_pk_metric": 0.3375643162560164
    },
    {
      "epoch": 8,
      "train_loss": 0.4676701039075851,
      "train_chorus_rate": 0.3589227631688118,
      "train_max_prob": 0.7031918585300445,
      "train_conf_over_90": 0.017614543560193853,
      "train_conf_over_95": 0.00021848287142347544,
      "val_loss": 0.4899388402700424,
      "val_macro_f1": 0.7489551670026905,
      "val_verse_f1": 0.8255879586077141,
      "val_chorus_f1": 0.6723223753976669,
      "val_chorus_rate": 0.39563363045454025,
      "val_max_prob": 0.7053292393684387,
      "val_conf_over_90": 0.02090876898728311,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004476993926353051,
      "epoch_time": 193.94354104995728,
      "val_boundary_f1": 0.38543516873889877,
      "val_boundary_precision": 0.3091168091168091,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.2658466127845767,
      "val_avg_segment_overlap": 0.6521477839748051,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.41823651809883083,
      "val_pk_metric": 0.29008711093714035
    },
    {
      "epoch": 9,
      "train_loss": 0.44437442570924757,
      "train_chorus_rate": 0.32502180263400077,
      "train_max_prob": 0.7224316388368607,
      "train_conf_over_90": 0.03905244476627558,
      "train_conf_over_95": 0.002969599756761454,
      "val_loss": 0.4943276643753052,
      "val_macro_f1": 0.7672034518455058,
      "val_verse_f1": 0.8527298850574713,
      "val_chorus_f1": 0.6816770186335404,
      "val_chorus_rate": 0.3336769789457321,
      "val_max_prob": 0.7008398026227951,
      "val_conf_over_90": 0.01080894109327346,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003456917922822672,
      "epoch_time": 254.67382621765137,
      "val_boundary_f1": 0.4422507403751234,
      "val_boundary_precision": 0.38030560271646857,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.32904694006231655,
      "val_avg_segment_overlap": 0.6569796112513693,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.36416508917473794,
      "val_pk_metric": 0.24607765620450842
    },
    {
      "epoch": 10,
      "train_loss": 0.439092718064785,
      "train_chorus_rate": 0.3457164362072945,
      "train_max_prob": 0.723758128285408,
      "train_conf_over_90": 0.05582451927475631,
      "train_conf_over_95": 0.0074067498266231265,
      "val_loss": 0.4846067652106285,
      "val_macro_f1": 0.7369285399198019,
      "val_verse_f1": 0.804763764154627,
      "val_chorus_f1": 0.6690933156849768,
      "val_chorus_rate": 0.44302798807621,
      "val_max_prob": 0.7169212847948074,
      "val_conf_over_90": 0.06763118132948875,
      "val_conf_over_95": 0.0023126734886318445,
      "learning_rate": 0.00025042132402407235,
      "epoch_time": 218.33560395240784,
      "val_boundary_f1": 0.36168307967770813,
      "val_boundary_precision": 0.29148629148629146,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.25304804691071925,
      "val_avg_segment_overlap": 0.6392205885179181,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4288473329622384,
      "val_pk_metric": 0.30241586844455726
    },
    {
      "epoch": 11,
      "train_loss": 0.4290675237774849,
      "train_chorus_rate": 0.32857681140303613,
      "train_max_prob": 0.739463922381401,
      "train_conf_over_90": 0.051268010027706624,
      "train_conf_over_95": 0.0031244986428646373,
      "val_loss": 0.4895298257470131,
      "val_macro_f1": 0.7473115805621298,
      "val_verse_f1": 0.8199160625715375,
      "val_chorus_f1": 0.6747070985527222,
      "val_chorus_rate": 0.4138244017958641,
      "val_max_prob": 0.7447494566440582,
      "val_conf_over_90": 0.09197541326284409,
      "val_conf_over_95": 0.00999186944682151,
      "learning_rate": 0.00016605176448203119,
      "epoch_time": 168.7476270198822,
      "val_boundary_f1": 0.3533906399235912,
      "val_boundary_precision": 0.2969502407704655,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.22807324443061455,
      "val_avg_segment_overlap": 0.6342191165684956,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.40797932617459626,
      "val_pk_metric": 0.2846920995139506
    },
    {
      "epoch": 12,
      "train_loss": 0.42790006250143053,
      "train_chorus_rate": 0.35955033004283904,
      "train_max_prob": 0.7455519586801529,
      "train_conf_over_90": 0.08017105795443058,
      "train_conf_over_95": 0.010657909652218222,
      "val_loss": 0.49066896736621857,
      "val_macro_f1": 0.7579319715510404,
      "val_verse_f1": 0.8379475821336287,
      "val_chorus_f1": 0.677916360968452,
      "val_chorus_rate": 0.3707531616091728,
      "val_max_prob": 0.7283866256475449,
      "val_conf_over_90": 0.06026061251759529,
      "val_conf_over_95": 0.0028101815842092037,
      "learning_rate": 9.627046825819491e-05,
      "epoch_time": 220.7840850353241,
      "val_boundary_f1": 0.4124881740775781,
      "val_boundary_precision": 0.344391785150079,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3111324587729678,
      "val_avg_segment_overlap": 0.6601225063979637,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.39243214575503055,
      "val_pk_metric": 0.26449582793089793
    },
    {
      "epoch": 13,
      "train_loss": 0.44163995534181594,
      "train_chorus_rate": 0.3518836468458176,
      "train_max_prob": 0.7307736337184906,
      "train_conf_over_90": 0.058763261511921884,
      "train_conf_over_95": 0.0020833699876675383,
      "val_loss": 0.4886903688311577,
      "val_macro_f1": 0.7555642111016425,
      "val_verse_f1": 0.8402043049981759,
      "val_chorus_f1": 0.670924117205109,
      "val_chorus_rate": 0.3548552691936493,
      "val_max_prob": 0.7106211185455322,
      "val_conf_over_90": 0.03263214975595474,
      "val_conf_over_95": 0.000693802023306489,
      "learning_rate": 4.412721284535539e-05,
      "epoch_time": 162.04308319091797,
      "val_boundary_f1": 0.40526849037487334,
      "val_boundary_precision": 0.3552397868561279,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.27524132980124494,
      "val_avg_segment_overlap": 0.6361845541992938,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3531738221588318,
      "val_pk_metric": 0.25212365940891096
    },
    {
      "epoch": 14,
      "train_loss": 0.4155932739377022,
      "train_chorus_rate": 0.30648173317313193,
      "train_max_prob": 0.7413437783718109,
      "train_conf_over_90": 0.06008054919075221,
      "train_conf_over_95": 0.0036988325882703066,
      "val_loss": 0.4886389970779419,
      "val_macro_f1": 0.760340440162041,
      "val_verse_f1": 0.838912520806362,
      "val_chorus_f1": 0.6817683595177202,
      "val_chorus_rate": 0.3732922077178955,
      "val_max_prob": 0.7379444539546967,
      "val_conf_over_90": 0.08443821780383587,
      "val_conf_over_95": 0.00826318096369505,
      "learning_rate": 1.1900908716153699e-05,
      "epoch_time": 169.29511189460754,
      "val_boundary_f1": 0.40812379110251445,
      "val_boundary_precision": 0.34590163934426227,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.28601436992211116,
      "val_avg_segment_overlap": 0.6585646615964452,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.37786952210833247,
      "val_pk_metric": 0.25771894029127207
    },
    {
      "epoch": 15,
      "train_loss": 0.4284031271934509,
      "train_chorus_rate": 0.342768557369709,
      "train_max_prob": 0.750458300113678,
      "train_conf_over_90": 0.08722830712795257,
      "train_conf_over_95": 0.009395803569350391,
      "val_loss": 0.4877520427107811,
      "val_macro_f1": 0.7591483731539753,
      "val_verse_f1": 0.8371057513914656,
      "val_chorus_f1": 0.681190994916485,
      "val_chorus_rate": 0.37743429094552994,
      "val_max_prob": 0.7315923869609833,
      "val_conf_over_90": 0.07753479108214378,
      "val_conf_over_95": 0.006564221926964819,
      "learning_rate": 1e-06,
      "epoch_time": 159.31720900535583,
      "val_boundary_f1": 0.404692082111437,
      "val_boundary_precision": 0.34557595993322204,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28036065720318104,
      "val_avg_segment_overlap": 0.653346583595072,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.38019936105501495,
      "val_pk_metric": 0.2596589637975952
    }
  ]
}