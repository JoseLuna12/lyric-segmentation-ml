{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2218563827162236,
      "layer_dropout": 0.2396900313147464,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.14816098055564583,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000825293205466523,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.010365712055920623,
      "gradient_clip_norm": 0.34390163238740207,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.117776177018471,
        "ece_after": 0.02404362478518533,
        "improvement": 0.09373255223328567,
        "params": {
          "temperature": 0.4706311184723943
        }
      },
      "platt": {
        "ece_before": 0.117776177018471,
        "ece_after": 0.03829201477742618,
        "improvement": 0.07948416224104482,
        "params": {
          "A": 1.812853992000684,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6019381403923034,
      "train_chorus_rate": 0.5991970077157021,
      "train_max_prob": 0.5846596986055375,
      "train_conf_over_90": 0.0026445263996720315,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5966315865516663,
      "val_macro_f1": 0.3445590109265116,
      "val_verse_f1": 0.20387742338961848,
      "val_chorus_f1": 0.4852405984634047,
      "val_chorus_rate": 0.9148253202438354,
      "val_max_prob": 0.6129841506481171,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007939204133925821,
      "epoch_time": 116.24757790565491,
      "val_boundary_f1": 0.003642987249544627,
      "val_boundary_precision": 0.008,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.0020325203252032522,
      "val_avg_segment_overlap": 0.13974726863934267,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40690766171918247,
      "val_pk_metric": 0.393891033422625
    },
    {
      "epoch": 2,
      "train_loss": 0.5685603946447373,
      "train_chorus_rate": 0.5880609924788587,
      "train_max_prob": 0.5690791666507721,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5852913111448288,
      "val_macro_f1": 0.4530070260796828,
      "val_verse_f1": 0.42157373632100054,
      "val_chorus_f1": 0.48444031583836505,
      "val_chorus_rate": 0.7582822293043137,
      "val_max_prob": 0.571808934211731,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007045782603689487,
      "epoch_time": 518.1014866828918,
      "val_boundary_f1": 0.06533575317604357,
      "val_boundary_precision": 0.14173228346456693,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.027048505481697425,
      "val_avg_segment_overlap": 0.19850089061711745,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4220739138645979,
      "val_pk_metric": 0.41805517818841853
    },
    {
      "epoch": 3,
      "train_loss": 0.5614839166402816,
      "train_chorus_rate": 0.5893192254006863,
      "train_max_prob": 0.5781013190746307,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5744225978851318,
      "val_macro_f1": 0.453970697889466,
      "val_verse_f1": 0.3991263991263991,
      "val_chorus_f1": 0.5088149966525329,
      "val_chorus_rate": 0.8013152182102203,
      "val_max_prob": 0.5633622407913208,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005708682793048372,
      "epoch_time": 62.78612685203552,
      "val_boundary_f1": 0.05923344947735191,
      "val_boundary_precision": 0.11333333333333333,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.023768648211914385,
      "val_avg_segment_overlap": 0.2066423816931297,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4291811162441127,
      "val_pk_metric": 0.42291226840580975
    },
    {
      "epoch": 4,
      "train_loss": 0.5480124697089195,
      "train_chorus_rate": 0.4939723275601864,
      "train_max_prob": 0.5918489396572113,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5469493865966797,
      "val_macro_f1": 0.6154406352593885,
      "val_verse_f1": 0.651705565529623,
      "val_chorus_f1": 0.579175704989154,
      "val_chorus_rate": 0.6076388955116272,
      "val_max_prob": 0.5971239656209946,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004131466027332615,
      "epoch_time": 75.53930497169495,
      "val_boundary_f1": 0.15011037527593818,
      "val_boundary_precision": 0.14107883817427386,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.0473681301358926,
      "val_avg_segment_overlap": 0.42491210954361963,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.1414141414141414,
      "val_window_diff": 0.5101020426521704,
      "val_pk_metric": 0.4295413036638396
    },
    {
      "epoch": 5,
      "train_loss": 0.5195057824254036,
      "train_chorus_rate": 0.44911074787378313,
      "train_max_prob": 0.6358755230903625,
      "train_conf_over_90": 0.002567265080870129,
      "train_conf_over_95": 0.0,
      "val_loss": 0.528659038245678,
      "val_macro_f1": 0.7244486903908924,
      "val_verse_f1": 0.8075471698113207,
      "val_chorus_f1": 0.6413502109704641,
      "val_chorus_rate": 0.3997565135359764,
      "val_max_prob": 0.6318774372339249,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025542492616168594,
      "epoch_time": 73.20323920249939,
      "val_boundary_f1": 0.33587786259541985,
      "val_boundary_precision": 0.28205128205128205,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.21690311732729547,
      "val_avg_segment_overlap": 0.6297512132451702,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4034933600296683,
      "val_pk_metric": 0.2961314987289687
    },
    {
      "epoch": 6,
      "train_loss": 0.5092164352536201,
      "train_chorus_rate": 0.4088642880320549,
      "train_max_prob": 0.6487459063529968,
      "train_conf_over_90": 0.0038958802586421372,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5199525132775307,
      "val_macro_f1": 0.6757528409632907,
      "val_verse_f1": 0.7371463968614496,
      "val_chorus_f1": 0.6143592850651318,
      "val_chorus_rate": 0.5115027576684952,
      "val_max_prob": 0.6537966579198837,
      "val_conf_over_90": 0.0076324958354234695,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012171494509757425,
      "epoch_time": 61.719833850860596,
      "val_boundary_f1": 0.2336448598130841,
      "val_boundary_precision": 0.19349845201238391,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.11472444456272662,
      "val_avg_segment_overlap": 0.5600296012790349,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.4940608996908483,
      "val_pk_metric": 0.38704816586311225
    },
    {
      "epoch": 7,
      "train_loss": 0.5063085600733757,
      "train_chorus_rate": 0.41551581397652626,
      "train_max_prob": 0.6546434819698334,
      "train_conf_over_90": 0.01811534706503153,
      "train_conf_over_95": 0.0003631734958617017,
      "val_loss": 0.5221648514270782,
      "val_macro_f1": 0.711786416181107,
      "val_verse_f1": 0.7931826886250478,
      "val_chorus_f1": 0.6303901437371663,
      "val_chorus_rate": 0.4189572334289551,
      "val_max_prob": 0.6940540373325348,
      "val_conf_over_90": 0.020030560030136257,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.2372792073940854e-05,
      "epoch_time": 150.45501589775085,
      "val_boundary_f1": 0.33170731707317075,
      "val_boundary_precision": 0.28286189683860236,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.1820708642288706,
      "val_avg_segment_overlap": 0.6140846969617021,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.42947799266134984,
      "val_pk_metric": 0.33155467723745136
    },
    {
      "epoch": 8,
      "train_loss": 0.49601405709981916,
      "train_chorus_rate": 0.37883893996477125,
      "train_max_prob": 0.6717012256383896,
      "train_conf_over_90": 0.012958615657407791,
      "train_conf_over_95": 7.678400725126266e-05,
      "val_loss": 0.5162685886025429,
      "val_macro_f1": 0.7177285628249868,
      "val_verse_f1": 0.7946738710922424,
      "val_chorus_f1": 0.6407832545577312,
      "val_chorus_rate": 0.4283740222454071,
      "val_max_prob": 0.6529771983623505,
      "val_conf_over_90": 0.0022311121283564717,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 98.09546899795532,
      "val_boundary_f1": 0.2951127819548872,
      "val_boundary_precision": 0.2453125,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.15947948781989077,
      "val_avg_segment_overlap": 0.6128766703040539,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4468735968572344,
      "val_pk_metric": 0.33728589990110663
    }
  ]
}