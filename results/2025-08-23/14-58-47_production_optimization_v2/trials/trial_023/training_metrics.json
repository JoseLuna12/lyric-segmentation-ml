{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.23742290399428773,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.21595984414081335,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00024301156065392228,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 9,
      "validation_strategy": "composite",
      "weight_decay": 0.009207539814908794,
      "gradient_clip_norm": 0.32311595025028383,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07032358729827615,
        "ece_after": 0.03348483408715261,
        "improvement": 0.03683875321112354,
        "params": {
          "temperature": 0.7085237210366722
        }
      },
      "platt": {
        "ece_before": 0.07032358729827615,
        "ece_after": 0.030947981537676535,
        "improvement": 0.03937560576059961,
        "params": {
          "A": 0.9645681098890148,
          "B": 0.424485712618762
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5736854046583175,
      "train_chorus_rate": 0.43213230147957804,
      "train_max_prob": 0.5571124494075775,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5862409174442291,
      "val_macro_f1": 0.49014914340429877,
      "val_verse_f1": 0.4939054119941493,
      "val_chorus_f1": 0.48639287481444826,
      "val_chorus_rate": 0.694073036313057,
      "val_max_prob": 0.5741604119539261,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002403672940287001,
      "epoch_time": 51.995503187179565,
      "val_boundary_f1": 0.043478260869565216,
      "val_boundary_precision": 0.07471264367816093,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.01833386560321873,
      "val_avg_segment_overlap": 0.22054133518171826,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4363234136933153,
      "val_pk_metric": 0.4279550890902803
    },
    {
      "epoch": 2,
      "train_loss": 0.569375467300415,
      "train_chorus_rate": 0.5216046223416925,
      "train_max_prob": 0.5959654182195664,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6262893080711365,
      "val_macro_f1": 0.42293818151835594,
      "val_verse_f1": 0.8248407643312102,
      "val_chorus_f1": 0.021035598705501618,
      "val_chorus_rate": 0.003538956865668297,
      "val_max_prob": 0.6512195467948914,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023255006129315487,
      "epoch_time": 49.48798322677612,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.17073260312618643,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26812230108202556,
      "val_pk_metric": 0.27247289661096563
    },
    {
      "epoch": 3,
      "train_loss": 0.5382135048508644,
      "train_chorus_rate": 0.34775493448833006,
      "train_max_prob": 0.6065357774496078,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5641663074493408,
      "val_macro_f1": 0.5429275844143144,
      "val_verse_f1": 0.5693057812862782,
      "val_chorus_f1": 0.5165493875423508,
      "val_chorus_rate": 0.6438663303852081,
      "val_max_prob": 0.6144459545612335,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021990151302907438,
      "epoch_time": 61.448832988739014,
      "val_boundary_f1": 0.1406060606060606,
      "val_boundary_precision": 0.14463840399002495,
      "val_boundary_recall": 0.13679245283018868,
      "val_complete_segments": 0.050157957912464815,
      "val_avg_segment_overlap": 0.29693452839387724,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.1111111111111111,
      "val_window_diff": 0.4369319637216498,
      "val_pk_metric": 0.36168547025695913
    },
    {
      "epoch": 4,
      "train_loss": 0.5194477424025535,
      "train_chorus_rate": 0.46072009652853013,
      "train_max_prob": 0.6324239015579224,
      "train_conf_over_90": 0.004041431879159063,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5380590707063675,
      "val_macro_f1": 0.6954708714152338,
      "val_verse_f1": 0.7989000916590285,
      "val_chorus_f1": 0.5920416511714391,
      "val_chorus_rate": 0.36201195418834686,
      "val_max_prob": 0.6588154137134552,
      "val_conf_over_90": 0.015310452552512288,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020297445149006744,
      "epoch_time": 60.67081594467163,
      "val_boundary_f1": 0.29290206648697215,
      "val_boundary_precision": 0.2365747460087083,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1667573231465066,
      "val_avg_segment_overlap": 0.5433707245592423,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.38929701248106374,
      "val_pk_metric": 0.30532926739881583
    },
    {
      "epoch": 5,
      "train_loss": 0.5062317252159119,
      "train_chorus_rate": 0.39293464422225954,
      "train_max_prob": 0.6784311056137085,
      "train_conf_over_90": 0.02405617441982031,
      "train_conf_over_95": 0.0012874433625256643,
      "val_loss": 0.5483408719301224,
      "val_macro_f1": 0.5839383816643902,
      "val_verse_f1": 0.6162260711030082,
      "val_chorus_f1": 0.5516506922257722,
      "val_chorus_rate": 0.6242189258337021,
      "val_max_prob": 0.6647080183029175,
      "val_conf_over_90": 0.015597774472553283,
      "val_conf_over_95": 0.0014422027743421495,
      "learning_rate": 0.0001825086704904417,
      "epoch_time": 49.17928218841553,
      "val_boundary_f1": 0.1977186311787072,
      "val_boundary_precision": 0.16560509554140126,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.06901762768676872,
      "val_avg_segment_overlap": 0.42650390388452064,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.2828282828282828,
      "val_window_diff": 0.5226569565766139,
      "val_pk_metric": 0.39097821777821173
    },
    {
      "epoch": 6,
      "train_loss": 0.5147256121039391,
      "train_chorus_rate": 0.4379076071083546,
      "train_max_prob": 0.6742625921964646,
      "train_conf_over_90": 0.019066979369381443,
      "train_conf_over_95": 0.0004103963496163487,
      "val_loss": 0.551397904753685,
      "val_macro_f1": 0.7000981111609355,
      "val_verse_f1": 0.8502700049091801,
      "val_chorus_f1": 0.5499262174126907,
      "val_chorus_rate": 0.20041939243674278,
      "val_max_prob": 0.692283496260643,
      "val_conf_over_90": 0.0123606693232432,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015939862286559384,
      "epoch_time": 449.62048983573914,
      "val_boundary_f1": 0.3295668549905838,
      "val_boundary_precision": 0.274294670846395,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.19456513209164322,
      "val_avg_segment_overlap": 0.5555654571367836,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.3460410733597412,
      "val_pk_metric": 0.2717917014225356
    },
    {
      "epoch": 7,
      "train_loss": 0.48360909074544906,
      "train_chorus_rate": 0.35463037714362144,
      "train_max_prob": 0.6936217099428177,
      "train_conf_over_90": 0.026466017845086752,
      "train_conf_over_95": 0.0011006771092070267,
      "val_loss": 0.5414470657706261,
      "val_macro_f1": 0.7150978706922316,
      "val_verse_f1": 0.8331307518666434,
      "val_chorus_f1": 0.5970649895178198,
      "val_chorus_rate": 0.28746695071458817,
      "val_max_prob": 0.6935246586799622,
      "val_conf_over_90": 0.02577406819909811,
      "val_conf_over_95": 0.0007134274201234803,
      "learning_rate": 0.00013465432859104167,
      "epoch_time": 66.76716089248657,
      "val_boundary_f1": 0.32460732984293195,
      "val_boundary_precision": 0.25761772853185594,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.22151752191518895,
      "val_avg_segment_overlap": 0.6028319950811625,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.40322893124144066,
      "val_pk_metric": 0.30121280105720416
    },
    {
      "epoch": 8,
      "train_loss": 0.4873575121164322,
      "train_chorus_rate": 0.349331958591938,
      "train_max_prob": 0.6827740550041199,
      "train_conf_over_90": 0.01781981169478968,
      "train_conf_over_95": 0.0009924011974362656,
      "val_loss": 0.5093515440821648,
      "val_macro_f1": 0.7128368574407928,
      "val_verse_f1": 0.7930902111324376,
      "val_chorus_f1": 0.632583503749148,
      "val_chorus_rate": 0.42244163900613785,
      "val_max_prob": 0.6666526794433594,
      "val_conf_over_90": 0.011922967270947993,
      "val_conf_over_95": 0.000979668096988462,
      "learning_rate": 0.00010935723206288067,
      "epoch_time": 2332.40101313591,
      "val_boundary_f1": 0.30692243536280234,
      "val_boundary_precision": 0.23741935483870968,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.16625813246969134,
      "val_avg_segment_overlap": 0.597154726496243,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.45198600679160494,
      "val_pk_metric": 0.3337176512187514
    },
    {
      "epoch": 9,
      "train_loss": 0.48137982487678527,
      "train_chorus_rate": 0.38084549009799956,
      "train_max_prob": 0.6993387877941132,
      "train_conf_over_90": 0.037755606882274154,
      "train_conf_over_95": 0.0033922128088306634,
      "val_loss": 0.5043670758605003,
      "val_macro_f1": 0.7145669270627844,
      "val_verse_f1": 0.7967200610221205,
      "val_chorus_f1": 0.6324137931034483,
      "val_chorus_rate": 0.4139040783047676,
      "val_max_prob": 0.6925220787525177,
      "val_conf_over_90": 0.0238426779396832,
      "val_conf_over_95": 0.0012459087738534436,
      "learning_rate": 8.461293778832849e-05,
      "epoch_time": 4743.480376243591,
      "val_boundary_f1": 0.314410480349345,
      "val_boundary_precision": 0.24965325936199723,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.21424985430817878,
      "val_avg_segment_overlap": 0.5956036942249806,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3918426068880661,
      "val_pk_metric": 0.3007384224844723
    }
  ]
}