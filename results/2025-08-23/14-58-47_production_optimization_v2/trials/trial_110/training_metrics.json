{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2650000039888396,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 256,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 726018,
      "lstm_params": 724992,
      "attention_params": 0,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009463769729858875,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.02012768576841817,
      "gradient_clip_norm": 0.3932779983968804,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10747875239561021,
        "ece_after": 0.011641422722100732,
        "improvement": 0.09583732967350947,
        "params": {
          "temperature": 0.5018745582020122
        }
      },
      "platt": {
        "ece_before": 0.10747875239561021,
        "ece_after": 0.011630332803679356,
        "improvement": 0.09584841959193086,
        "params": {
          "A": 2.0385633740711313,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5521793693304062,
      "train_chorus_rate": 0.661984221637249,
      "train_max_prob": 0.5635657876729965,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5758735239505768,
      "val_macro_f1": 0.5917876061394789,
      "val_verse_f1": 0.8061191626409019,
      "val_chorus_f1": 0.3774560496380558,
      "val_chorus_rate": 0.1763727106153965,
      "val_max_prob": 0.581341102719307,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009360475954505106,
      "epoch_time": 152.30632305145264,
      "val_boundary_f1": 0.26987951807228916,
      "val_boundary_precision": 0.27586206896551724,
      "val_boundary_recall": 0.2641509433962264,
      "val_complete_segments": 0.13492166420321244,
      "val_avg_segment_overlap": 0.3649413134971153,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.20707070707070707,
      "val_window_diff": 0.41374007782963085,
      "val_pk_metric": 0.33813644619361516
    },
    {
      "epoch": 2,
      "train_loss": 0.5348251700401306,
      "train_chorus_rate": 0.48363276310265063,
      "train_max_prob": 0.586883407831192,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5323482900857925,
      "val_macro_f1": 0.7059492341654879,
      "val_verse_f1": 0.7821338014433391,
      "val_chorus_f1": 0.6297646668876368,
      "val_chorus_rate": 0.4419589564204216,
      "val_max_prob": 0.6061878502368927,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009055109062085284,
      "epoch_time": 130.06801581382751,
      "val_boundary_f1": 0.3351605324980423,
      "val_boundary_precision": 0.2508792497069168,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.246652909537321,
      "val_avg_segment_overlap": 0.6175548267890258,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.47057459053396405,
      "val_pk_metric": 0.330623207566917
    },
    {
      "epoch": 3,
      "train_loss": 0.5139500081539154,
      "train_chorus_rate": 0.4542204186320305,
      "train_max_prob": 0.625003045797348,
      "train_conf_over_90": 0.0012127795605920255,
      "train_conf_over_95": 2.8901733458042145e-05,
      "val_loss": 0.5243920832872391,
      "val_macro_f1": 0.7169279092013704,
      "val_verse_f1": 0.7949951876804621,
      "val_chorus_f1": 0.6388606307222787,
      "val_chorus_rate": 0.42555253952741623,
      "val_max_prob": 0.6481940597295761,
      "val_conf_over_90": 0.0009250693838112056,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008561015051111081,
      "epoch_time": 137.73850321769714,
      "val_boundary_f1": 0.3620689655172414,
      "val_boundary_precision": 0.28532608695652173,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2706988328276769,
      "val_avg_segment_overlap": 0.6145952464665592,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.43059637697712516,
      "val_pk_metric": 0.31486110487546637
    },
    {
      "epoch": 4,
      "train_loss": 0.5083994477987289,
      "train_chorus_rate": 0.43761601448059084,
      "train_max_prob": 0.6389857262372971,
      "train_conf_over_90": 0.003107888693921268,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5131869912147522,
      "val_macro_f1": 0.6984429343979905,
      "val_verse_f1": 0.756132756132756,
      "val_chorus_f1": 0.6407531126632251,
      "val_chorus_rate": 0.5092270970344543,
      "val_max_prob": 0.6250537782907486,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007899788200788182,
      "epoch_time": 139.2251660823822,
      "val_boundary_f1": 0.29752066115702486,
      "val_boundary_precision": 0.22900763358778625,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.20206205106788352,
      "val_avg_segment_overlap": 0.6081570737859426,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4840180731535222,
      "val_pk_metric": 0.35903644456117845
    },
    {
      "epoch": 5,
      "train_loss": 0.49437997937202455,
      "train_chorus_rate": 0.43425608724355697,
      "train_max_prob": 0.6470129698514938,
      "train_conf_over_90": 0.005035421226057224,
      "train_conf_over_95": 0.00017152113432530313,
      "val_loss": 0.5091041475534439,
      "val_macro_f1": 0.7221714932842254,
      "val_verse_f1": 0.7868525896414341,
      "val_chorus_f1": 0.6574903969270167,
      "val_chorus_rate": 0.4680941104888916,
      "val_max_prob": 0.6488641947507858,
      "val_conf_over_90": 0.0009250693838112056,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007100327297394157,
      "epoch_time": 131.72471499443054,
      "val_boundary_f1": 0.36140350877192984,
      "val_boundary_precision": 0.2877094972067039,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.27634497093669946,
      "val_avg_segment_overlap": 0.6280322841934436,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4459901999298047,
      "val_pk_metric": 0.32641291370917236
    },
    {
      "epoch": 6,
      "train_loss": 0.49688777774572374,
      "train_chorus_rate": 0.44250614047050474,
      "train_max_prob": 0.6501834928989411,
      "train_conf_over_90": 0.009800545280450023,
      "train_conf_over_95": 0.0005842256010510028,
      "val_loss": 0.5077291429042816,
      "val_macro_f1": 0.7094094023917197,
      "val_verse_f1": 0.7674989766680312,
      "val_chorus_f1": 0.6513198281154082,
      "val_chorus_rate": 0.5006726831197739,
      "val_max_prob": 0.6594785153865814,
      "val_conf_over_90": 0.005386673961766064,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006197572618646363,
      "epoch_time": 140.0615680217743,
      "val_boundary_f1": 0.3394575678040245,
      "val_boundary_precision": 0.2698191933240612,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2440899276795353,
      "val_avg_segment_overlap": 0.6231381500007577,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.45964907533827204,
      "val_pk_metric": 0.3340489059540693
    },
    {
      "epoch": 7,
      "train_loss": 0.49010988026857377,
      "train_chorus_rate": 0.4092185840010643,
      "train_max_prob": 0.6577374905347824,
      "train_conf_over_90": 0.008746669034007937,
      "train_conf_over_95": 0.0010643437533872202,
      "val_loss": 0.5071484446525574,
      "val_macro_f1": 0.70342968601231,
      "val_verse_f1": 0.7670845127375657,
      "val_chorus_f1": 0.6397748592870544,
      "val_chorus_rate": 0.485662080347538,
      "val_max_prob": 0.6544193923473358,
      "val_conf_over_90": 0.008180887904018164,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0005230978875903643,
      "epoch_time": 133.6367859840393,
      "val_boundary_f1": 0.32628909551986474,
      "val_boundary_precision": 0.25428194993412384,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.21990730315226603,
      "val_avg_segment_overlap": 0.6264767105397683,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.47165561815988133,
      "val_pk_metric": 0.3393558759502269
    },
    {
      "epoch": 8,
      "train_loss": 0.48845855295658114,
      "train_chorus_rate": 0.4223706632852554,
      "train_max_prob": 0.6515086144208908,
      "train_conf_over_90": 0.011597439518664033,
      "train_conf_over_95": 0.0014621568843722343,
      "val_loss": 0.5077780783176422,
      "val_macro_f1": 0.6907821496546523,
      "val_verse_f1": 0.7466722129783695,
      "val_chorus_f1": 0.6348920863309352,
      "val_chorus_rate": 0.5196861624717712,
      "val_max_prob": 0.6593374758958817,
      "val_conf_over_90": 0.013798537198454142,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004242790853955236,
      "epoch_time": 137.92999005317688,
      "val_boundary_f1": 0.30127041742286753,
      "val_boundary_precision": 0.2448377581120944,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.16584516269033767,
      "val_avg_segment_overlap": 0.5843436378649713,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4761291528635406,
      "val_pk_metric": 0.3567599037833091
    },
    {
      "epoch": 9,
      "train_loss": 0.4885271042585373,
      "train_chorus_rate": 0.42293504625558853,
      "train_max_prob": 0.6592942178249359,
      "train_conf_over_90": 0.01262186446110718,
      "train_conf_over_95": 0.0012317584798438475,
      "val_loss": 0.5080292895436287,
      "val_macro_f1": 0.725654179464436,
      "val_verse_f1": 0.7977440684558539,
      "val_chorus_f1": 0.653564290473018,
      "val_chorus_rate": 0.43818797171115875,
      "val_max_prob": 0.6666622012853622,
      "val_conf_over_90": 0.012898919987492263,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.00032761971112125153,
      "epoch_time": 132.69203186035156,
      "val_boundary_f1": 0.34116623150565706,
      "val_boundary_precision": 0.27034482758620687,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2421788058320402,
      "val_avg_segment_overlap": 0.645300055561736,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4548031300930563,
      "val_pk_metric": 0.3326899139790937
    },
    {
      "epoch": 10,
      "train_loss": 0.48228304237127306,
      "train_chorus_rate": 0.38806035816669465,
      "train_max_prob": 0.6659228414297104,
      "train_conf_over_90": 0.01324051881674677,
      "train_conf_over_95": 0.001151672683772631,
      "val_loss": 0.5054929554462433,
      "val_macro_f1": 0.7425702556289149,
      "val_verse_f1": 0.8189393939393939,
      "val_chorus_f1": 0.6662011173184358,
      "val_chorus_rate": 0.40440502017736435,
      "val_max_prob": 0.6579864770174026,
      "val_conf_over_90": 0.005292204790748656,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023734424324647205,
      "epoch_time": 138.86120414733887,
      "val_boundary_f1": 0.35982532751091706,
      "val_boundary_precision": 0.2857142857142857,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2605266605796829,
      "val_avg_segment_overlap": 0.6572747981817373,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.44543200583802256,
      "val_pk_metric": 0.31890447827340646
    },
    {
      "epoch": 11,
      "train_loss": 0.4791505292057991,
      "train_chorus_rate": 0.38130174204707146,
      "train_max_prob": 0.6580184549093246,
      "train_conf_over_90": 0.010298415907891467,
      "train_conf_over_95": 0.0006121077865827828,
      "val_loss": 0.5034718960523605,
      "val_macro_f1": 0.720978283786633,
      "val_verse_f1": 0.7903225806451613,
      "val_chorus_f1": 0.6516339869281047,
      "val_chorus_rate": 0.45212025195360184,
      "val_max_prob": 0.6525736451148987,
      "val_conf_over_90": 0.010024947114288807,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015739815290706952,
      "epoch_time": 143.02721190452576,
      "val_boundary_f1": 0.33276740237691,
      "val_boundary_precision": 0.259946949602122,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.24077429573187792,
      "val_avg_segment_overlap": 0.6360091166362533,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.46785813409125265,
      "val_pk_metric": 0.33610270984841484
    },
    {
      "epoch": 12,
      "train_loss": 0.47498390525579454,
      "train_chorus_rate": 0.3919986844062805,
      "train_max_prob": 0.6638797014951706,
      "train_conf_over_90": 0.015684365958441047,
      "train_conf_over_95": 0.0015793833474162966,
      "val_loss": 0.50530955940485,
      "val_macro_f1": 0.7346260202916535,
      "val_verse_f1": 0.81061473844979,
      "val_chorus_f1": 0.6586373021335169,
      "val_chorus_rate": 0.4148136153817177,
      "val_max_prob": 0.6627207547426224,
      "val_conf_over_90": 0.010005011805333197,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.127546787477951e-05,
      "epoch_time": 141.36751008033752,
      "val_boundary_f1": 0.3572679509632224,
      "val_boundary_precision": 0.2841225626740947,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.24397451723803792,
      "val_avg_segment_overlap": 0.6463682127974204,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.44853029566852,
      "val_pk_metric": 0.3203766955762335
    },
    {
      "epoch": 13,
      "train_loss": 0.48272946029901503,
      "train_chorus_rate": 0.4061098530888557,
      "train_max_prob": 0.6623962670564651,
      "train_conf_over_90": 0.017456482601119205,
      "train_conf_over_95": 0.0014562661264790222,
      "val_loss": 0.5036967694759369,
      "val_macro_f1": 0.7306212163980255,
      "val_verse_f1": 0.8005459153831157,
      "val_chorus_f1": 0.6606965174129353,
      "val_chorus_rate": 0.44109775125980377,
      "val_max_prob": 0.6634780615568161,
      "val_conf_over_90": 0.015682467026636004,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.186606677735904e-05,
      "epoch_time": 146.1938500404358,
      "val_boundary_f1": 0.35429583702391493,
      "val_boundary_precision": 0.28368794326241137,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.25995242326101287,
      "val_avg_segment_overlap": 0.6429172324517445,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.45759493033495724,
      "val_pk_metric": 0.3204184873519852
    },
    {
      "epoch": 14,
      "train_loss": 0.4832769438624382,
      "train_chorus_rate": 0.41532510071992873,
      "train_max_prob": 0.6624877899885178,
      "train_conf_over_90": 0.015363708866061643,
      "train_conf_over_95": 0.0015130343002965675,
      "val_loss": 0.504886120557785,
      "val_macro_f1": 0.7304693426274401,
      "val_verse_f1": 0.8034782608695653,
      "val_chorus_f1": 0.6574604243853149,
      "val_chorus_rate": 0.4300958514213562,
      "val_max_prob": 0.6627592593431473,
      "val_conf_over_90": 0.014747895300388336,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1329377535376906e-05,
      "epoch_time": 155.19194197654724,
      "val_boundary_f1": 0.35532102022867196,
      "val_boundary_precision": 0.28330995792426367,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.253075257502617,
      "val_avg_segment_overlap": 0.6463137361324311,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4584541116767824,
      "val_pk_metric": 0.32579627162130254
    }
  ]
}