{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.16343491662366816,
      "layer_dropout": 0.23991579802092267,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1314509569765976,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2788867,
      "lstm_params": 2228224,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.000771353728534339,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01915074667594571,
      "gradient_clip_norm": 0.5180020544542104,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0779409398176581,
        "ece_after": 0.01689540220091525,
        "improvement": 0.06104553761674285,
        "params": {
          "temperature": 0.6517048048715933
        }
      },
      "platt": {
        "ece_before": 0.0779409398176581,
        "ece_after": 0.016077973782899088,
        "improvement": 0.06186296603475901,
        "params": {
          "A": 1.3114165679136591,
          "B": 0.20161251590750437
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6310576975345612,
      "train_chorus_rate": 0.6157804973423481,
      "train_max_prob": 0.5993445575237274,
      "train_conf_over_90": 0.0012647058814764024,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6040041744709015,
      "val_macro_f1": 0.3404054283214686,
      "val_verse_f1": 0.19705051772827112,
      "val_chorus_f1": 0.4837603389146661,
      "val_chorus_rate": 0.9174878895282745,
      "val_max_prob": 0.6087444424629211,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007629366899082721,
      "epoch_time": 124.6598482131958,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.1346259238007691,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40163025013212994,
      "val_pk_metric": 0.3874917807883339
    },
    {
      "epoch": 2,
      "train_loss": 0.5718876719474792,
      "train_chorus_rate": 0.4568315092474222,
      "train_max_prob": 0.5736046552658081,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5985299646854401,
      "val_macro_f1": 0.5539243211235333,
      "val_verse_f1": 0.6658814291323125,
      "val_chorus_f1": 0.4419672131147541,
      "val_chorus_rate": 0.4489901065826416,
      "val_max_prob": 0.5496503114700317,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007380534390074628,
      "epoch_time": 86.19042205810547,
      "val_boundary_f1": 0.0744336569579288,
      "val_boundary_precision": 0.11855670103092783,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.036159003831417624,
      "val_avg_segment_overlap": 0.24451243643928516,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.42586218176749113,
      "val_pk_metric": 0.41987107637588944
    },
    {
      "epoch": 3,
      "train_loss": 0.558334481716156,
      "train_chorus_rate": 0.5262815102934837,
      "train_max_prob": 0.5702408492565155,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5891430079936981,
      "val_macro_f1": 0.45310858926233505,
      "val_verse_f1": 0.4332313965341488,
      "val_chorus_f1": 0.47298578199052127,
      "val_chorus_rate": 0.736463338136673,
      "val_max_prob": 0.5687640011310577,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006977914932993621,
      "epoch_time": 78.29841589927673,
      "val_boundary_f1": 0.04727272727272727,
      "val_boundary_precision": 0.10317460317460317,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.020354406130268198,
      "val_avg_segment_overlap": 0.19776694541763307,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4524754309568633,
      "val_pk_metric": 0.46025277573064804
    },
    {
      "epoch": 4,
      "train_loss": 0.5657674193382263,
      "train_chorus_rate": 0.5562010481953621,
      "train_max_prob": 0.5799978375434875,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6078030169010162,
      "val_macro_f1": 0.4833231655651584,
      "val_verse_f1": 0.8223606168446026,
      "val_chorus_f1": 0.1442857142857143,
      "val_chorus_rate": 0.043974967673420906,
      "val_max_prob": 0.599349170923233,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006439104930096643,
      "epoch_time": 63.96477699279785,
      "val_boundary_f1": 0.06329113924050632,
      "val_boundary_precision": 0.3,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.07130028735632184,
      "val_avg_segment_overlap": 0.19977160562816285,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.27088767583419227,
      "val_pk_metric": 0.27256912776151104
    },
    {
      "epoch": 5,
      "train_loss": 0.5392939984798432,
      "train_chorus_rate": 0.46901788413524625,
      "train_max_prob": 0.586219185590744,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5871269702911377,
      "val_macro_f1": 0.48373682553430697,
      "val_verse_f1": 0.4784119106699752,
      "val_chorus_f1": 0.48906174039863876,
      "val_chorus_rate": 0.7104264497756958,
      "val_max_prob": 0.584214597940445,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005787652964007543,
      "epoch_time": 92.34669208526611,
      "val_boundary_f1": 0.0628099173553719,
      "val_boundary_precision": 0.10497237569060773,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.03825431034482758,
      "val_avg_segment_overlap": 0.21272943911321118,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.428218990421666,
      "val_pk_metric": 0.4168084933094187
    },
    {
      "epoch": 6,
      "train_loss": 0.553749930858612,
      "train_chorus_rate": 0.4502728670835495,
      "train_max_prob": 0.5978698134422302,
      "train_conf_over_90": 2.9940120293758808e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5835557281970978,
      "val_macro_f1": 0.6534223255877156,
      "val_verse_f1": 0.7981985103065997,
      "val_chorus_f1": 0.5086461408688316,
      "val_chorus_rate": 0.282437801361084,
      "val_max_prob": 0.5826365053653717,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005052030611657774,
      "epoch_time": 77.03324103355408,
      "val_boundary_f1": 0.18893387314439944,
      "val_boundary_precision": 0.22082018927444794,
      "val_boundary_recall": 0.1650943396226415,
      "val_complete_segments": 0.08782327586206896,
      "val_avg_segment_overlap": 0.4074243726772382,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.3239338321831827,
      "val_pk_metric": 0.3002504817637136
    },
    {
      "epoch": 7,
      "train_loss": 0.5318174421787262,
      "train_chorus_rate": 0.4851604551076889,
      "train_max_prob": 0.5979640305042266,
      "train_conf_over_90": 6.169031257741153e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5790908932685852,
      "val_macro_f1": 0.6634328186528022,
      "val_verse_f1": 0.8121274058933741,
      "val_chorus_f1": 0.5147382314122304,
      "val_chorus_rate": 0.2584235668182373,
      "val_max_prob": 0.6571322977542877,
      "val_conf_over_90": 0.0002475247601978481,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042643880997527035,
      "epoch_time": 58.04288625717163,
      "val_boundary_f1": 0.21994884910485932,
      "val_boundary_precision": 0.24022346368715083,
      "val_boundary_recall": 0.2028301886792453,
      "val_complete_segments": 0.11907327586206896,
      "val_avg_segment_overlap": 0.44467503097422434,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.3333973154499339,
      "val_pk_metric": 0.307753598873828
    },
    {
      "epoch": 8,
      "train_loss": 0.5192260205745697,
      "train_chorus_rate": 0.3992451265454292,
      "train_max_prob": 0.6605043709278107,
      "train_conf_over_90": 0.005563997873105108,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5303773880004883,
      "val_macro_f1": 0.654031977360561,
      "val_verse_f1": 0.7157148812005002,
      "val_chorus_f1": 0.5923490735206217,
      "val_chorus_rate": 0.5220528542995453,
      "val_max_prob": 0.6362209618091583,
      "val_conf_over_90": 0.000487329438328743,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003459149185590689,
      "epoch_time": 79.57339215278625,
      "val_boundary_f1": 0.18027571580063625,
      "val_boundary_precision": 0.16377649325626203,
      "val_boundary_recall": 0.20047169811320756,
      "val_complete_segments": 0.05202346743295019,
      "val_avg_segment_overlap": 0.49892963908775007,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.48431781034999943,
      "val_pk_metric": 0.40205703913085666
    },
    {
      "epoch": 9,
      "train_loss": 0.48481370508670807,
      "train_chorus_rate": 0.36397087275981904,
      "train_max_prob": 0.6726577401161193,
      "train_conf_over_90": 0.014932804729323835,
      "train_conf_over_95": 0.000646323844557628,
      "val_loss": 0.5244300067424774,
      "val_macro_f1": 0.7241201511013777,
      "val_verse_f1": 0.8205967976710334,
      "val_chorus_f1": 0.627643504531722,
      "val_chorus_rate": 0.3505891263484955,
      "val_max_prob": 0.6816204190254211,
      "val_conf_over_90": 0.007143477443605661,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002671506673685618,
      "epoch_time": 124.27155685424805,
      "val_boundary_f1": 0.3443579766536965,
      "val_boundary_precision": 0.29304635761589404,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.20210727969348657,
      "val_avg_segment_overlap": 0.6102252544807292,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.38931015873747477,
      "val_pk_metric": 0.29414068462565063
    },
    {
      "epoch": 10,
      "train_loss": 0.5001371234655381,
      "train_chorus_rate": 0.37805813550949097,
      "train_max_prob": 0.680545961856842,
      "train_conf_over_90": 0.020353046408854426,
      "train_conf_over_95": 0.0007465781760402024,
      "val_loss": 0.5172734409570694,
      "val_macro_f1": 0.7034233160826371,
      "val_verse_f1": 0.7860161352285825,
      "val_chorus_f1": 0.6208304969366917,
      "val_chorus_rate": 0.42174214124679565,
      "val_max_prob": 0.6680764853954315,
      "val_conf_over_90": 0.008613185957074165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019358843213358485,
      "epoch_time": 55.16760802268982,
      "val_boundary_f1": 0.29971181556195964,
      "val_boundary_precision": 0.25283630470016205,
      "val_boundary_recall": 0.36792452830188677,
      "val_complete_segments": 0.18660201149425287,
      "val_avg_segment_overlap": 0.5977054036570624,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4229807581549336,
      "val_pk_metric": 0.3312179870737275
    },
    {
      "epoch": 11,
      "train_loss": 0.47944315969944,
      "train_chorus_rate": 0.36338005065917967,
      "train_max_prob": 0.6875054597854614,
      "train_conf_over_90": 0.028244724543765188,
      "train_conf_over_95": 0.002551880310056731,
      "val_loss": 0.5087064355611801,
      "val_macro_f1": 0.7316311312278833,
      "val_verse_f1": 0.8151339202097773,
      "val_chorus_f1": 0.6481283422459893,
      "val_chorus_rate": 0.38909539580345154,
      "val_max_prob": 0.6906352937221527,
      "val_conf_over_90": 0.024632814340293407,
      "val_conf_over_95": 0.0007348541985265911,
      "learning_rate": 0.00012844323552467485,
      "epoch_time": 63.97292900085449,
      "val_boundary_f1": 0.35634328358208955,
      "val_boundary_precision": 0.29475308641975306,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.21683429118773948,
      "val_avg_segment_overlap": 0.6443910518077345,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3865697163718182,
      "val_pk_metric": 0.2957870239456427
    },
    {
      "epoch": 12,
      "train_loss": 0.4713230192661285,
      "train_chorus_rate": 0.3472841948270798,
      "train_max_prob": 0.69564368724823,
      "train_conf_over_90": 0.02336812987923622,
      "train_conf_over_95": 0.0006477424554759637,
      "val_loss": 0.5104731172323227,
      "val_macro_f1": 0.7338802044947047,
      "val_verse_f1": 0.8241335044929397,
      "val_chorus_f1": 0.6436269044964698,
      "val_chorus_rate": 0.36107830703258514,
      "val_max_prob": 0.6978646516799927,
      "val_conf_over_90": 0.011088433675467968,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.456223523497696e-05,
      "epoch_time": 111.44651794433594,
      "val_boundary_f1": 0.3600782778864971,
      "val_boundary_precision": 0.3076923076923077,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.22922653256704978,
      "val_avg_segment_overlap": 0.6290612060251425,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3702420039681542,
      "val_pk_metric": 0.2839438576452109
    },
    {
      "epoch": 13,
      "train_loss": 0.47271120846271514,
      "train_chorus_rate": 0.32034440338611603,
      "train_max_prob": 0.6834806621074676,
      "train_conf_over_90": 0.012160420604050159,
      "train_conf_over_95": 0.00039750610594637694,
      "val_loss": 0.5056679099798203,
      "val_macro_f1": 0.7462052887794433,
      "val_verse_f1": 0.8353326063249727,
      "val_chorus_f1": 0.6570779712339136,
      "val_chorus_rate": 0.34903837740421295,
      "val_max_prob": 0.699773520231247,
      "val_conf_over_90": 0.01946567464619875,
      "val_conf_over_95": 0.0004911894793622196,
      "learning_rate": 3.4300289526876134e-05,
      "epoch_time": 86.32718896865845,
      "val_boundary_f1": 0.3741562198649952,
      "val_boundary_precision": 0.3164763458401305,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.23563218390804597,
      "val_avg_segment_overlap": 0.6432300725173479,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.37340010181489325,
      "val_pk_metric": 0.277563132515886
    },
    {
      "epoch": 14,
      "train_loss": 0.48297653794288636,
      "train_chorus_rate": 0.3541476666927338,
      "train_max_prob": 0.6941196501255036,
      "train_conf_over_90": 0.02735792277380824,
      "train_conf_over_95": 0.0014899577712640167,
      "val_loss": 0.5019650161266327,
      "val_macro_f1": 0.7255754057112807,
      "val_verse_f1": 0.8086710650329877,
      "val_chorus_f1": 0.6424797463895737,
      "val_chorus_rate": 0.397379994392395,
      "val_max_prob": 0.6913114488124847,
      "val_conf_over_90": 0.02685281727463007,
      "val_conf_over_95": 0.0004911894793622196,
      "learning_rate": 9.41703862606692e-06,
      "epoch_time": 89.31755900382996,
      "val_boundary_f1": 0.32401157184185153,
      "val_boundary_precision": 0.2740619902120718,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.18312978927203066,
      "val_avg_segment_overlap": 0.6207284784273381,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3920671002509373,
      "val_pk_metric": 0.30359012286389564
    },
    {
      "epoch": 15,
      "train_loss": 0.4694208145141602,
      "train_chorus_rate": 0.3795651078224182,
      "train_max_prob": 0.6923370659351349,
      "train_conf_over_90": 0.03167466931045056,
      "train_conf_over_95": 0.002858877184917219,
      "val_loss": 0.5019301772117615,
      "val_macro_f1": 0.7296325734130031,
      "val_verse_f1": 0.8142883860108472,
      "val_chorus_f1": 0.6449767608151591,
      "val_chorus_rate": 0.38706888258457184,
      "val_max_prob": 0.6944253444671631,
      "val_conf_over_90": 0.026117962785065174,
      "val_conf_over_95": 0.0004911894793622196,
      "learning_rate": 1e-06,
      "epoch_time": 98.67751407623291,
      "val_boundary_f1": 0.3382209188660802,
      "val_boundary_precision": 0.2888146911519199,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.1991139846743295,
      "val_avg_segment_overlap": 0.6241288710650583,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.3872618078596225,
      "val_pk_metric": 0.2973985610531863
    }
  ]
}