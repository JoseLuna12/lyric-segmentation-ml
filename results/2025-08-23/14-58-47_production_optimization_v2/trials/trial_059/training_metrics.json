{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.15948912775980234,
      "layer_dropout": 0.3346428426576398,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.24379438002037535,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3550723,
      "lstm_params": 2990080,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008089073702296803,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.017843498152169523,
      "gradient_clip_norm": 0.43472112395642976,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07935003504479095,
        "ece_after": 0.017687427754603573,
        "improvement": 0.061662607290187375,
        "params": {
          "temperature": 0.5901911257860007
        }
      },
      "platt": {
        "ece_before": 0.07935003504479095,
        "ece_after": 0.02505885007514935,
        "improvement": 0.054291184969641595,
        "params": {
          "A": 1.4999995830772757,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5768637597560883,
      "train_chorus_rate": 0.45244807842245793,
      "train_max_prob": 0.5780826687812806,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5734885036945343,
      "val_macro_f1": 0.417704923848002,
      "val_verse_f1": 0.3339070567986231,
      "val_chorus_f1": 0.5015027908973809,
      "val_chorus_rate": 0.8440727591514587,
      "val_max_prob": 0.5602363795042038,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008000800130175003,
      "epoch_time": 250.86634612083435,
      "val_boundary_f1": 0.054644808743169404,
      "val_boundary_precision": 0.12,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.021762007803895398,
      "val_avg_segment_overlap": 0.18712312228913908,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.439960436731865,
      "val_pk_metric": 0.4450709646743345
    },
    {
      "epoch": 2,
      "train_loss": 0.557608251273632,
      "train_chorus_rate": 0.4562181032728404,
      "train_max_prob": 0.5873260110616684,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5963705629110336,
      "val_macro_f1": 0.32401198450031815,
      "val_verse_f1": 0.1674656439757111,
      "val_chorus_f1": 0.48055832502492524,
      "val_chorus_rate": 0.9317896217107773,
      "val_max_prob": 0.6384118348360062,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007739837392494918,
      "epoch_time": 177.12687587738037,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.12275977908278593,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4084813195320849,
      "val_pk_metric": 0.3924441896218974
    },
    {
      "epoch": 3,
      "train_loss": 0.5472785219550133,
      "train_chorus_rate": 0.4411502172704786,
      "train_max_prob": 0.6162707597017288,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.57833631336689,
      "val_macro_f1": 0.5010054085969398,
      "val_verse_f1": 0.5321312991215904,
      "val_chorus_f1": 0.4698795180722892,
      "val_chorus_rate": 0.6378202587366104,
      "val_max_prob": 0.6063448488712311,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000731759081313132,
      "epoch_time": 144.4102909564972,
      "val_boundary_f1": 0.05415162454873646,
      "val_boundary_precision": 0.11538461538461539,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.014567390826669725,
      "val_avg_segment_overlap": 0.19602334342807426,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4331530277097361,
      "val_pk_metric": 0.44021210589128973
    },
    {
      "epoch": 4,
      "train_loss": 0.531819973886013,
      "train_chorus_rate": 0.4355301011353731,
      "train_max_prob": 0.6136875420808792,
      "train_conf_over_90": 0.00029949544696137307,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5270650237798691,
      "val_macro_f1": 0.6767389475839507,
      "val_verse_f1": 0.7492980344965904,
      "val_chorus_f1": 0.6041798606713109,
      "val_chorus_rate": 0.4770067110657692,
      "val_max_prob": 0.6034080982208252,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006752514593766284,
      "epoch_time": 111.29074788093567,
      "val_boundary_f1": 0.2973523421588595,
      "val_boundary_precision": 0.2616487455197133,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.13325676835751066,
      "val_avg_segment_overlap": 0.5524223282167342,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4429307154580094,
      "val_pk_metric": 0.3677841753883585
    },
    {
      "epoch": 5,
      "train_loss": 0.4900846377015114,
      "train_chorus_rate": 0.38827364444732665,
      "train_max_prob": 0.6752525806427002,
      "train_conf_over_90": 0.00811534502718132,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5343243405222893,
      "val_macro_f1": 0.726320802431496,
      "val_verse_f1": 0.8435350756533699,
      "val_chorus_f1": 0.6091065292096219,
      "val_chorus_rate": 0.2726990580558777,
      "val_max_prob": 0.7030978947877884,
      "val_conf_over_90": 0.0009551455441396683,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006069305276722603,
      "epoch_time": 140.57324314117432,
      "val_boundary_f1": 0.3724007561436673,
      "val_boundary_precision": 0.3107255520504732,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.25351277652444143,
      "val_avg_segment_overlap": 0.606616837220739,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.37071864723115056,
      "val_pk_metric": 0.2736185822160858
    },
    {
      "epoch": 6,
      "train_loss": 0.4763039916753769,
      "train_chorus_rate": 0.38815446197986603,
      "train_max_prob": 0.6842941522598267,
      "train_conf_over_90": 0.012290458841016516,
      "train_conf_over_95": 0.0002806901815347373,
      "val_loss": 0.4943699911236763,
      "val_macro_f1": 0.7452512218963832,
      "val_verse_f1": 0.8279569892473118,
      "val_chorus_f1": 0.6625454545454545,
      "val_chorus_rate": 0.3758600652217865,
      "val_max_prob": 0.7328798174858093,
      "val_conf_over_90": 0.031408192589879036,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000529782238755712,
      "epoch_time": 110.38850808143616,
      "val_boundary_f1": 0.35581622678396874,
      "val_boundary_precision": 0.3038397328881469,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.21519463335476058,
      "val_avg_segment_overlap": 0.6334749084714892,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.41738112372996483,
      "val_pk_metric": 0.30305476010167287
    },
    {
      "epoch": 7,
      "train_loss": 0.46902128756046296,
      "train_chorus_rate": 0.34103157818317414,
      "train_max_prob": 0.713537409901619,
      "train_conf_over_90": 0.02763277262856718,
      "train_conf_over_95": 0.0029250775318359957,
      "val_loss": 0.49459488689899445,
      "val_macro_f1": 0.7054985315509541,
      "val_verse_f1": 0.7752184273232724,
      "val_chorus_f1": 0.6357786357786358,
      "val_chorus_rate": 0.46400099247694016,
      "val_max_prob": 0.6356108486652374,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004471783430512001,
      "epoch_time": 113.04081916809082,
      "val_boundary_f1": 0.2880143112701252,
      "val_boundary_precision": 0.23198847262247838,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.16721789013676608,
      "val_avg_segment_overlap": 0.6100387432816847,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.48308436221962553,
      "val_pk_metric": 0.35471514993983716
    },
    {
      "epoch": 8,
      "train_loss": 0.46374639719724653,
      "train_chorus_rate": 0.39626545682549474,
      "train_max_prob": 0.698923647403717,
      "train_conf_over_90": 0.019136481313034893,
      "train_conf_over_95": 0.0003474684344837442,
      "val_loss": 0.47956327348947525,
      "val_macro_f1": 0.7425131525698099,
      "val_verse_f1": 0.8214285714285715,
      "val_chorus_f1": 0.6635977337110481,
      "val_chorus_rate": 0.3942388892173767,
      "val_max_prob": 0.6878968775272369,
      "val_conf_over_90": 0.005970968573819846,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003627290271784805,
      "epoch_time": 117.21386432647705,
      "val_boundary_f1": 0.37783832879200724,
      "val_boundary_precision": 0.3072378138847858,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.25344445149588307,
      "val_avg_segment_overlap": 0.6529295260509037,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4358784250878943,
      "val_pk_metric": 0.3083873214879887
    },
    {
      "epoch": 9,
      "train_loss": 0.44913251996040343,
      "train_chorus_rate": 0.36051263809204104,
      "train_max_prob": 0.71398646235466,
      "train_conf_over_90": 0.03216743825469166,
      "train_conf_over_95": 0.0016521788347745314,
      "val_loss": 0.47905779629945755,
      "val_macro_f1": 0.7422162469081013,
      "val_verse_f1": 0.8132460531382364,
      "val_chorus_f1": 0.6711864406779662,
      "val_chorus_rate": 0.4249740093946457,
      "val_max_prob": 0.7370156645774841,
      "val_conf_over_90": 0.09959185123443604,
      "val_conf_over_95": 0.019266501301899552,
      "learning_rate": 0.0002801251314739684,
      "epoch_time": 139.59795498847961,
      "val_boundary_f1": 0.37161531279178334,
      "val_boundary_precision": 0.3075734157650695,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2565547330393566,
      "val_avg_segment_overlap": 0.6471989262638023,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.401922387094879,
      "val_pk_metric": 0.2854877271984716
    },
    {
      "epoch": 10,
      "train_loss": 0.4327889055013657,
      "train_chorus_rate": 0.32457423880696296,
      "train_max_prob": 0.7340433210134506,
      "train_conf_over_90": 0.04943923242390156,
      "train_conf_over_95": 0.00846983015362639,
      "val_loss": 0.47801461070775986,
      "val_macro_f1": 0.745258684510111,
      "val_verse_f1": 0.8161383285302592,
      "val_chorus_f1": 0.6743790404899627,
      "val_chorus_rate": 0.42216530442237854,
      "val_max_prob": 0.7325256019830704,
      "val_conf_over_90": 0.07680434081703424,
      "val_conf_over_95": 0.008492843888234347,
      "learning_rate": 0.00020297684255742018,
      "epoch_time": 158.43359422683716,
      "val_boundary_f1": 0.3613526570048309,
      "val_boundary_precision": 0.3060556464811784,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22751888193298586,
      "val_avg_segment_overlap": 0.6340217926648084,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.3950535969267016,
      "val_pk_metric": 0.2810523922731744
    },
    {
      "epoch": 11,
      "train_loss": 0.43280754536390303,
      "train_chorus_rate": 0.35790831297636033,
      "train_max_prob": 0.7345907717943192,
      "train_conf_over_90": 0.05729638310149312,
      "train_conf_over_95": 0.006208960225922056,
      "val_loss": 0.47585175186395645,
      "val_macro_f1": 0.7457489653960657,
      "val_verse_f1": 0.8224863233352198,
      "val_chorus_f1": 0.6690116074569117,
      "val_chorus_rate": 0.39849618077278137,
      "val_max_prob": 0.7148620337247849,
      "val_conf_over_90": 0.04630663013085723,
      "val_conf_over_95": 0.002775208093225956,
      "learning_rate": 0.00013465591085305202,
      "epoch_time": 116.31900119781494,
      "val_boundary_f1": 0.341796875,
      "val_boundary_precision": 0.2916666666666667,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.2301634273267359,
      "val_avg_segment_overlap": 0.634339321569264,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.38945314800229053,
      "val_pk_metric": 0.2770096777375849
    },
    {
      "epoch": 12,
      "train_loss": 0.4246071368455887,
      "train_chorus_rate": 0.3285153076052666,
      "train_max_prob": 0.7379994630813599,
      "train_conf_over_90": 0.04789163945242762,
      "train_conf_over_95": 0.004721204916131682,
      "val_loss": 0.47800806909799576,
      "val_macro_f1": 0.7422134057283373,
      "val_verse_f1": 0.8179920288479788,
      "val_chorus_f1": 0.6664347826086957,
      "val_chorus_rate": 0.40631916373968124,
      "val_max_prob": 0.7395145297050476,
      "val_conf_over_90": 0.09609214402735233,
      "val_conf_over_95": 0.016287298465613276,
      "learning_rate": 7.814828891654826e-05,
      "epoch_time": 108.2912368774414,
      "val_boundary_f1": 0.3452958292919495,
      "val_boundary_precision": 0.2932454695222405,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.22132938498261934,
      "val_avg_segment_overlap": 0.6317662386299542,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.39564939223355666,
      "val_pk_metric": 0.28464743756879934
    },
    {
      "epoch": 13,
      "train_loss": 0.4199213758111,
      "train_chorus_rate": 0.3370949521660805,
      "train_max_prob": 0.7479352653026581,
      "train_conf_over_90": 0.07929834257811308,
      "train_conf_over_95": 0.012742639938369393,
      "val_loss": 0.47747501730918884,
      "val_macro_f1": 0.7506401210634392,
      "val_verse_f1": 0.8286569397680509,
      "val_chorus_f1": 0.6726233023588277,
      "val_chorus_rate": 0.38757457584142685,
      "val_max_prob": 0.7335460782051086,
      "val_conf_over_90": 0.09434071555733681,
      "val_conf_over_95": 0.014120908104814589,
      "learning_rate": 3.5923630980188375e-05,
      "epoch_time": 105.39044213294983,
      "val_boundary_f1": 0.373887240356083,
      "val_boundary_precision": 0.3219761499148211,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.24875308955372583,
      "val_avg_segment_overlap": 0.654819427673464,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.382676937942811,
      "val_pk_metric": 0.262593002650457
    },
    {
      "epoch": 14,
      "train_loss": 0.41666884869337084,
      "train_chorus_rate": 0.31305459812283515,
      "train_max_prob": 0.7322930037975312,
      "train_conf_over_90": 0.053030266985297204,
      "train_conf_over_95": 0.007369462898350321,
      "val_loss": 0.4770074114203453,
      "val_macro_f1": 0.7585388334485134,
      "val_verse_f1": 0.8412001463593121,
      "val_chorus_f1": 0.6758775205377147,
      "val_chorus_rate": 0.3580467104911804,
      "val_max_prob": 0.7342071533203125,
      "val_conf_over_90": 0.07995628006756306,
      "val_conf_over_95": 0.012156036333180964,
      "learning_rate": 9.827357212180023e-06,
      "epoch_time": 128.1201720237732,
      "val_boundary_f1": 0.37,
      "val_boundary_precision": 0.3211805555555556,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.24260535531744437,
      "val_avg_segment_overlap": 0.6482824112265897,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.37057674475464136,
      "val_pk_metric": 0.25986746341719047
    },
    {
      "epoch": 15,
      "train_loss": 0.41775129437446595,
      "train_chorus_rate": 0.3232274428009987,
      "train_max_prob": 0.7457025319337844,
      "train_conf_over_90": 0.07990132682025433,
      "train_conf_over_95": 0.014482199959456921,
      "val_loss": 0.47785285860300064,
      "val_macro_f1": 0.7551059950472148,
      "val_verse_f1": 0.8376193975018369,
      "val_chorus_f1": 0.6725925925925926,
      "val_chorus_rate": 0.36352428793907166,
      "val_max_prob": 0.7420074939727783,
      "val_conf_over_90": 0.09434688836336136,
      "val_conf_over_95": 0.015653630543965846,
      "learning_rate": 1e-06,
      "epoch_time": 122.35716414451599,
      "val_boundary_f1": 0.3693239152371342,
      "val_boundary_precision": 0.32275132275132273,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.2469116234095025,
      "val_avg_segment_overlap": 0.6452018133079687,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3697646620934327,
      "val_pk_metric": 0.2612419656606522
    }
  ]
}