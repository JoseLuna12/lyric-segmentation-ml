{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.21365726713726824,
      "layer_dropout": 0.20015127026398186,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18909211112016205,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009924565544545238,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015511649391369892,
      "gradient_clip_norm": 0.3915938794205116,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12633895575414703,
        "ece_after": 0.025984945664939803,
        "improvement": 0.10035401008920722,
        "params": {
          "temperature": 0.5003798366829131
        }
      },
      "platt": {
        "ece_before": 0.12633895575414703,
        "ece_after": 0.03717944901326786,
        "improvement": 0.08915950674087916,
        "params": {
          "A": 1.6832151196340488,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6185628473758698,
      "train_chorus_rate": 0.47957923214125914,
      "train_max_prob": 0.5941288501024247,
      "train_conf_over_90": 0.026291513442993165,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5945814102888107,
      "val_macro_f1": 0.5176644430233455,
      "val_verse_f1": 0.5367351759981102,
      "val_chorus_f1": 0.4985937100485809,
      "val_chorus_rate": 0.6608705669641495,
      "val_max_prob": 0.5364547818899155,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000981623702213011,
      "epoch_time": 81.91577887535095,
      "val_boundary_f1": 0.059375000000000004,
      "val_boundary_precision": 0.08796296296296297,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.03965601717457497,
      "val_avg_segment_overlap": 0.2613940075457408,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4295446151614122,
      "val_pk_metric": 0.40622978946046684
    },
    {
      "epoch": 2,
      "train_loss": 0.568067654967308,
      "train_chorus_rate": 0.504905452899402,
      "train_max_prob": 0.558111971616745,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6113183945417404,
      "val_macro_f1": 0.5548053328730531,
      "val_verse_f1": 0.7265638844586213,
      "val_chorus_f1": 0.383046781287485,
      "val_chorus_rate": 0.3149286285042763,
      "val_max_prob": 0.5875072032213211,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009495985931132191,
      "epoch_time": 72.66825079917908,
      "val_boundary_f1": 0.10726643598615916,
      "val_boundary_precision": 0.2012987012987013,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.023425317075900322,
      "val_avg_segment_overlap": 0.2269465437069767,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4188881038830328,
      "val_pk_metric": 0.41920904168406237
    },
    {
      "epoch": 3,
      "train_loss": 0.5727892369031906,
      "train_chorus_rate": 0.4510779164003907,
      "train_max_prob": 0.5938148915767669,
      "train_conf_over_90": 6.468305364251136e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5865269005298615,
      "val_macro_f1": 0.43479154786902696,
      "val_verse_f1": 0.36358527676313573,
      "val_chorus_f1": 0.5059978189749181,
      "val_chorus_rate": 0.8264089077711105,
      "val_max_prob": 0.587538406252861,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008977808780963322,
      "epoch_time": 50.79260516166687,
      "val_boundary_f1": 0.06896551724137931,
      "val_boundary_precision": 0.14960629921259844,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.030840860175430695,
      "val_avg_segment_overlap": 0.19867215272394478,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.41031047601918996,
      "val_pk_metric": 0.404786495144782
    },
    {
      "epoch": 4,
      "train_loss": 0.5531720042228698,
      "train_chorus_rate": 0.46505375355482104,
      "train_max_prob": 0.6011647313833237,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5439642518758774,
      "val_macro_f1": 0.6706144142113633,
      "val_verse_f1": 0.7368636270701289,
      "val_chorus_f1": 0.6043652013525976,
      "val_chorus_rate": 0.5006076246500015,
      "val_max_prob": 0.6031572669744492,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000828435239957572,
      "epoch_time": 62.27699422836304,
      "val_boundary_f1": 0.2304761904761905,
      "val_boundary_precision": 0.19329073482428116,
      "val_boundary_recall": 0.28537735849056606,
      "val_complete_segments": 0.10940575479281736,
      "val_avg_segment_overlap": 0.5367789047612532,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.26262626262626265,
      "val_window_diff": 0.4832821078108292,
      "val_pk_metric": 0.38236336205025956
    },
    {
      "epoch": 5,
      "train_loss": 0.5096440613269806,
      "train_chorus_rate": 0.4057020127773285,
      "train_max_prob": 0.6686388969421386,
      "train_conf_over_90": 0.008463681433931924,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5254864171147346,
      "val_macro_f1": 0.7337250030705519,
      "val_verse_f1": 0.8235078053259871,
      "val_chorus_f1": 0.6439422008151167,
      "val_chorus_rate": 0.36432402580976486,
      "val_max_prob": 0.6696118861436844,
      "val_conf_over_90": 0.002985048107802868,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000744592415840893,
      "epoch_time": 958.0494689941406,
      "val_boundary_f1": 0.35186873290793075,
      "val_boundary_precision": 0.2867756315007429,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.22216972312412397,
      "val_avg_segment_overlap": 0.6331484077420362,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4223485737951218,
      "val_pk_metric": 0.28204130582711207
    },
    {
      "epoch": 6,
      "train_loss": 0.5078092113137245,
      "train_chorus_rate": 0.3806532360613346,
      "train_max_prob": 0.6778724700212478,
      "train_conf_over_90": 0.01688285286654718,
      "train_conf_over_95": 0.0005030396248912438,
      "val_loss": 0.521305039525032,
      "val_macro_f1": 0.6656389553429027,
      "val_verse_f1": 0.7254166666666667,
      "val_chorus_f1": 0.6058612440191388,
      "val_chorus_rate": 0.5220703333616257,
      "val_max_prob": 0.7300300300121307,
      "val_conf_over_90": 0.05765524925664067,
      "val_conf_over_95": 0.001296230053412728,
      "learning_rate": 0.0006499167394827013,
      "epoch_time": 67.48307776451111,
      "val_boundary_f1": 0.2019607843137255,
      "val_boundary_precision": 0.17281879194630873,
      "val_boundary_recall": 0.2429245283018868,
      "val_complete_segments": 0.1079179239836716,
      "val_avg_segment_overlap": 0.5238595393291591,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.49820787656004706,
      "val_pk_metric": 0.38301429932528497
    },
    {
      "epoch": 7,
      "train_loss": 0.5012760281562805,
      "train_chorus_rate": 0.369517420232296,
      "train_max_prob": 0.6834412693977356,
      "train_conf_over_90": 0.023533892905106768,
      "train_conf_over_95": 0.0017926409345818684,
      "val_loss": 0.5157327502965927,
      "val_macro_f1": 0.751098410430434,
      "val_verse_f1": 0.8444365065190212,
      "val_chorus_f1": 0.6577603143418468,
      "val_chorus_rate": 0.32605212926864624,
      "val_max_prob": 0.6745855808258057,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000548545992244149,
      "epoch_time": 104.69253611564636,
      "val_boundary_f1": 0.36131386861313874,
      "val_boundary_precision": 0.29464285714285715,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.23692218009556293,
      "val_avg_segment_overlap": 0.6629451116547882,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3998365786245998,
      "val_pk_metric": 0.27634322698442937
    },
    {
      "epoch": 8,
      "train_loss": 0.485091795027256,
      "train_chorus_rate": 0.37118964046239855,
      "train_max_prob": 0.6854101806879044,
      "train_conf_over_90": 0.0121745230659144,
      "train_conf_over_95": 2.915451768785715e-05,
      "val_loss": 0.5017118006944656,
      "val_macro_f1": 0.7480522985151176,
      "val_verse_f1": 0.8316430020283976,
      "val_chorus_f1": 0.6644615950018375,
      "val_chorus_rate": 0.3693668767809868,
      "val_max_prob": 0.7317053824663162,
      "val_conf_over_90": 0.03216826543211937,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0004449105622103751,
      "epoch_time": 73.63748908042908,
      "val_boundary_f1": 0.3627546071774976,
      "val_boundary_precision": 0.30807248764415157,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2408220464821737,
      "val_avg_segment_overlap": 0.6441702629399273,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3666272334254672,
      "val_pk_metric": 0.27118657453604667
    },
    {
      "epoch": 9,
      "train_loss": 0.476025353372097,
      "train_chorus_rate": 0.3116659462451935,
      "train_max_prob": 0.7028875142335892,
      "train_conf_over_90": 0.02661674814298749,
      "train_conf_over_95": 0.0013382892240770162,
      "val_loss": 0.5022900104522705,
      "val_macro_f1": 0.7308945913043466,
      "val_verse_f1": 0.812511776898436,
      "val_chorus_f1": 0.6492774057102573,
      "val_chorus_rate": 0.3980170488357544,
      "val_max_prob": 0.6965364217758179,
      "val_conf_over_90": 0.017534155631437898,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0003435398149718229,
      "epoch_time": 131.33839416503906,
      "val_boundary_f1": 0.30566037735849055,
      "val_boundary_precision": 0.25471698113207547,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.183714281619902,
      "val_avg_segment_overlap": 0.6268000571327723,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.42124449068142367,
      "val_pk_metric": 0.3087246444703487
    },
    {
      "epoch": 10,
      "train_loss": 0.4681504502892494,
      "train_chorus_rate": 0.3393899440765381,
      "train_max_prob": 0.7091658681631088,
      "train_conf_over_90": 0.028421526029706,
      "train_conf_over_95": 0.0016270141699351371,
      "val_loss": 0.500892736017704,
      "val_macro_f1": 0.724159678013572,
      "val_verse_f1": 0.8053130929791272,
      "val_chorus_f1": 0.6430062630480168,
      "val_chorus_rate": 0.4063524380326271,
      "val_max_prob": 0.7051856517791748,
      "val_conf_over_90": 0.02764933044090867,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00024886413861363116,
      "epoch_time": 103.49549913406372,
      "val_boundary_f1": 0.3174311926605504,
      "val_boundary_precision": 0.25975975975975973,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.20498226790644605,
      "val_avg_segment_overlap": 0.6290271904289552,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4503906280942091,
      "val_pk_metric": 0.32276025270669045
    },
    {
      "epoch": 11,
      "train_loss": 0.4750060349702835,
      "train_chorus_rate": 0.36130382120609283,
      "train_max_prob": 0.7005386114120483,
      "train_conf_over_90": 0.02232921855757013,
      "train_conf_over_95": 0.00039157564751803877,
      "val_loss": 0.5145978331565857,
      "val_macro_f1": 0.7716985569997495,
      "val_verse_f1": 0.8712160082093381,
      "val_chorus_f1": 0.672181105790161,
      "val_chorus_rate": 0.26514362171292305,
      "val_max_prob": 0.688666820526123,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016502131449695217,
      "epoch_time": 107.64779305458069,
      "val_boundary_f1": 0.4365162644281217,
      "val_boundary_precision": 0.3931947069943289,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.30250975486924586,
      "val_avg_segment_overlap": 0.6610560727602588,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3047404152153571,
      "val_pk_metric": 0.2209793709431497
    },
    {
      "epoch": 12,
      "train_loss": 0.4710201010107994,
      "train_chorus_rate": 0.3251873329281807,
      "train_max_prob": 0.7075796455144883,
      "train_conf_over_90": 0.020455400864011607,
      "train_conf_over_95": 0.00029422852676361797,
      "val_loss": 0.49934373795986176,
      "val_macro_f1": 0.7639072327044025,
      "val_verse_f1": 0.8525,
      "val_chorus_f1": 0.675314465408805,
      "val_chorus_rate": 0.32569900900125504,
      "val_max_prob": 0.7149443626403809,
      "val_conf_over_90": 0.019769891863688827,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.567567635819183e-05,
      "epoch_time": 95.47869610786438,
      "val_boundary_f1": 0.3878326996197719,
      "val_boundary_precision": 0.3248407643312102,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2663744129677322,
      "val_avg_segment_overlap": 0.6754216062906035,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3576552942523829,
      "val_pk_metric": 0.2498610024572922
    },
    {
      "epoch": 13,
      "train_loss": 0.4656842708587646,
      "train_chorus_rate": 0.32513482570648194,
      "train_max_prob": 0.7083945274353027,
      "train_conf_over_90": 0.022028348315507172,
      "train_conf_over_95": 0.00027784068370237944,
      "val_loss": 0.494182251393795,
      "val_macro_f1": 0.7432250146041243,
      "val_verse_f1": 0.8248229593738353,
      "val_chorus_f1": 0.6616270698344132,
      "val_chorus_rate": 0.38314974308013916,
      "val_max_prob": 0.7124059945344925,
      "val_conf_over_90": 0.0226398971863091,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.385796134130476e-05,
      "epoch_time": 97.06787180900574,
      "val_boundary_f1": 0.3487084870848709,
      "val_boundary_precision": 0.2863636363636364,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.23237910308429927,
      "val_avg_segment_overlap": 0.651858996623615,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4149455418439466,
      "val_pk_metric": 0.2925651456988044
    },
    {
      "epoch": 14,
      "train_loss": 0.4565177246928215,
      "train_chorus_rate": 0.32710457891225814,
      "train_max_prob": 0.7230491936206818,
      "train_conf_over_90": 0.028578927763737737,
      "train_conf_over_95": 0.00013964918325655163,
      "val_loss": 0.4953029230237007,
      "val_macro_f1": 0.7603555288606023,
      "val_verse_f1": 0.8481035412547188,
      "val_chorus_f1": 0.6726075164664859,
      "val_chorus_rate": 0.33495478332042694,
      "val_max_prob": 0.710525393486023,
      "val_conf_over_90": 0.016302026924677193,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1832852241512792e-05,
      "epoch_time": 115.38649487495422,
      "val_boundary_f1": 0.3780260707635009,
      "val_boundary_precision": 0.3123076923076923,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.26033060783856116,
      "val_avg_segment_overlap": 0.6693452339067267,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.36411768744701173,
      "val_pk_metric": 0.25500426196857695
    },
    {
      "epoch": 15,
      "train_loss": 0.46419831216335294,
      "train_chorus_rate": 0.33435779213905337,
      "train_max_prob": 0.7135939925909043,
      "train_conf_over_90": 0.0228894695173949,
      "train_conf_over_95": 6.337135564535857e-05,
      "val_loss": 0.49526961892843246,
      "val_macro_f1": 0.7586503751811082,
      "val_verse_f1": 0.8460151460512081,
      "val_chorus_f1": 0.6712856043110085,
      "val_chorus_rate": 0.3390798941254616,
      "val_max_prob": 0.7082056254148483,
      "val_conf_over_90": 0.01605572155676782,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 579.7413911819458,
      "val_boundary_f1": 0.3692022263450835,
      "val_boundary_precision": 0.30428134556574926,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.25313399484926524,
      "val_avg_segment_overlap": 0.6677814396547035,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.36587766288667856,
      "val_pk_metric": 0.2581910515198348
    }
  ]
}