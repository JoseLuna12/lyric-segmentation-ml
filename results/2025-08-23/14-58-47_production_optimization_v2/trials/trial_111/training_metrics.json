{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2528656981701908,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.26073877068936874,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1203458,
      "lstm_params": 675840,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0001682981587433007,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.02208695025602982,
      "gradient_clip_norm": 0.36820269600009364,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11010101346815031,
        "ece_after": 0.014812371248931899,
        "improvement": 0.09528864221921841,
        "params": {
          "temperature": 0.5063609201288034
        }
      },
      "platt": {
        "ece_before": 0.11010101346815031,
        "ece_after": 0.018515865759437374,
        "improvement": 0.09158514770871293,
        "params": {
          "A": 1.911413015618258,
          "B": -0.026508815260255916
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5578392773866654,
      "train_chorus_rate": 0.5645439803600312,
      "train_max_prob": 0.5550880819559098,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5709465891122818,
      "val_macro_f1": 0.45022203018031226,
      "val_verse_f1": 0.3948661933369743,
      "val_chorus_f1": 0.5055778670236502,
      "val_chorus_rate": 0.8013085573911667,
      "val_max_prob": 0.5733153373003006,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001664702256626218,
      "epoch_time": 144.60477900505066,
      "val_boundary_f1": 0.06620209059233449,
      "val_boundary_precision": 0.12666666666666668,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.025385196209692498,
      "val_avg_segment_overlap": 0.20708480971653223,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.44217039516043155,
      "val_pk_metric": 0.43824122644896146
    },
    {
      "epoch": 2,
      "train_loss": 0.551467715203762,
      "train_chorus_rate": 0.5795400023460389,
      "train_max_prob": 0.5792148053646088,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5611140877008438,
      "val_macro_f1": 0.48483523813148294,
      "val_verse_f1": 0.45561051809424635,
      "val_chorus_f1": 0.5140599581687195,
      "val_chorus_rate": 0.7577785551548004,
      "val_max_prob": 0.5839253664016724,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016106631586760688,
      "epoch_time": 124.16691994667053,
      "val_boundary_f1": 0.0864381520119225,
      "val_boundary_precision": 0.11740890688259109,
      "val_boundary_recall": 0.06839622641509434,
      "val_complete_segments": 0.034640209441375934,
      "val_avg_segment_overlap": 0.2540290121909247,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4811656689077971,
      "val_pk_metric": 0.4448445490766457
    },
    {
      "epoch": 3,
      "train_loss": 0.5356869950890542,
      "train_chorus_rate": 0.5006964519619942,
      "train_max_prob": 0.5955642879009246,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5577189922332764,
      "val_macro_f1": 0.5482885399095518,
      "val_verse_f1": 0.5726933830382106,
      "val_chorus_f1": 0.523883696780893,
      "val_chorus_rate": 0.6475290358066559,
      "val_max_prob": 0.6077748090028763,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001523226061471343,
      "epoch_time": 124.95160794258118,
      "val_boundary_f1": 0.1516709511568123,
      "val_boundary_precision": 0.16666666666666666,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.04950116758176143,
      "val_avg_segment_overlap": 0.31789492120696283,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.12626262626262627,
      "val_window_diff": 0.4584903888089519,
      "val_pk_metric": 0.41675295047872124
    },
    {
      "epoch": 4,
      "train_loss": 0.5178950890898705,
      "train_chorus_rate": 0.44902078807353973,
      "train_max_prob": 0.6227807253599167,
      "train_conf_over_90": 0.0005840446858201176,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5471164286136627,
      "val_macro_f1": 0.7031325348312849,
      "val_verse_f1": 0.8022827687776142,
      "val_chorus_f1": 0.6039823008849557,
      "val_chorus_rate": 0.36727532744407654,
      "val_max_prob": 0.6243355721235275,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000140621238572963,
      "epoch_time": 126.38983201980591,
      "val_boundary_f1": 0.31927710843373497,
      "val_boundary_precision": 0.27797202797202797,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.18724212206449747,
      "val_avg_segment_overlap": 0.5452670819833969,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.36848080531454647,
      "val_pk_metric": 0.3050792282657886
    },
    {
      "epoch": 5,
      "train_loss": 0.5063758537173271,
      "train_chorus_rate": 0.4342328518629074,
      "train_max_prob": 0.642167329788208,
      "train_conf_over_90": 0.0012873316678451373,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5275798141956329,
      "val_macro_f1": 0.6804947880083637,
      "val_verse_f1": 0.7467968273337401,
      "val_chorus_f1": 0.6141927486829873,
      "val_chorus_rate": 0.49328920990228653,
      "val_max_prob": 0.64151731133461,
      "val_conf_over_90": 0.0009250693838112056,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012647361905747552,
      "epoch_time": 119.07882189750671,
      "val_boundary_f1": 0.2785065590312815,
      "val_boundary_precision": 0.24338624338624337,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.16304892037924912,
      "val_avg_segment_overlap": 0.5355784626768069,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.39001477252643457,
      "val_pk_metric": 0.3239292367280664
    },
    {
      "epoch": 6,
      "train_loss": 0.5081066772341728,
      "train_chorus_rate": 0.42712353020906446,
      "train_max_prob": 0.6489320516586303,
      "train_conf_over_90": 0.0026885694911470636,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5308674722909927,
      "val_macro_f1": 0.7331982046409622,
      "val_verse_f1": 0.8234862385321101,
      "val_chorus_f1": 0.6429101707498143,
      "val_chorus_rate": 0.3624962493777275,
      "val_max_prob": 0.6384095549583435,
      "val_conf_over_90": 0.001422577421180904,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011049806646130916,
      "epoch_time": 131.25536108016968,
      "val_boundary_f1": 0.32087511394712853,
      "val_boundary_precision": 0.26151560178306094,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.19838836526270248,
      "val_avg_segment_overlap": 0.5906683253094239,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4140012122078402,
      "val_pk_metric": 0.3047828466618972
    },
    {
      "epoch": 7,
      "train_loss": 0.49935849457979203,
      "train_chorus_rate": 0.42676856070756913,
      "train_max_prob": 0.6543036848306656,
      "train_conf_over_90": 0.004322977486299351,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5238416641950607,
      "val_macro_f1": 0.6829501812611901,
      "val_verse_f1": 0.7478083588175332,
      "val_chorus_f1": 0.6180920037048471,
      "val_chorus_rate": 0.49566908925771713,
      "val_max_prob": 0.6456940472126007,
      "val_conf_over_90": 0.003407074313145131,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.339278909212295e-05,
      "epoch_time": 133.20675706863403,
      "val_boundary_f1": 0.26629422718808193,
      "val_boundary_precision": 0.22,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.12451783513554457,
      "val_avg_segment_overlap": 0.5338828157886479,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.4721522559755738,
      "val_pk_metric": 0.3626085833821469
    },
    {
      "epoch": 8,
      "train_loss": 0.5011702552437782,
      "train_chorus_rate": 0.3881766550242901,
      "train_max_prob": 0.6543400466442109,
      "train_conf_over_90": 0.0024086291203275325,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5212133824825287,
      "val_macro_f1": 0.7336244597038051,
      "val_verse_f1": 0.8175536881419234,
      "val_chorus_f1": 0.6496952312656867,
      "val_chorus_rate": 0.3857560232281685,
      "val_max_prob": 0.6478733569383621,
      "val_conf_over_90": 0.0023924328561406583,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.590536965117779e-05,
      "epoch_time": 121.86488699913025,
      "val_boundary_f1": 0.3365810451727192,
      "val_boundary_precision": 0.2695035460992908,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.2239132652573798,
      "val_avg_segment_overlap": 0.6080087855594117,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.38323507089195863,
      "val_pk_metric": 0.28915928200069796
    },
    {
      "epoch": 9,
      "train_loss": 0.4833934649825096,
      "train_chorus_rate": 0.39120965003967284,
      "train_max_prob": 0.6667228817939759,
      "train_conf_over_90": 0.007381771388463676,
      "train_conf_over_95": 0.0002407584775937721,
      "val_loss": 0.5197442471981049,
      "val_macro_f1": 0.7205606405664888,
      "val_verse_f1": 0.8016749143509707,
      "val_chorus_f1": 0.639446366782007,
      "val_chorus_rate": 0.41066689044237137,
      "val_max_prob": 0.6708442717790604,
      "val_conf_over_90": 0.006456533796153963,
      "val_conf_over_95": 0.0011563367443159223,
      "learning_rate": 5.880009228199156e-05,
      "epoch_time": 139.32571697235107,
      "val_boundary_f1": 0.3260473588342441,
      "val_boundary_precision": 0.2655786350148368,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.2227385695042111,
      "val_avg_segment_overlap": 0.6001320028840752,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.41921366720623343,
      "val_pk_metric": 0.3009789488243552
    },
    {
      "epoch": 10,
      "train_loss": 0.49112771898508073,
      "train_chorus_rate": 0.42244688868522645,
      "train_max_prob": 0.6786724835634231,
      "train_conf_over_90": 0.015500471441191621,
      "train_conf_over_95": 0.0008137805591104553,
      "val_loss": 0.5177965015172958,
      "val_macro_f1": 0.6573189996561648,
      "val_verse_f1": 0.7078964262786218,
      "val_chorus_f1": 0.6067415730337079,
      "val_chorus_rate": 0.5526837110519409,
      "val_max_prob": 0.6642020046710968,
      "val_conf_over_90": 0.01280721795046702,
      "val_conf_over_95": 0.001387604046612978,
      "learning_rate": 4.282453968582519e-05,
      "epoch_time": 145.16874885559082,
      "val_boundary_f1": 0.22899353647276086,
      "val_boundary_precision": 0.18816388467374812,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.12377941302914792,
      "val_avg_segment_overlap": 0.5247063745552489,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.48763033031597247,
      "val_pk_metric": 0.3628515214446394
    },
    {
      "epoch": 11,
      "train_loss": 0.4967761591076851,
      "train_chorus_rate": 0.43734961897134783,
      "train_max_prob": 0.6620162576436996,
      "train_conf_over_90": 0.008624099349253811,
      "train_conf_over_95": 0.00028591106820385903,
      "val_loss": 0.51497832685709,
      "val_macro_f1": 0.7412679239398882,
      "val_verse_f1": 0.8235513322153903,
      "val_chorus_f1": 0.658984515664386,
      "val_chorus_rate": 0.3827179968357086,
      "val_max_prob": 0.6574590504169464,
      "val_conf_over_90": 0.0031561815121676773,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.867692017033772e-05,
      "epoch_time": 129.66471338272095,
      "val_boundary_f1": 0.33156028368794327,
      "val_boundary_precision": 0.265625,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.20868309606379598,
      "val_avg_segment_overlap": 0.617634274584635,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.40516492516112684,
      "val_pk_metric": 0.2907718381938496
    },
    {
      "epoch": 12,
      "train_loss": 0.4945815473794937,
      "train_chorus_rate": 0.379203300178051,
      "train_max_prob": 0.660407018661499,
      "train_conf_over_90": 0.005369463615352288,
      "train_conf_over_95": 0.0002916514175012708,
      "val_loss": 0.5137533843517303,
      "val_macro_f1": 0.7298049730970297,
      "val_verse_f1": 0.8054489639293937,
      "val_chorus_f1": 0.6541609822646658,
      "val_chorus_rate": 0.42073486745357513,
      "val_max_prob": 0.6611661016941071,
      "val_conf_over_90": 0.004427250882145017,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1.6975552596166375e-05,
      "epoch_time": 136.35567784309387,
      "val_boundary_f1": 0.32749562171628727,
      "val_boundary_precision": 0.2604456824512535,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.20652417870074286,
      "val_avg_segment_overlap": 0.608596994778791,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.43574114347421106,
      "val_pk_metric": 0.3070656941225238
    },
    {
      "epoch": 13,
      "train_loss": 0.49452229738235476,
      "train_chorus_rate": 0.4011984169483185,
      "train_max_prob": 0.6638178139925003,
      "train_conf_over_90": 0.010244933050125837,
      "train_conf_over_95": 0.0003053936176002026,
      "val_loss": 0.5132335424423218,
      "val_macro_f1": 0.7265766424486525,
      "val_verse_f1": 0.8018486424032352,
      "val_chorus_f1": 0.6513046424940698,
      "val_chorus_rate": 0.42547381669282913,
      "val_max_prob": 0.6601224094629288,
      "val_conf_over_90": 0.005175651633180678,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 8.231842875693779e-06,
      "epoch_time": 120.00565814971924,
      "val_boundary_f1": 0.32720909886264216,
      "val_boundary_precision": 0.26008344923504867,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.19989182296976568,
      "val_avg_segment_overlap": 0.6083972816517325,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4400657010353496,
      "val_pk_metric": 0.31208234830847886
    },
    {
      "epoch": 14,
      "train_loss": 0.48987067490816116,
      "train_chorus_rate": 0.40827626883983614,
      "train_max_prob": 0.6622752815485,
      "train_conf_over_90": 0.010388321772916242,
      "train_conf_over_95": 0.00046507115475833414,
      "val_loss": 0.5133060812950134,
      "val_macro_f1": 0.7312039110031749,
      "val_verse_f1": 0.8093607305936074,
      "val_chorus_f1": 0.6530470914127424,
      "val_chorus_rate": 0.4099869877099991,
      "val_max_prob": 0.6601139903068542,
      "val_conf_over_90": 0.005175651633180678,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 2.827933080678882e-06,
      "epoch_time": 133.55290389060974,
      "val_boundary_f1": 0.32778264680105174,
      "val_boundary_precision": 0.2608089260808926,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.19735437983051982,
      "val_avg_segment_overlap": 0.610655043251718,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.43116524814217716,
      "val_pk_metric": 0.2985756273050184
    }
  ]
}