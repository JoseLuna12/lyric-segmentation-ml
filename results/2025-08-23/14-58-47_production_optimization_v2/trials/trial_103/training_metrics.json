{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2501466134483093,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2383515113338004,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008083438812501096,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 9,
      "validation_strategy": "composite",
      "weight_decay": 0.01857005053818392,
      "gradient_clip_norm": 0.34197399756983626,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1097156106401052,
        "ece_after": 0.020369829050098747,
        "improvement": 0.08934578159000645,
        "params": {
          "temperature": 0.5180777107045597
        }
      },
      "platt": {
        "ece_before": 0.1097156106401052,
        "ece_after": 0.02557100425886029,
        "improvement": 0.08414460638124491,
        "params": {
          "A": 1.8181329373716257,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5672233015298843,
      "train_chorus_rate": 0.5044044325011783,
      "train_max_prob": 0.5837672978639603,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.564593955874443,
      "val_macro_f1": 0.4716861402216878,
      "val_verse_f1": 0.4454780361757106,
      "val_chorus_f1": 0.49789424426766504,
      "val_chorus_rate": 0.7501958310604095,
      "val_max_prob": 0.5832670778036118,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007995226808310114,
      "epoch_time": 98.2154688835144,
      "val_boundary_f1": 0.06504065040650407,
      "val_boundary_precision": 0.10471204188481675,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.025359316292508233,
      "val_avg_segment_overlap": 0.23053486731703732,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4444553946584435,
      "val_pk_metric": 0.4447925221575286
    },
    {
      "epoch": 2,
      "train_loss": 0.5397314369678498,
      "train_chorus_rate": 0.5234784595668316,
      "train_max_prob": 0.6161358118057251,
      "train_conf_over_90": 0.0006688360823318362,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5439598262310028,
      "val_macro_f1": 0.7092459817207689,
      "val_verse_f1": 0.8092105263157894,
      "val_chorus_f1": 0.6092814371257484,
      "val_chorus_rate": 0.35775772482156754,
      "val_max_prob": 0.590251624584198,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007734446083608472,
      "epoch_time": 103.8956208229065,
      "val_boundary_f1": 0.3553113553113554,
      "val_boundary_precision": 0.2904191616766467,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.22962371931088793,
      "val_avg_segment_overlap": 0.5828917880996233,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.3799005360054833,
      "val_pk_metric": 0.28482126822037007
    },
    {
      "epoch": 3,
      "train_loss": 0.5084505632519722,
      "train_chorus_rate": 0.3776050418615341,
      "train_max_prob": 0.6389601856470108,
      "train_conf_over_90": 0.005899123437120579,
      "train_conf_over_95": 2.8555112658068536e-05,
      "val_loss": 0.5368443876504898,
      "val_macro_f1": 0.7213674339134439,
      "val_verse_f1": 0.8284548518715629,
      "val_chorus_f1": 0.6142800159553251,
      "val_chorus_rate": 0.3172220066189766,
      "val_max_prob": 0.6610822528600693,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007312494007430389,
      "epoch_time": 121.23159575462341,
      "val_boundary_f1": 0.38781163434903043,
      "val_boundary_precision": 0.3186646433990895,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.27468323117845916,
      "val_avg_segment_overlap": 0.6086564922230375,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.39002603276666903,
      "val_pk_metric": 0.2810861035498699
    },
    {
      "epoch": 4,
      "train_loss": 0.5028198972344399,
      "train_chorus_rate": 0.4502153418958187,
      "train_max_prob": 0.6622313648462296,
      "train_conf_over_90": 0.006135155324591324,
      "train_conf_over_95": 0.00010533707682043314,
      "val_loss": 0.5097933858633041,
      "val_macro_f1": 0.732378433496909,
      "val_verse_f1": 0.8133484162895928,
      "val_chorus_f1": 0.6514084507042254,
      "val_chorus_rate": 0.39861757308244705,
      "val_max_prob": 0.6512532532215118,
      "val_conf_over_90": 0.004496887733694166,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006747811910255548,
      "epoch_time": 95.71990299224854,
      "val_boundary_f1": 0.3414634146341463,
      "val_boundary_precision": 0.2767203513909224,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.23119940877098882,
      "val_avg_segment_overlap": 0.630483202966949,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.43737166975125874,
      "val_pk_metric": 0.3155593743459577
    },
    {
      "epoch": 5,
      "train_loss": 0.48656888753175737,
      "train_chorus_rate": 0.3901554808020592,
      "train_max_prob": 0.6659567207098007,
      "train_conf_over_90": 0.013350983866257594,
      "train_conf_over_95": 0.0004745505808386952,
      "val_loss": 0.5311235189437866,
      "val_macro_f1": 0.7489323831545242,
      "val_verse_f1": 0.8546742699153274,
      "val_chorus_f1": 0.643190496393721,
      "val_chorus_rate": 0.2803654633462429,
      "val_max_prob": 0.7041788399219513,
      "val_conf_over_90": 0.004110688925720751,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006065079109375823,
      "epoch_time": 98.42026495933533,
      "val_boundary_f1": 0.4161616161616161,
      "val_boundary_precision": 0.36395759717314485,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.27583904158665556,
      "val_avg_segment_overlap": 0.624041560605123,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.3312000861763558,
      "val_pk_metric": 0.24204263156702413
    },
    {
      "epoch": 6,
      "train_loss": 0.49192472249269487,
      "train_chorus_rate": 0.3883253142237663,
      "train_max_prob": 0.6722178995609284,
      "train_conf_over_90": 0.008324274956248701,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49778153747320175,
      "val_macro_f1": 0.7194683092883772,
      "val_verse_f1": 0.7806451612903225,
      "val_chorus_f1": 0.658291457286432,
      "val_chorus_rate": 0.48219554126262665,
      "val_max_prob": 0.6474500894546509,
      "val_conf_over_90": 0.0012063481262885034,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005294134304305116,
      "epoch_time": 90.63252711296082,
      "val_boundary_f1": 0.34124087591240876,
      "val_boundary_precision": 0.27827380952380953,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22334102395078004,
      "val_avg_segment_overlap": 0.6276241718678374,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4628800276587769,
      "val_pk_metric": 0.3301708879197979
    },
    {
      "epoch": 7,
      "train_loss": 0.4808921217918396,
      "train_chorus_rate": 0.40049072206020353,
      "train_max_prob": 0.6841211497783661,
      "train_conf_over_90": 0.014615082938689739,
      "train_conf_over_95": 3.052503161597997e-05,
      "val_loss": 0.495503731071949,
      "val_macro_f1": 0.7607358508581581,
      "val_verse_f1": 0.8412348401323044,
      "val_chorus_f1": 0.6802368615840119,
      "val_chorus_rate": 0.36476754397153854,
      "val_max_prob": 0.7047130465507507,
      "val_conf_over_90": 0.02658684365451336,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004468671482428634,
      "epoch_time": 93.49930024147034,
      "val_boundary_f1": 0.39924314096499525,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3119381140722604,
      "val_avg_segment_overlap": 0.6631762332358077,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3744707012479365,
      "val_pk_metric": 0.2639187247627387
    },
    {
      "epoch": 8,
      "train_loss": 0.4826045945286751,
      "train_chorus_rate": 0.36620307713747025,
      "train_max_prob": 0.6708504527807235,
      "train_conf_over_90": 0.00755407796241343,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4923751726746559,
      "val_macro_f1": 0.7599129836119862,
      "val_verse_f1": 0.8410425844346548,
      "val_chorus_f1": 0.6787833827893175,
      "val_chorus_rate": 0.36298298090696335,
      "val_max_prob": 0.678894892334938,
      "val_conf_over_90": 0.003663192328531295,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00036247673300724657,
      "epoch_time": 92.38986611366272,
      "val_boundary_f1": 0.40115163147792704,
      "val_boundary_precision": 0.33818770226537215,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.3089960093406541,
      "val_avg_segment_overlap": 0.670890961541829,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.37459106203808945,
      "val_pk_metric": 0.2703664742569428
    },
    {
      "epoch": 9,
      "train_loss": 0.47374234199523924,
      "train_chorus_rate": 0.3916393920779228,
      "train_max_prob": 0.6919396877288818,
      "train_conf_over_90": 0.014538085495587438,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49470827728509903,
      "val_macro_f1": 0.7620697912775272,
      "val_verse_f1": 0.843989769820972,
      "val_chorus_f1": 0.6801498127340825,
      "val_chorus_rate": 0.3567579686641693,
      "val_max_prob": 0.6824325770139694,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002799304508195983,
      "epoch_time": 86.75383305549622,
      "val_boundary_f1": 0.442,
      "val_boundary_precision": 0.3836805555555556,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.3385726432386029,
      "val_avg_segment_overlap": 0.669807095428246,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3523498386122736,
      "val_pk_metric": 0.25511557052563805
    }
  ]
}