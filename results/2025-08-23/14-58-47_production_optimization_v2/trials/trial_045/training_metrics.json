{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19736123637710035,
      "layer_dropout": 0.2159488539978401,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.13155157879195087,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009752249856657802,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.017607637152710052,
      "gradient_clip_norm": 0.4648121492509111,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11843448201073645,
        "ece_after": 0.015364823808018978,
        "improvement": 0.10306965820271746,
        "params": {
          "temperature": 0.5140927593718485
        }
      },
      "platt": {
        "ece_before": 0.11843448201073645,
        "ece_after": 0.03007918547963348,
        "improvement": 0.08835529653110297,
        "params": {
          "A": 1.6755054597057297,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6154415220022201,
      "train_chorus_rate": 0.5417243771255016,
      "train_max_prob": 0.5846522748470306,
      "train_conf_over_90": 0.022601476311683653,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6081643998622894,
      "val_macro_f1": 0.35765550690651204,
      "val_verse_f1": 0.22735674676524953,
      "val_chorus_f1": 0.4879542670477746,
      "val_chorus_rate": 0.9029166996479034,
      "val_max_prob": 0.6107802391052246,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009645804089848447,
      "epoch_time": 78.24812412261963,
      "val_boundary_f1": 0.018214936247723135,
      "val_boundary_precision": 0.04,
      "val_boundary_recall": 0.01179245283018868,
      "val_complete_segments": 0.007441423016714639,
      "val_avg_segment_overlap": 0.14862898402712296,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4205016227160551,
      "val_pk_metric": 0.41788867873632285
    },
    {
      "epoch": 2,
      "train_loss": 0.5828657299280167,
      "train_chorus_rate": 0.5273813330102712,
      "train_max_prob": 0.5667830318212509,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5955843776464462,
      "val_macro_f1": 0.47114608613792386,
      "val_verse_f1": 0.44984646878198564,
      "val_chorus_f1": 0.49244570349386213,
      "val_chorus_rate": 0.7403356283903122,
      "val_max_prob": 0.5539510697126389,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009331118980213408,
      "epoch_time": 66.91592907905579,
      "val_boundary_f1": 0.061930783242258654,
      "val_boundary_precision": 0.136,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.017819372167198255,
      "val_avg_segment_overlap": 0.20912104492243727,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4463982214789146,
      "val_pk_metric": 0.4566689948116033
    },
    {
      "epoch": 3,
      "train_loss": 0.5754674851894379,
      "train_chorus_rate": 0.5932532561477274,
      "train_max_prob": 0.571683332324028,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5922073423862457,
      "val_macro_f1": 0.4391233710925447,
      "val_verse_f1": 0.3867822318526544,
      "val_chorus_f1": 0.49146451033243493,
      "val_chorus_rate": 0.7942643314599991,
      "val_max_prob": 0.5679947286844254,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008821947777070431,
      "epoch_time": 44.81590509414673,
      "val_boundary_f1": 0.0759493670886076,
      "val_boundary_precision": 0.16279069767441862,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.030523408956600898,
      "val_avg_segment_overlap": 0.1925961707915686,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4141710045826859,
      "val_pk_metric": 0.4085020794339594
    },
    {
      "epoch": 4,
      "train_loss": 0.5615901291370392,
      "train_chorus_rate": 0.5141082525253295,
      "train_max_prob": 0.5796504557132721,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5711953043937683,
      "val_macro_f1": 0.46627471968653295,
      "val_verse_f1": 0.42773954473266274,
      "val_chorus_f1": 0.5048098946404032,
      "val_chorus_rate": 0.7733654677867889,
      "val_max_prob": 0.5956534296274185,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008140543705271369,
      "epoch_time": 52.68325185775757,
      "val_boundary_f1": 0.06167400881057269,
      "val_boundary_precision": 0.08171206225680934,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.02031962465419517,
      "val_avg_segment_overlap": 0.236333084393223,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.464105650549993,
      "val_pk_metric": 0.41520995831863133
    },
    {
      "epoch": 5,
      "train_loss": 0.5331449270248413,
      "train_chorus_rate": 0.44908768534660337,
      "train_max_prob": 0.6494896918535232,
      "train_conf_over_90": 0.001585444709053263,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5293557792901993,
      "val_macro_f1": 0.7020776145904636,
      "val_verse_f1": 0.7800700661736084,
      "val_chorus_f1": 0.6240851630073188,
      "val_chorus_rate": 0.4390847086906433,
      "val_max_prob": 0.6667809933423996,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007316687392493352,
      "epoch_time": 52.25230813026428,
      "val_boundary_f1": 0.310442144873001,
      "val_boundary_precision": 0.25821596244131456,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.14770932878037862,
      "val_avg_segment_overlap": 0.5821183520944571,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.44813436983767135,
      "val_pk_metric": 0.33606652473775356
    },
    {
      "epoch": 6,
      "train_loss": 0.5196911782026291,
      "train_chorus_rate": 0.38563925474882127,
      "train_max_prob": 0.6634244084358215,
      "train_conf_over_90": 0.0035591938794823363,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5293177738785744,
      "val_macro_f1": 0.6270773305905641,
      "val_verse_f1": 0.6735094998908059,
      "val_chorus_f1": 0.5806451612903225,
      "val_chorus_rate": 0.575127437710762,
      "val_max_prob": 0.6526039838790894,
      "val_conf_over_90": 0.0034616729826666415,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006386385312905981,
      "epoch_time": 46.12531113624573,
      "val_boundary_f1": 0.2256509161041466,
      "val_boundary_precision": 0.19086460032626426,
      "val_boundary_recall": 0.2759433962264151,
      "val_complete_segments": 0.09706434392277447,
      "val_avg_segment_overlap": 0.5330850291537793,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.504073597861266,
      "val_pk_metric": 0.40749025411997464
    },
    {
      "epoch": 7,
      "train_loss": 0.5054262205958366,
      "train_chorus_rate": 0.39859640449285505,
      "train_max_prob": 0.6707904219627381,
      "train_conf_over_90": 0.009412795485695824,
      "train_conf_over_95": 0.0001327761507127434,
      "val_loss": 0.5154986530542374,
      "val_macro_f1": 0.7360708349845961,
      "val_verse_f1": 0.8180625819748923,
      "val_chorus_f1": 0.6540790879942999,
      "val_chorus_rate": 0.3897170424461365,
      "val_max_prob": 0.6827244311571121,
      "val_conf_over_90": 0.0012360960827209055,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005390296131471882,
      "epoch_time": 97.28445196151733,
      "val_boundary_f1": 0.3317445185891325,
      "val_boundary_precision": 0.2784,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.20852781656069036,
      "val_avg_segment_overlap": 0.6273416607455563,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4271830007842175,
      "val_pk_metric": 0.3175171846724825
    },
    {
      "epoch": 8,
      "train_loss": 0.49355010539293287,
      "train_chorus_rate": 0.3630213066935539,
      "train_max_prob": 0.6790013909339905,
      "train_conf_over_90": 0.011674342007609084,
      "train_conf_over_95": 5.205622292123735e-05,
      "val_loss": 0.5114251151680946,
      "val_macro_f1": 0.7617310618006836,
      "val_verse_f1": 0.8535980148883375,
      "val_chorus_f1": 0.6698641087130296,
      "val_chorus_rate": 0.3153933435678482,
      "val_max_prob": 0.7029591500759125,
      "val_conf_over_90": 0.006561143905855715,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004371953725185925,
      "epoch_time": 68.7688398361206,
      "val_boundary_f1": 0.405484818805093,
      "val_boundary_precision": 0.34673366834170855,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2670133074295322,
      "val_avg_segment_overlap": 0.6533004319269201,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3277763759072982,
      "val_pk_metric": 0.24243553844048615
    },
    {
      "epoch": 9,
      "train_loss": 0.4820596963167191,
      "train_chorus_rate": 0.32009336426854135,
      "train_max_prob": 0.6918752938508987,
      "train_conf_over_90": 0.016418525917106307,
      "train_conf_over_95": 0.00036814214545302095,
      "val_loss": 0.5097872987389565,
      "val_macro_f1": 0.7307216667728702,
      "val_verse_f1": 0.8150364690480643,
      "val_chorus_f1": 0.6464068644976761,
      "val_chorus_rate": 0.38742656260728836,
      "val_max_prob": 0.6679150015115738,
      "val_conf_over_90": 0.01030684559373185,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033758645437518246,
      "epoch_time": 127.45249700546265,
      "val_boundary_f1": 0.3235555555555556,
      "val_boundary_precision": 0.25962910128388017,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.17759043128873458,
      "val_avg_segment_overlap": 0.6312067145900367,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.44762539049046496,
      "val_pk_metric": 0.3181123565869869
    },
    {
      "epoch": 10,
      "train_loss": 0.47926760762929915,
      "train_chorus_rate": 0.341482050716877,
      "train_max_prob": 0.6991145581007003,
      "train_conf_over_90": 0.022050620662048458,
      "train_conf_over_95": 0.0006278440909227356,
      "val_loss": 0.5086833089590073,
      "val_macro_f1": 0.7272129795895717,
      "val_verse_f1": 0.8077360637087599,
      "val_chorus_f1": 0.6466898954703834,
      "val_chorus_rate": 0.40516138076782227,
      "val_max_prob": 0.7105739861726761,
      "val_conf_over_90": 0.03201435459777713,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024455624641644524,
      "epoch_time": 98.72779107093811,
      "val_boundary_f1": 0.3572093023255814,
      "val_boundary_precision": 0.29493087557603687,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.22491180015040038,
      "val_avg_segment_overlap": 0.63812832081692,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4371980300282434,
      "val_pk_metric": 0.30746355272270975
    },
    {
      "epoch": 11,
      "train_loss": 0.48246375769376754,
      "train_chorus_rate": 0.34644281938672067,
      "train_max_prob": 0.6936147093772889,
      "train_conf_over_90": 0.018188865517731755,
      "train_conf_over_95": 9.746837604325264e-05,
      "val_loss": 0.5184604451060295,
      "val_macro_f1": 0.7651768178480663,
      "val_verse_f1": 0.8645383951682485,
      "val_chorus_f1": 0.6658152405278842,
      "val_chorus_rate": 0.2775919958949089,
      "val_max_prob": 0.6888785660266876,
      "val_conf_over_90": 0.00047234738303814083,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016217061513864356,
      "epoch_time": 105.64529991149902,
      "val_boundary_f1": 0.4372384937238494,
      "val_boundary_precision": 0.39285714285714285,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2964754350623916,
      "val_avg_segment_overlap": 0.660410271282902,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3111365419944102,
      "val_pk_metric": 0.2273146726110125
    },
    {
      "epoch": 12,
      "train_loss": 0.4804934233427048,
      "train_chorus_rate": 0.33335437402129175,
      "train_max_prob": 0.6942715734243393,
      "train_conf_over_90": 0.018315306823933498,
      "train_conf_over_95": 0.0003038732917048037,
      "val_loss": 0.5061594545841217,
      "val_macro_f1": 0.7590206549362795,
      "val_verse_f1": 0.8474941620262261,
      "val_chorus_f1": 0.670547147846333,
      "val_chorus_rate": 0.33346693217754364,
      "val_max_prob": 0.7167102247476578,
      "val_conf_over_90": 0.03265260998159647,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.403020795873729e-05,
      "epoch_time": 92.82681393623352,
      "val_boundary_f1": 0.3842549203373946,
      "val_boundary_precision": 0.3188180404354588,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.26755069529459774,
      "val_avg_segment_overlap": 0.6766343170440087,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.35214401739637424,
      "val_pk_metric": 0.25727840439042876
    },
    {
      "epoch": 13,
      "train_loss": 0.4732125326991081,
      "train_chorus_rate": 0.32674659267067907,
      "train_max_prob": 0.7035649001598359,
      "train_conf_over_90": 0.02336527854204178,
      "train_conf_over_95": 0.0001702541805570945,
      "val_loss": 0.5022768378257751,
      "val_macro_f1": 0.7407665174375757,
      "val_verse_f1": 0.8250555967383247,
      "val_chorus_f1": 0.6564774381368268,
      "val_chorus_rate": 0.3754115626215935,
      "val_max_prob": 0.7085237950086594,
      "val_conf_over_90": 0.02232120535336435,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.311308764443933e-05,
      "epoch_time": 93.30458283424377,
      "val_boundary_f1": 0.3776744186046512,
      "val_boundary_precision": 0.3118279569892473,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2515930905909697,
      "val_avg_segment_overlap": 0.6579501610054068,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.396204834783505,
      "val_pk_metric": 0.2848326871228861
    },
    {
      "epoch": 14,
      "train_loss": 0.4653458923101425,
      "train_chorus_rate": 0.3297788918018341,
      "train_max_prob": 0.7122210919857025,
      "train_conf_over_90": 0.02723882389254868,
      "train_conf_over_95": 0.0,
      "val_loss": 0.50271425396204,
      "val_macro_f1": 0.7592211171629009,
      "val_verse_f1": 0.8473845047636167,
      "val_chorus_f1": 0.6710577295621851,
      "val_chorus_rate": 0.3344723805785179,
      "val_max_prob": 0.6991194486618042,
      "val_conf_over_90": 0.01457248441874981,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1644576680935534e-05,
      "epoch_time": 99.66048574447632,
      "val_boundary_f1": 0.3891487371375117,
      "val_boundary_precision": 0.32248062015503876,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2689483131821414,
      "val_avg_segment_overlap": 0.6755601001507555,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3435265079879364,
      "val_pk_metric": 0.2557270513577213
    },
    {
      "epoch": 15,
      "train_loss": 0.47331744581460955,
      "train_chorus_rate": 0.33048325777053833,
      "train_max_prob": 0.7028124332427979,
      "train_conf_over_90": 0.021144048613496124,
      "train_conf_over_95": 0.00013827772345393897,
      "val_loss": 0.5022240579128265,
      "val_macro_f1": 0.7554899131260109,
      "val_verse_f1": 0.8430379746835442,
      "val_chorus_f1": 0.6679418515684774,
      "val_chorus_rate": 0.34256190806627274,
      "val_max_prob": 0.7005879431962967,
      "val_conf_over_90": 0.016271115047857165,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 98.38272094726562,
      "val_boundary_f1": 0.3758139534883721,
      "val_boundary_precision": 0.3102918586789555,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.25922756380073453,
      "val_avg_segment_overlap": 0.671827236619462,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.34755855146109554,
      "val_pk_metric": 0.2596790580963297
    }
  ]
}