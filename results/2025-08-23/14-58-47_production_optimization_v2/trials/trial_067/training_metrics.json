{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.21938911000256764,
      "layer_dropout": 0.23354668237128878,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.16499488686495412,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007200252233620828,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.017189302404285317,
      "gradient_clip_norm": 0.37776077328855645,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09720400016762187,
        "ece_after": 0.016028442132800864,
        "improvement": 0.08117555803482102,
        "params": {
          "temperature": 0.5630008648365
        }
      },
      "platt": {
        "ece_before": 0.09720400016762187,
        "ece_after": 0.017804204451545985,
        "improvement": 0.07939979571607589,
        "params": {
          "A": 1.7541044264401118,
          "B": -0.016244604067504692
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5589770808815956,
      "train_chorus_rate": 0.4225228526163846,
      "train_max_prob": 0.5904131293296814,
      "train_conf_over_90": 0.0001537515432573855,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5462910681962967,
      "val_macro_f1": 0.4556474459087554,
      "val_verse_f1": 0.41300293098854246,
      "val_chorus_f1": 0.4982919608289683,
      "val_chorus_rate": 0.7785680145025253,
      "val_max_prob": 0.5810485333204269,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007121690102303964,
      "epoch_time": 77.78982305526733,
      "val_boundary_f1": 0.02197802197802198,
      "val_boundary_precision": 0.04918032786885246,
      "val_boundary_recall": 0.014150943396226415,
      "val_complete_segments": 0.016204820181490383,
      "val_avg_segment_overlap": 0.1963711217079094,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4350756058991234,
      "val_pk_metric": 0.4421649434593036
    },
    {
      "epoch": 2,
      "train_loss": 0.5212032064795494,
      "train_chorus_rate": 0.4225331765104784,
      "train_max_prob": 0.5872475415468216,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5499514937400818,
      "val_macro_f1": 0.5826235924416926,
      "val_verse_f1": 0.7904918032786886,
      "val_chorus_f1": 0.3747553816046966,
      "val_chorus_rate": 0.20195842161774635,
      "val_max_prob": 0.5942803472280502,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000688943725047485,
      "epoch_time": 63.725159883499146,
      "val_boundary_f1": 0.11703958691910499,
      "val_boundary_precision": 0.21656050955414013,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.060532904514876945,
      "val_avg_segment_overlap": 0.2562351207684624,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.3146419353981114,
      "val_pk_metric": 0.3086683160149637
    },
    {
      "epoch": 3,
      "train_loss": 0.5261047095060348,
      "train_chorus_rate": 0.3982913151208777,
      "train_max_prob": 0.6309471696615219,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.530971109867096,
      "val_macro_f1": 0.40600819003010535,
      "val_verse_f1": 0.3095866314863676,
      "val_chorus_f1": 0.5024297485738431,
      "val_chorus_rate": 0.8628960251808167,
      "val_max_prob": 0.6135990023612976,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006513644242231251,
      "epoch_time": 45.55902600288391,
      "val_boundary_f1": 0.042933810375670844,
      "val_boundary_precision": 0.08888888888888889,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.018482150534112358,
      "val_avg_segment_overlap": 0.17996366210283743,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4228787835325445,
      "val_pk_metric": 0.4130816802553063
    },
    {
      "epoch": 4,
      "train_loss": 0.4944044053554535,
      "train_chorus_rate": 0.40418153181672095,
      "train_max_prob": 0.6431855678558349,
      "train_conf_over_90": 0.0023189390427432953,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4907336086034775,
      "val_macro_f1": 0.727391779080053,
      "val_verse_f1": 0.8371848739495797,
      "val_chorus_f1": 0.6175986842105263,
      "val_chorus_rate": 0.29896675050258636,
      "val_max_prob": 0.6165488809347153,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006010735035288334,
      "epoch_time": 52.45019221305847,
      "val_boundary_f1": 0.3517110266159695,
      "val_boundary_precision": 0.2945859872611465,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.19291154698100615,
      "val_avg_segment_overlap": 0.6127071973806666,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.38856679431080193,
      "val_pk_metric": 0.3051296039144748
    },
    {
      "epoch": 5,
      "train_loss": 0.45357914417982104,
      "train_chorus_rate": 0.38680603057146073,
      "train_max_prob": 0.6873417049646378,
      "train_conf_over_90": 0.01797107271850109,
      "train_conf_over_95": 8.103727595880628e-05,
      "val_loss": 0.44650688767433167,
      "val_macro_f1": 0.744997539127604,
      "val_verse_f1": 0.8242787560884227,
      "val_chorus_f1": 0.6657163221667854,
      "val_chorus_rate": 0.39004791527986526,
      "val_max_prob": 0.7149339020252228,
      "val_conf_over_90": 0.027348987758159637,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0005402689175215621,
      "epoch_time": 52.30052089691162,
      "val_boundary_f1": 0.3729781160799239,
      "val_boundary_precision": 0.31259968102073366,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.23918920624912143,
      "val_avg_segment_overlap": 0.6357645970623671,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4115130195030952,
      "val_pk_metric": 0.3064218676785537
    },
    {
      "epoch": 6,
      "train_loss": 0.44593639820814135,
      "train_chorus_rate": 0.3590386636555195,
      "train_max_prob": 0.7018815845251083,
      "train_conf_over_90": 0.02953562856419012,
      "train_conf_over_95": 0.0027159370190929623,
      "val_loss": 0.4494064673781395,
      "val_macro_f1": 0.757594560118968,
      "val_verse_f1": 0.8536756946887091,
      "val_chorus_f1": 0.661513425549227,
      "val_chorus_rate": 0.3043203130364418,
      "val_max_prob": 0.7174196094274521,
      "val_conf_over_90": 0.016979842737782747,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00047160811838260443,
      "epoch_time": 46.14863681793213,
      "val_boundary_f1": 0.37878787878787884,
      "val_boundary_precision": 0.31645569620253167,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2649923707983093,
      "val_avg_segment_overlap": 0.6568611005761906,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3864538095693857,
      "val_pk_metric": 0.2709235568380372
    },
    {
      "epoch": 7,
      "train_loss": 0.43862688541412354,
      "train_chorus_rate": 0.38349137604236605,
      "train_max_prob": 0.7098067790269852,
      "train_conf_over_90": 0.03926834462909028,
      "train_conf_over_95": 0.002108977426541969,
      "val_loss": 0.4534827917814255,
      "val_macro_f1": 0.7654879341713168,
      "val_verse_f1": 0.862356621480709,
      "val_chorus_f1": 0.6686192468619246,
      "val_chorus_rate": 0.28796177729964256,
      "val_max_prob": 0.6910032033920288,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00039809191250540137,
      "epoch_time": 89.58170294761658,
      "val_boundary_f1": 0.41119691119691115,
      "val_boundary_precision": 0.3480392156862745,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.2820946116545268,
      "val_avg_segment_overlap": 0.6627517297425553,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3644066274312776,
      "val_pk_metric": 0.2523276953272018
    },
    {
      "epoch": 8,
      "train_loss": 0.4237713858485222,
      "train_chorus_rate": 0.35027813985943795,
      "train_max_prob": 0.7139378666877747,
      "train_conf_over_90": 0.023067526530940085,
      "train_conf_over_95": 3.410641220398247e-05,
      "val_loss": 0.4423598498106003,
      "val_macro_f1": 0.7636929009561069,
      "val_verse_f1": 0.8535847713929905,
      "val_chorus_f1": 0.6738010305192231,
      "val_chorus_rate": 0.3200996592640877,
      "val_max_prob": 0.7361495345830917,
      "val_conf_over_90": 0.0351357611361891,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003229333108566816,
      "epoch_time": 62.98377084732056,
      "val_boundary_f1": 0.386411889596603,
      "val_boundary_precision": 0.35135135135135137,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.24559962932179266,
      "val_avg_segment_overlap": 0.6380616824204206,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3009848506336167,
      "val_pk_metric": 0.24030257366466407
    },
    {
      "epoch": 9,
      "train_loss": 0.4118740066885948,
      "train_chorus_rate": 0.3146387688815594,
      "train_max_prob": 0.7408080846071243,
      "train_conf_over_90": 0.05929422713816166,
      "train_conf_over_95": 0.005100286798551679,
      "val_loss": 0.4362294524908066,
      "val_macro_f1": 0.7580745613076637,
      "val_verse_f1": 0.8407759882869692,
      "val_chorus_f1": 0.6753731343283582,
      "val_chorus_rate": 0.3590396121144295,
      "val_max_prob": 0.7107635140419006,
      "val_conf_over_90": 0.027151166927069426,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00024941710497947844,
      "epoch_time": 111.0259747505188,
      "val_boundary_f1": 0.39186691312384475,
      "val_boundary_precision": 0.3221884498480243,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.27244351797639177,
      "val_avg_segment_overlap": 0.663900063193074,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.390487496350106,
      "val_pk_metric": 0.27033269047638303
    },
    {
      "epoch": 10,
      "train_loss": 0.408833834528923,
      "train_chorus_rate": 0.31760038062930107,
      "train_max_prob": 0.7305815815925598,
      "train_conf_over_90": 0.03704839552519843,
      "train_conf_over_95": 0.0029057797917630525,
      "val_loss": 0.4450359344482422,
      "val_macro_f1": 0.7294923385768445,
      "val_verse_f1": 0.8021680216802168,
      "val_chorus_f1": 0.6568166554734721,
      "val_chorus_rate": 0.43172596395015717,
      "val_max_prob": 0.7313319593667984,
      "val_conf_over_90": 0.07540591899305582,
      "val_conf_over_95": 0.0024120582384057343,
      "learning_rate": 0.00018075630584052078,
      "epoch_time": 87.87792205810547,
      "val_boundary_f1": 0.3342723004694836,
      "val_boundary_precision": 0.27769110764430577,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.2003937432357369,
      "val_avg_segment_overlap": 0.6313544537495683,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.43778515804093443,
      "val_pk_metric": 0.3195821054453244
    },
    {
      "epoch": 11,
      "train_loss": 0.41451101303100585,
      "train_chorus_rate": 0.34231373369693757,
      "train_max_prob": 0.7316554397344589,
      "train_conf_over_90": 0.046656001615338026,
      "train_conf_over_95": 0.0022543670958839355,
      "val_loss": 0.43755093216896057,
      "val_macro_f1": 0.772967445222549,
      "val_verse_f1": 0.857602862254025,
      "val_chorus_f1": 0.6883320281910729,
      "val_chorus_rate": 0.3277740105986595,
      "val_max_prob": 0.7109448462724686,
      "val_conf_over_90": 0.012267345504369587,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011995171983324954,
      "epoch_time": 91.91496086120605,
      "val_boundary_f1": 0.4153686396677051,
      "val_boundary_precision": 0.37105751391465674,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.26883421635542526,
      "val_avg_segment_overlap": 0.6701316147902249,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.316272696832229,
      "val_pk_metric": 0.23708188422940252
    },
    {
      "epoch": 12,
      "train_loss": 0.4076301619410515,
      "train_chorus_rate": 0.3265805721282959,
      "train_max_prob": 0.7328845292329789,
      "train_conf_over_90": 0.04125260702567175,
      "train_conf_over_95": 0.001949845056515187,
      "val_loss": 0.433422788977623,
      "val_macro_f1": 0.761522174917286,
      "val_verse_f1": 0.8418151754547125,
      "val_chorus_f1": 0.6812291743798594,
      "val_chorus_rate": 0.36385278403759,
      "val_max_prob": 0.7455940991640091,
      "val_conf_over_90": 0.06780311558395624,
      "val_conf_over_95": 0.00660430861171335,
      "learning_rate": 6.966079913895769e-05,
      "epoch_time": 81.73715114593506,
      "val_boundary_f1": 0.4113614103819785,
      "val_boundary_precision": 0.35175879396984927,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2734923967294063,
      "val_avg_segment_overlap": 0.6738368609965667,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.37977327843651026,
      "val_pk_metric": 0.27069178400507465
    },
    {
      "epoch": 13,
      "train_loss": 0.3991263896226883,
      "train_chorus_rate": 0.3212191715836525,
      "train_max_prob": 0.7367344617843627,
      "train_conf_over_90": 0.05301916915923357,
      "train_conf_over_95": 0.0029192729358328505,
      "val_loss": 0.4330197796225548,
      "val_macro_f1": 0.7534603734365135,
      "val_verse_f1": 0.8316240909938468,
      "val_chorus_f1": 0.6752966558791801,
      "val_chorus_rate": 0.3835935667157173,
      "val_max_prob": 0.7464677840471268,
      "val_conf_over_90": 0.08608429040759802,
      "val_conf_over_95": 0.009991447615902871,
      "learning_rate": 3.2081498314597736e-05,
      "epoch_time": 82.41522669792175,
      "val_boundary_f1": 0.38963531669865636,
      "val_boundary_precision": 0.3284789644012945,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2512905326929717,
      "val_avg_segment_overlap": 0.6622318832999313,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.37628917979856014,
      "val_pk_metric": 0.2699749241211159
    },
    {
      "epoch": 14,
      "train_loss": 0.3977958276867867,
      "train_chorus_rate": 0.32248233035206797,
      "train_max_prob": 0.7494858711957931,
      "train_conf_over_90": 0.07707220101729036,
      "train_conf_over_95": 0.0055082817794755105,
      "val_loss": 0.43340425193309784,
      "val_macro_f1": 0.7750502037246483,
      "val_verse_f1": 0.8597930788440957,
      "val_chorus_f1": 0.6903073286052008,
      "val_chorus_rate": 0.3236537054181099,
      "val_max_prob": 0.7343064844608307,
      "val_conf_over_90": 0.040482856100425124,
      "val_conf_over_95": 0.001387604046612978,
      "learning_rate": 8.85621313168639e-06,
      "epoch_time": 87.33216595649719,
      "val_boundary_f1": 0.41218274111675124,
      "val_boundary_precision": 0.36185383244206776,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.29222034676700637,
      "val_avg_segment_overlap": 0.6759541653620902,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.32180036928444894,
      "val_pk_metric": 0.2384729303076764
    },
    {
      "epoch": 15,
      "train_loss": 0.4025234207510948,
      "train_chorus_rate": 0.30995322242379186,
      "train_max_prob": 0.7377180755138397,
      "train_conf_over_90": 0.04859553361311555,
      "train_conf_over_95": 0.0019544557435438037,
      "val_loss": 0.43145962804555893,
      "val_macro_f1": 0.7725747884782184,
      "val_verse_f1": 0.8537821208830982,
      "val_chorus_f1": 0.6913674560733384,
      "val_chorus_rate": 0.34340616315603256,
      "val_max_prob": 0.7331482172012329,
      "val_conf_over_90": 0.048110471572726965,
      "val_conf_over_95": 0.002081406069919467,
      "learning_rate": 1e-06,
      "epoch_time": 86.77696299552917,
      "val_boundary_f1": 0.4149797570850202,
      "val_boundary_precision": 0.36347517730496454,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.2863467144617728,
      "val_avg_segment_overlap": 0.6769986584350527,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3351340324160601,
      "val_pk_metric": 0.24415034759400484
    }
  ]
}