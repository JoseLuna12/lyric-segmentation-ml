{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2660365194797597,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2641288072907107,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00094993276693061,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015637680348729376,
      "gradient_clip_norm": 0.37110109750452763,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1382488321900836,
        "ece_after": 0.02564035981073827,
        "improvement": 0.11260847237934533,
        "params": {
          "temperature": 0.45817542280432244
        }
      },
      "platt": {
        "ece_before": 0.1382488321900836,
        "ece_after": 0.07584765887213599,
        "improvement": 0.06240117331794762,
        "params": {
          "A": 1.4999993524657893,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5758128315210342,
      "train_chorus_rate": 0.503401374979876,
      "train_max_prob": 0.5904210180044174,
      "train_conf_over_90": 4.0650405571796e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5672353506088257,
      "val_macro_f1": 0.47546679884378884,
      "val_verse_f1": 0.447900466562986,
      "val_chorus_f1": 0.5030331311245917,
      "val_chorus_rate": 0.7531168311834335,
      "val_max_prob": 0.579638347029686,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009395645380807389,
      "epoch_time": 100.52980089187622,
      "val_boundary_f1": 0.057324840764331204,
      "val_boundary_precision": 0.08823529411764706,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.01838362942551702,
      "val_avg_segment_overlap": 0.23579845580089895,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4485807245367137,
      "val_pk_metric": 0.45100859189960335
    },
    {
      "epoch": 2,
      "train_loss": 0.5408577963709831,
      "train_chorus_rate": 0.5246902324259282,
      "train_max_prob": 0.6070438086986542,
      "train_conf_over_90": 0.0001623768883291632,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5407537221908569,
      "val_macro_f1": 0.7080967018183518,
      "val_verse_f1": 0.7908934379185001,
      "val_chorus_f1": 0.6252999657182036,
      "val_chorus_rate": 0.4178374856710434,
      "val_max_prob": 0.5987180173397064,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009089129928841468,
      "epoch_time": 105.5328221321106,
      "val_boundary_f1": 0.3339449541284404,
      "val_boundary_precision": 0.2732732732732733,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.2097399588650914,
      "val_avg_segment_overlap": 0.5830095152502744,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4083171721910605,
      "val_pk_metric": 0.3100453133160582
    },
    {
      "epoch": 3,
      "train_loss": 0.5180928215384484,
      "train_chorus_rate": 0.40984050640836356,
      "train_max_prob": 0.6449184358119965,
      "train_conf_over_90": 0.0018373012950178235,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5241497978568077,
      "val_macro_f1": 0.715852139461833,
      "val_verse_f1": 0.7928902627511593,
      "val_chorus_f1": 0.6388140161725068,
      "val_chorus_rate": 0.4301973432302475,
      "val_max_prob": 0.6712207496166229,
      "val_conf_over_90": 0.0034518602769821882,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008593177509483573,
      "epoch_time": 123.2702808380127,
      "val_boundary_f1": 0.33185448092280395,
      "val_boundary_precision": 0.26600284495021337,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22784532373609787,
      "val_avg_segment_overlap": 0.6136027606946455,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4256146125726283,
      "val_pk_metric": 0.31358797315176395
    },
    {
      "epoch": 4,
      "train_loss": 0.5000485613942146,
      "train_chorus_rate": 0.4250542141497135,
      "train_max_prob": 0.6630623042583466,
      "train_conf_over_90": 0.0074936033401172605,
      "train_conf_over_95": 0.00031124770175665616,
      "val_loss": 0.5252904817461967,
      "val_macro_f1": 0.7519902487361978,
      "val_verse_f1": 0.849744583406729,
      "val_chorus_f1": 0.6542359140656667,
      "val_chorus_rate": 0.3074057176709175,
      "val_max_prob": 0.6438305974006653,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000792946362330339,
      "epoch_time": 96.58800029754639,
      "val_boundary_f1": 0.4128787878787879,
      "val_boundary_precision": 0.3449367088607595,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.2959526334393779,
      "val_avg_segment_overlap": 0.6419122887694411,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3846956183932598,
      "val_pk_metric": 0.27340844598691016
    },
    {
      "epoch": 5,
      "train_loss": 0.49179804772138597,
      "train_chorus_rate": 0.38516443520784377,
      "train_max_prob": 0.662765446305275,
      "train_conf_over_90": 0.010541385225951671,
      "train_conf_over_95": 0.00033427350572310386,
      "val_loss": 0.5248392969369888,
      "val_macro_f1": 0.7580154161804828,
      "val_verse_f1": 0.856544502617801,
      "val_chorus_f1": 0.6594863297431648,
      "val_chorus_rate": 0.29439112544059753,
      "val_max_prob": 0.701824888586998,
      "val_conf_over_90": 0.0048695404548197985,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007126995751979574,
      "epoch_time": 100.69616532325745,
      "val_boundary_f1": 0.4169184290030212,
      "val_boundary_precision": 0.36379613356766255,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28925562056527065,
      "val_avg_segment_overlap": 0.6345053266609026,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.32747845540816056,
      "val_pk_metric": 0.24006129951898758
    },
    {
      "epoch": 6,
      "train_loss": 0.4947229251265526,
      "train_chorus_rate": 0.3755756437778473,
      "train_max_prob": 0.6729182481765748,
      "train_conf_over_90": 0.006940789558575489,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5036724731326103,
      "val_macro_f1": 0.7111259798566301,
      "val_verse_f1": 0.7708587708587709,
      "val_chorus_f1": 0.6513931888544892,
      "val_chorus_rate": 0.4934709891676903,
      "val_max_prob": 0.6355855613946915,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006220845592157047,
      "epoch_time": 91.84447479248047,
      "val_boundary_f1": 0.3618361836183619,
      "val_boundary_precision": 0.2925764192139738,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2425397086982453,
      "val_avg_segment_overlap": 0.6235500680377853,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.46022992560235765,
      "val_pk_metric": 0.33084652921998925
    },
    {
      "epoch": 7,
      "train_loss": 0.4845488160848618,
      "train_chorus_rate": 0.4042618617415428,
      "train_max_prob": 0.6807920694351196,
      "train_conf_over_90": 0.009799150651087985,
      "train_conf_over_95": 3.052503161597997e-05,
      "val_loss": 0.4977656900882721,
      "val_macro_f1": 0.7513037310226374,
      "val_verse_f1": 0.8297236743838686,
      "val_chorus_f1": 0.6728837876614061,
      "val_chorus_rate": 0.38566771894693375,
      "val_max_prob": 0.6961406469345093,
      "val_conf_over_90": 0.02555749285966158,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005250616254010945,
      "epoch_time": 95.7061939239502,
      "val_boundary_f1": 0.3996212121212121,
      "val_boundary_precision": 0.3338607594936709,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.30769991510977723,
      "val_avg_segment_overlap": 0.6576982197787066,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.39105452910374,
      "val_pk_metric": 0.2824484151674721
    },
    {
      "epoch": 8,
      "train_loss": 0.488641557097435,
      "train_chorus_rate": 0.36922373473644254,
      "train_max_prob": 0.666337987780571,
      "train_conf_over_90": 0.005150357249658555,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49527595937252045,
      "val_macro_f1": 0.7586853762001889,
      "val_verse_f1": 0.8366740905716405,
      "val_chorus_f1": 0.6806966618287373,
      "val_chorus_rate": 0.37785911560058594,
      "val_max_prob": 0.6622492223978043,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004258711415295155,
      "epoch_time": 94.50720000267029,
      "val_boundary_f1": 0.4134705332086062,
      "val_boundary_precision": 0.3426356589147287,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.3286737369849777,
      "val_avg_segment_overlap": 0.6784507451287367,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.387052552020027,
      "val_pk_metric": 0.27564180382643305
    },
    {
      "epoch": 9,
      "train_loss": 0.4782873630523682,
      "train_chorus_rate": 0.3950683608651161,
      "train_max_prob": 0.688785943388939,
      "train_conf_over_90": 0.012755866651423276,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4968145564198494,
      "val_macro_f1": 0.7545760503512868,
      "val_verse_f1": 0.8319641523525019,
      "val_chorus_f1": 0.6771879483500717,
      "val_chorus_rate": 0.3858530521392822,
      "val_max_prob": 0.6798893958330154,
      "val_conf_over_90": 0.001422577421180904,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003288482077149052,
      "epoch_time": 89.13463926315308,
      "val_boundary_f1": 0.41740850642927796,
      "val_boundary_precision": 0.3594548551959114,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3127953586065993,
      "val_avg_segment_overlap": 0.6550294601951075,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.38145989047886425,
      "val_pk_metric": 0.2728972140793956
    },
    {
      "epoch": 10,
      "train_loss": 0.47387406677007676,
      "train_chorus_rate": 0.33823332339525225,
      "train_max_prob": 0.6885525822639466,
      "train_conf_over_90": 0.012513522885274141,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49050265550613403,
      "val_macro_f1": 0.7531222988711412,
      "val_verse_f1": 0.823754057666603,
      "val_chorus_f1": 0.6824905400756793,
      "val_chorus_rate": 0.41479139775037766,
      "val_max_prob": 0.6969130486249924,
      "val_conf_over_90": 0.015335612930357456,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023823319173265254,
      "epoch_time": 98.39944982528687,
      "val_boundary_f1": 0.41060903732809423,
      "val_boundary_precision": 0.35185185185185186,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.3076780272167335,
      "val_avg_segment_overlap": 0.6570962128677627,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.386321747160629,
      "val_pk_metric": 0.2819909962177948
    },
    {
      "epoch": 11,
      "train_loss": 0.4656747132539749,
      "train_chorus_rate": 0.34241496995091436,
      "train_max_prob": 0.6931677907705307,
      "train_conf_over_90": 0.014449234411586076,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4965726509690285,
      "val_macro_f1": 0.7686675743954379,
      "val_verse_f1": 0.8501906664245504,
      "val_chorus_f1": 0.6871444823663253,
      "val_chorus_rate": 0.3485419228672981,
      "val_max_prob": 0.6856229603290558,
      "val_conf_over_90": 0.027219966985285282,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015798640460027103,
      "epoch_time": 115.35020470619202,
      "val_boundary_f1": 0.42073778664007977,
      "val_boundary_precision": 0.3644214162348877,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.30147994912045817,
      "val_avg_segment_overlap": 0.6763460013271941,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3805458049293889,
      "val_pk_metric": 0.2584790669975746
    },
    {
      "epoch": 12,
      "train_loss": 0.4619554400444031,
      "train_chorus_rate": 0.37159370332956315,
      "train_max_prob": 0.7022870391607284,
      "train_conf_over_90": 0.027383808884769677,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49367254227399826,
      "val_macro_f1": 0.7474625713281362,
      "val_verse_f1": 0.8202097235462344,
      "val_chorus_f1": 0.6747154191100379,
      "val_chorus_rate": 0.41265514492988586,
      "val_max_prob": 0.6964244544506073,
      "val_conf_over_90": 0.040193844586610794,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.16150159822527e-05,
      "epoch_time": 95.60715913772583,
      "val_boundary_f1": 0.41487279843444225,
      "val_boundary_precision": 0.35451505016722407,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.3058843288827382,
      "val_avg_segment_overlap": 0.6561172376077726,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3964210746243975,
      "val_pk_metric": 0.2809400496585204
    },
    {
      "epoch": 13,
      "train_loss": 0.47250652611255645,
      "train_chorus_rate": 0.3515737161040306,
      "train_max_prob": 0.6897639185190201,
      "train_conf_over_90": 0.022354609449394047,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4912727400660515,
      "val_macro_f1": 0.7828952936721829,
      "val_verse_f1": 0.862230215827338,
      "val_chorus_f1": 0.7035603715170278,
      "val_chorus_rate": 0.33544696122407913,
      "val_max_prob": 0.6738122999668121,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.201977404646312e-05,
      "epoch_time": 93.17353391647339,
      "val_boundary_f1": 0.45245245245245247,
      "val_boundary_precision": 0.39304347826086955,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.336239561027472,
      "val_avg_segment_overlap": 0.6839014370444843,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.34303599219906844,
      "val_pk_metric": 0.2390406205963747
    },
    {
      "epoch": 14,
      "train_loss": 0.4604690566658974,
      "train_chorus_rate": 0.3155809462070465,
      "train_max_prob": 0.6847718209028244,
      "train_conf_over_90": 0.011558625620091334,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4904659539461136,
      "val_macro_f1": 0.753117325567142,
      "val_verse_f1": 0.8258725341426404,
      "val_chorus_f1": 0.6803621169916435,
      "val_chorus_rate": 0.4058960974216461,
      "val_max_prob": 0.6937306970357895,
      "val_conf_over_90": 0.022874278016388416,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1368228849871098e-05,
      "epoch_time": 110.23978614807129,
      "val_boundary_f1": 0.4166666666666667,
      "val_boundary_precision": 0.3595890410958904,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.30838058934559465,
      "val_avg_segment_overlap": 0.6589941723493455,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.38508592662744956,
      "val_pk_metric": 0.27011772108312043
    },
    {
      "epoch": 15,
      "train_loss": 0.45549725741147995,
      "train_chorus_rate": 0.33664112240076066,
      "train_max_prob": 0.6937173813581466,
      "train_conf_over_90": 0.01812096491921693,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49035972356796265,
      "val_macro_f1": 0.7731993636702335,
      "val_verse_f1": 0.8502291475710358,
      "val_chorus_f1": 0.696169579769431,
      "val_chorus_rate": 0.36106420308351517,
      "val_max_prob": 0.6983685791492462,
      "val_conf_over_90": 0.021678052144125104,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 107.06734275817871,
      "val_boundary_f1": 0.44779116465863456,
      "val_boundary_precision": 0.38986013986013984,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.3427003450200693,
      "val_avg_segment_overlap": 0.6820240136743292,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3529569017704519,
      "val_pk_metric": 0.24804875413057398
    }
  ]
}