{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19045562255324486,
      "layer_dropout": 0.29796183105372787,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.2434839676899592,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2715139,
      "lstm_params": 2154496,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0007098396883776576,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.008311642728241947,
      "gradient_clip_norm": 0.46757065225605243,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0736408499755653,
        "ece_after": 0.06462582492055499,
        "improvement": 0.009015025055010312,
        "params": {
          "temperature": 0.49627820625130464
        }
      },
      "platt": {
        "ece_before": 0.0736408499755653,
        "ece_after": 0.09493470164143969,
        "improvement": -0.021293851665874386,
        "params": {
          "A": 0.4999990798343848,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.587619423866272,
      "train_chorus_rate": 0.6062951609492302,
      "train_max_prob": 0.5755098521709442,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6227606534957886,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.617756724357605,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006828610841507271,
      "epoch_time": 43.40042304992676,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05860871647509579,
      "val_avg_segment_overlap": 0.16652069003437917,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26503295450423625,
      "val_pk_metric": 0.2713936688312747
    },
    {
      "epoch": 2,
      "train_loss": 0.5691439688205719,
      "train_chorus_rate": 0.4572386406827718,
      "train_max_prob": 0.5686420559883117,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5936712622642517,
      "val_macro_f1": 0.513606952335663,
      "val_verse_f1": 0.5619834710743802,
      "val_chorus_f1": 0.4652304335969458,
      "val_chorus_rate": 0.600643664598465,
      "val_max_prob": 0.5492547154426575,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006060325194018292,
      "epoch_time": 38.16009187698364,
      "val_boundary_f1": 0.05254515599343186,
      "val_boundary_precision": 0.08648648648648649,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.02885536398467433,
      "val_avg_segment_overlap": 0.22947268176972435,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4204620118307578,
      "val_pk_metric": 0.4047461093059458
    },
    {
      "epoch": 3,
      "train_loss": 0.5576602995395661,
      "train_chorus_rate": 0.4139630185440183,
      "train_max_prob": 0.583120197057724,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5906158983707428,
      "val_macro_f1": 0.5111062524632765,
      "val_verse_f1": 0.5645339827319017,
      "val_chorus_f1": 0.4576785221946512,
      "val_chorus_rate": 0.5909819900989532,
      "val_max_prob": 0.568805456161499,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004910504466613102,
      "epoch_time": 38.79475975036621,
      "val_boundary_f1": 0.0948905109489051,
      "val_boundary_precision": 0.20967741935483872,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.019995210727969347,
      "val_avg_segment_overlap": 0.22322576857121712,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.38656135788680457,
      "val_pk_metric": 0.40342684448678945
    },
    {
      "epoch": 4,
      "train_loss": 0.5389647424221039,
      "train_chorus_rate": 0.5147013425827026,
      "train_max_prob": 0.5845797717571258,
      "train_conf_over_90": 0.00793755273334682,
      "train_conf_over_95": 0.0,
      "val_loss": 0.605434238910675,
      "val_macro_f1": 0.529368998042588,
      "val_verse_f1": 0.6397453749751343,
      "val_chorus_f1": 0.4189926211100417,
      "val_chorus_rate": 0.4657672792673111,
      "val_max_prob": 0.5789602696895599,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003554198441888288,
      "epoch_time": 42.39378905296326,
      "val_boundary_f1": 0.04460966542750929,
      "val_boundary_precision": 0.10526315789473684,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.05094588122605364,
      "val_avg_segment_overlap": 0.21393244566034422,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3098664786283327,
      "val_pk_metric": 0.30098098414552954
    },
    {
      "epoch": 5,
      "train_loss": 0.5624685645103454,
      "train_chorus_rate": 0.5158824130892754,
      "train_max_prob": 0.5762079119682312,
      "train_conf_over_90": 0.00023807250836398451,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5916209816932678,
      "val_macro_f1": 0.5185468210851794,
      "val_verse_f1": 0.5823937554206419,
      "val_chorus_f1": 0.45469988674971695,
      "val_chorus_rate": 0.5677103400230408,
      "val_max_prob": 0.5657658576965332,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021978924171634748,
      "epoch_time": 28.322394847869873,
      "val_boundary_f1": 0.05405405405405405,
      "val_boundary_precision": 0.11450381679389313,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.05477729885057471,
      "val_avg_segment_overlap": 0.22141915275291335,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3293519066482302,
      "val_pk_metric": 0.31284622256280514
    },
    {
      "epoch": 6,
      "train_loss": 0.5584754645824432,
      "train_chorus_rate": 0.6339170873165131,
      "train_max_prob": 0.5713136374950409,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.594824880361557,
      "val_macro_f1": 0.5480196829569315,
      "val_verse_f1": 0.6887640449438203,
      "val_chorus_f1": 0.4072753209700428,
      "val_chorus_rate": 0.3889366537332535,
      "val_max_prob": 0.5683106184005737,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010480716897582838,
      "epoch_time": 27.822235345840454,
      "val_boundary_f1": 0.04609929078014184,
      "val_boundary_precision": 0.09285714285714286,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.053220785440613025,
      "val_avg_segment_overlap": 0.23560731810698232,
      "val_verse_to_chorus_acc": 0.017699115044247787,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.31818198791054697,
      "val_pk_metric": 0.3059464286675633
    },
    {
      "epoch": 7,
      "train_loss": 0.5447230637073517,
      "train_chorus_rate": 0.46976352035999297,
      "train_max_prob": 0.5791252493858338,
      "train_conf_over_90": 7.822672196198255e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5931099057197571,
      "val_macro_f1": 0.5282695076259234,
      "val_verse_f1": 0.629172567266842,
      "val_chorus_f1": 0.42736644798500467,
      "val_chorus_rate": 0.48638951778411865,
      "val_max_prob": 0.5707437098026276,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.7978604226930563e-05,
      "epoch_time": 32.940598011016846,
      "val_boundary_f1": 0.054249547920433995,
      "val_boundary_precision": 0.11627906976744186,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.05268199233716475,
      "val_avg_segment_overlap": 0.22829619803839885,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3104258920692663,
      "val_pk_metric": 0.30341300861224274
    },
    {
      "epoch": 8,
      "train_loss": 0.5602425277233124,
      "train_chorus_rate": 0.55296391248703,
      "train_max_prob": 0.5735089421272278,
      "train_conf_over_90": 3.511235991027206e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.591790109872818,
      "val_macro_f1": 0.5213521911958202,
      "val_verse_f1": 0.5972869860110216,
      "val_chorus_f1": 0.4454173963806188,
      "val_chorus_rate": 0.5416849851608276,
      "val_max_prob": 0.5727243721485138,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 32.72462606430054,
      "val_boundary_f1": 0.050816696914700546,
      "val_boundary_precision": 0.11023622047244094,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.05477729885057471,
      "val_avg_segment_overlap": 0.21912312364495384,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3239400886221686,
      "val_pk_metric": 0.31101704247301987
    }
  ]
}