{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.15691736517142468,
      "layer_dropout": 0.20026896842886752,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.13958706208777497,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009200344193431324,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.012858432369209553,
      "gradient_clip_norm": 0.4176814379888316,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10003323468044839,
        "ece_after": 0.023280580570163814,
        "improvement": 0.07675265411028458,
        "params": {
          "temperature": 0.5753635515843444
        }
      },
      "platt": {
        "ece_before": 0.10003323468044839,
        "ece_after": 0.02935311938901312,
        "improvement": 0.07068011529143527,
        "params": {
          "A": 1.6526020185966086,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5652496635913848,
      "train_chorus_rate": 0.6056920557923149,
      "train_max_prob": 0.5637580007314682,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5734108686447144,
      "val_macro_f1": 0.52391845640496,
      "val_verse_f1": 0.6318318318318318,
      "val_chorus_f1": 0.4160050809780883,
      "val_chorus_rate": 0.4736504480242729,
      "val_max_prob": 0.5327270030975342,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009099928658077018,
      "epoch_time": 90.01062297821045,
      "val_boundary_f1": 0.06557377049180327,
      "val_boundary_precision": 0.144,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.009448063424733626,
      "val_avg_segment_overlap": 0.21637783728541837,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44501193283875434,
      "val_pk_metric": 0.46672519140328184
    },
    {
      "epoch": 2,
      "train_loss": 0.5418119996786117,
      "train_chorus_rate": 0.5637698836624623,
      "train_max_prob": 0.5522799998521805,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5808533132076263,
      "val_macro_f1": 0.5297694179320124,
      "val_verse_f1": 0.7792041078305519,
      "val_chorus_f1": 0.2803347280334728,
      "val_chorus_rate": 0.16975700855255127,
      "val_max_prob": 0.5601737648248672,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008803070692756281,
      "epoch_time": 47.53528189659119,
      "val_boundary_f1": 0.09824561403508772,
      "val_boundary_precision": 0.1917808219178082,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.057013235777816904,
      "val_avg_segment_overlap": 0.25818596431066165,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3303796456523486,
      "val_pk_metric": 0.3237914574664095
    },
    {
      "epoch": 3,
      "train_loss": 0.5265947982668877,
      "train_chorus_rate": 0.4474641852313653,
      "train_max_prob": 0.5815335094928742,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5835071355104446,
      "val_macro_f1": 0.46917951784045303,
      "val_verse_f1": 0.8206264775413712,
      "val_chorus_f1": 0.11773255813953488,
      "val_chorus_rate": 0.03769574174657464,
      "val_max_prob": 0.5732922255992889,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008322744415036193,
      "epoch_time": 128.46212100982666,
      "val_boundary_f1": 0.10588235294117647,
      "val_boundary_precision": 0.313953488372093,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.0707695633066789,
      "val_avg_segment_overlap": 0.21827496462588103,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.28664142498351386,
      "val_pk_metric": 0.2801127738653703
    },
    {
      "epoch": 4,
      "train_loss": 0.5221304014325142,
      "train_chorus_rate": 0.4718478720635176,
      "train_max_prob": 0.5853488028049469,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5680181235074997,
      "val_macro_f1": 0.5306881187466139,
      "val_verse_f1": 0.5709115584709341,
      "val_chorus_f1": 0.49046467902229385,
      "val_chorus_rate": 0.616285502910614,
      "val_max_prob": 0.6246486902236938,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007679942388114319,
      "epoch_time": 95.92508506774902,
      "val_boundary_f1": 0.08064516129032259,
      "val_boundary_precision": 0.12755102040816327,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.04053572963965329,
      "val_avg_segment_overlap": 0.24566149182098754,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.39811847972181574,
      "val_pk_metric": 0.37213734158577044
    },
    {
      "epoch": 5,
      "train_loss": 0.5174531131982804,
      "train_chorus_rate": 0.45207481011748313,
      "train_max_prob": 0.62163747549057,
      "train_conf_over_90": 0.00034831733792088925,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5324253290891647,
      "val_macro_f1": 0.6871601029029015,
      "val_verse_f1": 0.7969460098163971,
      "val_chorus_f1": 0.5773741959894061,
      "val_chorus_rate": 0.35000911355018616,
      "val_max_prob": 0.628655731678009,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006902758145073493,
      "epoch_time": 47.230061054229736,
      "val_boundary_f1": 0.2786885245901639,
      "val_boundary_precision": 0.2463768115942029,
      "val_boundary_recall": 0.32075471698113206,
      "val_complete_segments": 0.1340749968268526,
      "val_avg_segment_overlap": 0.5283662320347995,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.39797414588900193,
      "val_pk_metric": 0.3137460590589862
    },
    {
      "epoch": 6,
      "train_loss": 0.49616212397813797,
      "train_chorus_rate": 0.40599030926823615,
      "train_max_prob": 0.6506555825471878,
      "train_conf_over_90": 0.006347360194195062,
      "train_conf_over_95": 4.084967367816717e-05,
      "val_loss": 0.540283627808094,
      "val_macro_f1": 0.7042273981889497,
      "val_verse_f1": 0.8290155440414508,
      "val_chorus_f1": 0.5794392523364487,
      "val_chorus_rate": 0.27850350737571716,
      "val_max_prob": 0.6747622191905975,
      "val_conf_over_90": 0.0019090149726253003,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006025158366678362,
      "epoch_time": 49.039551973342896,
      "val_boundary_f1": 0.3236763236763237,
      "val_boundary_precision": 0.2807625649913345,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.1762022134238465,
      "val_avg_segment_overlap": 0.5643595390321504,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.42212105208202316,
      "val_pk_metric": 0.3162266869528013
    },
    {
      "epoch": 7,
      "train_loss": 0.4785825163125992,
      "train_chorus_rate": 0.3860520049929619,
      "train_max_prob": 0.6665290623903275,
      "train_conf_over_90": 0.008986184213426895,
      "train_conf_over_95": 3.5460991784930226e-05,
      "val_loss": 0.5105482935905457,
      "val_macro_f1": 0.7137843525878098,
      "val_verse_f1": 0.8106422018348624,
      "val_chorus_f1": 0.6169265033407573,
      "val_chorus_rate": 0.3626686930656433,
      "val_max_prob": 0.671488955616951,
      "val_conf_over_90": 0.002853709680493921,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005085498374435753,
      "epoch_time": 87.94035124778748,
      "val_boundary_f1": 0.27339449541284405,
      "val_boundary_precision": 0.22372372372372373,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.15279837480261657,
      "val_avg_segment_overlap": 0.5984372315516808,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4459384972929573,
      "val_pk_metric": 0.32066462986872807
    },
    {
      "epoch": 8,
      "train_loss": 0.47534314543008804,
      "train_chorus_rate": 0.36923201754689217,
      "train_max_prob": 0.6610536873340607,
      "train_conf_over_90": 0.0060461002518422905,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5047391727566719,
      "val_macro_f1": 0.7035722892940417,
      "val_verse_f1": 0.7914377723053608,
      "val_chorus_f1": 0.6157068062827225,
      "val_chorus_rate": 0.4046721011400223,
      "val_max_prob": 0.6386757642030716,
      "val_conf_over_90": 0.0019090149726253003,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004124845818995575,
      "epoch_time": 106.86942481994629,
      "val_boundary_f1": 0.2631578947368421,
      "val_boundary_precision": 0.21386430678466076,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.1422273754590828,
      "val_avg_segment_overlap": 0.5891183070979344,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.45189377194049835,
      "val_pk_metric": 0.32774644192015834
    },
    {
      "epoch": 9,
      "train_loss": 0.4714276999235153,
      "train_chorus_rate": 0.3729577139019966,
      "train_max_prob": 0.6722218543291092,
      "train_conf_over_90": 0.01909336320240982,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5085347071290016,
      "val_macro_f1": 0.6742078433490217,
      "val_verse_f1": 0.7530156219102235,
      "val_chorus_f1": 0.5954000647878198,
      "val_chorus_rate": 0.458672396838665,
      "val_max_prob": 0.6902726143598557,
      "val_conf_over_90": 0.03468756377696991,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003185185826752964,
      "epoch_time": 67.91964507102966,
      "val_boundary_f1": 0.2302568981921979,
      "val_boundary_precision": 0.19298245614035087,
      "val_boundary_recall": 0.28537735849056606,
      "val_complete_segments": 0.08438118849041436,
      "val_avg_segment_overlap": 0.5496018222491583,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.4667597294083952,
      "val_pk_metric": 0.36049677692104576
    },
    {
      "epoch": 10,
      "train_loss": 0.4716506123542786,
      "train_chorus_rate": 0.37052384614944456,
      "train_max_prob": 0.6691199719905854,
      "train_conf_over_90": 0.016688344610156492,
      "train_conf_over_95": 3.331112675368786e-05,
      "val_loss": 0.507003903388977,
      "val_macro_f1": 0.7507755782523386,
      "val_verse_f1": 0.8545170799375759,
      "val_chorus_f1": 0.6470340765671014,
      "val_chorus_rate": 0.2843846306204796,
      "val_max_prob": 0.6954869031906128,
      "val_conf_over_90": 0.005300431221257895,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023075860483578323,
      "epoch_time": 45.693368911743164,
      "val_boundary_f1": 0.35514018691588783,
      "val_boundary_precision": 0.3172541743970315,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.2310855849031883,
      "val_avg_segment_overlap": 0.6101549755089992,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.3380101114011068,
      "val_pk_metric": 0.2534248063879471
    },
    {
      "epoch": 11,
      "train_loss": 0.4714863017201424,
      "train_chorus_rate": 0.33836159482598305,
      "train_max_prob": 0.6749381184577942,
      "train_conf_over_90": 0.01338395873317495,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5022729560732841,
      "val_macro_f1": 0.7340563964944169,
      "val_verse_f1": 0.8394019349164468,
      "val_chorus_f1": 0.6287108580723871,
      "val_chorus_rate": 0.30447251349687576,
      "val_max_prob": 0.6472465842962265,
      "val_conf_over_90": 0.00024108003708533943,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015304018053170066,
      "epoch_time": 40.64937210083008,
      "val_boundary_f1": 0.33200795228628227,
      "val_boundary_precision": 0.2869415807560137,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.18408108722265668,
      "val_avg_segment_overlap": 0.6026786928496528,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.3682630855932899,
      "val_pk_metric": 0.2661738717917534
    },
    {
      "epoch": 12,
      "train_loss": 0.47083946168422697,
      "train_chorus_rate": 0.36008860170841217,
      "train_max_prob": 0.6720442622900009,
      "train_conf_over_90": 0.011120189120993018,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49458907544612885,
      "val_macro_f1": 0.7359656773600245,
      "val_verse_f1": 0.8326442566960274,
      "val_chorus_f1": 0.6392870980240216,
      "val_chorus_rate": 0.3345367833971977,
      "val_max_prob": 0.664079561829567,
      "val_conf_over_90": 0.00212065689265728,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.875997783951321e-05,
      "epoch_time": 72.84436321258545,
      "val_boundary_f1": 0.31364956437560504,
      "val_boundary_precision": 0.2660098522167488,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.17284531350013854,
      "val_avg_segment_overlap": 0.6198274914758899,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.38748582370534823,
      "val_pk_metric": 0.27619545174053267
    },
    {
      "epoch": 13,
      "train_loss": 0.46168348640203477,
      "train_chorus_rate": 0.35740794986486435,
      "train_max_prob": 0.6858313888311386,
      "train_conf_over_90": 0.02651444971561432,
      "train_conf_over_95": 2.7793218032456933e-05,
      "val_loss": 0.49074192345142365,
      "val_macro_f1": 0.7324612740122458,
      "val_verse_f1": 0.8221445650174728,
      "val_chorus_f1": 0.6427779830070189,
      "val_chorus_rate": 0.36564449220895767,
      "val_max_prob": 0.6714415848255157,
      "val_conf_over_90": 0.0092810396454297,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.072735006750422e-05,
      "epoch_time": 50.4418089389801,
      "val_boundary_f1": 0.3144774688398849,
      "val_boundary_precision": 0.2649434571890145,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.1801364555738893,
      "val_avg_segment_overlap": 0.614602374428294,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.3964671705011263,
      "val_pk_metric": 0.28323058701348436
    }
  ]
}