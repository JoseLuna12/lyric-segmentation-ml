{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.26141583585346806,
      "layer_dropout": 0.2005268114791217,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.16235645244554667,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006829265086656474,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "composite",
      "weight_decay": 0.02132441779106332,
      "gradient_clip_norm": 0.3457761230819491,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08304318113797773,
        "ece_after": 0.10167961260248963,
        "improvement": -0.018636431464511896,
        "params": {
          "temperature": 0.7326662534470667
        }
      },
      "platt": {
        "ece_before": 0.08304318113797773,
        "ece_after": 0.07607888851922248,
        "improvement": 0.006964292618755252,
        "params": {
          "A": 0.9999954439181844,
          "B": -0.02053748399143923
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.601008677482605,
      "train_chorus_rate": 0.4808474275283515,
      "train_max_prob": 0.608514153957367,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6018344014883041,
      "val_macro_f1": 0.33410409025965926,
      "val_verse_f1": 0.18578199052132702,
      "val_chorus_f1": 0.48242618999799153,
      "val_chorus_rate": 0.9229311496019363,
      "val_max_prob": 0.5791439712047577,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006569722263493599,
      "epoch_time": 101.60423612594604,
      "val_boundary_f1": 0.014571948998178508,
      "val_boundary_precision": 0.032,
      "val_boundary_recall": 0.009433962264150943,
      "val_complete_segments": 0.005629828813816089,
      "val_avg_segment_overlap": 0.13085623138318042,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3879380623327314,
      "val_pk_metric": 0.36875172730169475
    },
    {
      "epoch": 2,
      "train_loss": 0.5775321334600448,
      "train_chorus_rate": 0.5713004671037197,
      "train_max_prob": 0.555035549402237,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6010069698095322,
      "val_macro_f1": 0.5037428736676857,
      "val_verse_f1": 0.5461538461538461,
      "val_chorus_f1": 0.4613319011815253,
      "val_chorus_rate": 0.6149957925081253,
      "val_max_prob": 0.5504128634929657,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005830606836069968,
      "epoch_time": 69.82775378227234,
      "val_boundary_f1": 0.061488673139158574,
      "val_boundary_precision": 0.0979381443298969,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.02577528861993337,
      "val_avg_segment_overlap": 0.23143122194012863,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4578499020577268,
      "val_pk_metric": 0.45894440025248884
    },
    {
      "epoch": 3,
      "train_loss": 0.5531647697091102,
      "train_chorus_rate": 0.6251740597188473,
      "train_max_prob": 0.5725143045186997,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6511779576539993,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.6457664519548416,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004724442428112798,
      "epoch_time": 123.5398690700531,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 4,
      "train_loss": 0.5851295083761215,
      "train_chorus_rate": 0.47985324151813985,
      "train_max_prob": 0.5935657322406769,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5945967435836792,
      "val_macro_f1": 0.46920189098998877,
      "val_verse_f1": 0.45564516129032256,
      "val_chorus_f1": 0.482758620689655,
      "val_chorus_rate": 0.7262064069509506,
      "val_max_prob": 0.540972501039505,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003419632543328237,
      "epoch_time": 73.00625991821289,
      "val_boundary_f1": 0.03839441535776615,
      "val_boundary_precision": 0.0738255033557047,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.023549718101679926,
      "val_avg_segment_overlap": 0.21501085641476186,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.42947145506952433,
      "val_pk_metric": 0.4334453996245795
    },
    {
      "epoch": 5,
      "train_loss": 0.5650594368577003,
      "train_chorus_rate": 0.47969680002424864,
      "train_max_prob": 0.5750420302152633,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5953023284673691,
      "val_macro_f1": 0.462965282319385,
      "val_verse_f1": 0.44753476611883686,
      "val_chorus_f1": 0.47839579851993314,
      "val_chorus_rate": 0.7303441166877747,
      "val_max_prob": 0.5460257679224014,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021148226585436766,
      "epoch_time": 113.16616296768188,
      "val_boundary_f1": 0.05564142194744976,
      "val_boundary_precision": 0.08071748878923767,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.0319419082011871,
      "val_avg_segment_overlap": 0.2244234718605667,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4770208600405549,
      "val_pk_metric": 0.4805161640594438
    },
    {
      "epoch": 6,
      "train_loss": 0.5641965180635452,
      "train_chorus_rate": 0.6113402254879474,
      "train_max_prob": 0.5701844185590744,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5952711850404739,
      "val_macro_f1": 0.39603164364656773,
      "val_verse_f1": 0.31133961725221365,
      "val_chorus_f1": 0.4807236700409218,
      "val_chorus_rate": 0.8403147310018539,
      "val_max_prob": 0.5958167314529419,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001008658250586506,
      "epoch_time": 90.45129084587097,
      "val_boundary_f1": 0.06934306569343066,
      "val_boundary_precision": 0.1532258064516129,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.03253004936461988,
      "val_avg_segment_overlap": 0.1756566316945402,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.41157113147860724,
      "val_pk_metric": 0.4050123633634409
    },
    {
      "epoch": 7,
      "train_loss": 0.5657127678394318,
      "train_chorus_rate": 0.6132885739207268,
      "train_max_prob": 0.5664758533239365,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5948449969291687,
      "val_macro_f1": 0.4121424106452566,
      "val_verse_f1": 0.3466003316749585,
      "val_chorus_f1": 0.4776844896155546,
      "val_chorus_rate": 0.8124140053987503,
      "val_max_prob": 0.5810705423355103,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.695428231628758e-05,
      "epoch_time": 51.85733389854431,
      "val_boundary_f1": 0.05745062836624776,
      "val_boundary_precision": 0.12030075187969924,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.029327831846389645,
      "val_avg_segment_overlap": 0.1881414330477154,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.41800690654569056,
      "val_pk_metric": 0.41426512947705874
    },
    {
      "epoch": 8,
      "train_loss": 0.563688337802887,
      "train_chorus_rate": 0.7714208781719207,
      "train_max_prob": 0.5687214970588684,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5969179421663284,
      "val_macro_f1": 0.4662920494002382,
      "val_verse_f1": 0.4534474081529944,
      "val_chorus_f1": 0.47913669064748204,
      "val_chorus_rate": 0.7253280580043793,
      "val_max_prob": 0.5589538365602493,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 114.91487717628479,
      "val_boundary_f1": 0.05378151260504202,
      "val_boundary_precision": 0.0935672514619883,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.01975536739587641,
      "val_avg_segment_overlap": 0.2164977367085435,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.44725409931319515,
      "val_pk_metric": 0.44593296321980924
    }
  ]
}