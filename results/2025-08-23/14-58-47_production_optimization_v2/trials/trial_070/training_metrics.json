{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.16679868819803345,
      "layer_dropout": 0.2074864280246231,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12156719141997327,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.000245955318992536,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01893381298026579,
      "gradient_clip_norm": 0.786779760678525,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06150762949043735,
        "ece_after": 0.06490032609061783,
        "improvement": -0.0033926966001804754,
        "params": {
          "temperature": 0.6133542236507612
        }
      },
      "platt": {
        "ece_before": 0.06150762949043735,
        "ece_after": 0.06008733522095707,
        "improvement": 0.0014202942694802809,
        "params": {
          "A": 1.4991001508084554,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.570694899559021,
      "train_chorus_rate": 0.4019906193949282,
      "train_max_prob": 0.5526681661605835,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5879732966423035,
      "val_macro_f1": 0.48214176426296296,
      "val_verse_f1": 0.5038887579542777,
      "val_chorus_f1": 0.46039477057164824,
      "val_chorus_rate": 0.6582054793834686,
      "val_max_prob": 0.5308527946472168,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002417819939471518,
      "epoch_time": 133.90727710723877,
      "val_boundary_f1": 0.06834532374100719,
      "val_boundary_precision": 0.14393939393939395,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.016163793103448273,
      "val_avg_segment_overlap": 0.2076728065303739,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43431867130770907,
      "val_pk_metric": 0.4380956060735264
    },
    {
      "epoch": 2,
      "train_loss": 0.5532939404249191,
      "train_chorus_rate": 0.5071522101759911,
      "train_max_prob": 0.5450134634971618,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5953584909439087,
      "val_macro_f1": 0.5609754991546377,
      "val_verse_f1": 0.7708921747798637,
      "val_chorus_f1": 0.3510588235294118,
      "val_chorus_rate": 0.22211027890443802,
      "val_max_prob": 0.5529053211212158,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002295464240160965,
      "epoch_time": 73.24484300613403,
      "val_boundary_f1": 0.057803468208092484,
      "val_boundary_precision": 0.15789473684210525,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.04711446360153257,
      "val_avg_segment_overlap": 0.22775552617066167,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.3310895933288714,
      "val_pk_metric": 0.33753093973223647
    },
    {
      "epoch": 3,
      "train_loss": 0.5342887043952942,
      "train_chorus_rate": 0.39228064492344855,
      "train_max_prob": 0.5699342846870422,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5933872759342194,
      "val_macro_f1": 0.5538799966653496,
      "val_verse_f1": 0.6593843098311817,
      "val_chorus_f1": 0.4483756834995175,
      "val_chorus_rate": 0.46353231370449066,
      "val_max_prob": 0.5650677382946014,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021008244306993602,
      "epoch_time": 151.9293670654297,
      "val_boundary_f1": 0.062157221206581355,
      "val_boundary_precision": 0.13821138211382114,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.04627634099616858,
      "val_avg_segment_overlap": 0.22938436828013858,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3584762086844768,
      "val_pk_metric": 0.35590676094877594
    },
    {
      "epoch": 4,
      "train_loss": 0.5394370973110199,
      "train_chorus_rate": 0.4850186586380005,
      "train_max_prob": 0.5855955064296723,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5930896103382111,
      "val_macro_f1": 0.5614268532097989,
      "val_verse_f1": 0.7684351017684351,
      "val_chorus_f1": 0.35441860465116276,
      "val_chorus_rate": 0.228116974234581,
      "val_max_prob": 0.5790540874004364,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000184716489244402,
      "epoch_time": 119.69466400146484,
      "val_boundary_f1": 0.05078125,
      "val_boundary_precision": 0.14772727272727273,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.06573275862068965,
      "val_avg_segment_overlap": 0.23007128940733554,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.2930934358561854,
      "val_pk_metric": 0.29811839263975504
    },
    {
      "epoch": 5,
      "train_loss": 0.5506574273109436,
      "train_chorus_rate": 0.526206710934639,
      "train_max_prob": 0.5909153163433075,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5879320502281189,
      "val_macro_f1": 0.5772847605612261,
      "val_verse_f1": 0.6917874396135266,
      "val_chorus_f1": 0.4627820815089255,
      "val_chorus_rate": 0.4291992336511612,
      "val_max_prob": 0.5725073516368866,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015517721037348377,
      "epoch_time": 75.17738270759583,
      "val_boundary_f1": 0.05597014925373134,
      "val_boundary_precision": 0.13392857142857142,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.06381704980842912,
      "val_avg_segment_overlap": 0.24097732762337787,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.31905038979504785,
      "val_pk_metric": 0.3244055581879155
    },
    {
      "epoch": 6,
      "train_loss": 0.54808309674263,
      "train_chorus_rate": 0.4626334846019745,
      "train_max_prob": 0.5689815282821655,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5762005746364594,
      "val_macro_f1": 0.5582628244146708,
      "val_verse_f1": 0.6324642556770395,
      "val_chorus_f1": 0.48406139315230223,
      "val_chorus_rate": 0.5323987305164337,
      "val_max_prob": 0.5648033618927002,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000123477659496268,
      "epoch_time": 83.22058320045471,
      "val_boundary_f1": 0.07272727272727274,
      "val_boundary_precision": 0.15873015873015872,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.06573275862068965,
      "val_avg_segment_overlap": 0.24218058662896844,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.32428735035308287,
      "val_pk_metric": 0.32918234136630065
    },
    {
      "epoch": 7,
      "train_loss": 0.5306069314479828,
      "train_chorus_rate": 0.4962576895952225,
      "train_max_prob": 0.5958181381225586,
      "train_conf_over_90": 3.787878667935729e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5868109166622162,
      "val_macro_f1": 0.5757315675793635,
      "val_verse_f1": 0.6869040669390932,
      "val_chorus_f1": 0.4645590682196339,
      "val_chorus_rate": 0.43789011240005493,
      "val_max_prob": 0.5887493789196014,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.177810861905224e-05,
      "epoch_time": 132.49653792381287,
      "val_boundary_f1": 0.06355140186915888,
      "val_boundary_precision": 0.15315315315315314,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.058249521072796934,
      "val_avg_segment_overlap": 0.23342655759222192,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.32405645509689973,
      "val_pk_metric": 0.32433315718037925
    },
    {
      "epoch": 8,
      "train_loss": 0.5214187920093536,
      "train_chorus_rate": 0.456021648645401,
      "train_max_prob": 0.6109421253204346,
      "train_conf_over_90": 0.00011827930284198373,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5793991386890411,
      "val_macro_f1": 0.5788472024380656,
      "val_verse_f1": 0.702959028831563,
      "val_chorus_f1": 0.45473537604456826,
      "val_chorus_rate": 0.4054672569036484,
      "val_max_prob": 0.5743526816368103,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.223882974813402e-05,
      "epoch_time": 132.32450008392334,
      "val_boundary_f1": 0.05904059040590406,
      "val_boundary_precision": 0.13559322033898305,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.060524425287356326,
      "val_avg_segment_overlap": 0.24824215057406204,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3030571939257967,
      "val_pk_metric": 0.30609361061733886
    },
    {
      "epoch": 9,
      "train_loss": 0.5368546068668365,
      "train_chorus_rate": 0.49413068145513533,
      "train_max_prob": 0.5918914258480072,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5756466090679169,
      "val_macro_f1": 0.5486532013751237,
      "val_verse_f1": 0.6108353118929418,
      "val_chorus_f1": 0.48647109085730555,
      "val_chorus_rate": 0.5624698400497437,
      "val_max_prob": 0.5857017040252686,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.687287592259996e-05,
      "epoch_time": 94.79151916503906,
      "val_boundary_f1": 0.04477611940298507,
      "val_boundary_precision": 0.10714285714285714,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.04729406130268199,
      "val_avg_segment_overlap": 0.22423405163891907,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3374384806592827,
      "val_pk_metric": 0.32404788255280303
    },
    {
      "epoch": 10,
      "train_loss": 0.5314936906099319,
      "train_chorus_rate": 0.4535264909267426,
      "train_max_prob": 0.6016632914543152,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5773942768573761,
      "val_macro_f1": 0.566243612488438,
      "val_verse_f1": 0.6587044534412956,
      "val_chorus_f1": 0.47378277153558046,
      "val_chorus_rate": 0.48694680631160736,
      "val_max_prob": 0.5830934047698975,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.7408894976439513e-05,
      "epoch_time": 63.29018998146057,
      "val_boundary_f1": 0.056179775280898875,
      "val_boundary_precision": 0.13636363636363635,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.05459770114942529,
      "val_avg_segment_overlap": 0.2353191231044417,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3044358299864629,
      "val_pk_metric": 0.3091717147161814
    },
    {
      "epoch": 11,
      "train_loss": 0.534151166677475,
      "train_chorus_rate": 0.4481201976537704,
      "train_max_prob": 0.5947149217128753,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5763639807701111,
      "val_macro_f1": 0.567659923086404,
      "val_verse_f1": 0.6535545994673223,
      "val_chorus_f1": 0.4817652467054857,
      "val_chorus_rate": 0.5014619827270508,
      "val_max_prob": 0.5832739174365997,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.1733250453841915e-06,
      "epoch_time": 78.15126395225525,
      "val_boundary_f1": 0.041275797373358354,
      "val_boundary_precision": 0.10091743119266056,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.05477729885057471,
      "val_avg_segment_overlap": 0.2366163184153792,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.31023900115385206,
      "val_pk_metric": 0.3158279233127036
    },
    {
      "epoch": 12,
      "train_loss": 0.5361602604389191,
      "train_chorus_rate": 0.47059004902839663,
      "train_max_prob": 0.5991010129451751,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5751233696937561,
      "val_macro_f1": 0.5611989155672803,
      "val_verse_f1": 0.6394330971238016,
      "val_chorus_f1": 0.48296473401075907,
      "val_chorus_rate": 0.5218946039676666,
      "val_max_prob": 0.5829529762268066,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 105.15319609642029,
      "val_boundary_f1": 0.037664783427495296,
      "val_boundary_precision": 0.09345794392523364,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.05459770114942529,
      "val_avg_segment_overlap": 0.23021101368023641,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3103930983272998,
      "val_pk_metric": 0.31601463322687406
    }
  ]
}