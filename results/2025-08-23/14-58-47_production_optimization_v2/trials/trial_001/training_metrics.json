{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.34640170568352,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 170498,
      "lstm_params": 169984,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00033155126334571787,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.006283790142503271,
      "gradient_clip_norm": 0.3627509626545986,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.011609189841742565,
        "ece_after": 0.04892737630659566,
        "improvement": -0.0373181864648531,
        "params": {
          "temperature": 0.7621033632370781
        }
      },
      "platt": {
        "ece_before": 0.011609189841742565,
        "ece_after": 0.029164692390644266,
        "improvement": -0.017555502548901702,
        "params": {
          "A": 1.1633438469354567,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5665475249290466,
      "train_chorus_rate": 0.18823444209992884,
      "train_max_prob": 0.5234009444713592,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6049705743789673,
      "val_macro_f1": 0.5095966847485485,
      "val_verse_f1": 0.772501998401279,
      "val_chorus_f1": 0.24669137109581785,
      "val_chorus_rate": 0.1640225425362587,
      "val_max_prob": 0.5298404395580292,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003259196327619129,
      "epoch_time": 449.8474328517914,
      "val_boundary_f1": 0.054644808743169404,
      "val_boundary_precision": 0.12,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.011135057471264368,
      "val_avg_segment_overlap": 0.21337129896529142,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40465238590761965,
      "val_pk_metric": 0.42569848337445104
    },
    {
      "epoch": 2,
      "train_loss": 0.5698916375637054,
      "train_chorus_rate": 0.435647451877594,
      "train_max_prob": 0.5278479278087616,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5997035503387451,
      "val_macro_f1": 0.5205630226128135,
      "val_verse_f1": 0.6207596993703026,
      "val_chorus_f1": 0.42036634585532445,
      "val_chorus_rate": 0.49110841751098633,
      "val_max_prob": 0.5311670303344727,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030940852732807476,
      "epoch_time": 351.76499795913696,
      "val_boundary_f1": 0.07486631016042782,
      "val_boundary_precision": 0.15328467153284672,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.014427681992337165,
      "val_avg_segment_overlap": 0.2137842637084924,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4779944201966888,
      "val_pk_metric": 0.48596652397911977
    },
    {
      "epoch": 3,
      "train_loss": 0.5656277239322662,
      "train_chorus_rate": 0.405882702767849,
      "train_max_prob": 0.5385383903980255,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5968464314937592,
      "val_macro_f1": 0.4316113949385849,
      "val_verse_f1": 0.38512971382722655,
      "val_chorus_f1": 0.4780930760499433,
      "val_chorus_rate": 0.7820740044116974,
      "val_max_prob": 0.5380364954471588,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002831431515936276,
      "epoch_time": 753.9804537296295,
      "val_boundary_f1": 0.04347826086956522,
      "val_boundary_precision": 0.09375,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.020174808429118774,
      "val_avg_segment_overlap": 0.19493966653531677,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4224782459684192,
      "val_pk_metric": 0.4176936496792422
    },
    {
      "epoch": 4,
      "train_loss": 0.5591343522071839,
      "train_chorus_rate": 0.5279042690992355,
      "train_max_prob": 0.5481763899326324,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5978117287158966,
      "val_macro_f1": 0.49469564100298025,
      "val_verse_f1": 0.5372593431483579,
      "val_chorus_f1": 0.4521319388576026,
      "val_chorus_rate": 0.6159052550792694,
      "val_max_prob": 0.5475118458271027,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002489134475092884,
      "epoch_time": 952.6417479515076,
      "val_boundary_f1": 0.05434782608695653,
      "val_boundary_precision": 0.1171875,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.014607279693486588,
      "val_avg_segment_overlap": 0.204822755864577,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4387631633491226,
      "val_pk_metric": 0.4382283365577794
    },
    {
      "epoch": 5,
      "train_loss": 0.5591153502464294,
      "train_chorus_rate": 0.5707112431526185,
      "train_max_prob": 0.5522237837314605,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6016521453857422,
      "val_macro_f1": 0.5148103418566216,
      "val_verse_f1": 0.5940468651044964,
      "val_chorus_f1": 0.4355738186087467,
      "val_chorus_rate": 0.5367118120193481,
      "val_max_prob": 0.5525446236133575,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002090521128411442,
      "epoch_time": 717.6622231006622,
      "val_boundary_f1": 0.05,
      "val_boundary_precision": 0.10294117647058823,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.01496647509578544,
      "val_avg_segment_overlap": 0.20866844701589582,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.46779029810885125,
      "val_pk_metric": 0.4751282266321464
    },
    {
      "epoch": 6,
      "train_loss": 0.5639555275440216,
      "train_chorus_rate": 0.5842466324567794,
      "train_max_prob": 0.5628124296665191,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5958513617515564,
      "val_macro_f1": 0.48027527396022507,
      "val_verse_f1": 0.48665696263949537,
      "val_chorus_f1": 0.47389358528095477,
      "val_chorus_rate": 0.6880478858947754,
      "val_max_prob": 0.549683690071106,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001662756316728589,
      "epoch_time": 740.3628449440002,
      "val_boundary_f1": 0.06093189964157706,
      "val_boundary_precision": 0.12686567164179105,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.020354406130268198,
      "val_avg_segment_overlap": 0.20743695603406365,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4556483131685134,
      "val_pk_metric": 0.4593947352410701
    },
    {
      "epoch": 7,
      "train_loss": 0.5433039426803589,
      "train_chorus_rate": 0.45335171520709994,
      "train_max_prob": 0.5741186201572418,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6023871004581451,
      "val_macro_f1": 0.5352986836694262,
      "val_verse_f1": 0.6222589987587919,
      "val_chorus_f1": 0.4483383685800605,
      "val_chorus_rate": 0.5128833502531052,
      "val_max_prob": 0.5513920187950134,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012349915050457365,
      "epoch_time": 2150.2036459445953,
      "val_boundary_f1": 0.07863247863247863,
      "val_boundary_precision": 0.14285714285714285,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.012871168582375478,
      "val_avg_segment_overlap": 0.2179117024623612,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4632306642437948,
      "val_pk_metric": 0.47293441934618063
    },
    {
      "epoch": 8,
      "train_loss": 0.560035353899002,
      "train_chorus_rate": 0.543784961104393,
      "train_max_prob": 0.564749562740326,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5988702774047852,
      "val_macro_f1": 0.4962456322229323,
      "val_verse_f1": 0.5301426599171652,
      "val_chorus_f1": 0.46234860452869925,
      "val_chorus_rate": 0.632849395275116,
      "val_max_prob": 0.5618642866611481,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.363781583642949e-05,
      "epoch_time": 162.36141800880432,
      "val_boundary_f1": 0.06474820143884892,
      "val_boundary_precision": 0.13636363636363635,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.014248084291187738,
      "val_avg_segment_overlap": 0.21019116039328506,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4614432572939065,
      "val_pk_metric": 0.46795817888464236
    },
    {
      "epoch": 9,
      "train_loss": 0.5543253242969512,
      "train_chorus_rate": 0.5483504086732864,
      "train_max_prob": 0.5790624022483826,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5993587374687195,
      "val_macro_f1": 0.4966928445380212,
      "val_verse_f1": 0.5326610130644053,
      "val_chorus_f1": 0.46072467601163714,
      "val_chorus_rate": 0.6287186741828918,
      "val_max_prob": 0.5605974197387695,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.940811175209025e-05,
      "epoch_time": 1639.9521777629852,
      "val_boundary_f1": 0.054249547920433995,
      "val_boundary_precision": 0.11627906976744186,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.016163793103448273,
      "val_avg_segment_overlap": 0.20877216967167955,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4605563110284563,
      "val_pk_metric": 0.4659923931346208
    },
    {
      "epoch": 10,
      "train_loss": 0.5644369423389435,
      "train_chorus_rate": 0.6074407696723938,
      "train_max_prob": 0.5710787236690521,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5968118011951447,
      "val_macro_f1": 0.4744585839291706,
      "val_verse_f1": 0.47368421052631576,
      "val_chorus_f1": 0.4752329573320255,
      "val_chorus_rate": 0.7017471492290497,
      "val_max_prob": 0.5613373816013336,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.3142736017643106e-05,
      "epoch_time": 606.1162400245667,
      "val_boundary_f1": 0.05026929982046679,
      "val_boundary_precision": 0.10526315789473684,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.016522988505747127,
      "val_avg_segment_overlap": 0.2035723535173789,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.45565273506425386,
      "val_pk_metric": 0.458848354455461
    },
    {
      "epoch": 11,
      "train_loss": 0.5571066498756408,
      "train_chorus_rate": 0.6077065348625184,
      "train_max_prob": 0.5690658211708068,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.598485916852951,
      "val_macro_f1": 0.49584582114096065,
      "val_verse_f1": 0.5308840413318026,
      "val_chorus_f1": 0.46080760095011875,
      "val_chorus_rate": 0.6307220160961151,
      "val_max_prob": 0.5580742657184601,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.631630583804976e-06,
      "epoch_time": 1754.4484906196594,
      "val_boundary_f1": 0.053667262969588556,
      "val_boundary_precision": 0.1111111111111111,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.018079501915708812,
      "val_avg_segment_overlap": 0.2107347947813658,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4628958814790525,
      "val_pk_metric": 0.47144532186144394
    },
    {
      "epoch": 12,
      "train_loss": 0.5580611407756806,
      "train_chorus_rate": 0.5444242268800735,
      "train_max_prob": 0.5692849636077881,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5987039506435394,
      "val_macro_f1": 0.49830140053697836,
      "val_verse_f1": 0.5366187542778919,
      "val_chorus_f1": 0.45998404679606486,
      "val_chorus_rate": 0.6238453686237335,
      "val_max_prob": 0.5580609440803528,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 171.88620686531067,
      "val_boundary_f1": 0.06440071556350627,
      "val_boundary_precision": 0.13333333333333333,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.016163793103448273,
      "val_avg_segment_overlap": 0.21219719852659127,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.4615827066143817,
      "val_pk_metric": 0.4705894499477717
    }
  ]
}