{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.1857545112962129,
      "layer_dropout": 0.2477213043212608,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.11867754499064956,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1099523,
      "lstm_params": 958464,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008325708470886173,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.01851530843407482,
      "gradient_clip_norm": 0.31609178397370086,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07421156061421676,
        "ece_after": 0.007375235334477872,
        "improvement": 0.06683632527973889,
        "params": {
          "temperature": 0.6355325383603087
        }
      },
      "platt": {
        "ece_before": 0.07421156061421676,
        "ece_after": 0.012129853452118533,
        "improvement": 0.062081707162098224,
        "params": {
          "A": 1.4999993823132876,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5680824488401413,
      "train_chorus_rate": 0.48526974170235915,
      "train_max_prob": 0.573591947555542,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5796174108982086,
      "val_macro_f1": 0.4063113153927892,
      "val_verse_f1": 0.3147502903600465,
      "val_chorus_f1": 0.4978723404255319,
      "val_chorus_rate": 0.8545238077640533,
      "val_max_prob": 0.549368292093277,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008234849380042633,
      "epoch_time": 145.05936002731323,
      "val_boundary_f1": 0.050816696914700546,
      "val_boundary_precision": 0.11023622047244094,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.025483717318287837,
      "val_avg_segment_overlap": 0.18292906743947385,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4120015401919031,
      "val_pk_metric": 0.40587736052700574
    },
    {
      "epoch": 2,
      "train_loss": 0.5440511137247086,
      "train_chorus_rate": 0.40928705893456935,
      "train_max_prob": 0.5625193744897843,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5531633794307709,
      "val_macro_f1": 0.6220397356266922,
      "val_verse_f1": 0.6881270903010034,
      "val_chorus_f1": 0.555952380952381,
      "val_chorus_rate": 0.5265609249472618,
      "val_max_prob": 0.5851798355579376,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007966243085772166,
      "epoch_time": 123.91661500930786,
      "val_boundary_f1": 0.15424836601307187,
      "val_boundary_precision": 0.17302052785923755,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.050204719186691615,
      "val_avg_segment_overlap": 0.378322194566938,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.1414141414141414,
      "val_window_diff": 0.4753739794337175,
      "val_pk_metric": 0.4118689043499253
    },
    {
      "epoch": 3,
      "train_loss": 0.5152994334697724,
      "train_chorus_rate": 0.4563714563846588,
      "train_max_prob": 0.6381120830774307,
      "train_conf_over_90": 2.6357406750321388e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5172573924064636,
      "val_macro_f1": 0.6585612319743972,
      "val_verse_f1": 0.7064398018522506,
      "val_chorus_f1": 0.6106826620965439,
      "val_chorus_rate": 0.5603821575641632,
      "val_max_prob": 0.6539915949106216,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007531628972050397,
      "epoch_time": 151.62018394470215,
      "val_boundary_f1": 0.23837209302325585,
      "val_boundary_precision": 0.20230263157894737,
      "val_boundary_recall": 0.29009433962264153,
      "val_complete_segments": 0.12731307091063188,
      "val_avg_segment_overlap": 0.5412649663826439,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.23232323232323232,
      "val_window_diff": 0.5128223108900364,
      "val_pk_metric": 0.4025511302620782
    },
    {
      "epoch": 4,
      "train_loss": 0.4968403622508049,
      "train_chorus_rate": 0.4418977089226246,
      "train_max_prob": 0.6772012054920197,
      "train_conf_over_90": 0.013943058173754252,
      "train_conf_over_95": 6.930006784386933e-05,
      "val_loss": 0.5077683329582214,
      "val_macro_f1": 0.7199978872128092,
      "val_verse_f1": 0.7937803692905734,
      "val_chorus_f1": 0.646215405135045,
      "val_chorus_rate": 0.4375155493617058,
      "val_max_prob": 0.683640643954277,
      "val_conf_over_90": 0.0022415812563849613,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006950001761156866,
      "epoch_time": 134.9380440711975,
      "val_boundary_f1": 0.32007759456838025,
      "val_boundary_precision": 0.27182866556836904,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.18700504018637634,
      "val_avg_segment_overlap": 0.5969696861760623,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.439417622814489,
      "val_pk_metric": 0.3439692137008116
    },
    {
      "epoch": 5,
      "train_loss": 0.4907025292515755,
      "train_chorus_rate": 0.4116580583155155,
      "train_max_prob": 0.6860816776752472,
      "train_conf_over_90": 0.011513874214142562,
      "train_conf_over_95": 0.0001672188809607178,
      "val_loss": 0.5314805507659912,
      "val_macro_f1": 0.7268707278994819,
      "val_verse_f1": 0.8441848479642673,
      "val_chorus_f1": 0.6095566078346965,
      "val_chorus_rate": 0.27156949043273926,
      "val_max_prob": 0.6695502400398254,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006246781353164629,
      "epoch_time": 138.0086019039154,
      "val_boundary_f1": 0.33432835820895523,
      "val_boundary_precision": 0.2891566265060241,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.18031792207295919,
      "val_avg_segment_overlap": 0.609194497496478,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4091535932399978,
      "val_pk_metric": 0.29367187671049044
    },
    {
      "epoch": 6,
      "train_loss": 0.4829590037465096,
      "train_chorus_rate": 0.4065423488616943,
      "train_max_prob": 0.6916944950819015,
      "train_conf_over_90": 0.009856040810700507,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5020969063043594,
      "val_macro_f1": 0.7492868917967992,
      "val_verse_f1": 0.8269266829176823,
      "val_chorus_f1": 0.671647100675916,
      "val_chorus_rate": 0.3910970836877823,
      "val_max_prob": 0.7015269100666046,
      "val_conf_over_90": 0.0031249414605554193,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005452701854328855,
      "epoch_time": 137.18011498451233,
      "val_boundary_f1": 0.3629697525206233,
      "val_boundary_precision": 0.29685157421289354,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.24573192909619207,
      "val_avg_segment_overlap": 0.64793704573607,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.41422222332400727,
      "val_pk_metric": 0.29410282670334775
    },
    {
      "epoch": 7,
      "train_loss": 0.47258752286434175,
      "train_chorus_rate": 0.3593332529067993,
      "train_max_prob": 0.689092269539833,
      "train_conf_over_90": 0.0132515362551203,
      "train_conf_over_95": 0.00013442632916849107,
      "val_loss": 0.5161883980035782,
      "val_macro_f1": 0.7481545726415149,
      "val_verse_f1": 0.848410328473564,
      "val_chorus_f1": 0.6478988168094656,
      "val_chorus_rate": 0.303591538220644,
      "val_max_prob": 0.6707623302936554,
      "val_conf_over_90": 0.005853561888216063,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00046024683491648576,
      "epoch_time": 137.58924102783203,
      "val_boundary_f1": 0.360655737704918,
      "val_boundary_precision": 0.30505709624796085,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.24053837392914806,
      "val_avg_segment_overlap": 0.6425236030863055,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.3817794981255004,
      "val_pk_metric": 0.272291829534811
    },
    {
      "epoch": 8,
      "train_loss": 0.4666667714715004,
      "train_chorus_rate": 0.3390264794230461,
      "train_max_prob": 0.6959248423576355,
      "train_conf_over_90": 0.026098012842703612,
      "train_conf_over_95": 0.0006866893294500187,
      "val_loss": 0.501058466732502,
      "val_macro_f1": 0.7476354085568437,
      "val_verse_f1": 0.8300629396519806,
      "val_chorus_f1": 0.6652078774617067,
      "val_chorus_rate": 0.37450873851776123,
      "val_max_prob": 0.7255764454603195,
      "val_conf_over_90": 0.05410523619502783,
      "val_conf_over_95": 0.001793738076230511,
      "learning_rate": 0.0003733240121721318,
      "epoch_time": 153.058198928833,
      "val_boundary_f1": 0.35009671179883944,
      "val_boundary_precision": 0.2967213114754098,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.22737559556223394,
      "val_avg_segment_overlap": 0.6400161422883854,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.39983407376107605,
      "val_pk_metric": 0.28599623546207154
    }
  ]
}