{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.3129465578104105,
      "layer_dropout": 0.21336102249718256,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.14155536274878533,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000886480483007609,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.02107966612919643,
      "gradient_clip_norm": 0.4964484997410078,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08692324135181712,
        "ece_after": 0.017281006136085762,
        "improvement": 0.06964223521573135,
        "params": {
          "temperature": 0.6135661431631074
        }
      },
      "platt": {
        "ece_before": 0.08692324135181712,
        "ece_after": 0.03198966717673192,
        "improvement": 0.054933574175085195,
        "params": {
          "A": 1.4098144210174557,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6131614476442337,
      "train_chorus_rate": 0.5260245257202769,
      "train_max_prob": 0.5810374677181244,
      "train_conf_over_90": 0.010424353927373887,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5990332365036011,
      "val_macro_f1": 0.39834929445249967,
      "val_verse_f1": 0.2989114445425125,
      "val_chorus_f1": 0.49778714436248683,
      "val_chorus_rate": 0.8654248267412186,
      "val_max_prob": 0.5827696174383163,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008713944751097885,
      "epoch_time": 70.53854012489319,
      "val_boundary_f1": 0.07285974499089254,
      "val_boundary_precision": 0.16,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.030744335078905595,
      "val_avg_segment_overlap": 0.17860273218364572,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4240978248011673,
      "val_pk_metric": 0.4266901669595025
    },
    {
      "epoch": 2,
      "train_loss": 0.5758811235427856,
      "train_chorus_rate": 0.5480369018798228,
      "train_max_prob": 0.5602628260850906,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6005818396806717,
      "val_macro_f1": 0.5340200080047303,
      "val_verse_f1": 0.6412457576362548,
      "val_chorus_f1": 0.4267942583732057,
      "val_chorus_rate": 0.4706878960132599,
      "val_max_prob": 0.5623298585414886,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008271645379237568,
      "epoch_time": 55.91976189613342,
      "val_boundary_f1": 0.043243243243243246,
      "val_boundary_precision": 0.0916030534351145,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.005533303717290992,
      "val_avg_segment_overlap": 0.21177182541789208,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.449494879028246,
      "val_pk_metric": 0.4655369618932708
    },
    {
      "epoch": 3,
      "train_loss": 0.5810728698968888,
      "train_chorus_rate": 0.4997144712135196,
      "train_max_prob": 0.5808043897151947,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5956712812185287,
      "val_macro_f1": 0.5365713605818724,
      "val_verse_f1": 0.6032632030914555,
      "val_chorus_f1": 0.46987951807228917,
      "val_chorus_rate": 0.5571942180395126,
      "val_max_prob": 0.5352914035320282,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007568048685753143,
      "epoch_time": 41.20235323905945,
      "val_boundary_f1": 0.08754208754208755,
      "val_boundary_precision": 0.15294117647058825,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.02161372287300177,
      "val_avg_segment_overlap": 0.23467091384071076,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.45181160531017206,
      "val_pk_metric": 0.45555777538059794
    },
    {
      "epoch": 4,
      "train_loss": 0.5638939678668976,
      "train_chorus_rate": 0.5666376911103725,
      "train_max_prob": 0.5693459868431091,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5804023891687393,
      "val_macro_f1": 0.5014637358978967,
      "val_verse_f1": 0.5036674816625917,
      "val_chorus_f1": 0.49925999013320177,
      "val_chorus_rate": 0.6979024708271027,
      "val_max_prob": 0.5876343846321106,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006651103622557068,
      "epoch_time": 46.45890688896179,
      "val_boundary_f1": 0.0728862973760933,
      "val_boundary_precision": 0.09541984732824428,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.026073854493790866,
      "val_avg_segment_overlap": 0.24033886486487296,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.46534215868299944,
      "val_pk_metric": 0.4307336126005767
    },
    {
      "epoch": 5,
      "train_loss": 0.5405810594558715,
      "train_chorus_rate": 0.4531805455684662,
      "train_max_prob": 0.631816902756691,
      "train_conf_over_90": 0.000408635861822404,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5362791419029236,
      "val_macro_f1": 0.7036014633428525,
      "val_verse_f1": 0.7876004592422503,
      "val_chorus_f1": 0.6196024674434545,
      "val_chorus_rate": 0.4177563115954399,
      "val_max_prob": 0.6530806720256805,
      "val_conf_over_90": 0.0004975080228177831,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005583298480382787,
      "epoch_time": 45.70484709739685,
      "val_boundary_f1": 0.30273437499999994,
      "val_boundary_precision": 0.25833333333333336,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.14623349110358655,
      "val_avg_segment_overlap": 0.5829054557452453,
      "val_verse_to_chorus_acc": 0.29646017699115046,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.43629358982211963,
      "val_pk_metric": 0.34098793361643803
    },
    {
      "epoch": 6,
      "train_loss": 0.5240356534719467,
      "train_chorus_rate": 0.3955288350582123,
      "train_max_prob": 0.655566343665123,
      "train_conf_over_90": 0.0037629420548910275,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5273889377713203,
      "val_macro_f1": 0.7076829452950947,
      "val_verse_f1": 0.7890895121014215,
      "val_chorus_f1": 0.6262763784887678,
      "val_chorus_rate": 0.4225552827119827,
      "val_max_prob": 0.6798610687255859,
      "val_conf_over_90": 0.011186181218363345,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044374024150380456,
      "epoch_time": 39.52906823158264,
      "val_boundary_f1": 0.3086997193638915,
      "val_boundary_precision": 0.2558139534883721,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.15996752130103137,
      "val_avg_segment_overlap": 0.6090443589614535,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4497440001619172,
      "val_pk_metric": 0.3364391717047948
    },
    {
      "epoch": 7,
      "train_loss": 0.5118256643414497,
      "train_chorus_rate": 0.39363735988736154,
      "train_max_prob": 0.6605665773153305,
      "train_conf_over_90": 0.015935421304311602,
      "train_conf_over_95": 0.0010230719461105763,
      "val_loss": 0.5267925336956978,
      "val_macro_f1": 0.7308278322154278,
      "val_verse_f1": 0.8213891951488422,
      "val_chorus_f1": 0.6402664692820134,
      "val_chorus_rate": 0.3640787899494171,
      "val_max_prob": 0.6712102591991425,
      "val_conf_over_90": 0.001955058774910867,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003291506349693305,
      "epoch_time": 81.4422779083252,
      "val_boundary_f1": 0.30952380952380953,
      "val_boundary_precision": 0.25299401197604793,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.1711017713668827,
      "val_avg_segment_overlap": 0.6293650565915038,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4434666838730992,
      "val_pk_metric": 0.32272312299902134
    },
    {
      "epoch": 8,
      "train_loss": 0.4964320495724678,
      "train_chorus_rate": 0.38273067474365235,
      "train_max_prob": 0.6751398116350174,
      "train_conf_over_90": 0.009346207624184899,
      "train_conf_over_95": 2.915451768785715e-05,
      "val_loss": 0.5223166719079018,
      "val_macro_f1": 0.7532008374651897,
      "val_verse_f1": 0.8485385296722764,
      "val_chorus_f1": 0.6578631452581032,
      "val_chorus_rate": 0.3145119845867157,
      "val_max_prob": 0.7099362164735794,
      "val_conf_over_90": 0.013281771214678884,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022237012075190235,
      "epoch_time": 57.20193886756897,
      "val_boundary_f1": 0.36937799043062197,
      "val_boundary_precision": 0.3107890499194847,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.24071653080136643,
      "val_avg_segment_overlap": 0.6517700247121306,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.35437853883554093,
      "val_pk_metric": 0.25309563953531605
    },
    {
      "epoch": 9,
      "train_loss": 0.4801300197839737,
      "train_chorus_rate": 0.32710956782102585,
      "train_max_prob": 0.6968017309904099,
      "train_conf_over_90": 0.020663235324900598,
      "train_conf_over_95": 0.0007531999319326133,
      "val_loss": 0.5151621848344803,
      "val_macro_f1": 0.7209747161101213,
      "val_verse_f1": 0.8058745998870269,
      "val_chorus_f1": 0.6360748323332157,
      "val_chorus_rate": 0.3963467851281166,
      "val_max_prob": 0.6793458163738251,
      "val_conf_over_90": 0.014226775907445699,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013067561443229464,
      "epoch_time": 103.85269594192505,
      "val_boundary_f1": 0.28434197886647455,
      "val_boundary_precision": 0.23987034035656402,
      "val_boundary_recall": 0.3490566037735849,
      "val_complete_segments": 0.14234819389909528,
      "val_avg_segment_overlap": 0.6026482247135051,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4320625090573257,
      "val_pk_metric": 0.3219372338610268
    },
    {
      "epoch": 10,
      "train_loss": 0.48142645210027696,
      "train_chorus_rate": 0.34467857927083967,
      "train_max_prob": 0.6939553707838059,
      "train_conf_over_90": 0.024690218816976993,
      "train_conf_over_95": 0.0022977051470661537,
      "val_loss": 0.5130335092544556,
      "val_macro_f1": 0.7117807181840617,
      "val_verse_f1": 0.7909843960701215,
      "val_chorus_f1": 0.632577040298002,
      "val_chorus_rate": 0.4256190061569214,
      "val_max_prob": 0.680181473493576,
      "val_conf_over_90": 0.019825748400762677,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.0315945083852304e-05,
      "epoch_time": 82.3014190196991,
      "val_boundary_f1": 0.3023041474654378,
      "val_boundary_precision": 0.2481089258698941,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.17372543540359023,
      "val_avg_segment_overlap": 0.6086892211633114,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4472648469309294,
      "val_pk_metric": 0.3283609684475127
    },
    {
      "epoch": 11,
      "train_loss": 0.48828388154506686,
      "train_chorus_rate": 0.3571374908089638,
      "train_max_prob": 0.687658616900444,
      "train_conf_over_90": 0.023490289389155806,
      "train_conf_over_95": 0.0013479107845341786,
      "val_loss": 0.5105888396501541,
      "val_macro_f1": 0.7332141430235484,
      "val_verse_f1": 0.8174692049272115,
      "val_chorus_f1": 0.6489590811198852,
      "val_chorus_rate": 0.38489796966314316,
      "val_max_prob": 0.6918013244867325,
      "val_conf_over_90": 0.018840544391423464,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.6086007897820535e-05,
      "epoch_time": 85.09109878540039,
      "val_boundary_f1": 0.3373493975903614,
      "val_boundary_precision": 0.2778625954198473,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.21704940624611888,
      "val_avg_segment_overlap": 0.635786639816132,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4131326485077282,
      "val_pk_metric": 0.29731460407143606
    },
    {
      "epoch": 12,
      "train_loss": 0.48286222517490385,
      "train_chorus_rate": 0.35933284014463424,
      "train_max_prob": 0.6863748043775558,
      "train_conf_over_90": 0.019878265226725488,
      "train_conf_over_95": 0.0003969883866375312,
      "val_loss": 0.5120991319417953,
      "val_macro_f1": 0.7443006709896108,
      "val_verse_f1": 0.8354155350353071,
      "val_chorus_f1": 0.6531858069439146,
      "val_chorus_rate": 0.3447161465883255,
      "val_max_prob": 0.6907545179128647,
      "val_conf_over_90": 0.015201875241473317,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 74.45320796966553,
      "val_boundary_f1": 0.37126865671641796,
      "val_boundary_precision": 0.30709876543209874,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.23144063621264044,
      "val_avg_segment_overlap": 0.6493056679098572,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.38390831372129464,
      "val_pk_metric": 0.2700364799539799
    }
  ]
}