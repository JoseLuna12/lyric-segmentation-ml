{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2141698732802953,
      "layer_dropout": 0.27676724834149485,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.15000247984174964,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0008647522704377587,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.019549975878704745,
      "gradient_clip_norm": 0.3656725454508073,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09874966629361823,
        "ece_after": 0.021776839314954458,
        "improvement": 0.07697282697866377,
        "params": {
          "temperature": 0.5738545705902559
        }
      },
      "platt": {
        "ece_before": 0.09874966629361823,
        "ece_after": 0.03432041048008237,
        "improvement": 0.06442925581353585,
        "params": {
          "A": 1.5293045641961092,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5769116759300232,
      "train_chorus_rate": 0.4069463236257434,
      "train_max_prob": 0.5806849360466003,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6091549396514893,
      "val_macro_f1": 0.5019910573639771,
      "val_verse_f1": 0.8104337276311799,
      "val_chorus_f1": 0.1935483870967742,
      "val_chorus_rate": 0.08086821809411049,
      "val_max_prob": 0.5624110102653503,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008553147406974148,
      "epoch_time": 70.75551986694336,
      "val_boundary_f1": 0.029787234042553193,
      "val_boundary_precision": 0.15217391304347827,
      "val_boundary_recall": 0.01650943396226415,
      "val_complete_segments": 0.056333812260536395,
      "val_avg_segment_overlap": 0.19117627755557462,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.2896536799245696,
      "val_pk_metric": 0.29154789087159894
    },
    {
      "epoch": 2,
      "train_loss": 0.5764691710472107,
      "train_chorus_rate": 0.5028298602672294,
      "train_max_prob": 0.5880239427089691,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6034475862979889,
      "val_macro_f1": 0.5122956009450129,
      "val_verse_f1": 0.8077687719834837,
      "val_chorus_f1": 0.21682242990654207,
      "val_chorus_rate": 0.09443575888872147,
      "val_max_prob": 0.561072438955307,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008274146168123282,
      "epoch_time": 457.6631019115448,
      "val_boundary_f1": 0.04453441295546559,
      "val_boundary_precision": 0.15714285714285714,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.056333812260536395,
      "val_avg_segment_overlap": 0.206953970151028,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.29428424951755044,
      "val_pk_metric": 0.29581822674260116
    },
    {
      "epoch": 3,
      "train_loss": 0.5504126965999603,
      "train_chorus_rate": 0.535217797383666,
      "train_max_prob": 0.5896957695484162,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6122486591339111,
      "val_macro_f1": 0.5462817188119982,
      "val_verse_f1": 0.7814976548601004,
      "val_chorus_f1": 0.311065782763896,
      "val_chorus_rate": 0.181782566010952,
      "val_max_prob": 0.5724442899227142,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007822712680759255,
      "epoch_time": 116.67913126945496,
      "val_boundary_f1": 0.05223880597014926,
      "val_boundary_precision": 0.125,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.05878831417624521,
      "val_avg_segment_overlap": 0.22920862285754195,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.3200570870441508,
      "val_pk_metric": 0.3146124275187828
    },
    {
      "epoch": 4,
      "train_loss": 0.5644638061523437,
      "train_chorus_rate": 0.5754576653242112,
      "train_max_prob": 0.5866778135299683,
      "train_conf_over_90": 3.328894672449678e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.595166802406311,
      "val_macro_f1": 0.5738269689145876,
      "val_verse_f1": 0.6946039035591274,
      "val_chorus_f1": 0.453050034270048,
      "val_chorus_rate": 0.41701552271842957,
      "val_max_prob": 0.5516983270645142,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007218576754498083,
      "epoch_time": 66.98266291618347,
      "val_boundary_f1": 0.08959999999999999,
      "val_boundary_precision": 0.13930348258706468,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.0636374521072797,
      "val_avg_segment_overlap": 0.2883787583334507,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.35124597092745713,
      "val_pk_metric": 0.33504682110064055
    },
    {
      "epoch": 5,
      "train_loss": 0.5526388049125671,
      "train_chorus_rate": 0.5411032378673554,
      "train_max_prob": 0.6048478126525879,
      "train_conf_over_90": 3.654970787465572e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5891943871974945,
      "val_macro_f1": 0.5301077829595435,
      "val_verse_f1": 0.5736120476511575,
      "val_chorus_f1": 0.48660351826792964,
      "val_chorus_rate": 0.6078869998455048,
      "val_max_prob": 0.5602006018161774,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000648814202828319,
      "epoch_time": 118.96988272666931,
      "val_boundary_f1": 0.08214849921011058,
      "val_boundary_precision": 0.12440191387559808,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.036877394636015325,
      "val_avg_segment_overlap": 0.24594653194379446,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.4099888862141794,
      "val_pk_metric": 0.3787771317748168
    },
    {
      "epoch": 6,
      "train_loss": 0.5497094392776489,
      "train_chorus_rate": 0.5479192063212395,
      "train_max_prob": 0.599813061952591,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5925226807594299,
      "val_macro_f1": 0.5774660414371056,
      "val_verse_f1": 0.6811279826464207,
      "val_chorus_f1": 0.4738041002277904,
      "val_chorus_rate": 0.4548877626657486,
      "val_max_prob": 0.5927031934261322,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005663332004664858,
      "epoch_time": 91.66556191444397,
      "val_boundary_f1": 0.08653846153846154,
      "val_boundary_precision": 0.135,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.04346264367816092,
      "val_avg_segment_overlap": 0.26272005722384745,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.4008062453542147,
      "val_pk_metric": 0.3643156843964539
    },
    {
      "epoch": 7,
      "train_loss": 0.5412731647491456,
      "train_chorus_rate": 0.4458265841007233,
      "train_max_prob": 0.605925691127777,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5607669353485107,
      "val_macro_f1": 0.6003435592783183,
      "val_verse_f1": 0.6601153599658193,
      "val_chorus_f1": 0.5405717585908173,
      "val_chorus_rate": 0.550897479057312,
      "val_max_prob": 0.6064067184925079,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00047801948395528214,
      "epoch_time": 42.83276915550232,
      "val_boundary_f1": 0.16751269035532995,
      "val_boundary_precision": 0.1813186813186813,
      "val_boundary_recall": 0.15566037735849056,
      "val_complete_segments": 0.0570522030651341,
      "val_avg_segment_overlap": 0.380726680648086,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.15151515151515152,
      "val_window_diff": 0.471514257495373,
      "val_pk_metric": 0.4152230150610663
    },
    {
      "epoch": 8,
      "train_loss": 0.5219531416893005,
      "train_chorus_rate": 0.4632946252822876,
      "train_max_prob": 0.640385776758194,
      "train_conf_over_90": 0.005062196438666433,
      "train_conf_over_95": 7.189072784967721e-05,
      "val_loss": 0.5503265261650085,
      "val_macro_f1": 0.6761205486413662,
      "val_verse_f1": 0.7725208175624526,
      "val_chorus_f1": 0.5797202797202797,
      "val_chorus_rate": 0.4026552140712738,
      "val_max_prob": 0.6145792901515961,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00038773278648247665,
      "epoch_time": 46.923726081848145,
      "val_boundary_f1": 0.2141280353200883,
      "val_boundary_precision": 0.2012448132780083,
      "val_boundary_recall": 0.22877358490566038,
      "val_complete_segments": 0.09961685823754789,
      "val_avg_segment_overlap": 0.5004770312913984,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.20707070707070707,
      "val_window_diff": 0.40786147322336563,
      "val_pk_metric": 0.3457603784999316
    },
    {
      "epoch": 9,
      "train_loss": 0.5157475709915161,
      "train_chorus_rate": 0.41050789058208464,
      "train_max_prob": 0.6580081760883332,
      "train_conf_over_90": 0.015109301218762994,
      "train_conf_over_95": 0.002028167829848826,
      "val_loss": 0.561052680015564,
      "val_macro_f1": 0.704730866607401,
      "val_verse_f1": 0.8345274650290003,
      "val_chorus_f1": 0.5749342681858018,
      "val_chorus_rate": 0.2606474310159683,
      "val_max_prob": 0.6728573143482208,
      "val_conf_over_90": 0.0034421863965690136,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002994190699712729,
      "epoch_time": 62.43573570251465,
      "val_boundary_f1": 0.3057591623036649,
      "val_boundary_precision": 0.2749529190207156,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.13266283524904215,
      "val_avg_segment_overlap": 0.5743580034169788,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.38253643543649496,
      "val_pk_metric": 0.30141623248150834
    },
    {
      "epoch": 10,
      "train_loss": 0.4929811179637909,
      "train_chorus_rate": 0.35796851515769956,
      "train_max_prob": 0.6654774427413941,
      "train_conf_over_90": 0.012328673363663256,
      "train_conf_over_95": 0.0005758473504101858,
      "val_loss": 0.5359890758991241,
      "val_macro_f1": 0.7257502747772069,
      "val_verse_f1": 0.8310858765081617,
      "val_chorus_f1": 0.6204146730462521,
      "val_chorus_rate": 0.316128671169281,
      "val_max_prob": 0.667473554611206,
      "val_conf_over_90": 0.0066600083373487,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021693806760943974,
      "epoch_time": 68.15180897712708,
      "val_boundary_f1": 0.33102081268582756,
      "val_boundary_precision": 0.28547008547008546,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.18516522988505746,
      "val_avg_segment_overlap": 0.6072314209913745,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.3874038353120951,
      "val_pk_metric": 0.3064120937841348
    },
    {
      "epoch": 11,
      "train_loss": 0.4866493821144104,
      "train_chorus_rate": 0.34312802106142043,
      "train_max_prob": 0.6818967282772064,
      "train_conf_over_90": 0.02084155585616827,
      "train_conf_over_95": 0.002957571783917956,
      "val_loss": 0.5213395655155182,
      "val_macro_f1": 0.6872873100037517,
      "val_verse_f1": 0.76131850675139,
      "val_chorus_f1": 0.6132561132561133,
      "val_chorus_rate": 0.4635472744703293,
      "val_max_prob": 0.6577796339988708,
      "val_conf_over_90": 0.012824966572225094,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 0.00014389459498795047,
      "epoch_time": 393.3160398006439,
      "val_boundary_f1": 0.24857685009487668,
      "val_boundary_precision": 0.20793650793650795,
      "val_boundary_recall": 0.3089622641509434,
      "val_complete_segments": 0.1337404214559387,
      "val_avg_segment_overlap": 0.5704339650227175,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.30303030303030304,
      "val_window_diff": 0.4759893242590864,
      "val_pk_metric": 0.36785913655162905
    },
    {
      "epoch": 12,
      "train_loss": 0.4963111877441406,
      "train_chorus_rate": 0.36664688885211943,
      "train_max_prob": 0.6747871160507202,
      "train_conf_over_90": 0.018562920670956374,
      "train_conf_over_95": 0.0014813201560173184,
      "val_loss": 0.5212655514478683,
      "val_macro_f1": 0.6802114797492611,
      "val_verse_f1": 0.7512057877813505,
      "val_chorus_f1": 0.6092171717171717,
      "val_chorus_rate": 0.478240504860878,
      "val_max_prob": 0.6783124208450317,
      "val_conf_over_90": 0.03125808201730251,
      "val_conf_over_95": 0.0032062416430562735,
      "learning_rate": 8.34810023618332e-05,
      "epoch_time": 86.31917214393616,
      "val_boundary_f1": 0.24091778202676864,
      "val_boundary_precision": 0.20257234726688103,
      "val_boundary_recall": 0.2971698113207547,
      "val_complete_segments": 0.10853687739463601,
      "val_avg_segment_overlap": 0.565222308717338,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.30303030303030304,
      "val_window_diff": 0.49034539955871714,
      "val_pk_metric": 0.39153772605497106
    },
    {
      "epoch": 13,
      "train_loss": 0.49619180262088775,
      "train_chorus_rate": 0.3920829653739929,
      "train_max_prob": 0.6785201549530029,
      "train_conf_over_90": 0.028664769046008585,
      "train_conf_over_95": 0.004880184918874875,
      "val_loss": 0.5232744365930557,
      "val_macro_f1": 0.729504889434164,
      "val_verse_f1": 0.8222384784198975,
      "val_chorus_f1": 0.6367713004484306,
      "val_chorus_rate": 0.357407882809639,
      "val_max_prob": 0.6700341403484344,
      "val_conf_over_90": 0.008381101302802563,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.833765362543038e-05,
      "epoch_time": 68.60681009292603,
      "val_boundary_f1": 0.326171875,
      "val_boundary_precision": 0.2783333333333333,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.18414750957854406,
      "val_avg_segment_overlap": 0.6189496733322273,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4117165324392744,
      "val_pk_metric": 0.31714613288602445
    },
    {
      "epoch": 14,
      "train_loss": 0.49301553070545195,
      "train_chorus_rate": 0.38900784254074094,
      "train_max_prob": 0.667260879278183,
      "train_conf_over_90": 0.02092475825920701,
      "train_conf_over_95": 0.0023465209902497008,
      "val_loss": 0.5186359286308289,
      "val_macro_f1": 0.6948628555440131,
      "val_verse_f1": 0.7730205278592376,
      "val_chorus_f1": 0.6167051832287884,
      "val_chorus_rate": 0.44409704208374023,
      "val_max_prob": 0.6706180274486542,
      "val_conf_over_90": 0.017002006992697716,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 1.0437529740343873e-05,
      "epoch_time": 80.54129600524902,
      "val_boundary_f1": 0.2592592592592593,
      "val_boundary_precision": 0.22093023255813954,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.12488026819923373,
      "val_avg_segment_overlap": 0.5816113697949926,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.46125329672427423,
      "val_pk_metric": 0.3641899722918142
    },
    {
      "epoch": 15,
      "train_loss": 0.49220562875270846,
      "train_chorus_rate": 0.4014639377593994,
      "train_max_prob": 0.6743001878261566,
      "train_conf_over_90": 0.02507772548124194,
      "train_conf_over_95": 0.0026016287622042,
      "val_loss": 0.5191638916730881,
      "val_macro_f1": 0.7171294222481992,
      "val_verse_f1": 0.8036855960887551,
      "val_chorus_f1": 0.6305732484076433,
      "val_chorus_rate": 0.3942470997571945,
      "val_max_prob": 0.6721358895301819,
      "val_conf_over_90": 0.012569721788167953,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 1e-06,
      "epoch_time": 75.22839593887329,
      "val_boundary_f1": 0.28927203065134105,
      "val_boundary_precision": 0.2435483870967742,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.17079741379310343,
      "val_avg_segment_overlap": 0.6051736727029703,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.43291120647295156,
      "val_pk_metric": 0.3375338476649763
    }
  ]
}