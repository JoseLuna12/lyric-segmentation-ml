{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.177783272669898,
      "layer_dropout": 0.20897017302035098,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 565762,
      "lstm_params": 565248,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008379206269936514,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.011484612944920066,
      "gradient_clip_norm": 0.8872800077332361,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.047559252861440755,
        "ece_after": 0.020073858512408147,
        "improvement": 0.027485394349032608,
        "params": {
          "temperature": 0.7265252639636549
        }
      },
      "platt": {
        "ece_before": 0.047559252861440755,
        "ece_after": 0.01970088181830577,
        "improvement": 0.027858371043134985,
        "params": {
          "A": 1.2879741926753228,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5485296979546547,
      "train_chorus_rate": 0.3867215525358915,
      "train_max_prob": 0.5619839876890182,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5896909534931183,
      "val_macro_f1": 0.5457613648976706,
      "val_verse_f1": 0.7116387839539485,
      "val_chorus_f1": 0.3798839458413927,
      "val_chorus_rate": 0.3353951796889305,
      "val_max_prob": 0.5486964732408524,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008287762651460619,
      "epoch_time": 43.01797294616699,
      "val_boundary_f1": 0.05628517823639775,
      "val_boundary_precision": 0.13761467889908258,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.01980212867010322,
      "val_avg_segment_overlap": 0.20755514211689594,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3906377449033269,
      "val_pk_metric": 0.4051895932637094
    },
    {
      "epoch": 2,
      "train_loss": 0.5500950917601586,
      "train_chorus_rate": 0.464372843503952,
      "train_max_prob": 0.57494957447052,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5837528705596924,
      "val_macro_f1": 0.46935342773195937,
      "val_verse_f1": 0.4591887831747621,
      "val_chorus_f1": 0.47951807228915666,
      "val_chorus_rate": 0.7218729108572006,
      "val_max_prob": 0.5684540718793869,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008017428320955495,
      "epoch_time": 50.900063037872314,
      "val_boundary_f1": 0.043399638336347204,
      "val_boundary_precision": 0.09302325581395349,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.017698963165559137,
      "val_avg_segment_overlap": 0.19641412867692,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.433263271247601,
      "val_pk_metric": 0.43944223126727305
    },
    {
      "epoch": 3,
      "train_loss": 0.539257325232029,
      "train_chorus_rate": 0.48239627480506897,
      "train_max_prob": 0.5843690425157547,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5837336629629135,
      "val_macro_f1": 0.49161916682069007,
      "val_verse_f1": 0.5034797216222703,
      "val_chorus_f1": 0.4797586120191099,
      "val_chorus_rate": 0.6793837547302246,
      "val_max_prob": 0.6072553098201752,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007580018185872259,
      "epoch_time": 68.48586082458496,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.015958014142001417,
      "val_avg_segment_overlap": 0.20376111696068222,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.423472343799732,
      "val_pk_metric": 0.4308068079820372
    },
    {
      "epoch": 4,
      "train_loss": 0.5453344315290451,
      "train_chorus_rate": 0.457939762622118,
      "train_max_prob": 0.5890954077243805,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5696785151958466,
      "val_macro_f1": 0.5262351508473857,
      "val_verse_f1": 0.5570670970717085,
      "val_chorus_f1": 0.49540320462306275,
      "val_chorus_rate": 0.6371144205331802,
      "val_max_prob": 0.5659359097480774,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006994649168040746,
      "epoch_time": 96.00003719329834,
      "val_boundary_f1": 0.07142857142857142,
      "val_boundary_precision": 0.12804878048780488,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.022179976143390776,
      "val_avg_segment_overlap": 0.24199078602783836,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.41966349518130736,
      "val_pk_metric": 0.41827479938828405
    },
    {
      "epoch": 5,
      "train_loss": 0.5050787895917892,
      "train_chorus_rate": 0.3733301594853401,
      "train_max_prob": 0.6060637205839157,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5647119730710983,
      "val_macro_f1": 0.5761151716500554,
      "val_verse_f1": 0.6356589147286822,
      "val_chorus_f1": 0.5165714285714287,
      "val_chorus_rate": 0.5624711066484451,
      "val_max_prob": 0.6196458488702774,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006286904702452386,
      "epoch_time": 92.50387811660767,
      "val_boundary_f1": 0.0940438871473354,
      "val_boundary_precision": 0.14018691588785046,
      "val_boundary_recall": 0.07075471698113207,
      "val_complete_segments": 0.030445769205048104,
      "val_avg_segment_overlap": 0.2800129450447595,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.4072751279431167,
      "val_pk_metric": 0.3887729728830066
    },
    {
      "epoch": 6,
      "train_loss": 0.5151739627122879,
      "train_chorus_rate": 0.4307657744735479,
      "train_max_prob": 0.6254823118448257,
      "train_conf_over_90": 0.0004784536897204816,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5310146659612656,
      "val_macro_f1": 0.6749902924522933,
      "val_verse_f1": 0.7801076266468733,
      "val_chorus_f1": 0.5698729582577132,
      "val_chorus_rate": 0.37811534106731415,
      "val_max_prob": 0.6294532418251038,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005487716618388131,
      "epoch_time": 81.55117011070251,
      "val_boundary_f1": 0.24971098265895952,
      "val_boundary_precision": 0.24489795918367346,
      "val_boundary_recall": 0.25471698113207547,
      "val_complete_segments": 0.09203096445938441,
      "val_avg_segment_overlap": 0.5000716557356428,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.43693833427035156,
      "val_pk_metric": 0.3768400333133302
    },
    {
      "epoch": 7,
      "train_loss": 0.49856221824884417,
      "train_chorus_rate": 0.4119968831539154,
      "train_max_prob": 0.6458890944719314,
      "train_conf_over_90": 0.009146395575953647,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5122311860322952,
      "val_macro_f1": 0.6635637210945914,
      "val_verse_f1": 0.7356926188068758,
      "val_chorus_f1": 0.591434823382307,
      "val_chorus_rate": 0.48651278018951416,
      "val_max_prob": 0.6618882417678833,
      "val_conf_over_90": 0.005618561001028866,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004632013270051495,
      "epoch_time": 105.0208649635315,
      "val_boundary_f1": 0.21656050955414013,
      "val_boundary_precision": 0.1969111969111969,
      "val_boundary_recall": 0.24056603773584906,
      "val_complete_segments": 0.07618204858395738,
      "val_avg_segment_overlap": 0.5344928675599249,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.46681581535973077,
      "val_pk_metric": 0.3963806817523339
    },
    {
      "epoch": 8,
      "train_loss": 0.4838224396109581,
      "train_chorus_rate": 0.4103138163685799,
      "train_max_prob": 0.6746775954961777,
      "train_conf_over_90": 0.015019552269950508,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5073500648140907,
      "val_macro_f1": 0.7096336623459376,
      "val_verse_f1": 0.8030471943515421,
      "val_chorus_f1": 0.6162201303403332,
      "val_chorus_rate": 0.3797677233815193,
      "val_max_prob": 0.6750497668981552,
      "val_conf_over_90": 0.003317502298159525,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003757192999885022,
      "epoch_time": 89.82244610786438,
      "val_boundary_f1": 0.3319755600814664,
      "val_boundary_precision": 0.2921146953405018,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.17916779262219346,
      "val_avg_segment_overlap": 0.598077438467537,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4164467544455736,
      "val_pk_metric": 0.3224041870613473
    },
    {
      "epoch": 9,
      "train_loss": 0.47809157222509385,
      "train_chorus_rate": 0.3651057854294777,
      "train_max_prob": 0.6730696439743042,
      "train_conf_over_90": 0.01383707590866834,
      "train_conf_over_95": 3.646973054856062e-05,
      "val_loss": 0.5059040412306786,
      "val_macro_f1": 0.6835333486708366,
      "val_verse_f1": 0.7631940357072788,
      "val_chorus_f1": 0.6038726616343945,
      "val_chorus_rate": 0.4494278281927109,
      "val_max_prob": 0.6882897615432739,
      "val_conf_over_90": 0.02802318357862532,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00029014896515483854,
      "epoch_time": 89.10815596580505,
      "val_boundary_f1": 0.2707070707070707,
      "val_boundary_precision": 0.23674911660777384,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.13065226262469104,
      "val_avg_segment_overlap": 0.5767976713599828,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.45865993870693433,
      "val_pk_metric": 0.36634187666981477
    },
    {
      "epoch": 10,
      "train_loss": 0.4721022918820381,
      "train_chorus_rate": 0.39827186465263364,
      "train_max_prob": 0.6892732113599778,
      "train_conf_over_90": 0.023332145693711937,
      "train_conf_over_95": 0.0006120122910942882,
      "val_loss": 0.5017993822693825,
      "val_macro_f1": 0.6832804753944932,
      "val_verse_f1": 0.7579491255961844,
      "val_chorus_f1": 0.6086118251928021,
      "val_chorus_rate": 0.4654523655772209,
      "val_max_prob": 0.6835278272628784,
      "val_conf_over_90": 0.01352213742211461,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000210230156748413,
      "epoch_time": 121.21047401428223,
      "val_boundary_f1": 0.2719211822660098,
      "val_boundary_precision": 0.233502538071066,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.1413715468991185,
      "val_avg_segment_overlap": 0.5844637793289483,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.45816417249171504,
      "val_pk_metric": 0.3650435417810091
    },
    {
      "epoch": 11,
      "train_loss": 0.45971135050058365,
      "train_chorus_rate": 0.3758592173457146,
      "train_max_prob": 0.6920027017593384,
      "train_conf_over_90": 0.024701749626547097,
      "train_conf_over_95": 0.0005058772454503924,
      "val_loss": 0.5008155256509781,
      "val_macro_f1": 0.7069051117518836,
      "val_verse_f1": 0.7992530345471521,
      "val_chorus_f1": 0.6145571889566152,
      "val_chorus_rate": 0.3860389292240143,
      "val_max_prob": 0.6992659419775009,
      "val_conf_over_90": 0.03184740478172898,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013945571018957699,
      "epoch_time": 245.7524218559265,
      "val_boundary_f1": 0.33877551020408164,
      "val_boundary_precision": 0.29856115107913667,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.20004309338879858,
      "val_avg_segment_overlap": 0.6099513550345799,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4102369435732764,
      "val_pk_metric": 0.31443393812741094
    },
    {
      "epoch": 12,
      "train_loss": 0.4674123957753181,
      "train_chorus_rate": 0.3769402354955673,
      "train_max_prob": 0.6897369921207428,
      "train_conf_over_90": 0.02471079190727323,
      "train_conf_over_95": 0.0002744240133324638,
      "val_loss": 0.5032333880662918,
      "val_macro_f1": 0.7190768798901885,
      "val_verse_f1": 0.8133848133848134,
      "val_chorus_f1": 0.6247689463955638,
      "val_chorus_rate": 0.3658190220594406,
      "val_max_prob": 0.7022685110569,
      "val_conf_over_90": 0.025001015048474073,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 8.091880840642557e-05,
      "epoch_time": 142.95536422729492,
      "val_boundary_f1": 0.32628398791540786,
      "val_boundary_precision": 0.28471001757469244,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.17969900479179376,
      "val_avg_segment_overlap": 0.6081827803971326,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.41555133090510243,
      "val_pk_metric": 0.30609886301376993
    },
    {
      "epoch": 13,
      "train_loss": 0.4522295638918877,
      "train_chorus_rate": 0.36037362143397333,
      "train_max_prob": 0.7036506116390229,
      "train_conf_over_90": 0.029897902021184565,
      "train_conf_over_95": 0.0007470689452020451,
      "val_loss": 0.496068611741066,
      "val_macro_f1": 0.7030193935461319,
      "val_verse_f1": 0.7850683086395999,
      "val_chorus_f1": 0.6209704784526638,
      "val_chorus_rate": 0.4248400777578354,
      "val_max_prob": 0.6893915235996246,
      "val_conf_over_90": 0.02818388445302844,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 3.7177794898101796e-05,
      "epoch_time": 95.05528092384338,
      "val_boundary_f1": 0.32163742690058483,
      "val_boundary_precision": 0.27408637873754155,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.17648779668928133,
      "val_avg_segment_overlap": 0.615642092964179,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4326649275212868,
      "val_pk_metric": 0.3319115763530278
    },
    {
      "epoch": 14,
      "train_loss": 0.4572077766060829,
      "train_chorus_rate": 0.3652881994843483,
      "train_max_prob": 0.7012419790029526,
      "train_conf_over_90": 0.03773414422757924,
      "train_conf_over_95": 0.0008904765592887998,
      "val_loss": 0.4994271844625473,
      "val_macro_f1": 0.7025574750296939,
      "val_verse_f1": 0.7902124430955993,
      "val_chorus_f1": 0.6149025069637883,
      "val_chorus_rate": 0.4067712351679802,
      "val_max_prob": 0.6966674476861954,
      "val_conf_over_90": 0.0332990912720561,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1.0144361847589479e-05,
      "epoch_time": 85.32876491546631,
      "val_boundary_f1": 0.31818181818181823,
      "val_boundary_precision": 0.27380952380952384,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.17888952806768288,
      "val_avg_segment_overlap": 0.6080587266578705,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4316796410196217,
      "val_pk_metric": 0.32914860580349503
    },
    {
      "epoch": 15,
      "train_loss": 0.45468197017908096,
      "train_chorus_rate": 0.3675537586212158,
      "train_max_prob": 0.702954250574112,
      "train_conf_over_90": 0.034376973658800124,
      "train_conf_over_95": 0.001376528647961095,
      "val_loss": 0.49862639605998993,
      "val_macro_f1": 0.7064920471449367,
      "val_verse_f1": 0.794789503492543,
      "val_chorus_f1": 0.6181945907973305,
      "val_chorus_rate": 0.40064169466495514,
      "val_max_prob": 0.6950765252113342,
      "val_conf_over_90": 0.031540637370198965,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1e-06,
      "epoch_time": 107.40342211723328,
      "val_boundary_f1": 0.3237907206317868,
      "val_boundary_precision": 0.27843803056027167,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.18304950724091762,
      "val_avg_segment_overlap": 0.6111792338372327,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4276839737509549,
      "val_pk_metric": 0.3246263191972541
    }
  ]
}