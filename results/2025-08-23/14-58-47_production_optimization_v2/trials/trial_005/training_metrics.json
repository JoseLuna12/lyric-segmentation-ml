{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19921850423381712,
      "layer_dropout": 0.34417116641293005,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.2734445231961012,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0002755817776624396,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "line_f1",
      "weight_decay": 0.016885424264571337,
      "gradient_clip_norm": 0.8007934032532431,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05789199213850474,
        "ece_after": 0.026708228268417258,
        "improvement": 0.03118376387008748,
        "params": {
          "temperature": 0.62478559886334
        }
      },
      "platt": {
        "ece_before": 0.05789199213850474,
        "ece_after": 0.032257801115747047,
        "improvement": 0.025634191022757692,
        "params": {
          "A": 1.3018597994526444,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5715511679649353,
      "train_chorus_rate": 0.6029585018171929,
      "train_max_prob": 0.5672007322311401,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5879309177398682,
      "val_macro_f1": 0.43129868916739034,
      "val_verse_f1": 0.38590872698158524,
      "val_chorus_f1": 0.47668865135319544,
      "val_chorus_rate": 0.7808253765106201,
      "val_max_prob": 0.5654540508985519,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002725816423440891,
      "epoch_time": 161.95078921318054,
      "val_boundary_f1": 0.05828779599271403,
      "val_boundary_precision": 0.128,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.021787887721079664,
      "val_avg_segment_overlap": 0.18969768518317148,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4229224555304431,
      "val_pk_metric": 0.420207397607969
    },
    {
      "epoch": 2,
      "train_loss": 0.568365353345871,
      "train_chorus_rate": 0.6231817483901978,
      "train_max_prob": 0.55532166659832,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5912903696298599,
      "val_macro_f1": 0.4998127755013348,
      "val_verse_f1": 0.5361721611721612,
      "val_chorus_f1": 0.46345338983050843,
      "val_chorus_rate": 0.6280511766672134,
      "val_max_prob": 0.5540067553520203,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002637123566986959,
      "epoch_time": 134.89657187461853,
      "val_boundary_f1": 0.05524861878453039,
      "val_boundary_precision": 0.12605042016806722,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.022300385145029897,
      "val_avg_segment_overlap": 0.19866496192286062,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4465754507107663,
      "val_pk_metric": 0.45454965708356687
    },
    {
      "epoch": 3,
      "train_loss": 0.5497118532657623,
      "train_chorus_rate": 0.5909243896603584,
      "train_max_prob": 0.5714729487895965,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6093901544809341,
      "val_macro_f1": 0.48083618087865276,
      "val_verse_f1": 0.809265944645006,
      "val_chorus_f1": 0.15240641711229946,
      "val_chorus_rate": 0.06712019350379705,
      "val_max_prob": 0.5794476121664047,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024936155106851826,
      "epoch_time": 146.7867739200592,
      "val_boundary_f1": 0.03375527426160337,
      "val_boundary_precision": 0.16,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.06068118944577057,
      "val_avg_segment_overlap": 0.1945791153701504,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.2696513191871265,
      "val_pk_metric": 0.2770244467184917
    },
    {
      "epoch": 4,
      "train_loss": 0.5641937851905823,
      "train_chorus_rate": 0.5645244944840669,
      "train_max_prob": 0.579628375172615,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6048297733068466,
      "val_macro_f1": 0.46159164867951175,
      "val_verse_f1": 0.808542413381123,
      "val_chorus_f1": 0.11464088397790054,
      "val_chorus_rate": 0.0556868351995945,
      "val_max_prob": 0.5739386975765228,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023015642452240047,
      "epoch_time": 132.4263150691986,
      "val_boundary_f1": 0.03404255319148936,
      "val_boundary_precision": 0.17391304347826086,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.05889547516005629,
      "val_avg_segment_overlap": 0.1895851473997787,
      "val_verse_to_chorus_acc": 0.017699115044247787,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.2719843086675699,
      "val_pk_metric": 0.27829673999673943
    },
    {
      "epoch": 5,
      "train_loss": 0.5582396879792213,
      "train_chorus_rate": 0.491821426153183,
      "train_max_prob": 0.5764055490493775,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5850405246019363,
      "val_macro_f1": 0.507071170072932,
      "val_verse_f1": 0.5234133586879011,
      "val_chorus_f1": 0.49072898145796295,
      "val_chorus_rate": 0.6677186042070389,
      "val_max_prob": 0.5471698939800262,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020693633324682967,
      "epoch_time": 234.24932098388672,
      "val_boundary_f1": 0.07380073800738009,
      "val_boundary_precision": 0.1694915254237288,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.045285845988391055,
      "val_avg_segment_overlap": 0.22229391477962865,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.35062301596316603,
      "val_pk_metric": 0.353289197455282
    },
    {
      "epoch": 6,
      "train_loss": 0.5599853843450546,
      "train_chorus_rate": 0.6202828910201788,
      "train_max_prob": 0.5724188715219498,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5831947773694992,
      "val_macro_f1": 0.4290027597523681,
      "val_verse_f1": 0.3733333333333333,
      "val_chorus_f1": 0.484672186171403,
      "val_chorus_rate": 0.7977662235498428,
      "val_max_prob": 0.5797672867774963,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018071610665290836,
      "epoch_time": 135.96065425872803,
      "val_boundary_f1": 0.04379562043795621,
      "val_boundary_precision": 0.0967741935483871,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.016351109100313767,
      "val_avg_segment_overlap": 0.19029429995602262,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4460828777445779,
      "val_pk_metric": 0.45324477418851444
    },
    {
      "epoch": 7,
      "train_loss": 0.5591372102499008,
      "train_chorus_rate": 0.6391406200826169,
      "train_max_prob": 0.571320578455925,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5884111970663071,
      "val_macro_f1": 0.5646185828825498,
      "val_verse_f1": 0.6648033539628669,
      "val_chorus_f1": 0.46443381180223287,
      "val_chorus_rate": 0.4724690914154053,
      "val_max_prob": 0.5442754030227661,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015264169446139745,
      "epoch_time": 135.719890832901,
      "val_boundary_f1": 0.06655574043261232,
      "val_boundary_precision": 0.11299435028248588,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.05698735586063264,
      "val_avg_segment_overlap": 0.2602553247594651,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.34439428727823673,
      "val_pk_metric": 0.32653224323725377
    },
    {
      "epoch": 8,
      "train_loss": 0.5576389521360398,
      "train_chorus_rate": 0.6020659238100052,
      "train_max_prob": 0.5694472104310989,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5859912484884262,
      "val_macro_f1": 0.5387702305648827,
      "val_verse_f1": 0.5921197446621175,
      "val_chorus_f1": 0.4854207164676479,
      "val_chorus_rate": 0.5882868096232414,
      "val_max_prob": 0.5630269944667816,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012394008320104218,
      "epoch_time": 145.30575299263,
      "val_boundary_f1": 0.060708263069139956,
      "val_boundary_precision": 0.10650887573964497,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.03671749502873575,
      "val_avg_segment_overlap": 0.23139138564074435,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.38424365517033443,
      "val_pk_metric": 0.3790801306383963
    },
    {
      "epoch": 9,
      "train_loss": 0.5551663354039192,
      "train_chorus_rate": 0.6211980596184731,
      "train_max_prob": 0.5744354516267777,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5894202888011932,
      "val_macro_f1": 0.6018959686957079,
      "val_verse_f1": 0.737497710203334,
      "val_chorus_f1": 0.46629422718808194,
      "val_chorus_rate": 0.36142898350954056,
      "val_max_prob": 0.5737322419881821,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.586567100953124e-05,
      "epoch_time": 157.7071521282196,
      "val_boundary_f1": 0.08012820512820512,
      "val_boundary_precision": 0.125,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.056150412645640635,
      "val_avg_segment_overlap": 0.2962665024399071,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.05555555555555555,
      "val_window_diff": 0.3494317900819145,
      "val_pk_metric": 0.3349253424633509
    },
    {
      "epoch": 10,
      "train_loss": 0.5393696933984756,
      "train_chorus_rate": 0.5049802511930466,
      "train_max_prob": 0.5775354385375977,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5790688991546631,
      "val_macro_f1": 0.6074168782158604,
      "val_verse_f1": 0.7129862589510355,
      "val_chorus_f1": 0.5018474974806854,
      "val_chorus_rate": 0.43317609280347824,
      "val_max_prob": 0.5798462182283401,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.964544441560993e-05,
      "epoch_time": 137.01787185668945,
      "val_boundary_f1": 0.11453744493392069,
      "val_boundary_precision": 0.1517509727626459,
      "val_boundary_recall": 0.09198113207547169,
      "val_complete_segments": 0.045848107234639585,
      "val_avg_segment_overlap": 0.32934478923244837,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.3972997294970073,
      "val_pk_metric": 0.3615954245978777
    },
    {
      "epoch": 11,
      "train_loss": 0.5296548917889595,
      "train_chorus_rate": 0.4966999337077141,
      "train_max_prob": 0.6080820292234421,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5728545635938644,
      "val_macro_f1": 0.6255202657445582,
      "val_verse_f1": 0.7241982507288631,
      "val_chorus_f1": 0.5268422807602534,
      "val_chorus_rate": 0.4389725625514984,
      "val_max_prob": 0.592808723449707,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.642535314003914e-05,
      "epoch_time": 152.46418404579163,
      "val_boundary_f1": 0.1484593837535014,
      "val_boundary_precision": 0.18275862068965518,
      "val_boundary_recall": 0.125,
      "val_complete_segments": 0.06633689817677092,
      "val_avg_segment_overlap": 0.369226116689058,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.40200831216443084,
      "val_pk_metric": 0.36283847196488767
    },
    {
      "epoch": 12,
      "train_loss": 0.5389510333538056,
      "train_chorus_rate": 0.5142351448535919,
      "train_max_prob": 0.6039978414773941,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5675363093614578,
      "val_macro_f1": 0.5100502944442343,
      "val_verse_f1": 0.5130583353673419,
      "val_chorus_f1": 0.5070422535211268,
      "val_chorus_rate": 0.6954454332590103,
      "val_max_prob": 0.6148698776960373,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.7220226593921327e-05,
      "epoch_time": 143.37157917022705,
      "val_boundary_f1": 0.07547169811320754,
      "val_boundary_precision": 0.11320754716981132,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.029546761956624104,
      "val_avg_segment_overlap": 0.2560278605110383,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.454882531013173,
      "val_pk_metric": 0.4381122151376671
    },
    {
      "epoch": 13,
      "train_loss": 0.5395186692476273,
      "train_chorus_rate": 0.5199708580970764,
      "train_max_prob": 0.6071654677391052,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5669079422950745,
      "val_macro_f1": 0.5507228232066438,
      "val_verse_f1": 0.595849140816782,
      "val_chorus_f1": 0.5055965055965056,
      "val_chorus_rate": 0.6014446765184402,
      "val_max_prob": 0.590103268623352,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.2869420963743652e-05,
      "epoch_time": 121.68623208999634,
      "val_boundary_f1": 0.10569105691056911,
      "val_boundary_precision": 0.12420382165605096,
      "val_boundary_recall": 0.09198113207547169,
      "val_complete_segments": 0.033517273522575754,
      "val_avg_segment_overlap": 0.3076710189669522,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.49129816881533617,
      "val_pk_metric": 0.4360719099197039
    },
    {
      "epoch": 14,
      "train_loss": 0.5344116881489753,
      "train_chorus_rate": 0.5316758185625077,
      "train_max_prob": 0.6027164310216904,
      "train_conf_over_90": 3.050640516448766e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5669103264808655,
      "val_macro_f1": 0.6331445671999633,
      "val_verse_f1": 0.7226061204343532,
      "val_chorus_f1": 0.5436830139655733,
      "val_chorus_rate": 0.4584348797798157,
      "val_max_prob": 0.5971227735280991,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.000135318350512e-06,
      "epoch_time": 142.57755088806152,
      "val_boundary_f1": 0.1742522756827048,
      "val_boundary_precision": 0.19420289855072465,
      "val_boundary_recall": 0.1580188679245283,
      "val_complete_segments": 0.055691261629755795,
      "val_avg_segment_overlap": 0.3986112887954859,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.13131313131313133,
      "val_window_diff": 0.4389849900775651,
      "val_pk_metric": 0.38250385945477317
    },
    {
      "epoch": 15,
      "train_loss": 0.5293736651539802,
      "train_chorus_rate": 0.47974083125591277,
      "train_max_prob": 0.6083525478839874,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5659186989068985,
      "val_macro_f1": 0.6326489652349219,
      "val_verse_f1": 0.7226824457593688,
      "val_chorus_f1": 0.5426154847104749,
      "val_chorus_rate": 0.4571278840303421,
      "val_max_prob": 0.5965791940689087,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 129.74196910858154,
      "val_boundary_f1": 0.1760204081632653,
      "val_boundary_precision": 0.19166666666666668,
      "val_boundary_recall": 0.16273584905660377,
      "val_complete_segments": 0.05723016987598112,
      "val_avg_segment_overlap": 0.4050636079341726,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.44698175749210856,
      "val_pk_metric": 0.3897184263917651
    }
  ]
}