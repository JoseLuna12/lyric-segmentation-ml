{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.164868023297203,
      "layer_dropout": 0.23856760701883212,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12973045666374572,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00078702518350858,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.016588284149919183,
      "gradient_clip_norm": 0.440334933265638,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11837144343874077,
        "ece_after": 0.026139118655608553,
        "improvement": 0.09223232478313222,
        "params": {
          "temperature": 0.5249574237981595
        }
      },
      "platt": {
        "ece_before": 0.11837144343874077,
        "ece_after": 0.050613504510614395,
        "improvement": 0.06775793892812637,
        "params": {
          "A": 1.4999996045712656,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6015289962291718,
      "train_chorus_rate": 0.47327691353857515,
      "train_max_prob": 0.5930635571479798,
      "train_conf_over_90": 0.0007072570733726025,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5994678288698196,
      "val_macro_f1": 0.37213727649215356,
      "val_verse_f1": 0.2532565889124508,
      "val_chorus_f1": 0.4910179640718563,
      "val_chorus_rate": 0.8895692825317383,
      "val_max_prob": 0.6154907941818237,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007784369154369234,
      "epoch_time": 73.69318199157715,
      "val_boundary_f1": 0.0400728597449909,
      "val_boundary_precision": 0.088,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.012922966899637102,
      "val_avg_segment_overlap": 0.15747206076579137,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4182672947753521,
      "val_pk_metric": 0.41729733312250983
    },
    {
      "epoch": 2,
      "train_loss": 0.5784850865602493,
      "train_chorus_rate": 0.49173372946679594,
      "train_max_prob": 0.5787400215864181,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5881471335887909,
      "val_macro_f1": 0.4957864265426123,
      "val_verse_f1": 0.5233993015133876,
      "val_chorus_f1": 0.4681735515718369,
      "val_chorus_rate": 0.6460944265127182,
      "val_max_prob": 0.5578208565711975,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007530474597477675,
      "epoch_time": 63.35179305076599,
      "val_boundary_f1": 0.06884057971014493,
      "val_boundary_precision": 0.1484375,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.025017981168564414,
      "val_avg_segment_overlap": 0.21368201492021252,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4442197464380968,
      "val_pk_metric": 0.4527176305090206
    },
    {
      "epoch": 3,
      "train_loss": 0.568275374174118,
      "train_chorus_rate": 0.5161336547229439,
      "train_max_prob": 0.5828934699296952,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5863142013549805,
      "val_macro_f1": 0.39429356121243886,
      "val_verse_f1": 0.29121041728321984,
      "val_chorus_f1": 0.49737670514165794,
      "val_chorus_rate": 0.8706048876047134,
      "val_max_prob": 0.5823163837194443,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007119664574868539,
      "epoch_time": 45.685068130493164,
      "val_boundary_f1": 0.032786885245901634,
      "val_boundary_precision": 0.072,
      "val_boundary_recall": 0.02122641509433962,
      "val_complete_segments": 0.012579635763623039,
      "val_avg_segment_overlap": 0.1708247323494013,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4251246349954777,
      "val_pk_metric": 0.4242172982103613
    },
    {
      "epoch": 4,
      "train_loss": 0.5595240294933319,
      "train_chorus_rate": 0.48786868564784525,
      "train_max_prob": 0.5795172274112701,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5828971862792969,
      "val_macro_f1": 0.61746232516233,
      "val_verse_f1": 0.7437223042836042,
      "val_chorus_f1": 0.4912023460410558,
      "val_chorus_rate": 0.3714505806565285,
      "val_max_prob": 0.5818156898021698,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006569893455815045,
      "epoch_time": 52.63286209106445,
      "val_boundary_f1": 0.19329896907216493,
      "val_boundary_precision": 0.21306818181818182,
      "val_boundary_recall": 0.17688679245283018,
      "val_complete_segments": 0.07825774759762034,
      "val_avg_segment_overlap": 0.3639981356014612,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.17676767676767677,
      "val_window_diff": 0.4300358584180142,
      "val_pk_metric": 0.40129308567384636
    },
    {
      "epoch": 5,
      "train_loss": 0.5382578238844872,
      "train_chorus_rate": 0.46328627988696097,
      "train_max_prob": 0.6218894064426422,
      "train_conf_over_90": 0.0006480506592197344,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5391213074326515,
      "val_macro_f1": 0.7014479812305214,
      "val_verse_f1": 0.804093567251462,
      "val_chorus_f1": 0.5988023952095809,
      "val_chorus_rate": 0.3572677969932556,
      "val_max_prob": 0.6420801132917404,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000590518887631435,
      "epoch_time": 51.890389919281006,
      "val_boundary_f1": 0.35151515151515156,
      "val_boundary_precision": 0.30742049469964666,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.1910288981603934,
      "val_avg_segment_overlap": 0.5867715882329544,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.3993121089268031,
      "val_pk_metric": 0.319290324409239
    },
    {
      "epoch": 6,
      "train_loss": 0.517372564971447,
      "train_chorus_rate": 0.39392114579677584,
      "train_max_prob": 0.6575615644454956,
      "train_conf_over_90": 0.005470649729249999,
      "train_conf_over_95": 0.0,
      "val_loss": 0.524680957198143,
      "val_macro_f1": 0.7301541422047868,
      "val_verse_f1": 0.8243218641907882,
      "val_chorus_f1": 0.6359864202187855,
      "val_chorus_rate": 0.3516673967242241,
      "val_max_prob": 0.695262610912323,
      "val_conf_over_90": 0.014779426448512822,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005154601616097089,
      "epoch_time": 46.6455180644989,
      "val_boundary_f1": 0.3577545195052331,
      "val_boundary_precision": 0.29984051036682613,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.2314669255681981,
      "val_avg_segment_overlap": 0.6385000811549701,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4015981661440755,
      "val_pk_metric": 0.29328772688776783
    },
    {
      "epoch": 7,
      "train_loss": 0.5024596229195595,
      "train_chorus_rate": 0.39430014193058016,
      "train_max_prob": 0.665285837650299,
      "train_conf_over_90": 0.024975973600521683,
      "train_conf_over_95": 0.0028337856056168675,
      "val_loss": 0.513861246407032,
      "val_macro_f1": 0.7370959834716532,
      "val_verse_f1": 0.827485380116959,
      "val_chorus_f1": 0.6467065868263473,
      "val_chorus_rate": 0.35712968558073044,
      "val_max_prob": 0.659504309296608,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004350935940152036,
      "epoch_time": 89.26901006698608,
      "val_boundary_f1": 0.34242709313264347,
      "val_boundary_precision": 0.28482003129890454,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.20631555278957187,
      "val_avg_segment_overlap": 0.6398000309189705,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4226115108587648,
      "val_pk_metric": 0.30918333243075924
    },
    {
      "epoch": 8,
      "train_loss": 0.48363829851150514,
      "train_chorus_rate": 0.37029228955507276,
      "train_max_prob": 0.6839731812477112,
      "train_conf_over_90": 0.009639455197611824,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5126499831676483,
      "val_macro_f1": 0.7552596173144048,
      "val_verse_f1": 0.8494413903174323,
      "val_chorus_f1": 0.6610778443113773,
      "val_chorus_rate": 0.31588268280029297,
      "val_max_prob": 0.7072498649358749,
      "val_conf_over_90": 0.011767725576646626,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003529315894933765,
      "epoch_time": 62.73664307594299,
      "val_boundary_f1": 0.39019407558733393,
      "val_boundary_precision": 0.3441441441441441,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.23479513068590482,
      "val_avg_segment_overlap": 0.6452642619657993,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3489924053708368,
      "val_pk_metric": 0.2588826513496378
    },
    {
      "epoch": 9,
      "train_loss": 0.46963465958833694,
      "train_chorus_rate": 0.3227901265025139,
      "train_max_prob": 0.703896376490593,
      "train_conf_over_90": 0.024512712849536912,
      "train_conf_over_95": 0.0009933640132658184,
      "val_loss": 0.506004199385643,
      "val_macro_f1": 0.7259403070073258,
      "val_verse_f1": 0.8139059304703476,
      "val_chorus_f1": 0.6379746835443039,
      "val_chorus_rate": 0.3795967474579811,
      "val_max_prob": 0.681877076625824,
      "val_conf_over_90": 0.010096367390360683,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002725650218988711,
      "epoch_time": 110.85895490646362,
      "val_boundary_f1": 0.31431244153414406,
      "val_boundary_precision": 0.26046511627906976,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.16221197716425712,
      "val_avg_segment_overlap": 0.6259308917034931,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.42890404175159225,
      "val_pk_metric": 0.31672296994376903
    },
    {
      "epoch": 10,
      "train_loss": 0.4693771779537201,
      "train_chorus_rate": 0.3406315430998802,
      "train_max_prob": 0.7003573685884475,
      "train_conf_over_90": 0.02173039838380646,
      "train_conf_over_95": 0.0008957209734944627,
      "val_loss": 0.5057213455438614,
      "val_macro_f1": 0.7270185710406432,
      "val_verse_f1": 0.810749859049051,
      "val_chorus_f1": 0.6432872830322353,
      "val_chorus_rate": 0.3934934139251709,
      "val_max_prob": 0.7026197761297226,
      "val_conf_over_90": 0.025297312764450908,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019750629587714507,
      "epoch_time": 88.77130270004272,
      "val_boundary_f1": 0.34552102376599636,
      "val_boundary_precision": 0.282089552238806,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.21652251023937133,
      "val_avg_segment_overlap": 0.6441844828075375,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4348361578005951,
      "val_pk_metric": 0.30955537606104205
    },
    {
      "epoch": 11,
      "train_loss": 0.4739114329218864,
      "train_chorus_rate": 0.3364572063088417,
      "train_max_prob": 0.6952464789152145,
      "train_conf_over_90": 0.02549895297270268,
      "train_conf_over_95": 0.0002320049738045782,
      "val_loss": 0.5143893882632256,
      "val_macro_f1": 0.7620583777461858,
      "val_verse_f1": 0.8634406750473566,
      "val_chorus_f1": 0.6606760804450149,
      "val_chorus_rate": 0.27449800074100494,
      "val_max_prob": 0.6882357448339462,
      "val_conf_over_90": 0.0011759620974771678,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013103583792707562,
      "epoch_time": 92.27367091178894,
      "val_boundary_f1": 0.4290288153681963,
      "val_boundary_precision": 0.391812865497076,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.27499152121368453,
      "val_avg_segment_overlap": 0.6464417390369077,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3138842218363451,
      "val_pk_metric": 0.23806220429505592
    },
    {
      "epoch": 12,
      "train_loss": 0.47182372510433196,
      "train_chorus_rate": 0.3285928048193455,
      "train_max_prob": 0.6979514062404633,
      "train_conf_over_90": 0.017737951112212613,
      "train_conf_over_95": 6.951686809770763e-05,
      "val_loss": 0.501196913421154,
      "val_macro_f1": 0.744859348641173,
      "val_verse_f1": 0.8322663252240717,
      "val_chorus_f1": 0.6574523720582742,
      "val_chorus_rate": 0.35827820748090744,
      "val_max_prob": 0.7075828313827515,
      "val_conf_over_90": 0.028587871231138706,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.605872602172606e-05,
      "epoch_time": 81.48110795021057,
      "val_boundary_f1": 0.3566634707574305,
      "val_boundary_precision": 0.30048465266558966,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21709017948413495,
      "val_avg_segment_overlap": 0.6501450994322382,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4010604742536142,
      "val_pk_metric": 0.2908130478608304
    },
    {
      "epoch": 13,
      "train_loss": 0.4654113471508026,
      "train_chorus_rate": 0.33265905231237414,
      "train_max_prob": 0.7021222859621048,
      "train_conf_over_90": 0.026798215741291643,
      "train_conf_over_95": 0.00027524006145540625,
      "val_loss": 0.4983603060245514,
      "val_macro_f1": 0.7390371342699641,
      "val_verse_f1": 0.8224786006698921,
      "val_chorus_f1": 0.6555956678700361,
      "val_chorus_rate": 0.3807920813560486,
      "val_max_prob": 0.7081642597913742,
      "val_conf_over_90": 0.027990011731162667,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.4977723760812425e-05,
      "epoch_time": 83.64113688468933,
      "val_boundary_f1": 0.36757775683317623,
      "val_boundary_precision": 0.30612244897959184,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.24624185047037644,
      "val_avg_segment_overlap": 0.6516053383395268,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3997345798096327,
      "val_pk_metric": 0.29049853354384336
    },
    {
      "epoch": 14,
      "train_loss": 0.4581709817051888,
      "train_chorus_rate": 0.3354052990674973,
      "train_max_prob": 0.7165127247571945,
      "train_conf_over_90": 0.03410823652520776,
      "train_conf_over_95": 0.0003661517519503832,
      "val_loss": 0.5000757202506065,
      "val_macro_f1": 0.7582665479370734,
      "val_verse_f1": 0.8498664292074801,
      "val_chorus_f1": 0.6666666666666667,
      "val_chorus_rate": 0.3214527666568756,
      "val_max_prob": 0.7068426311016083,
      "val_conf_over_90": 0.015754197374917567,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.588268071656572e-06,
      "epoch_time": 88.8005759716034,
      "val_boundary_f1": 0.4007744433688286,
      "val_boundary_precision": 0.3399014778325123,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2758672416546224,
      "val_avg_segment_overlap": 0.6708688663391442,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3581345146124402,
      "val_pk_metric": 0.25906131845043257
    },
    {
      "epoch": 15,
      "train_loss": 0.4630663499236107,
      "train_chorus_rate": 0.32726064026355745,
      "train_max_prob": 0.7086705535650253,
      "train_conf_over_90": 0.024380679707974195,
      "train_conf_over_95": 0.0001756469311658293,
      "val_loss": 0.4989611804485321,
      "val_macro_f1": 0.7568512280577071,
      "val_verse_f1": 0.8460017969451932,
      "val_chorus_f1": 0.667700659170221,
      "val_chorus_rate": 0.3338690251111984,
      "val_max_prob": 0.7039963155984879,
      "val_conf_over_90": 0.016714240540750325,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 89.50304388999939,
      "val_boundary_f1": 0.37294685990338167,
      "val_boundary_precision": 0.3158756137479542,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.25111995043066093,
      "val_avg_segment_overlap": 0.6657846949943127,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3609812574030555,
      "val_pk_metric": 0.2597200563813859
    }
  ]
}