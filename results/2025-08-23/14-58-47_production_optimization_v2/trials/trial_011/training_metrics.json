{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.20285287194395651,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0005228401343287477,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.02442124006959069,
      "gradient_clip_norm": 0.7264917736138693,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0801020195535686,
        "ece_after": 0.015366241482245649,
        "improvement": 0.06473577807132296,
        "params": {
          "temperature": 0.6300772897672536
        }
      },
      "platt": {
        "ece_before": 0.0801020195535686,
        "ece_after": 0.01703687262499964,
        "improvement": 0.06306514692856896,
        "params": {
          "A": 1.4999992253763916,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5267628446221352,
      "train_chorus_rate": 0.3201343617402017,
      "train_max_prob": 0.5421375811100007,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5553673803806305,
      "val_macro_f1": 0.5843307549983293,
      "val_verse_f1": 0.7819573901464714,
      "val_chorus_f1": 0.38670411985018727,
      "val_chorus_rate": 0.2251596711575985,
      "val_max_prob": 0.5653301328420639,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005171384048445096,
      "epoch_time": 127.04922699928284,
      "val_boundary_f1": 0.14492753623188406,
      "val_boundary_precision": 0.18796992481203006,
      "val_boundary_recall": 0.1179245283018868,
      "val_complete_segments": 0.025582238426883182,
      "val_avg_segment_overlap": 0.2763737100601747,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.4078900722198655,
      "val_pk_metric": 0.4015263271014083
    },
    {
      "epoch": 2,
      "train_loss": 0.5265337213873863,
      "train_chorus_rate": 0.3569109573960304,
      "train_max_prob": 0.5630062967538834,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5396759212017059,
      "val_macro_f1": 0.6206301749325991,
      "val_verse_f1": 0.7924273157538877,
      "val_chorus_f1": 0.4488330341113106,
      "val_chorus_rate": 0.2484622821211815,
      "val_max_prob": 0.5684113204479218,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005002824093301899,
      "epoch_time": 98.95996522903442,
      "val_boundary_f1": 0.2675438596491228,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.28773584905660377,
      "val_complete_segments": 0.10354841472285799,
      "val_avg_segment_overlap": 0.39252095289893185,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.20707070707070707,
      "val_window_diff": 0.41259718438663595,
      "val_pk_metric": 0.35536439074044657
    },
    {
      "epoch": 3,
      "train_loss": 0.4992411345243454,
      "train_chorus_rate": 0.3833143536001444,
      "train_max_prob": 0.58417888879776,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.513012021780014,
      "val_macro_f1": 0.6009535830847753,
      "val_verse_f1": 0.6462284958094398,
      "val_chorus_f1": 0.5556786703601109,
      "val_chorus_rate": 0.5874601006507874,
      "val_max_prob": 0.5992765724658966,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00047300883567380497,
      "epoch_time": 118.47684502601624,
      "val_boundary_f1": 0.20702402957486138,
      "val_boundary_precision": 0.1702127659574468,
      "val_boundary_recall": 0.2641509433962264,
      "val_complete_segments": 0.08435331256115985,
      "val_avg_segment_overlap": 0.432995983185369,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.2828282828282828,
      "val_window_diff": 0.4874313441945428,
      "val_pk_metric": 0.40728309777886307
    },
    {
      "epoch": 4,
      "train_loss": 0.48096767365932463,
      "train_chorus_rate": 0.3618914470076561,
      "train_max_prob": 0.6235506772994995,
      "train_conf_over_90": 0.0004657776356907561,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5125265866518021,
      "val_macro_f1": 0.683561251880147,
      "val_verse_f1": 0.8205655526992288,
      "val_chorus_f1": 0.5465569510610654,
      "val_chorus_rate": 0.26857903599739075,
      "val_max_prob": 0.6343913674354553,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004365096699172653,
      "epoch_time": 99.0551187992096,
      "val_boundary_f1": 0.33994334277620397,
      "val_boundary_precision": 0.28346456692913385,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.19895002941132314,
      "val_avg_segment_overlap": 0.5480646647335705,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.40836891269911896,
      "val_pk_metric": 0.3186697038861284
    },
    {
      "epoch": 5,
      "train_loss": 0.45811422616243364,
      "train_chorus_rate": 0.32434007376432417,
      "train_max_prob": 0.6445171445608139,
      "train_conf_over_90": 0.002234726710594259,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4846794605255127,
      "val_macro_f1": 0.6981665652031389,
      "val_verse_f1": 0.7928971962616822,
      "val_chorus_f1": 0.6034359341445956,
      "val_chorus_rate": 0.3873412683606148,
      "val_max_prob": 0.6508860290050507,
      "val_conf_over_90": 0.0030448722245637327,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00039238010074656073,
      "epoch_time": 107.48702692985535,
      "val_boundary_f1": 0.3339285714285714,
      "val_boundary_precision": 0.2686781609195402,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.20401160894268,
      "val_avg_segment_overlap": 0.5912730074169575,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4275545979825942,
      "val_pk_metric": 0.3290041507840903
    },
    {
      "epoch": 6,
      "train_loss": 0.4443073034286499,
      "train_chorus_rate": 0.3489152044057846,
      "train_max_prob": 0.6682271897792816,
      "train_conf_over_90": 0.01056732515571639,
      "train_conf_over_95": 0.00013237866514828056,
      "val_loss": 0.4762292876839638,
      "val_macro_f1": 0.6654686070913114,
      "val_verse_f1": 0.721497686159024,
      "val_chorus_f1": 0.6094395280235988,
      "val_chorus_rate": 0.5335347801446915,
      "val_max_prob": 0.652192160487175,
      "val_conf_over_90": 0.006592384015675634,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034254880209161803,
      "epoch_time": 116.53475594520569,
      "val_boundary_f1": 0.24040920716112532,
      "val_boundary_precision": 0.1882510013351135,
      "val_boundary_recall": 0.33254716981132076,
      "val_complete_segments": 0.10319568356418833,
      "val_avg_segment_overlap": 0.5384903604557194,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4922448434767255,
      "val_pk_metric": 0.37592369961646704
    },
    {
      "epoch": 7,
      "train_loss": 0.4457405522465706,
      "train_chorus_rate": 0.3910299465060234,
      "train_max_prob": 0.6756792396306992,
      "train_conf_over_90": 0.01960795947816223,
      "train_conf_over_95": 0.00039584950427524747,
      "val_loss": 0.47543637454509735,
      "val_macro_f1": 0.7118607627613387,
      "val_verse_f1": 0.8078835881377786,
      "val_chorus_f1": 0.6158379373848987,
      "val_chorus_rate": 0.3678755909204483,
      "val_max_prob": 0.6693846434354782,
      "val_conf_over_90": 0.01161226851399988,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0002891936408207588,
      "epoch_time": 122.69440722465515,
      "val_boundary_f1": 0.3379310344827587,
      "val_boundary_precision": 0.266304347826087,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.21846590947863484,
      "val_avg_segment_overlap": 0.6161202331112411,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4502628644206463,
      "val_pk_metric": 0.33034265117776873
    },
    {
      "epoch": 8,
      "train_loss": 0.44290481954813005,
      "train_chorus_rate": 0.37121240645647047,
      "train_max_prob": 0.6825922280550003,
      "train_conf_over_90": 0.025257997680455446,
      "train_conf_over_95": 0.0010243800119496883,
      "val_loss": 0.4703676253557205,
      "val_macro_f1": 0.7367879478425605,
      "val_verse_f1": 0.8341996773615343,
      "val_chorus_f1": 0.6393762183235868,
      "val_chorus_rate": 0.33151979744434357,
      "val_max_prob": 0.6928766816854477,
      "val_conf_over_90": 0.028448399621993303,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023464649350798895,
      "epoch_time": 105.89933919906616,
      "val_boundary_f1": 0.3702359346642468,
      "val_boundary_precision": 0.3008849557522124,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.26636310223266746,
      "val_avg_segment_overlap": 0.6292947504068789,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.41409431357181076,
      "val_pk_metric": 0.3003493130919183
    },
    {
      "epoch": 9,
      "train_loss": 0.43824470192193987,
      "train_chorus_rate": 0.3487801618874073,
      "train_max_prob": 0.6910582989454269,
      "train_conf_over_90": 0.027125201327726244,
      "train_conf_over_95": 0.0006131865811767057,
      "val_loss": 0.4593580961227417,
      "val_macro_f1": 0.7156760603467205,
      "val_verse_f1": 0.7970211953408439,
      "val_chorus_f1": 0.6343309253525972,
      "val_chorus_rate": 0.41497276723384857,
      "val_max_prob": 0.6821432113647461,
      "val_conf_over_90": 0.023828784935176373,
      "val_conf_over_95": 0.0009348820603918284,
      "learning_rate": 0.00018129133223712966,
      "epoch_time": 106.48509097099304,
      "val_boundary_f1": 0.3310225303292894,
      "val_boundary_precision": 0.26164383561643834,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.20750840031062726,
      "val_avg_segment_overlap": 0.6074286981405704,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4564827071103298,
      "val_pk_metric": 0.32830127433394957
    },
    {
      "epoch": 10,
      "train_loss": 0.43715567886829376,
      "train_chorus_rate": 0.38320027142763136,
      "train_max_prob": 0.691352441906929,
      "train_conf_over_90": 0.03424910744652152,
      "train_conf_over_95": 0.0016921702335821465,
      "val_loss": 0.45979418605566025,
      "val_macro_f1": 0.7314717217919006,
      "val_verse_f1": 0.8172002978406553,
      "val_chorus_f1": 0.6457431457431458,
      "val_chorus_rate": 0.38191404938697815,
      "val_max_prob": 0.6860778033733368,
      "val_conf_over_90": 0.024346229154616594,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.000131460033582187,
      "epoch_time": 101.16173696517944,
      "val_boundary_f1": 0.3394898856640281,
      "val_boundary_precision": 0.270687237026648,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2142631610553138,
      "val_avg_segment_overlap": 0.6241683326883594,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4473074701553271,
      "val_pk_metric": 0.31971529830839435
    },
    {
      "epoch": 11,
      "train_loss": 0.4412775844335556,
      "train_chorus_rate": 0.37152349650859834,
      "train_max_prob": 0.690537303686142,
      "train_conf_over_90": 0.03562449002638459,
      "train_conf_over_95": 0.0027037648542318493,
      "val_loss": 0.45830921083688736,
      "val_macro_f1": 0.7391690813126989,
      "val_verse_f1": 0.8272443546906555,
      "val_chorus_f1": 0.6510938079347423,
      "val_chorus_rate": 0.36353758722543716,
      "val_max_prob": 0.6914671063423157,
      "val_conf_over_90": 0.028131002094596624,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 8.733046441148245e-05,
      "epoch_time": 94.97332692146301,
      "val_boundary_f1": 0.35701598579040855,
      "val_boundary_precision": 0.2863247863247863,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.25064131697217595,
      "val_avg_segment_overlap": 0.6280426408486302,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.42859720187183387,
      "val_pk_metric": 0.3033666324226103
    },
    {
      "epoch": 12,
      "train_loss": 0.42410852909088137,
      "train_chorus_rate": 0.34891469180583956,
      "train_max_prob": 0.6970727503299713,
      "train_conf_over_90": 0.037598395813256504,
      "train_conf_over_95": 0.0024775444966508076,
      "val_loss": 0.4565894901752472,
      "val_macro_f1": 0.729323123977599,
      "val_verse_f1": 0.8125469571750562,
      "val_chorus_f1": 0.6460992907801418,
      "val_chorus_rate": 0.39364224672317505,
      "val_max_prob": 0.6878228187561035,
      "val_conf_over_90": 0.02656295895576477,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 5.0831298654942724e-05,
      "epoch_time": 107.99851989746094,
      "val_boundary_f1": 0.3330396475770925,
      "val_boundary_precision": 0.26582278481012656,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.21492394341015764,
      "val_avg_segment_overlap": 0.6165526146118087,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4464897945189101,
      "val_pk_metric": 0.3138490016290207
    },
    {
      "epoch": 13,
      "train_loss": 0.41860008239746094,
      "train_chorus_rate": 0.33952158093452456,
      "train_max_prob": 0.7011052340269088,
      "train_conf_over_90": 0.03947984101250768,
      "train_conf_over_95": 0.0020942569797625767,
      "val_loss": 0.4569650664925575,
      "val_macro_f1": 0.7306594302124112,
      "val_verse_f1": 0.8162504658963846,
      "val_chorus_f1": 0.6450683945284377,
      "val_chorus_rate": 0.38353175669908524,
      "val_max_prob": 0.6931865066289902,
      "val_conf_over_90": 0.031035015359520912,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 2.355772499855776e-05,
      "epoch_time": 105.23552203178406,
      "val_boundary_f1": 0.34397163120567376,
      "val_boundary_precision": 0.2755681818181818,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.23277318751868065,
      "val_avg_segment_overlap": 0.6156338523161264,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4341820407125689,
      "val_pk_metric": 0.306764311086568
    },
    {
      "epoch": 14,
      "train_loss": 0.4278594344854355,
      "train_chorus_rate": 0.34975695610046387,
      "train_max_prob": 0.7003271996974945,
      "train_conf_over_90": 0.039956492371857166,
      "train_conf_over_95": 0.0028137096378486603,
      "val_loss": 0.4561622813344002,
      "val_macro_f1": 0.7265672681494417,
      "val_verse_f1": 0.8094968908988129,
      "val_chorus_f1": 0.6436376454000704,
      "val_chorus_rate": 0.39786799252033234,
      "val_max_prob": 0.6920088976621628,
      "val_conf_over_90": 0.03050775872543454,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 6.701729484238134e-06,
      "epoch_time": 97.4829580783844,
      "val_boundary_f1": 0.33509700176366847,
      "val_boundary_precision": 0.2676056338028169,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.22202403130292847,
      "val_avg_segment_overlap": 0.6124969464150555,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4421819417613774,
      "val_pk_metric": 0.3112981012419122
    }
  ]
}