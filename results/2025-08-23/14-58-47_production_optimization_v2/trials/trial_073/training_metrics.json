{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.15018650455727078,
      "layer_dropout": 0.2230878062122977,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.13494054429086902,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 718595,
      "lstm_params": 577536,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009255573244192645,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "line_f1",
      "weight_decay": 0.01752820304956542,
      "gradient_clip_norm": 0.3494389457086987,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08798200060377422,
        "ece_after": 0.013983270186338076,
        "improvement": 0.07399873041743614,
        "params": {
          "temperature": 0.598455381316817
        }
      },
      "platt": {
        "ece_before": 0.08798200060377422,
        "ece_after": 0.011205534364713436,
        "improvement": 0.07677646623906079,
        "params": {
          "A": 1.5888726142026082,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5884821206331253,
      "train_chorus_rate": 0.5640541012340691,
      "train_max_prob": 0.5653020560741424,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5996597111225128,
      "val_macro_f1": 0.539920331830761,
      "val_verse_f1": 0.6778764405819008,
      "val_chorus_f1": 0.4019642230796212,
      "val_chorus_rate": 0.40035369992256165,
      "val_max_prob": 0.5437220185995102,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009154554265204174,
      "epoch_time": 93.90318894386292,
      "val_boundary_f1": 0.055350553505535055,
      "val_boundary_precision": 0.1271186440677966,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.01280056188592774,
      "val_avg_segment_overlap": 0.21423964803683598,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.418575231940283,
      "val_pk_metric": 0.4379331500347165
    },
    {
      "epoch": 2,
      "train_loss": 0.5618602424860001,
      "train_chorus_rate": 0.46461668037809434,
      "train_max_prob": 0.5701123893260955,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5923436880111694,
      "val_macro_f1": 0.5483687613653933,
      "val_verse_f1": 0.6243430733655665,
      "val_chorus_f1": 0.47239444936521996,
      "val_chorus_rate": 0.5330364927649498,
      "val_max_prob": 0.5614411979913712,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00088559123423634,
      "epoch_time": 50.20830273628235,
      "val_boundary_f1": 0.06091370558375634,
      "val_boundary_precision": 0.10778443113772455,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.041124280241459456,
      "val_avg_segment_overlap": 0.22714484130827273,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4229618837088727,
      "val_pk_metric": 0.4190225956933272
    },
    {
      "epoch": 3,
      "train_loss": 0.5516992434859276,
      "train_chorus_rate": 0.4544945014640689,
      "train_max_prob": 0.5984806478023529,
      "train_conf_over_90": 2.2988505952525885e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5929517149925232,
      "val_macro_f1": 0.5852597333172216,
      "val_verse_f1": 0.8067872578837842,
      "val_chorus_f1": 0.3637322087506589,
      "val_chorus_rate": 0.16589705646038055,
      "val_max_prob": 0.5443606525659561,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008372699560741405,
      "epoch_time": 135.9234118461609,
      "val_boundary_f1": 0.16927899686520376,
      "val_boundary_precision": 0.2523364485981308,
      "val_boundary_recall": 0.12735849056603774,
      "val_complete_segments": 0.0919191366036541,
      "val_avg_segment_overlap": 0.3162172832224672,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.32531520099332323,
      "val_pk_metric": 0.31224175622963435
    },
    {
      "epoch": 4,
      "train_loss": 0.5496277585625648,
      "train_chorus_rate": 0.39998165164142846,
      "train_max_prob": 0.6011605590581894,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5805336087942123,
      "val_macro_f1": 0.4950736699898074,
      "val_verse_f1": 0.4923456790123456,
      "val_chorus_f1": 0.49780166096726913,
      "val_chorus_rate": 0.7077369093894958,
      "val_max_prob": 0.5875265598297119,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007726034637607252,
      "epoch_time": 99.59562492370605,
      "val_boundary_f1": 0.06654991243432574,
      "val_boundary_precision": 0.1292517006802721,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.02717290650747703,
      "val_avg_segment_overlap": 0.21919405126485897,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.4286842779828351,
      "val_pk_metric": 0.42889246871977466
    },
    {
      "epoch": 5,
      "train_loss": 0.5489903211593627,
      "train_chorus_rate": 0.4526714652776718,
      "train_max_prob": 0.6125800341367722,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5525082796812057,
      "val_macro_f1": 0.7051526822447252,
      "val_verse_f1": 0.8191960332920134,
      "val_chorus_f1": 0.5911093311974369,
      "val_chorus_rate": 0.3147602900862694,
      "val_max_prob": 0.6090348362922668,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006944179933144483,
      "epoch_time": 49.5783109664917,
      "val_boundary_f1": 0.33514689880304677,
      "val_boundary_precision": 0.3111111111111111,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.19673377361606417,
      "val_avg_segment_overlap": 0.5454657278741523,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.35854709218689557,
      "val_pk_metric": 0.29418394424476546
    },
    {
      "epoch": 6,
      "train_loss": 0.5069504633545876,
      "train_chorus_rate": 0.379840537160635,
      "train_max_prob": 0.668710520863533,
      "train_conf_over_90": 0.01696886161225848,
      "train_conf_over_95": 0.0005224451248068363,
      "val_loss": 0.5389652252197266,
      "val_macro_f1": 0.7352574386349249,
      "val_verse_f1": 0.8449383573537071,
      "val_chorus_f1": 0.6255765199161425,
      "val_chorus_rate": 0.286700502038002,
      "val_max_prob": 0.7201347649097443,
      "val_conf_over_90": 0.02184301265515387,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006061306249693244,
      "epoch_time": 51.86394190788269,
      "val_boundary_f1": 0.3536121673003802,
      "val_boundary_precision": 0.2961783439490446,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21314063457488697,
      "val_avg_segment_overlap": 0.6261051129228231,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.3895372795673907,
      "val_pk_metric": 0.2912954778943386
    },
    {
      "epoch": 7,
      "train_loss": 0.47987995594739913,
      "train_chorus_rate": 0.36941647455096244,
      "train_max_prob": 0.7006006598472595,
      "train_conf_over_90": 0.018710839140112512,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5016935467720032,
      "val_macro_f1": 0.7501924703223012,
      "val_verse_f1": 0.842275255697111,
      "val_chorus_f1": 0.6581096849474913,
      "val_chorus_rate": 0.33231227844953537,
      "val_max_prob": 0.7077807635068893,
      "val_conf_over_90": 0.015919251716695726,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005115999403718318,
      "epoch_time": 92.12723994255066,
      "val_boundary_f1": 0.33727810650887574,
      "val_boundary_precision": 0.28983050847457625,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.1922268807210483,
      "val_avg_segment_overlap": 0.6343168321984163,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.37692362237319166,
      "val_pk_metric": 0.27367456890151864
    },
    {
      "epoch": 8,
      "train_loss": 0.4754768878221512,
      "train_chorus_rate": 0.340169707685709,
      "train_max_prob": 0.6979286670684814,
      "train_conf_over_90": 0.019676646578591316,
      "train_conf_over_95": 0.0001757752150297165,
      "val_loss": 0.49611691385507584,
      "val_macro_f1": 0.718360677469834,
      "val_verse_f1": 0.7976236105787657,
      "val_chorus_f1": 0.6390977443609023,
      "val_chorus_rate": 0.419484905898571,
      "val_max_prob": 0.6913261413574219,
      "val_conf_over_90": 0.02730048750527203,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0004149573840474328,
      "epoch_time": 112.25644779205322,
      "val_boundary_f1": 0.30129390018484287,
      "val_boundary_precision": 0.24772036474164133,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1531032528513971,
      "val_avg_segment_overlap": 0.617178361114874,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4470718921653861,
      "val_pk_metric": 0.32230561932794116
    },
    {
      "epoch": 9,
      "train_loss": 0.4709588289260864,
      "train_chorus_rate": 0.36869057938456534,
      "train_max_prob": 0.7056867092847824,
      "train_conf_over_90": 0.03008251270512119,
      "train_conf_over_95": 0.0003549349872628227,
      "val_loss": 0.4981059581041336,
      "val_macro_f1": 0.7360239725843156,
      "val_verse_f1": 0.820817843866171,
      "val_chorus_f1": 0.6512301013024603,
      "val_chorus_rate": 0.3797972723841667,
      "val_max_prob": 0.7368116080760956,
      "val_conf_over_90": 0.07367109321057796,
      "val_conf_over_95": 0.001387604046612978,
      "learning_rate": 0.00032042669944994014,
      "epoch_time": 70.90848588943481,
      "val_boundary_f1": 0.3256262042389211,
      "val_boundary_precision": 0.2752442996742671,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.15551097226600938,
      "val_avg_segment_overlap": 0.6237569268323946,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4037486579945579,
      "val_pk_metric": 0.29700925171555315
    },
    {
      "epoch": 10,
      "train_loss": 0.4679739952087402,
      "train_chorus_rate": 0.3489744797348976,
      "train_max_prob": 0.7069755107164383,
      "train_conf_over_90": 0.031486361566931007,
      "train_conf_over_95": 0.00021082483290228992,
      "val_loss": 0.49994856119155884,
      "val_macro_f1": 0.7715681249570534,
      "val_verse_f1": 0.872937574417418,
      "val_chorus_f1": 0.6701986754966887,
      "val_chorus_rate": 0.2570255249738693,
      "val_max_prob": 0.7284447252750397,
      "val_conf_over_90": 0.015181517228484154,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002321393311048162,
      "epoch_time": 47.972954988479614,
      "val_boundary_f1": 0.4105263157894737,
      "val_boundary_precision": 0.37072243346007605,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2702245155320447,
      "val_avg_segment_overlap": 0.6491236264393602,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.29124491386896617,
      "val_pk_metric": 0.2224389497821128
    },
    {
      "epoch": 11,
      "train_loss": 0.46720695346593855,
      "train_chorus_rate": 0.32455347925424577,
      "train_max_prob": 0.7120604097843171,
      "train_conf_over_90": 0.03043274461233523,
      "train_conf_over_95": 0.0006645861110882833,
      "val_loss": 0.5045003145933151,
      "val_macro_f1": 0.7605564688146729,
      "val_verse_f1": 0.864577983222051,
      "val_chorus_f1": 0.6565349544072948,
      "val_chorus_rate": 0.2664530761539936,
      "val_max_prob": 0.6687452346086502,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015395386065853933,
      "epoch_time": 43.06807804107666,
      "val_boundary_f1": 0.39879154078549844,
      "val_boundary_precision": 0.34797891036906853,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.2547734202161562,
      "val_avg_segment_overlap": 0.6435090690199134,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3244850496325711,
      "val_pk_metric": 0.23518378125491463
    },
    {
      "epoch": 12,
      "train_loss": 0.4665166810154915,
      "train_chorus_rate": 0.3472850970923901,
      "train_max_prob": 0.7118920266628266,
      "train_conf_over_90": 0.028931572707369922,
      "train_conf_over_95": 6.38977624475956e-05,
      "val_loss": 0.4890463650226593,
      "val_macro_f1": 0.7615303242091744,
      "val_verse_f1": 0.8555829517435717,
      "val_chorus_f1": 0.6674776966747771,
      "val_chorus_rate": 0.3063299357891083,
      "val_max_prob": 0.7029953300952911,
      "val_conf_over_90": 0.016773736395407468,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.928736834512397e-05,
      "epoch_time": 76.59080815315247,
      "val_boundary_f1": 0.3898635477582846,
      "val_boundary_precision": 0.33222591362126247,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.26630576380046156,
      "val_avg_segment_overlap": 0.6549838475029701,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3420805631509307,
      "val_pk_metric": 0.24480400913423664
    },
    {
      "epoch": 13,
      "train_loss": 0.4527314767241478,
      "train_chorus_rate": 0.3454176798462868,
      "train_max_prob": 0.7201172679662704,
      "train_conf_over_90": 0.04366471767425537,
      "train_conf_over_95": 0.0005286936939228326,
      "val_loss": 0.48350241780281067,
      "val_macro_f1": 0.7695707537057286,
      "val_verse_f1": 0.8583584470838503,
      "val_chorus_f1": 0.6807830603276068,
      "val_chorus_rate": 0.31565017998218536,
      "val_max_prob": 0.7092145681381226,
      "val_conf_over_90": 0.031080326531082392,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.096609018292439e-05,
      "epoch_time": 53.132169246673584,
      "val_boundary_f1": 0.39809523809523806,
      "val_boundary_precision": 0.33386581469648563,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2670203020017442,
      "val_avg_segment_overlap": 0.6726228390176765,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.33982579033837024,
      "val_pk_metric": 0.23934909119316822
    },
    {
      "epoch": 14,
      "train_loss": 0.45973109602928164,
      "train_chorus_rate": 0.30915811732411386,
      "train_max_prob": 0.7096315860748291,
      "train_conf_over_90": 0.03116858045104891,
      "train_conf_over_95": 0.0005821084516355768,
      "val_loss": 0.48156245797872543,
      "val_macro_f1": 0.7566803562564295,
      "val_verse_f1": 0.8409339657059468,
      "val_chorus_f1": 0.6724267468069121,
      "val_chorus_rate": 0.35463424772024155,
      "val_max_prob": 0.7153504192829132,
      "val_conf_over_90": 0.04433079995214939,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1101897898847053e-05,
      "epoch_time": 73.95122814178467,
      "val_boundary_f1": 0.36638338054768654,
      "val_boundary_precision": 0.30551181102362207,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2464737631890336,
      "val_avg_segment_overlap": 0.6559584356730923,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3689636778893648,
      "val_pk_metric": 0.2638044472935257
    },
    {
      "epoch": 15,
      "train_loss": 0.4419453486800194,
      "train_chorus_rate": 0.3597610004246235,
      "train_max_prob": 0.7291525781154633,
      "train_conf_over_90": 0.05222627576440573,
      "train_conf_over_95": 0.00040383291197940705,
      "val_loss": 0.4814302772283554,
      "val_macro_f1": 0.7643989343989344,
      "val_verse_f1": 0.8495670995670995,
      "val_chorus_f1": 0.6792307692307693,
      "val_chorus_rate": 0.3392796292901039,
      "val_max_prob": 0.7149783670902252,
      "val_conf_over_90": 0.040858675725758076,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 119.3231029510498,
      "val_boundary_f1": 0.3817663817663818,
      "val_boundary_precision": 0.3195548489666137,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2603286118264909,
      "val_avg_segment_overlap": 0.6634731246337561,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3512318303898885,
      "val_pk_metric": 0.24647068043991435
    }
  ]
}