{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2873157560952451,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.14082731714591387,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1211907,
      "lstm_params": 651264,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0009375765904863061,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.007682388229446726,
      "gradient_clip_norm": 0.5432799765074673,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06821190098882424,
        "ece_after": 0.03645617402138552,
        "improvement": 0.03175572696743872,
        "params": {
          "temperature": 0.6597426293953111
        }
      },
      "platt": {
        "ece_before": 0.06821190098882424,
        "ece_after": 0.13611920232095978,
        "improvement": -0.06790730133213554,
        "params": {
          "A": 0.49999933986472894,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5880023300647735,
      "train_chorus_rate": 0.4623719397932291,
      "train_max_prob": 0.597976565361023,
      "train_conf_over_90": 0.003148823231458664,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5842637419700623,
      "val_macro_f1": 0.5345149858961724,
      "val_verse_f1": 0.8121827411167514,
      "val_chorus_f1": 0.25684723067559345,
      "val_chorus_rate": 0.10378379747271538,
      "val_max_prob": 0.5459645092487335,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009019302665329047,
      "epoch_time": 106.31766295433044,
      "val_boundary_f1": 0.16377952755905514,
      "val_boundary_precision": 0.24644549763033174,
      "val_boundary_recall": 0.12264150943396226,
      "val_complete_segments": 0.06034482758620689,
      "val_avg_segment_overlap": 0.26651866105962374,
      "val_verse_to_chorus_acc": 0.10619469026548672,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.3233850507134258,
      "val_pk_metric": 0.30168243948453766
    },
    {
      "epoch": 2,
      "train_loss": 0.5527297675609588,
      "train_chorus_rate": 0.550021268427372,
      "train_max_prob": 0.5667447507381439,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5759181976318359,
      "val_macro_f1": 0.6155472975014351,
      "val_verse_f1": 0.788135593220339,
      "val_chorus_f1": 0.4429590017825312,
      "val_chorus_rate": 0.2512144595384598,
      "val_max_prob": 0.557748943567276,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008004181243598746,
      "epoch_time": 99.21193289756775,
      "val_boundary_f1": 0.22623345367027678,
      "val_boundary_precision": 0.23095823095823095,
      "val_boundary_recall": 0.22169811320754718,
      "val_complete_segments": 0.09584530651340997,
      "val_avg_segment_overlap": 0.37362530380121817,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.23232323232323232,
      "val_window_diff": 0.34222576864187293,
      "val_pk_metric": 0.30064302288701794
    },
    {
      "epoch": 3,
      "train_loss": 0.5269536316394806,
      "train_chorus_rate": 0.4334656670689583,
      "train_max_prob": 0.5804736971855163,
      "train_conf_over_90": 0.00035642391885630785,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5681715309619904,
      "val_macro_f1": 0.4369910209088387,
      "val_verse_f1": 0.3823769377209682,
      "val_chorus_f1": 0.4916051040967092,
      "val_chorus_rate": 0.7973240315914154,
      "val_max_prob": 0.6176370084285736,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006484944674031995,
      "epoch_time": 106.06573820114136,
      "val_boundary_f1": 0.08743169398907102,
      "val_boundary_precision": 0.1038961038961039,
      "val_boundary_recall": 0.07547169811320754,
      "val_complete_segments": 0.022270114942528736,
      "val_avg_segment_overlap": 0.2180253512455823,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.49823741482425743,
      "val_pk_metric": 0.4463745396508038
    },
    {
      "epoch": 4,
      "train_loss": 0.5404796957969665,
      "train_chorus_rate": 0.5801994070410729,
      "train_max_prob": 0.6049465239048004,
      "train_conf_over_90": 0.0004143646452575922,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5601283609867096,
      "val_macro_f1": 0.6787501910502083,
      "val_verse_f1": 0.8161018407018751,
      "val_chorus_f1": 0.5413985413985414,
      "val_chorus_rate": 0.27258314192295074,
      "val_max_prob": 0.5978394448757172,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00046928829524315306,
      "epoch_time": 104.21878600120544,
      "val_boundary_f1": 0.3011190233977619,
      "val_boundary_precision": 0.26475849731663686,
      "val_boundary_recall": 0.3490566037735849,
      "val_complete_segments": 0.15774664750957854,
      "val_avg_segment_overlap": 0.49484309830335943,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.37799015278750925,
      "val_pk_metric": 0.2961017079936196
    },
    {
      "epoch": 5,
      "train_loss": 0.5256057143211365,
      "train_chorus_rate": 0.4144469901919365,
      "train_max_prob": 0.6027252733707428,
      "train_conf_over_90": 0.00015358857344835997,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5429418385028839,
      "val_macro_f1": 0.5854304813192408,
      "val_verse_f1": 0.6259507829977629,
      "val_chorus_f1": 0.5449101796407186,
      "val_chorus_rate": 0.60260409116745,
      "val_max_prob": 0.6305700838565826,
      "val_conf_over_90": 0.0004911894793622196,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00029008212308310674,
      "epoch_time": 92.19749617576599,
      "val_boundary_f1": 0.20733944954128444,
      "val_boundary_precision": 0.16966966966966968,
      "val_boundary_recall": 0.2665094339622642,
      "val_complete_segments": 0.06345785440613028,
      "val_avg_segment_overlap": 0.43064362546672935,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.5270184677546526,
      "val_pk_metric": 0.4280942999824398
    },
    {
      "epoch": 6,
      "train_loss": 0.5059309989213944,
      "train_chorus_rate": 0.48793090879917145,
      "train_max_prob": 0.6412664234638215,
      "train_conf_over_90": 0.007056705123977736,
      "train_conf_over_95": 0.00016540147189516574,
      "val_loss": 0.5349297523498535,
      "val_macro_f1": 0.6473608068345644,
      "val_verse_f1": 0.718200408997955,
      "val_chorus_f1": 0.576521204671174,
      "val_chorus_rate": 0.49948516488075256,
      "val_max_prob": 0.6355719566345215,
      "val_conf_over_90": 0.003944955999031663,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001381584661264315,
      "epoch_time": 100.31180810928345,
      "val_boundary_f1": 0.27172995780590714,
      "val_boundary_precision": 0.21156373193166886,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.11775622605363985,
      "val_avg_segment_overlap": 0.524782662126708,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.49243472767601953,
      "val_pk_metric": 0.374052775818457
    },
    {
      "epoch": 7,
      "train_loss": 0.4966426998376846,
      "train_chorus_rate": 0.40586877167224883,
      "train_max_prob": 0.6426606953144074,
      "train_conf_over_90": 0.0031630220299120994,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5381532907485962,
      "val_macro_f1": 0.6445737561827176,
      "val_verse_f1": 0.7177189409368636,
      "val_chorus_f1": 0.5714285714285715,
      "val_chorus_rate": 0.49449606239795685,
      "val_max_prob": 0.6490942239761353,
      "val_conf_over_90": 0.005178719758987427,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.664632395340139e-05,
      "epoch_time": 91.52966094017029,
      "val_boundary_f1": 0.24913494809688583,
      "val_boundary_precision": 0.19672131147540983,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.10674090038314177,
      "val_avg_segment_overlap": 0.5140732286750377,
      "val_verse_to_chorus_acc": 0.22566371681415928,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4879188728185784,
      "val_pk_metric": 0.38329038552300065
    },
    {
      "epoch": 8,
      "train_loss": 0.4949117124080658,
      "train_chorus_rate": 0.445455875992775,
      "train_max_prob": 0.6574391961097718,
      "train_conf_over_90": 0.006737961713224649,
      "train_conf_over_95": 0.00013090297288727016,
      "val_loss": 0.5402671694755554,
      "val_macro_f1": 0.68103236643194,
      "val_verse_f1": 0.7838038632986626,
      "val_chorus_f1": 0.5782608695652174,
      "val_chorus_rate": 0.3780262619256973,
      "val_max_prob": 0.6466140449047089,
      "val_conf_over_90": 0.002962576923891902,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 111.67734503746033,
      "val_boundary_f1": 0.2961082910321489,
      "val_boundary_precision": 0.23087071240105542,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.16924090038314177,
      "val_avg_segment_overlap": 0.5616076202408912,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.43785784463415317,
      "val_pk_metric": 0.3311536626704028
    }
  ]
}