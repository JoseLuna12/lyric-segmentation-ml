{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.265187192677686,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.11115133537492615,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 704259,
      "lstm_params": 563200,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00012701407475214274,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.015897219097457515,
      "gradient_clip_norm": 0.9305788219025521,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05612909599172576,
        "ece_after": 0.022185708998111463,
        "improvement": 0.033943386993614294,
        "params": {
          "temperature": 0.7315326049083168
        }
      },
      "platt": {
        "ece_before": 0.05612909599172576,
        "ece_after": 0.02541914503209013,
        "improvement": 0.03070995095963563,
        "params": {
          "A": 1.2802638635268748,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5383151039481163,
      "train_chorus_rate": 0.2433562593534589,
      "train_max_prob": 0.5388636857271194,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5714779645204544,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.5677640438079834,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001256372198148208,
      "epoch_time": 243.00109004974365,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 2,
      "train_loss": 0.5404746249318123,
      "train_chorus_rate": 0.4013435013592243,
      "train_max_prob": 0.5477977812290191,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5578447729349136,
      "val_macro_f1": 0.5871446395919235,
      "val_verse_f1": 0.7129681912290609,
      "val_chorus_f1": 0.4613210879547863,
      "val_chorus_rate": 0.3973225727677345,
      "val_max_prob": 0.5381756126880646,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012156683017049895,
      "epoch_time": 155.37335896492004,
      "val_boundary_f1": 0.0798611111111111,
      "val_boundary_precision": 0.1513157894736842,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.041931351515126704,
      "val_avg_segment_overlap": 0.2549735028257287,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.3615746052946306,
      "val_pk_metric": 0.36334553888635
    },
    {
      "epoch": 3,
      "train_loss": 0.5332411006093025,
      "train_chorus_rate": 0.441089129447937,
      "train_max_prob": 0.5631723970174789,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5460704118013382,
      "val_macro_f1": 0.573410786461479,
      "val_verse_f1": 0.6214963584197749,
      "val_chorus_f1": 0.525325214503183,
      "val_chorus_rate": 0.5894367098808289,
      "val_max_prob": 0.563043549656868,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011498080137853062,
      "epoch_time": 192.08371496200562,
      "val_boundary_f1": 0.12006861063464837,
      "val_boundary_precision": 0.22012578616352202,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.06655782429907563,
      "val_avg_segment_overlap": 0.2515016777923014,
      "val_verse_to_chorus_acc": 0.11061946902654868,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3416697577922385,
      "val_pk_metric": 0.3398159563378903
    },
    {
      "epoch": 4,
      "train_loss": 0.510584433376789,
      "train_chorus_rate": 0.4466750599443913,
      "train_max_prob": 0.594255530834198,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.545139417052269,
      "val_macro_f1": 0.6296328794235234,
      "val_verse_f1": 0.7752511898466421,
      "val_chorus_f1": 0.4840145690004047,
      "val_chorus_rate": 0.30777331441640854,
      "val_max_prob": 0.5821465104818344,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010616697450039726,
      "epoch_time": 363.16982316970825,
      "val_boundary_f1": 0.14035087719298245,
      "val_boundary_precision": 0.21674876847290642,
      "val_boundary_recall": 0.10377358490566038,
      "val_complete_segments": 0.07257416293736549,
      "val_avg_segment_overlap": 0.28962192177132634,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.3022830546197544,
      "val_pk_metric": 0.29081570729412204
    },
    {
      "epoch": 5,
      "train_loss": 0.5112323239445686,
      "train_chorus_rate": 0.41508526876568796,
      "train_max_prob": 0.6103535443544388,
      "train_conf_over_90": 0.0010277247056365013,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5351339727640152,
      "val_macro_f1": 0.6335559495616029,
      "val_verse_f1": 0.7308364059771008,
      "val_chorus_f1": 0.536275493146105,
      "val_chorus_rate": 0.43573056161403656,
      "val_max_prob": 0.5869882702827454,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.551055606410707e-05,
      "epoch_time": 178.44593787193298,
      "val_boundary_f1": 0.16978417266187049,
      "val_boundary_precision": 0.2177121771217712,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.08506385873830201,
      "val_avg_segment_overlap": 0.32702028733350225,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.3298910268057392,
      "val_pk_metric": 0.3091218775334498
    },
    {
      "epoch": 6,
      "train_loss": 0.48077173680067065,
      "train_chorus_rate": 0.40749760195612905,
      "train_max_prob": 0.6355392217636109,
      "train_conf_over_90": 0.010176977189257742,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5248376429080963,
      "val_macro_f1": 0.6505213000058361,
      "val_verse_f1": 0.7422680412371133,
      "val_chorus_f1": 0.5587745587745588,
      "val_chorus_rate": 0.4390653893351555,
      "val_max_prob": 0.6039008051156998,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.347728269049494e-05,
      "epoch_time": 229.5865249633789,
      "val_boundary_f1": 0.19086021505376344,
      "val_boundary_precision": 0.221875,
      "val_boundary_recall": 0.16745283018867924,
      "val_complete_segments": 0.08763475640463976,
      "val_avg_segment_overlap": 0.3535335747869913,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.32689692304803525,
      "val_pk_metric": 0.3000203019654718
    },
    {
      "epoch": 7,
      "train_loss": 0.4982143998146057,
      "train_chorus_rate": 0.4089851051568985,
      "train_max_prob": 0.6205278396606445,
      "train_conf_over_90": 9.863719460554421e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5151053443551064,
      "val_macro_f1": 0.6718123357568947,
      "val_verse_f1": 0.7739277018168197,
      "val_chorus_f1": 0.5696969696969697,
      "val_chorus_rate": 0.3907014727592468,
      "val_max_prob": 0.6207204163074493,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.059306616803974e-05,
      "epoch_time": 156.60249400138855,
      "val_boundary_f1": 0.21588089330024818,
      "val_boundary_precision": 0.22774869109947643,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.0971259985178331,
      "val_avg_segment_overlap": 0.39674171357657995,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.33515188620319225,
      "val_pk_metric": 0.29891447440412205
    },
    {
      "epoch": 8,
      "train_loss": 0.4901156112551689,
      "train_chorus_rate": 0.4012621447443962,
      "train_max_prob": 0.6467318385839462,
      "train_conf_over_90": 0.006854467367520556,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5062428191304207,
      "val_macro_f1": 0.6451304659253175,
      "val_verse_f1": 0.6962867568147671,
      "val_chorus_f1": 0.5939741750358679,
      "val_chorus_rate": 0.558447927236557,
      "val_max_prob": 0.6313194334506989,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.742100858410305e-05,
      "epoch_time": 177.79880285263062,
      "val_boundary_f1": 0.23157894736842105,
      "val_boundary_precision": 0.2296983758700696,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.1365696707160122,
      "val_avg_segment_overlap": 0.410343334013018,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.38355044682473605,
      "val_pk_metric": 0.333209920408322
    },
    {
      "epoch": 9,
      "train_loss": 0.47400469332933426,
      "train_chorus_rate": 0.4050186961889267,
      "train_max_prob": 0.6541403025388718,
      "train_conf_over_90": 0.009075929495156742,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49750954657793045,
      "val_macro_f1": 0.7046392142916647,
      "val_verse_f1": 0.7946546207415772,
      "val_chorus_f1": 0.614623807841752,
      "val_chorus_rate": 0.39729979634284973,
      "val_max_prob": 0.6478075385093689,
      "val_conf_over_90": 0.0022209895541891456,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.453679206164784e-05,
      "epoch_time": 162.80961108207703,
      "val_boundary_f1": 0.28602620087336245,
      "val_boundary_precision": 0.266260162601626,
      "val_boundary_recall": 0.3089622641509434,
      "val_complete_segments": 0.1455022341687241,
      "val_avg_segment_overlap": 0.47954532401509503,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.2878787878787879,
      "val_window_diff": 0.3349149083991678,
      "val_pk_metric": 0.28959800310599776
    },
    {
      "epoch": 10,
      "train_loss": 0.4632951498031616,
      "train_chorus_rate": 0.3909023582935333,
      "train_max_prob": 0.6732200384140015,
      "train_conf_over_90": 0.023589166812598705,
      "train_conf_over_95": 0.00010814412962645292,
      "val_loss": 0.4956166595220566,
      "val_macro_f1": 0.6969654370734255,
      "val_verse_f1": 0.7745845552297166,
      "val_chorus_f1": 0.6193463189171343,
      "val_chorus_rate": 0.4464340955018997,
      "val_max_prob": 0.654266357421875,
      "val_conf_over_90": 0.002487230231054127,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.25035186880357e-05,
      "epoch_time": 211.00250506401062,
      "val_boundary_f1": 0.2773722627737226,
      "val_boundary_precision": 0.2485981308411215,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.15257245012017015,
      "val_avg_segment_overlap": 0.49516804767675954,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.3758187952340605,
      "val_pk_metric": 0.3112033766668149
    },
    {
      "epoch": 11,
      "train_loss": 0.46189980357885363,
      "train_chorus_rate": 0.40066741928458216,
      "train_max_prob": 0.6813762962818146,
      "train_conf_over_90": 0.022966855322010815,
      "train_conf_over_95": 0.00010952119482681155,
      "val_loss": 0.4889860153198242,
      "val_macro_f1": 0.6771619940814114,
      "val_verse_f1": 0.736623807548735,
      "val_chorus_f1": 0.6177001806140878,
      "val_chorus_rate": 0.5179120153188705,
      "val_max_prob": 0.6599454432725906,
      "val_conf_over_90": 0.003216005628928542,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.1847100251745513e-05,
      "epoch_time": 199.9965898990631,
      "val_boundary_f1": 0.25728643216080405,
      "val_boundary_precision": 0.22416812609457093,
      "val_boundary_recall": 0.3018867924528302,
      "val_complete_segments": 0.14192681357315504,
      "val_avg_segment_overlap": 0.48100529333239683,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.40234009789138564,
      "val_pk_metric": 0.32266880984491214
    },
    {
      "epoch": 12,
      "train_loss": 0.4513303831219673,
      "train_chorus_rate": 0.3806750625371933,
      "train_max_prob": 0.6833094269037246,
      "train_conf_over_90": 0.01996590683120303,
      "train_conf_over_95": 0.0001050357852363959,
      "val_loss": 0.4860967695713043,
      "val_macro_f1": 0.7015197432636604,
      "val_verse_f1": 0.7763597094050657,
      "val_chorus_f1": 0.626679777122255,
      "val_chorus_rate": 0.45147718489170074,
      "val_max_prob": 0.6648857295513153,
      "val_conf_over_90": 0.005668262485414743,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.3033273373612142e-05,
      "epoch_time": 186.99675011634827,
      "val_boundary_f1": 0.3125618199802176,
      "val_boundary_precision": 0.26916524701873934,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.16033132435571462,
      "val_avg_segment_overlap": 0.520820725462249,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.3709562133106443,
      "val_pk_metric": 0.30619462954918597
    },
    {
      "epoch": 13,
      "train_loss": 0.45600973516702653,
      "train_chorus_rate": 0.3662517167627811,
      "train_max_prob": 0.6825274437665939,
      "train_conf_over_90": 0.018071687826886774,
      "train_conf_over_95": 3.382949798833579e-05,
      "val_loss": 0.48569489270448685,
      "val_macro_f1": 0.7024112267948629,
      "val_verse_f1": 0.7773199921522463,
      "val_chorus_f1": 0.6275024614374795,
      "val_chorus_rate": 0.4505321756005287,
      "val_max_prob": 0.6676556318998337,
      "val_conf_over_90": 0.006638446124270558,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.447244581643785e-06,
      "epoch_time": 152.79455494880676,
      "val_boundary_f1": 0.30585898709036746,
      "val_boundary_precision": 0.2641509433962264,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.15316059128360296,
      "val_avg_segment_overlap": 0.5196858919864842,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.37378421212122603,
      "val_pk_metric": 0.3058938365202578
    },
    {
      "epoch": 14,
      "train_loss": 0.45424424260854723,
      "train_chorus_rate": 0.3769123300909996,
      "train_max_prob": 0.6864834070205689,
      "train_conf_over_90": 0.02844671569764614,
      "train_conf_over_95": 0.00036046571913175287,
      "val_loss": 0.4855090603232384,
      "val_macro_f1": 0.7120279010912589,
      "val_verse_f1": 0.7920830130668716,
      "val_chorus_f1": 0.6319727891156462,
      "val_chorus_rate": 0.42412586510181427,
      "val_max_prob": 0.6688741743564606,
      "val_conf_over_90": 0.007632824184838682,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.37685493732194e-06,
      "epoch_time": 219.22904682159424,
      "val_boundary_f1": 0.3055555555555555,
      "val_boundary_precision": 0.2636986301369863,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.16650652508287717,
      "val_avg_segment_overlap": 0.5265311839850433,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.36418238707022793,
      "val_pk_metric": 0.3022220559211776
    },
    {
      "epoch": 15,
      "train_loss": 0.4603198990225792,
      "train_chorus_rate": 0.3854915753006935,
      "train_max_prob": 0.684808149933815,
      "train_conf_over_90": 0.022558547416701914,
      "train_conf_over_95": 0.00023646821791771798,
      "val_loss": 0.48514049500226974,
      "val_macro_f1": 0.705645812039378,
      "val_verse_f1": 0.7819812792511699,
      "val_chorus_f1": 0.6293103448275862,
      "val_chorus_rate": 0.44286924600601196,
      "val_max_prob": 0.6686873584985733,
      "val_conf_over_90": 0.006879526190459728,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 169.16526317596436,
      "val_boundary_f1": 0.3022571148184495,
      "val_boundary_precision": 0.25882352941176473,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.15925815225921272,
      "val_avg_segment_overlap": 0.5247830017855778,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.3724123757472148,
      "val_pk_metric": 0.30590594445221353
    }
  ]
}