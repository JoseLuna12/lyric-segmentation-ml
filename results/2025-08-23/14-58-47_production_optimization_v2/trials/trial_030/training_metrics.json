{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2512195267407457,
      "layer_dropout": 0.2513545507288776,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17838779427993476,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006054584824164433,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.006529935200527742,
      "gradient_clip_norm": 0.3972320590804119,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07769597772589366,
        "ece_after": 0.023243312927032495,
        "improvement": 0.05445266479886117,
        "params": {
          "temperature": 0.6465353051321373
        }
      },
      "platt": {
        "ece_before": 0.07769597772589366,
        "ece_after": 0.02575791691574461,
        "improvement": 0.05193806081014905,
        "params": {
          "A": 1.499971570537482,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6162230193614959,
      "train_chorus_rate": 0.4480430817231536,
      "train_max_prob": 0.5990413308143616,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6048445105552673,
      "val_macro_f1": 0.5540939698692875,
      "val_verse_f1": 0.755036397494498,
      "val_chorus_f1": 0.35315154224407685,
      "val_chorus_rate": 0.24990642815828323,
      "val_max_prob": 0.5330130159854889,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005824526512869144,
      "epoch_time": 113.734628200531,
      "val_boundary_f1": 0.060708263069139956,
      "val_boundary_precision": 0.10650887573964497,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.030718455161721336,
      "val_avg_segment_overlap": 0.23709737616132207,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.3724598661978284,
      "val_pk_metric": 0.37161899715782043
    },
    {
      "epoch": 2,
      "train_loss": 0.569713893532753,
      "train_chorus_rate": 0.658748934417963,
      "train_max_prob": 0.551677456498146,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5985046476125717,
      "val_macro_f1": 0.4987182285010414,
      "val_verse_f1": 0.5447593342330185,
      "val_chorus_f1": 0.45267712276906436,
      "val_chorus_rate": 0.6086927056312561,
      "val_max_prob": 0.5585606843233109,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00051693758713942,
      "epoch_time": 94.27358293533325,
      "val_boundary_f1": 0.05090909090909091,
      "val_boundary_precision": 0.1111111111111111,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.013416578978615035,
      "val_avg_segment_overlap": 0.207879745304213,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4505738732179384,
      "val_pk_metric": 0.4587180853136323
    },
    {
      "epoch": 3,
      "train_loss": 0.5720711588859558,
      "train_chorus_rate": 0.5868219999596477,
      "train_max_prob": 0.5745229721069336,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5929342955350876,
      "val_macro_f1": 0.40789995952164804,
      "val_verse_f1": 0.32879818594104304,
      "val_chorus_f1": 0.48700173310225303,
      "val_chorus_rate": 0.8345288634300232,
      "val_max_prob": 0.5743899047374725,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041888736459488066,
      "epoch_time": 58.45514702796936,
      "val_boundary_f1": 0.04347826086956522,
      "val_boundary_precision": 0.09375,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.016449630208909105,
      "val_avg_segment_overlap": 0.1741966955246453,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4124594634954274,
      "val_pk_metric": 0.40634353371881593
    },
    {
      "epoch": 4,
      "train_loss": 0.5630711317062378,
      "train_chorus_rate": 0.5456147320568562,
      "train_max_prob": 0.5771249324083328,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5835088342428207,
      "val_macro_f1": 0.5002431382278971,
      "val_verse_f1": 0.5013477088948788,
      "val_chorus_f1": 0.4991385675609155,
      "val_chorus_rate": 0.7008117139339447,
      "val_max_prob": 0.5894152522087097,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003032292412082217,
      "epoch_time": 73.27593493461609,
      "val_boundary_f1": 0.0907563025210084,
      "val_boundary_precision": 0.15789473684210525,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.034219238553809074,
      "val_avg_segment_overlap": 0.21960304007632908,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.42946784532547405,
      "val_pk_metric": 0.4259262024663271
    },
    {
      "epoch": 5,
      "train_loss": 0.545085160434246,
      "train_chorus_rate": 0.4835249200463295,
      "train_max_prob": 0.6118146508932114,
      "train_conf_over_90": 8.103727595880628e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.561923623085022,
      "val_macro_f1": 0.646355867435559,
      "val_verse_f1": 0.7297297297297297,
      "val_chorus_f1": 0.5629820051413881,
      "val_chorus_rate": 0.46597159653902054,
      "val_max_prob": 0.6356114745140076,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001875711178215628,
      "epoch_time": 70.95165395736694,
      "val_boundary_f1": 0.19248826291079815,
      "val_boundary_precision": 0.19158878504672897,
      "val_boundary_recall": 0.19339622641509435,
      "val_complete_segments": 0.06021545329604715,
      "val_avg_segment_overlap": 0.4460652777929807,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.46489638797796573,
      "val_pk_metric": 0.4076609813960681
    },
    {
      "epoch": 6,
      "train_loss": 0.5246632277965546,
      "train_chorus_rate": 0.4322167679667473,
      "train_max_prob": 0.6413325935602188,
      "train_conf_over_90": 0.0019775467197177933,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5393941104412079,
      "val_macro_f1": 0.6878406156416892,
      "val_verse_f1": 0.7695601401323472,
      "val_chorus_f1": 0.6061210911510313,
      "val_chorus_rate": 0.4395591840147972,
      "val_max_prob": 0.6285177171230316,
      "val_conf_over_90": 0.00024108003708533943,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.95208952770234e-05,
      "epoch_time": 59.424440145492554,
      "val_boundary_f1": 0.2477341389728097,
      "val_boundary_precision": 0.21616871704745166,
      "val_boundary_recall": 0.29009433962264153,
      "val_complete_segments": 0.1282359620641699,
      "val_avg_segment_overlap": 0.5598363565513242,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.2828282828282828,
      "val_window_diff": 0.45401941283106917,
      "val_pk_metric": 0.3722643760943012
    },
    {
      "epoch": 7,
      "train_loss": 0.5143250569701194,
      "train_chorus_rate": 0.4054912328720093,
      "train_max_prob": 0.6494432479143143,
      "train_conf_over_90": 0.010605225973995403,
      "train_conf_over_95": 0.00021614391007460654,
      "val_loss": 0.5421881526708603,
      "val_macro_f1": 0.7105750622024766,
      "val_verse_f1": 0.8090875778673507,
      "val_chorus_f1": 0.6120625465376024,
      "val_chorus_rate": 0.36136190593242645,
      "val_max_prob": 0.6788989901542664,
      "val_conf_over_90": 0.008164977189153433,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.400583112952892e-05,
      "epoch_time": 147.16802406311035,
      "val_boundary_f1": 0.3430962343096234,
      "val_boundary_precision": 0.3082706766917293,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.17548567921049366,
      "val_avg_segment_overlap": 0.5851963086469705,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.41149232214966025,
      "val_pk_metric": 0.327928550065973
    },
    {
      "epoch": 8,
      "train_loss": 0.5034845411777497,
      "train_chorus_rate": 0.3827777147293091,
      "train_max_prob": 0.6676905065774917,
      "train_conf_over_90": 0.012314230523770675,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5311534851789474,
      "val_macro_f1": 0.7118356278700839,
      "val_verse_f1": 0.793571838530706,
      "val_chorus_f1": 0.6300994172094617,
      "val_chorus_rate": 0.41759975999593735,
      "val_max_prob": 0.6575040966272354,
      "val_conf_over_90": 0.004827849683351815,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 95.6445791721344,
      "val_boundary_f1": 0.2811881188118812,
      "val_boundary_precision": 0.24232081911262798,
      "val_boundary_recall": 0.33490566037735847,
      "val_complete_segments": 0.15006861504740612,
      "val_avg_segment_overlap": 0.5869791247898465,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.44017239582266676,
      "val_pk_metric": 0.3471673708254674
    }
  ]
}