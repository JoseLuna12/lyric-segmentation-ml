{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.24800971615160625,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2707176711612295,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008638573760190358,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01929517963767494,
      "gradient_clip_norm": 0.3951631833385986,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14271795931171574,
        "ece_after": 0.030325043836721976,
        "improvement": 0.11239291547499376,
        "params": {
          "temperature": 0.44438457404246196
        }
      },
      "platt": {
        "ece_before": 0.14271795931171574,
        "ece_after": 0.03223627414883706,
        "improvement": 0.11048168516287868,
        "params": {
          "A": 2.1423777368039563,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5687736719846725,
      "train_chorus_rate": 0.5336976963211782,
      "train_max_prob": 0.5852231413125992,
      "train_conf_over_90": 4.0650405571796e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5629554092884064,
      "val_macro_f1": 0.4848027622341742,
      "val_verse_f1": 0.46936708860759496,
      "val_chorus_f1": 0.5002384358607534,
      "val_chorus_rate": 0.7304617315530777,
      "val_max_prob": 0.5745847523212433,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008544296240737614,
      "epoch_time": 110.49580407142639,
      "val_boundary_f1": 0.07570977917981073,
      "val_boundary_precision": 0.11428571428571428,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.025359316292508233,
      "val_avg_segment_overlap": 0.2430690562701142,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.4448573735339366,
      "val_pk_metric": 0.44915909889921424
    },
    {
      "epoch": 2,
      "train_loss": 0.5356202945113182,
      "train_chorus_rate": 0.46826315559446813,
      "train_max_prob": 0.6021195918321609,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5438346266746521,
      "val_macro_f1": 0.6955584933370806,
      "val_verse_f1": 0.7913319633850178,
      "val_chorus_f1": 0.5997850232891436,
      "val_chorus_rate": 0.38703545928001404,
      "val_max_prob": 0.605959489941597,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008265584062373197,
      "epoch_time": 107.520840883255,
      "val_boundary_f1": 0.3155856727976767,
      "val_boundary_precision": 0.2676518883415435,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1825730403938251,
      "val_avg_segment_overlap": 0.5538411161876212,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.3900908055190537,
      "val_pk_metric": 0.30403440551704447
    },
    {
      "epoch": 3,
      "train_loss": 0.5127248972654342,
      "train_chorus_rate": 0.41420322097837925,
      "train_max_prob": 0.6316263496875762,
      "train_conf_over_90": 0.0002613642485812306,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5284350216388702,
      "val_macro_f1": 0.6166506875186697,
      "val_verse_f1": 0.6502596522917137,
      "val_chorus_f1": 0.5830417227456258,
      "val_chorus_rate": 0.6129201501607895,
      "val_max_prob": 0.6365996301174164,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000781461828470105,
      "epoch_time": 124.8141279220581,
      "val_boundary_f1": 0.17984189723320157,
      "val_boundary_precision": 0.15476190476190477,
      "val_boundary_recall": 0.21462264150943397,
      "val_complete_segments": 0.06618661723380706,
      "val_avg_segment_overlap": 0.47495426227868465,
      "val_verse_to_chorus_acc": 0.18141592920353983,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.5053101905962919,
      "val_pk_metric": 0.4034253984497132
    },
    {
      "epoch": 4,
      "train_loss": 0.5037036016583443,
      "train_chorus_rate": 0.41749436110258104,
      "train_max_prob": 0.6610753923654556,
      "train_conf_over_90": 0.002518982384935953,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5120320841670036,
      "val_macro_f1": 0.7271320454540275,
      "val_verse_f1": 0.8013129947866384,
      "val_chorus_f1": 0.6529510961214166,
      "val_chorus_rate": 0.4289815351366997,
      "val_max_prob": 0.6462381929159164,
      "val_conf_over_90": 0.0037432616227306426,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007211108276179333,
      "epoch_time": 97.46686100959778,
      "val_boundary_f1": 0.34212920837124655,
      "val_boundary_precision": 0.2785185185185185,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22990172796641514,
      "val_avg_segment_overlap": 0.6256347659992023,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4502583864882936,
      "val_pk_metric": 0.3346763034221337
    },
    {
      "epoch": 5,
      "train_loss": 0.4892299696803093,
      "train_chorus_rate": 0.3914567120373249,
      "train_max_prob": 0.660316190123558,
      "train_conf_over_90": 0.010672267852351069,
      "train_conf_over_95": 0.00015103444166015835,
      "val_loss": 0.5352986305952072,
      "val_macro_f1": 0.7501227295041728,
      "val_verse_f1": 0.8573883161512028,
      "val_chorus_f1": 0.6428571428571428,
      "val_chorus_rate": 0.272210281342268,
      "val_max_prob": 0.6990900635719299,
      "val_conf_over_90": 0.0038944597472436726,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000648143032014277,
      "epoch_time": 102.00528216362,
      "val_boundary_f1": 0.4057084607543323,
      "val_boundary_precision": 0.35727109515260325,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.26643574342407855,
      "val_avg_segment_overlap": 0.6201749453446861,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.3280704500601914,
      "val_pk_metric": 0.24318252313036176
    },
    {
      "epoch": 6,
      "train_loss": 0.4933130815625191,
      "train_chorus_rate": 0.37682232856750486,
      "train_max_prob": 0.6645071148872376,
      "train_conf_over_90": 0.003995090903481468,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5015508010983467,
      "val_macro_f1": 0.7090508326836196,
      "val_verse_f1": 0.7698557789965468,
      "val_chorus_f1": 0.6482458863706924,
      "val_chorus_rate": 0.49116309732198715,
      "val_max_prob": 0.6407343447208405,
      "val_conf_over_90": 0.0014323900977615267,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005657474844653462,
      "epoch_time": 94.4852180480957,
      "val_boundary_f1": 0.3360287511230907,
      "val_boundary_precision": 0.2714078374455733,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.21763355538541115,
      "val_avg_segment_overlap": 0.6245503412404116,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.46610594444683023,
      "val_pk_metric": 0.3404210058895019
    },
    {
      "epoch": 7,
      "train_loss": 0.4829717710614204,
      "train_chorus_rate": 0.39387422874569894,
      "train_max_prob": 0.681369099020958,
      "train_conf_over_90": 0.015429672814207152,
      "train_conf_over_95": 7.296685653273016e-05,
      "val_loss": 0.4957486018538475,
      "val_macro_f1": 0.7542106404851503,
      "val_verse_f1": 0.8337662337662337,
      "val_chorus_f1": 0.6746550472040669,
      "val_chorus_rate": 0.37730546295642853,
      "val_max_prob": 0.6873242408037186,
      "val_conf_over_90": 0.015551842283457518,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004775252657767329,
      "epoch_time": 97.32622385025024,
      "val_boundary_f1": 0.39729990356798456,
      "val_boundary_precision": 0.3360522022838499,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.30826217635602576,
      "val_avg_segment_overlap": 0.652424152852661,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3880868476862196,
      "val_pk_metric": 0.27695553223140656
    },
    {
      "epoch": 8,
      "train_loss": 0.4877018019556999,
      "train_chorus_rate": 0.3684212490916252,
      "train_max_prob": 0.6586969524621964,
      "train_conf_over_90": 0.0033480734477052466,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4935210943222046,
      "val_macro_f1": 0.7594668759662994,
      "val_verse_f1": 0.8357262726086145,
      "val_chorus_f1": 0.6832074793239842,
      "val_chorus_rate": 0.38384056091308594,
      "val_max_prob": 0.668370395898819,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003873321102423033,
      "epoch_time": 94.75324702262878,
      "val_boundary_f1": 0.4026717557251908,
      "val_boundary_precision": 0.33814102564102566,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3089980053527243,
      "val_avg_segment_overlap": 0.6732304635614024,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.38464097995364654,
      "val_pk_metric": 0.2825033497950319
    },
    {
      "epoch": 9,
      "train_loss": 0.4762666836380959,
      "train_chorus_rate": 0.39131501913070676,
      "train_max_prob": 0.6837382107973099,
      "train_conf_over_90": 0.01151925640006084,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4994817301630974,
      "val_macro_f1": 0.7682132488695488,
      "val_verse_f1": 0.8518317993142032,
      "val_chorus_f1": 0.6845946984248943,
      "val_chorus_rate": 0.34024668484926224,
      "val_max_prob": 0.6615192890167236,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002991098915536899,
      "epoch_time": 90.82564306259155,
      "val_boundary_f1": 0.42885771543086176,
      "val_boundary_precision": 0.37282229965156793,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.3261084179164773,
      "val_avg_segment_overlap": 0.6739438953358383,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3615775557307901,
      "val_pk_metric": 0.25593014243359546
    },
    {
      "epoch": 10,
      "train_loss": 0.47284753024578097,
      "train_chorus_rate": 0.3383894398808479,
      "train_max_prob": 0.6862823784351348,
      "train_conf_over_90": 0.011443569808034227,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4900728836655617,
      "val_macro_f1": 0.7564172598382914,
      "val_verse_f1": 0.8268241569822823,
      "val_chorus_f1": 0.6860103626943005,
      "val_chorus_rate": 0.41175755113363266,
      "val_max_prob": 0.6987819075584412,
      "val_conf_over_90": 0.01902365661226213,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002167143440047591,
      "epoch_time": 98.79593801498413,
      "val_boundary_f1": 0.4117073170731707,
      "val_boundary_precision": 0.35108153078202997,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3162423861522483,
      "val_avg_segment_overlap": 0.6684421447409251,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3852512018643081,
      "val_pk_metric": 0.2819335429238559
    },
    {
      "epoch": 11,
      "train_loss": 0.4655680686235428,
      "train_chorus_rate": 0.332614541053772,
      "train_max_prob": 0.6909565895795822,
      "train_conf_over_90": 0.011796443921048195,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49350980669260025,
      "val_macro_f1": 0.7519397949085449,
      "val_verse_f1": 0.8284534534534534,
      "val_chorus_f1": 0.6754261363636362,
      "val_chorus_rate": 0.3921728804707527,
      "val_max_prob": 0.6798791736364365,
      "val_conf_over_90": 0.019671180518344045,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014374654840110268,
      "epoch_time": 115.7221372127533,
      "val_boundary_f1": 0.3930968360498562,
      "val_boundary_precision": 0.33117932148626816,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.29447838233628265,
      "val_avg_segment_overlap": 0.6610502581558368,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.41024839994895185,
      "val_pk_metric": 0.2819294355961893
    },
    {
      "epoch": 12,
      "train_loss": 0.4613365203142166,
      "train_chorus_rate": 0.3768272325396538,
      "train_max_prob": 0.7001461982727051,
      "train_conf_over_90": 0.027709779888391496,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49241045862436295,
      "val_macro_f1": 0.7592574992922578,
      "val_verse_f1": 0.836647463296785,
      "val_chorus_f1": 0.6818675352877308,
      "val_chorus_rate": 0.3791997879743576,
      "val_max_prob": 0.6948542445898056,
      "val_conf_over_90": 0.03398851305246353,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.339554754893085e-05,
      "epoch_time": 96.4849910736084,
      "val_boundary_f1": 0.4181818181818182,
      "val_boundary_precision": 0.3657243816254417,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.3133576198528478,
      "val_avg_segment_overlap": 0.6695116121901175,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3828815598431657,
      "val_pk_metric": 0.274885293055839
    },
    {
      "epoch": 13,
      "train_loss": 0.4720698371529579,
      "train_chorus_rate": 0.34996204227209093,
      "train_max_prob": 0.6846417963504792,
      "train_conf_over_90": 0.019212311273440717,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49329882115125656,
      "val_macro_f1": 0.7778985461168787,
      "val_verse_f1": 0.8628774422735347,
      "val_chorus_f1": 0.6929196499602227,
      "val_chorus_rate": 0.3181166723370552,
      "val_max_prob": 0.6734368950128555,
      "val_conf_over_90": 0.0016286840836983174,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.8298969781715955e-05,
      "epoch_time": 93.54887413978577,
      "val_boundary_f1": 0.43398157625383826,
      "val_boundary_precision": 0.3833634719710669,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.3248605009342019,
      "val_avg_segment_overlap": 0.6740979870208649,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3367335247083724,
      "val_pk_metric": 0.23268870077434747
    },
    {
      "epoch": 14,
      "train_loss": 0.460698039829731,
      "train_chorus_rate": 0.30842499136924745,
      "train_max_prob": 0.6831775605678558,
      "train_conf_over_90": 0.01099411785544362,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48971017450094223,
      "val_macro_f1": 0.7493627274559201,
      "val_verse_f1": 0.8189158016147635,
      "val_chorus_f1": 0.6798096532970768,
      "val_chorus_rate": 0.4227782338857651,
      "val_max_prob": 0.6912457942962646,
      "val_conf_over_90": 0.02078795642592013,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0427751945274366e-05,
      "epoch_time": 110.9499020576477,
      "val_boundary_f1": 0.4035608308605341,
      "val_boundary_precision": 0.3475298126064736,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.28224508025674516,
      "val_avg_segment_overlap": 0.6569476479669708,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3939476107055353,
      "val_pk_metric": 0.2851630675588552
    },
    {
      "epoch": 15,
      "train_loss": 0.45628255903720855,
      "train_chorus_rate": 0.34981018453836443,
      "train_max_prob": 0.6915167927742004,
      "train_conf_over_90": 0.01788874713238329,
      "train_conf_over_95": 0.0,
      "val_loss": 0.489314541220665,
      "val_macro_f1": 0.7693635210878502,
      "val_verse_f1": 0.8469031428046314,
      "val_chorus_f1": 0.6918238993710691,
      "val_chorus_rate": 0.3642290532588959,
      "val_max_prob": 0.6943389624357224,
      "val_conf_over_90": 0.01806945912539959,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 107.60231494903564,
      "val_boundary_f1": 0.4298507462686567,
      "val_boundary_precision": 0.3717728055077453,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.329807250061757,
      "val_avg_segment_overlap": 0.6759316624674148,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3494487107829849,
      "val_pk_metric": 0.24856874324734177
    }
  ]
}