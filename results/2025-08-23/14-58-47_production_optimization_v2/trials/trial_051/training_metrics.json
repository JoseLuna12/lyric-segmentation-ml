{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1733674839522236,
      "layer_dropout": 0.25325969396709924,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.12326010403501936,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2715139,
      "lstm_params": 2154496,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0005780752753894838,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.017035157061812592,
      "gradient_clip_norm": 0.574268977307728,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08367490843084802,
        "ece_after": 0.016323834672306768,
        "improvement": 0.06735107375854124,
        "params": {
          "temperature": 0.5688150780176413
        }
      },
      "platt": {
        "ece_before": 0.08367490843084802,
        "ece_after": 0.032778242262618225,
        "improvement": 0.05089666616822979,
        "params": {
          "A": 1.4999967322195504,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5659768730401993,
      "train_chorus_rate": 0.6673727525863796,
      "train_max_prob": 0.5762675344944,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5784638524055481,
      "val_macro_f1": 0.43813265834696197,
      "val_verse_f1": 0.8220017508024511,
      "val_chorus_f1": 0.054263565891472874,
      "val_chorus_rate": 0.01696888473816216,
      "val_max_prob": 0.5703570544719696,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005717700357272538,
      "epoch_time": 37.13970398902893,
      "val_boundary_f1": 0.013636363636363637,
      "val_boundary_precision": 0.1875,
      "val_boundary_recall": 0.007075471698113208,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.1730233973537641,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.2768556373740388,
      "val_pk_metric": 0.28337160755859336
    },
    {
      "epoch": 2,
      "train_loss": 0.5451717332005501,
      "train_chorus_rate": 0.4731231858721003,
      "train_max_prob": 0.5705320417881012,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5629318207502365,
      "val_macro_f1": 0.5179855119609472,
      "val_verse_f1": 0.615761535320539,
      "val_chorus_f1": 0.42020948860135543,
      "val_chorus_rate": 0.4974401742219925,
      "val_max_prob": 0.5424706935882568,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005531298859696998,
      "epoch_time": 33.63793325424194,
      "val_boundary_f1": 0.03683241252302026,
      "val_boundary_precision": 0.08403361344537816,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.012974726734005633,
      "val_avg_segment_overlap": 0.21402611422158513,
      "val_verse_to_chorus_acc": 0.017699115044247787,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4357094147268636,
      "val_pk_metric": 0.4539844454446826
    },
    {
      "epoch": 3,
      "train_loss": 0.5323687314987182,
      "train_chorus_rate": 0.5249720759689808,
      "train_max_prob": 0.5622574597597122,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5612889230251312,
      "val_macro_f1": 0.505446228181222,
      "val_verse_f1": 0.5545129579982128,
      "val_chorus_f1": 0.4563794983642312,
      "val_chorus_rate": 0.6013377904891968,
      "val_max_prob": 0.5606452524662018,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005229694901065895,
      "epoch_time": 41.423877000808716,
      "val_boundary_f1": 0.04744525547445255,
      "val_boundary_precision": 0.10483870967741936,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.01263139559799157,
      "val_avg_segment_overlap": 0.21440195932280653,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44022214649462205,
      "val_pk_metric": 0.46005161179312604
    },
    {
      "epoch": 4,
      "train_loss": 0.5235655769705773,
      "train_chorus_rate": 0.6011699795722961,
      "train_max_prob": 0.5744967460632324,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5689675956964493,
      "val_macro_f1": 0.5449308742086445,
      "val_verse_f1": 0.6295299233795817,
      "val_chorus_f1": 0.4603318250377074,
      "val_chorus_rate": 0.5151912271976471,
      "val_max_prob": 0.5695290118455887,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004826070021627771,
      "epoch_time": 47.792739152908325,
      "val_boundary_f1": 0.07299270072992702,
      "val_boundary_precision": 0.16129032258064516,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.032238478062974356,
      "val_avg_segment_overlap": 0.2231297971211786,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.38953793146665133,
      "val_pk_metric": 0.39560473153828635
    },
    {
      "epoch": 5,
      "train_loss": 0.534247724711895,
      "train_chorus_rate": 0.5819620430469513,
      "train_max_prob": 0.5707825571298599,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5629552900791168,
      "val_macro_f1": 0.42325762762927677,
      "val_verse_f1": 0.3707106187516887,
      "val_chorus_f1": 0.4758046365068648,
      "val_chorus_rate": 0.7928346395492554,
      "val_max_prob": 0.6027241051197052,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043380645654211283,
      "epoch_time": 33.66292977333069,
      "val_boundary_f1": 0.03992740471869328,
      "val_boundary_precision": 0.08661417322834646,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.017136292480937232,
      "val_avg_segment_overlap": 0.18096360359969568,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4380735899713346,
      "val_pk_metric": 0.43948980118094627
    },
    {
      "epoch": 6,
      "train_loss": 0.5386922806501389,
      "train_chorus_rate": 0.5882214305922389,
      "train_max_prob": 0.5688579320907593,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5653006881475449,
      "val_macro_f1": 0.5684907487787701,
      "val_verse_f1": 0.6958665149791431,
      "val_chorus_f1": 0.44111498257839726,
      "val_chorus_rate": 0.406044602394104,
      "val_max_prob": 0.5674729198217392,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003787006712592186,
      "epoch_time": 35.52569389343262,
      "val_boundary_f1": 0.1094017094017094,
      "val_boundary_precision": 0.19875776397515527,
      "val_boundary_recall": 0.07547169811320754,
      "val_complete_segments": 0.0651154411493754,
      "val_avg_segment_overlap": 0.27063546218438295,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.3137547499340967,
      "val_pk_metric": 0.29776650764230983
    },
    {
      "epoch": 7,
      "train_loss": 0.5211115807294846,
      "train_chorus_rate": 0.5604909300804138,
      "train_max_prob": 0.5720723479986191,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5582060515880585,
      "val_macro_f1": 0.5991941065194322,
      "val_verse_f1": 0.6964426877470357,
      "val_chorus_f1": 0.5019455252918288,
      "val_chorus_rate": 0.45877406001091003,
      "val_max_prob": 0.5860632061958313,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003196980335578523,
      "epoch_time": 45.55643177032471,
      "val_boundary_f1": 0.11782477341389727,
      "val_boundary_precision": 0.1638655462184874,
      "val_boundary_recall": 0.09198113207547169,
      "val_complete_segments": 0.05064498485760416,
      "val_avg_segment_overlap": 0.31195149784043835,
      "val_verse_to_chorus_acc": 0.10619469026548672,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3851518554750307,
      "val_pk_metric": 0.35548163098296104
    },
    {
      "epoch": 8,
      "train_loss": 0.5283900424838066,
      "train_chorus_rate": 0.6008645415306091,
      "train_max_prob": 0.5932940870523453,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.540189266204834,
      "val_macro_f1": 0.5724341134414914,
      "val_verse_f1": 0.634804972138877,
      "val_chorus_f1": 0.5100632547441059,
      "val_chorus_rate": 0.554942324757576,
      "val_max_prob": 0.591274619102478,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002593772418316317,
      "epoch_time": 36.098626136779785,
      "val_boundary_f1": 0.13486005089058523,
      "val_boundary_precision": 0.1464088397790055,
      "val_boundary_recall": 0.125,
      "val_complete_segments": 0.050722624609156955,
      "val_avg_segment_overlap": 0.36726034417066095,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.09595959595959595,
      "val_window_diff": 0.43462682891324883,
      "val_pk_metric": 0.38873429858037184
    },
    {
      "epoch": 9,
      "train_loss": 0.5110549494624138,
      "train_chorus_rate": 0.4901510700583458,
      "train_max_prob": 0.6075655996799469,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.534657433629036,
      "val_macro_f1": 0.6545063881118776,
      "val_verse_f1": 0.7642124883504194,
      "val_chorus_f1": 0.5448002878733357,
      "val_chorus_rate": 0.38411034643650055,
      "val_max_prob": 0.6104468107223511,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020037460413026528,
      "epoch_time": 35.452946186065674,
      "val_boundary_f1": 0.2310924369747899,
      "val_boundary_precision": 0.20833333333333334,
      "val_boundary_recall": 0.25943396226415094,
      "val_complete_segments": 0.09121990116157666,
      "val_avg_segment_overlap": 0.5104524048745043,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.43764388699692724,
      "val_pk_metric": 0.38242309360180327
    },
    {
      "epoch": 10,
      "train_loss": 0.503556826710701,
      "train_chorus_rate": 0.48093738704919814,
      "train_max_prob": 0.6244775295257569,
      "train_conf_over_90": 0.0003076864639297128,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5255215838551521,
      "val_macro_f1": 0.6681426894626024,
      "val_verse_f1": 0.7696069211961631,
      "val_chorus_f1": 0.5666784577290415,
      "val_chorus_rate": 0.3956857770681381,
      "val_max_prob": 0.6481782644987106,
      "val_conf_over_90": 0.000798722030594945,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014526881884737103,
      "epoch_time": 38.74661684036255,
      "val_boundary_f1": 0.2633228840125392,
      "val_boundary_precision": 0.23639774859287055,
      "val_boundary_recall": 0.2971698113207547,
      "val_complete_segments": 0.10084412544645843,
      "val_avg_segment_overlap": 0.5306953430880275,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.44204765445869554,
      "val_pk_metric": 0.375063092524111
    },
    {
      "epoch": 11,
      "train_loss": 0.5024310275912285,
      "train_chorus_rate": 0.44814064502716067,
      "train_max_prob": 0.6404646098613739,
      "train_conf_over_90": 0.0002505794807802886,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5203345641493797,
      "val_macro_f1": 0.658188130678199,
      "val_verse_f1": 0.754217791411043,
      "val_chorus_f1": 0.5621584699453551,
      "val_chorus_rate": 0.42085494101047516,
      "val_max_prob": 0.6235091239213943,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.64682732267068e-05,
      "epoch_time": 32.42071318626404,
      "val_boundary_f1": 0.2032854209445585,
      "val_boundary_precision": 0.18,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.08995567488409484,
      "val_avg_segment_overlap": 0.5203904326711478,
      "val_verse_to_chorus_acc": 0.21238938053097345,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.46323195837429804,
      "val_pk_metric": 0.38297379293953565
    },
    {
      "epoch": 12,
      "train_loss": 0.4959097787737846,
      "train_chorus_rate": 0.44388049095869064,
      "train_max_prob": 0.6284714102745056,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5168637335300446,
      "val_macro_f1": 0.662032935680329,
      "val_verse_f1": 0.7509235854559595,
      "val_chorus_f1": 0.5731422859046984,
      "val_chorus_rate": 0.4385203719139099,
      "val_max_prob": 0.642650917172432,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.610578528289429e-05,
      "epoch_time": 400.78007912635803,
      "val_boundary_f1": 0.2261048304213772,
      "val_boundary_precision": 0.20036429872495445,
      "val_boundary_recall": 0.25943396226415094,
      "val_complete_segments": 0.09337482650048927,
      "val_avg_segment_overlap": 0.5364849065782367,
      "val_verse_to_chorus_acc": 0.22566371681415928,
      "val_chorus_to_verse_acc": 0.25252525252525254,
      "val_window_diff": 0.4534709381606802,
      "val_pk_metric": 0.37871719744103466
    },
    {
      "epoch": 13,
      "train_loss": 0.4824997022747993,
      "train_chorus_rate": 0.40225100368261335,
      "train_max_prob": 0.6438927173614502,
      "train_conf_over_90": 0.0006459911877755075,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5194895565509796,
      "val_macro_f1": 0.6821459870286624,
      "val_verse_f1": 0.7901008249312557,
      "val_chorus_f1": 0.5741911491260692,
      "val_chorus_rate": 0.3619144782423973,
      "val_max_prob": 0.6377929300069809,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.594538941978392e-05,
      "epoch_time": 40.69909191131592,
      "val_boundary_f1": 0.2552763819095477,
      "val_boundary_precision": 0.2224168126094571,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.12030491899261782,
      "val_avg_segment_overlap": 0.5500735129752543,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.41745155805682127,
      "val_pk_metric": 0.3408616883311846
    },
    {
      "epoch": 14,
      "train_loss": 0.491015100479126,
      "train_chorus_rate": 0.4110159143805504,
      "train_max_prob": 0.6375042289495468,
      "train_conf_over_90": 0.0009726490068715065,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5154680088162422,
      "val_macro_f1": 0.6781925727281986,
      "val_verse_f1": 0.7749244712990937,
      "val_chorus_f1": 0.5814606741573033,
      "val_chorus_rate": 0.40083929151296616,
      "val_max_prob": 0.6409841477870941,
      "val_conf_over_90": 0.0004975080228177831,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.305239662230019e-06,
      "epoch_time": 44.43746304512024,
      "val_boundary_f1": 0.2636916835699797,
      "val_boundary_precision": 0.2313167259786477,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.11714347471240366,
      "val_avg_segment_overlap": 0.5537717869050536,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.43206032319876886,
      "val_pk_metric": 0.34272156454615277
    },
    {
      "epoch": 15,
      "train_loss": 0.4841679438948631,
      "train_chorus_rate": 0.4047832012176514,
      "train_max_prob": 0.6471773892641067,
      "train_conf_over_90": 0.0012971149175427855,
      "train_conf_over_95": 0.0,
      "val_loss": 0.516802042722702,
      "val_macro_f1": 0.6866860650985365,
      "val_verse_f1": 0.7904059040590405,
      "val_chorus_f1": 0.5829662261380323,
      "val_chorus_rate": 0.3703429102897644,
      "val_max_prob": 0.637502908706665,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 44.08156490325928,
      "val_boundary_f1": 0.27635619242579323,
      "val_boundary_precision": 0.244122965641953,
      "val_boundary_recall": 0.31839622641509435,
      "val_complete_segments": 0.13685307031012228,
      "val_avg_segment_overlap": 0.5596804492058676,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.3282828282828283,
      "val_window_diff": 0.3910409704931407,
      "val_pk_metric": 0.3236240368532941
    }
  ]
}