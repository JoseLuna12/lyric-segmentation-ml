{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.15453567876713586,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007034038160416916,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.020467112307467186,
      "gradient_clip_norm": 0.6120884727849795,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06424940471155004,
        "ece_after": 0.013710721639261268,
        "improvement": 0.05053868307228877,
        "params": {
          "temperature": 0.7001100917067893
        }
      },
      "platt": {
        "ece_before": 0.06424940471155004,
        "ece_after": 0.02015171977297967,
        "improvement": 0.04409768493857037,
        "params": {
          "A": 1.32788521476828,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5482936933636665,
      "train_chorus_rate": 0.35419911553617567,
      "train_max_prob": 0.5488788157701492,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5816898196935654,
      "val_macro_f1": 0.5795127015649977,
      "val_verse_f1": 0.7958488730338901,
      "val_chorus_f1": 0.3631765300961052,
      "val_chorus_rate": 0.18628015741705894,
      "val_max_prob": 0.5822985172271729,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006957292117245708,
      "epoch_time": 162.34654903411865,
      "val_boundary_f1": 0.15827338129496404,
      "val_boundary_precision": 0.2029520295202952,
      "val_boundary_recall": 0.12971698113207547,
      "val_complete_segments": 0.042954759789330305,
      "val_avg_segment_overlap": 0.2773724128182486,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.1111111111111111,
      "val_window_diff": 0.39616646893469176,
      "val_pk_metric": 0.37126052148871935
    },
    {
      "epoch": 2,
      "train_loss": 0.5425904989242554,
      "train_chorus_rate": 0.3583688370883465,
      "train_max_prob": 0.5757335543632507,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.547140896320343,
      "val_macro_f1": 0.6626396343579365,
      "val_verse_f1": 0.7609811751283514,
      "val_chorus_f1": 0.5642980935875216,
      "val_chorus_rate": 0.40893378108739853,
      "val_max_prob": 0.5781671851873398,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006730408158087039,
      "epoch_time": 99.853022813797,
      "val_boundary_f1": 0.292910447761194,
      "val_boundary_precision": 0.24228395061728394,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.12894876015236567,
      "val_avg_segment_overlap": 0.5137232233360013,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4457704036075229,
      "val_pk_metric": 0.3718004962176099
    },
    {
      "epoch": 3,
      "train_loss": 0.5039338529109955,
      "train_chorus_rate": 0.41049126610159875,
      "train_max_prob": 0.6110464870929718,
      "train_conf_over_90": 0.00023096705263014883,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5178699716925621,
      "val_macro_f1": 0.685673757745122,
      "val_verse_f1": 0.7765288626405029,
      "val_chorus_f1": 0.594818652849741,
      "val_chorus_rate": 0.41164160519838333,
      "val_max_prob": 0.6421681642532349,
      "val_conf_over_90": 0.002833230304531753,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006363302200666171,
      "epoch_time": 122.1227650642395,
      "val_boundary_f1": 0.29385574354407834,
      "val_boundary_precision": 0.23605150214592274,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.15601415496696514,
      "val_avg_segment_overlap": 0.556519331626738,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.44479904625842986,
      "val_pk_metric": 0.34797042941204853
    },
    {
      "epoch": 4,
      "train_loss": 0.47838337272405623,
      "train_chorus_rate": 0.34217130988836286,
      "train_max_prob": 0.6635141879320144,
      "train_conf_over_90": 0.010825132322497665,
      "train_conf_over_95": 0.0001717444189125672,
      "val_loss": 0.4985494911670685,
      "val_macro_f1": 0.6958876417445286,
      "val_verse_f1": 0.7698992692079794,
      "val_chorus_f1": 0.6218760142810776,
      "val_chorus_rate": 0.4580320715904236,
      "val_max_prob": 0.6494349092245102,
      "val_conf_over_90": 0.004588261770550162,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005872018536892222,
      "epoch_time": 103.45812487602234,
      "val_boundary_f1": 0.29974597798475866,
      "val_boundary_precision": 0.23381770145310435,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.16246077921581634,
      "val_avg_segment_overlap": 0.5826860730960954,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.45387276548475763,
      "val_pk_metric": 0.3418720076789331
    },
    {
      "epoch": 5,
      "train_loss": 0.46823218613862994,
      "train_chorus_rate": 0.3532092571258545,
      "train_max_prob": 0.6745342463254929,
      "train_conf_over_90": 0.019616757717449217,
      "train_conf_over_95": 0.0005664428230375051,
      "val_loss": 0.49349140375852585,
      "val_macro_f1": 0.7240584482175391,
      "val_verse_f1": 0.8237416561428827,
      "val_chorus_f1": 0.6243752402921954,
      "val_chorus_rate": 0.34023385494947433,
      "val_max_prob": 0.6882613301277161,
      "val_conf_over_90": 0.029156929813325405,
      "val_conf_over_95": 0.0007385880599031225,
      "learning_rate": 0.0005278028620312686,
      "epoch_time": 112.81688284873962,
      "val_boundary_f1": 0.35614035087719303,
      "val_boundary_precision": 0.2835195530726257,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2600203217912656,
      "val_avg_segment_overlap": 0.6239904046832556,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.437334574835304,
      "val_pk_metric": 0.31283766269944113
    },
    {
      "epoch": 6,
      "train_loss": 0.45097993314266205,
      "train_chorus_rate": 0.34554163441061975,
      "train_max_prob": 0.6923159092664719,
      "train_conf_over_90": 0.03927385788410902,
      "train_conf_over_95": 0.002636214008089155,
      "val_loss": 0.4838741421699524,
      "val_macro_f1": 0.693867027261581,
      "val_verse_f1": 0.7579203899268888,
      "val_chorus_f1": 0.6298136645962732,
      "val_chorus_rate": 0.491902194917202,
      "val_max_prob": 0.6768466234207153,
      "val_conf_over_90": 0.023090197704732418,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.0004607292660561942,
      "epoch_time": 122.59574294090271,
      "val_boundary_f1": 0.29830508474576267,
      "val_boundary_precision": 0.2328042328042328,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.18287493295446638,
      "val_avg_segment_overlap": 0.5897106977282923,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.47359638992171726,
      "val_pk_metric": 0.34423340903408567
    },
    {
      "epoch": 7,
      "train_loss": 0.4520535573363304,
      "train_chorus_rate": 0.37763113528490067,
      "train_max_prob": 0.700414851307869,
      "train_conf_over_90": 0.05397487552836537,
      "train_conf_over_95": 0.00460417058202438,
      "val_loss": 0.48835132271051407,
      "val_macro_f1": 0.7061560705842621,
      "val_verse_f1": 0.7921732522796353,
      "val_chorus_f1": 0.6201388888888889,
      "val_chorus_rate": 0.4085330665111542,
      "val_max_prob": 0.694238469004631,
      "val_conf_over_90": 0.046562024392187595,
      "val_conf_over_95": 0.004662795807234943,
      "learning_rate": 0.00038891250376293257,
      "epoch_time": 128.95336890220642,
      "val_boundary_f1": 0.31901840490797545,
      "val_boundary_precision": 0.25383542538354253,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.18324614001973494,
      "val_avg_segment_overlap": 0.6031040011229019,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.46427521616998135,
      "val_pk_metric": 0.33849227836599144
    },
    {
      "epoch": 8,
      "train_loss": 0.4472270533442497,
      "train_chorus_rate": 0.3691631451249123,
      "train_max_prob": 0.7060621321201325,
      "train_conf_over_90": 0.051230549719184636,
      "train_conf_over_95": 0.005329649185296148,
      "val_loss": 0.47418519109487534,
      "val_macro_f1": 0.7218062987461744,
      "val_verse_f1": 0.8022857142857143,
      "val_chorus_f1": 0.6413268832066344,
      "val_chorus_rate": 0.41172700375318527,
      "val_max_prob": 0.7050579190254211,
      "val_conf_over_90": 0.040790118277072906,
      "val_conf_over_95": 0.001954748877324164,
      "learning_rate": 0.00031549131227875905,
      "epoch_time": 109.18442702293396,
      "val_boundary_f1": 0.3581560283687943,
      "val_boundary_precision": 0.2869318181818182,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24233966393298312,
      "val_avg_segment_overlap": 0.616221092073843,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4451889742229408,
      "val_pk_metric": 0.3124197482536299
    },
    {
      "epoch": 9,
      "train_loss": 0.4426172137260437,
      "train_chorus_rate": 0.3542014315724373,
      "train_max_prob": 0.710739117860794,
      "train_conf_over_90": 0.05853986535221338,
      "train_conf_over_95": 0.0058183621906209735,
      "val_loss": 0.4757044091820717,
      "val_macro_f1": 0.6909647218675931,
      "val_verse_f1": 0.7563842723956222,
      "val_chorus_f1": 0.6255451713395639,
      "val_chorus_rate": 0.4893152266740799,
      "val_max_prob": 0.6996408104896545,
      "val_conf_over_90": 0.0567615469917655,
      "val_conf_over_95": 0.007602438214235008,
      "learning_rate": 0.0002436745499854973,
      "epoch_time": 111.79297208786011,
      "val_boundary_f1": 0.278503046127067,
      "val_boundary_precision": 0.2206896551724138,
      "val_boundary_recall": 0.37735849056603776,
      "val_complete_segments": 0.1604242668664726,
      "val_avg_segment_overlap": 0.5767929032739276,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4853475391937231,
      "val_pk_metric": 0.3517939233199016
    },
    {
      "epoch": 10,
      "train_loss": 0.4466275587677956,
      "train_chorus_rate": 0.38045824021101,
      "train_max_prob": 0.7163264185190201,
      "train_conf_over_90": 0.07005197107791901,
      "train_conf_over_95": 0.010325146582908928,
      "val_loss": 0.4766033738851547,
      "val_macro_f1": 0.7359718353786109,
      "val_verse_f1": 0.8231166912850811,
      "val_chorus_f1": 0.6488269794721407,
      "val_chorus_rate": 0.3712262809276581,
      "val_max_prob": 0.7050254344940186,
      "val_conf_over_90": 0.047934393398463726,
      "val_conf_over_95": 0.005149871343746781,
      "learning_rate": 0.00017660095401042294,
      "epoch_time": 104.76934099197388,
      "val_boundary_f1": 0.33895297249334516,
      "val_boundary_precision": 0.2716927453769559,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.21970193568814989,
      "val_avg_segment_overlap": 0.6336786339755864,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.46106798623644196,
      "val_pk_metric": 0.3228826007637131
    },
    {
      "epoch": 11,
      "train_loss": 0.45055660605430603,
      "train_chorus_rate": 0.3608666077256203,
      "train_max_prob": 0.7112092912197113,
      "train_conf_over_90": 0.06370157506316901,
      "train_conf_over_95": 0.009333034988958388,
      "val_loss": 0.47053611278533936,
      "val_macro_f1": 0.7424089068825912,
      "val_verse_f1": 0.8269230769230771,
      "val_chorus_f1": 0.6578947368421052,
      "val_chorus_rate": 0.37337855994701385,
      "val_max_prob": 0.708700641989708,
      "val_conf_over_90": 0.05420692078769207,
      "val_conf_over_95": 0.004566834366414696,
      "learning_rate": 0.00011720196235246938,
      "epoch_time": 98.26612520217896,
      "val_boundary_f1": 0.36460176991150445,
      "val_boundary_precision": 0.29178470254957506,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.24675044116984735,
      "val_avg_segment_overlap": 0.6342024093973637,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4363571617394489,
      "val_pk_metric": 0.3062963783103316
    },
    {
      "epoch": 12,
      "train_loss": 0.4302219614386559,
      "train_chorus_rate": 0.3550861418247223,
      "train_max_prob": 0.7169971883296966,
      "train_conf_over_90": 0.06896911263465881,
      "train_conf_over_95": 0.009351506415987388,
      "val_loss": 0.4684665873646736,
      "val_macro_f1": 0.7334845498907999,
      "val_verse_f1": 0.8156906906906908,
      "val_chorus_f1": 0.6512784090909091,
      "val_chorus_rate": 0.3928411230444908,
      "val_max_prob": 0.70976422727108,
      "val_conf_over_90": 0.05749225523322821,
      "val_conf_over_95": 0.005757834645919502,
      "learning_rate": 6.80735959750744e-05,
      "epoch_time": 113.44082570075989,
      "val_boundary_f1": 0.34829443447037706,
      "val_boundary_precision": 0.2811594202898551,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2328488312581632,
      "val_avg_segment_overlap": 0.6218600567215158,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4437225244247099,
      "val_pk_metric": 0.3116518748093101
    },
    {
      "epoch": 13,
      "train_loss": 0.42472701519727707,
      "train_chorus_rate": 0.3385579749941826,
      "train_max_prob": 0.7227406412363052,
      "train_conf_over_90": 0.07165812272578478,
      "train_conf_over_95": 0.00823366100084968,
      "val_loss": 0.4673618897795677,
      "val_macro_f1": 0.7320128439880053,
      "val_verse_f1": 0.8128301886792454,
      "val_chorus_f1": 0.6511954992967651,
      "val_chorus_rate": 0.3996608406305313,
      "val_max_prob": 0.7128309160470963,
      "val_conf_over_90": 0.06062232702970505,
      "val_conf_over_95": 0.005757834645919502,
      "learning_rate": 3.136300023298756e-05,
      "epoch_time": 111.0319139957428,
      "val_boundary_f1": 0.35103510351035105,
      "val_boundary_precision": 0.2838427947598253,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2402384944405093,
      "val_avg_segment_overlap": 0.6210538128451061,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4403012446896751,
      "val_pk_metric": 0.3157610936154952
    },
    {
      "epoch": 14,
      "train_loss": 0.433533550798893,
      "train_chorus_rate": 0.35075783133506777,
      "train_max_prob": 0.7203343719244003,
      "train_conf_over_90": 0.0706681115552783,
      "train_conf_over_95": 0.009632643102668226,
      "val_loss": 0.4670865014195442,
      "val_macro_f1": 0.7307564846090115,
      "val_verse_f1": 0.8122171945701359,
      "val_chorus_f1": 0.6492957746478873,
      "val_chorus_rate": 0.39866581559181213,
      "val_max_prob": 0.7121754437685013,
      "val_conf_over_90": 0.06036131363362074,
      "val_conf_over_95": 0.005757834645919502,
      "learning_rate": 8.674604317120771e-06,
      "epoch_time": 100.6511070728302,
      "val_boundary_f1": 0.34735899731423464,
      "val_boundary_precision": 0.27994227994227994,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.22910124182658648,
      "val_avg_segment_overlap": 0.6175370869583375,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4508307289711308,
      "val_pk_metric": 0.31655439972033766
    }
  ]
}