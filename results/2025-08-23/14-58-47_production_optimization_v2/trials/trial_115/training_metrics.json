{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.29734717007415234,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2819921670737123,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1867010,
      "lstm_params": 1339392,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009256353698442996,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.02093870224701764,
      "gradient_clip_norm": 0.37217309794477066,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10227301425514612,
        "ece_after": 0.04114634340193513,
        "improvement": 0.06112667085321099,
        "params": {
          "temperature": 0.5872721631088266
        }
      },
      "platt": {
        "ece_before": 0.10227301425514612,
        "ece_after": 0.05409816711087125,
        "improvement": 0.04817484714427487,
        "params": {
          "A": 1.4999974384450716,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6046800941228867,
      "train_chorus_rate": 0.4853653487516567,
      "train_max_prob": 0.6333448946475982,
      "train_conf_over_90": 0.0015272244811058045,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5599720776081085,
      "val_macro_f1": 0.49435096955609265,
      "val_verse_f1": 0.4785804816223067,
      "val_chorus_f1": 0.5101214574898786,
      "val_chorus_rate": 0.7314874529838562,
      "val_max_prob": 0.5476032644510269,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009155326192055581,
      "epoch_time": 102.70157384872437,
      "val_boundary_f1": 0.0868217054263566,
      "val_boundary_precision": 0.12669683257918551,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.024236380373708052,
      "val_avg_segment_overlap": 0.24574949057024364,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.4484002472203843,
      "val_pk_metric": 0.4532904456399301
    },
    {
      "epoch": 2,
      "train_loss": 0.5349916651844978,
      "train_chorus_rate": 0.5285096101462841,
      "train_max_prob": 0.5742338091135025,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5562763065099716,
      "val_macro_f1": 0.6491974824271436,
      "val_verse_f1": 0.8246848911442135,
      "val_chorus_f1": 0.47371007371007373,
      "val_chorus_rate": 0.20108694583177567,
      "val_max_prob": 0.5836201459169388,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008856659059706227,
      "epoch_time": 97.73136019706726,
      "val_boundary_f1": 0.33333333333333337,
      "val_boundary_precision": 0.2876712328767123,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.1948770047126357,
      "val_avg_segment_overlap": 0.4728492238359628,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.3793646930879582,
      "val_pk_metric": 0.3028071791444267
    },
    {
      "epoch": 3,
      "train_loss": 0.5259772703051567,
      "train_chorus_rate": 0.4326504997909069,
      "train_max_prob": 0.6222610861063004,
      "train_conf_over_90": 0.00032247757189907134,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5349517315626144,
      "val_macro_f1": 0.541161997657896,
      "val_verse_f1": 0.5286543802070184,
      "val_chorus_f1": 0.5536696151087735,
      "val_chorus_rate": 0.7282322347164154,
      "val_max_prob": 0.6618190854787827,
      "val_conf_over_90": 0.0014170421636663377,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008373405488242513,
      "epoch_time": 101.53906893730164,
      "val_boundary_f1": 0.125,
      "val_boundary_precision": 0.11864406779661017,
      "val_boundary_recall": 0.1320754716981132,
      "val_complete_segments": 0.0436673019785427,
      "val_avg_segment_overlap": 0.3677971707953972,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.14646464646464646,
      "val_window_diff": 0.4653107281824505,
      "val_pk_metric": 0.38865532662884184
    },
    {
      "epoch": 4,
      "train_loss": 0.49714342802762984,
      "train_chorus_rate": 0.45752336755394934,
      "train_max_prob": 0.6559726089239121,
      "train_conf_over_90": 0.002266660417080857,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5187069475650787,
      "val_macro_f1": 0.6338132836206134,
      "val_verse_f1": 0.6668168506420366,
      "val_chorus_f1": 0.6008097165991904,
      "val_chorus_rate": 0.610587865114212,
      "val_max_prob": 0.6687746196985245,
      "val_conf_over_90": 0.012855082051828504,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007726685977645315,
      "epoch_time": 103.50899982452393,
      "val_boundary_f1": 0.2571428571428571,
      "val_boundary_precision": 0.22661870503597123,
      "val_boundary_recall": 0.2971698113207547,
      "val_complete_segments": 0.13166968286268393,
      "val_avg_segment_overlap": 0.5203632407748722,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.30303030303030304,
      "val_window_diff": 0.44983348649633603,
      "val_pk_metric": 0.35722459009616575
    },
    {
      "epoch": 5,
      "train_loss": 0.48994573652744294,
      "train_chorus_rate": 0.3789760902523994,
      "train_max_prob": 0.6605589210987091,
      "train_conf_over_90": 0.0032277866557706147,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5178691670298576,
      "val_macro_f1": 0.7468625343571578,
      "val_verse_f1": 0.848378615249781,
      "val_chorus_f1": 0.6453464534645346,
      "val_chorus_rate": 0.300530768930912,
      "val_max_prob": 0.6662552058696747,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006944765273832247,
      "epoch_time": 84.70542001724243,
      "val_boundary_f1": 0.4245374878286271,
      "val_boundary_precision": 0.3615257048092869,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3332144938454588,
      "val_avg_segment_overlap": 0.642033922638228,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3521990770515388,
      "val_pk_metric": 0.249485551148959
    },
    {
      "epoch": 6,
      "train_loss": 0.482608500123024,
      "train_chorus_rate": 0.3569320350885391,
      "train_max_prob": 0.663214099407196,
      "train_conf_over_90": 0.004569159940001555,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5084754973649979,
      "val_macro_f1": 0.6947880278414172,
      "val_verse_f1": 0.7501039501039503,
      "val_chorus_f1": 0.6394721055788842,
      "val_chorus_rate": 0.5199833810329437,
      "val_max_prob": 0.7144816815853119,
      "val_conf_over_90": 0.053447142243385315,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006061817063631765,
      "epoch_time": 90.32416677474976,
      "val_boundary_f1": 0.34989648033126297,
      "val_boundary_precision": 0.3118081180811808,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.23150797176512977,
      "val_avg_segment_overlap": 0.5723039103672344,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4327092065728453,
      "val_pk_metric": 0.3365462843927604
    },
    {
      "epoch": 7,
      "train_loss": 0.4795925959944725,
      "train_chorus_rate": 0.39971409887075426,
      "train_max_prob": 0.6733508020639419,
      "train_conf_over_90": 0.01019065074797254,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4924435317516327,
      "val_macro_f1": 0.7440413416269589,
      "val_verse_f1": 0.8150711264898116,
      "val_chorus_f1": 0.6730115567641061,
      "val_chorus_rate": 0.42332808673381805,
      "val_max_prob": 0.6692257672548294,
      "val_conf_over_90": 0.004623235028702766,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005116430420685214,
      "epoch_time": 100.30772137641907,
      "val_boundary_f1": 0.4072727272727273,
      "val_boundary_precision": 0.33136094674556216,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3291932289811399,
      "val_avg_segment_overlap": 0.669690394059694,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.41534453816494343,
      "val_pk_metric": 0.28806778518837034
    },
    {
      "epoch": 8,
      "train_loss": 0.4783514514565468,
      "train_chorus_rate": 0.35986123979091644,
      "train_max_prob": 0.6749135583639145,
      "train_conf_over_90": 0.008367285353597254,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49158886075019836,
      "val_macro_f1": 0.7440113624103203,
      "val_verse_f1": 0.8181298800228528,
      "val_chorus_f1": 0.6698928447977878,
      "val_chorus_rate": 0.41183173656463623,
      "val_max_prob": 0.689869225025177,
      "val_conf_over_90": 0.0023421116056852043,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004149923277757784,
      "epoch_time": 87.97832107543945,
      "val_boundary_f1": 0.4057971014492754,
      "val_boundary_precision": 0.3436988543371522,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.30747898898747256,
      "val_avg_segment_overlap": 0.6590831218593056,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.39279189396574,
      "val_pk_metric": 0.29081176099449535
    },
    {
      "epoch": 9,
      "train_loss": 0.47784732580184935,
      "train_chorus_rate": 0.3872374251484871,
      "train_max_prob": 0.6722820609807968,
      "train_conf_over_90": 0.006909272389020771,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49813392758369446,
      "val_macro_f1": 0.7181822606748682,
      "val_verse_f1": 0.7801932367149759,
      "val_chorus_f1": 0.6561712846347607,
      "val_chorus_rate": 0.4813108667731285,
      "val_max_prob": 0.7041405439376831,
      "val_conf_over_90": 0.0726940706372261,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032045366348112324,
      "epoch_time": 90.40535116195679,
      "val_boundary_f1": 0.3641674780915288,
      "val_boundary_precision": 0.3101160862354892,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2590361001813812,
      "val_avg_segment_overlap": 0.6337841151744789,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.42829007557793924,
      "val_pk_metric": 0.32535740730116974
    },
    {
      "epoch": 10,
      "train_loss": 0.45810628682374954,
      "train_chorus_rate": 0.35970679894089697,
      "train_max_prob": 0.6946945458650589,
      "train_conf_over_90": 0.027894854289479555,
      "train_conf_over_95": 6.922382162883877e-05,
      "val_loss": 0.49804455041885376,
      "val_macro_f1": 0.7355414064851694,
      "val_verse_f1": 0.8075661069291644,
      "val_chorus_f1": 0.6635167060411744,
      "val_chorus_rate": 0.4286515340209007,
      "val_max_prob": 0.7015826106071472,
      "val_conf_over_90": 0.03617348801344633,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023215884246107502,
      "epoch_time": 99.5038001537323,
      "val_boundary_f1": 0.4110898661567877,
      "val_boundary_precision": 0.34565916398713825,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2859597951989256,
      "val_avg_segment_overlap": 0.6553018102553138,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.42522169410063304,
      "val_pk_metric": 0.30778537383423293
    },
    {
      "epoch": 11,
      "train_loss": 0.4696090713143349,
      "train_chorus_rate": 0.37658477649092675,
      "train_max_prob": 0.6744594126939774,
      "train_conf_over_90": 0.011569755314849318,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4987769350409508,
      "val_macro_f1": 0.7706189710058708,
      "val_verse_f1": 0.8640725876810329,
      "val_chorus_f1": 0.6771653543307087,
      "val_chorus_rate": 0.29394813627004623,
      "val_max_prob": 0.7026984840631485,
      "val_conf_over_90": 0.013531734002754092,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001539667720797683,
      "epoch_time": 95.57183790206909,
      "val_boundary_f1": 0.4399596367305752,
      "val_boundary_precision": 0.3844797178130511,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3309530633496699,
      "val_avg_segment_overlap": 0.6589955810908301,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3429303923579399,
      "val_pk_metric": 0.24073701607305917
    },
    {
      "epoch": 12,
      "train_loss": 0.4627601355314255,
      "train_chorus_rate": 0.33505841717123985,
      "train_max_prob": 0.6869498491287231,
      "train_conf_over_90": 0.011250866757472977,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4903452917933464,
      "val_macro_f1": 0.7452595136442617,
      "val_verse_f1": 0.8170147537842498,
      "val_chorus_f1": 0.6735042735042734,
      "val_chorus_rate": 0.4194268584251404,
      "val_max_prob": 0.702269122004509,
      "val_conf_over_90": 0.016083376249298453,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.929482102004826e-05,
      "epoch_time": 99.13383197784424,
      "val_boundary_f1": 0.4153225806451613,
      "val_boundary_precision": 0.3626760563380282,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.30010421912595825,
      "val_avg_segment_overlap": 0.6622596766199211,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3955646372501286,
      "val_pk_metric": 0.28848876257081024
    },
    {
      "epoch": 13,
      "train_loss": 0.4540062233805656,
      "train_chorus_rate": 0.34020606279373167,
      "train_max_prob": 0.6930764943361283,
      "train_conf_over_90": 0.014452943357173353,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4859571307897568,
      "val_macro_f1": 0.756743487067477,
      "val_verse_f1": 0.8318949343339588,
      "val_chorus_f1": 0.681592039800995,
      "val_chorus_rate": 0.39221610873937607,
      "val_max_prob": 0.6812399178743362,
      "val_conf_over_90": 0.0028647801955230534,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.096946387367665e-05,
      "epoch_time": 105.15599799156189,
      "val_boundary_f1": 0.43661971830985913,
      "val_boundary_precision": 0.38070175438596493,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.32172152458472714,
      "val_avg_segment_overlap": 0.6730281254183208,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.35370116438150895,
      "val_pk_metric": 0.27033108888768825
    },
    {
      "epoch": 14,
      "train_loss": 0.4578024119138718,
      "train_chorus_rate": 0.36567636430263517,
      "train_max_prob": 0.6933906435966491,
      "train_conf_over_90": 0.0181844838662073,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48770513385534286,
      "val_macro_f1": 0.7459472991290024,
      "val_verse_f1": 0.8132038834951456,
      "val_chorus_f1": 0.678690714762859,
      "val_chorus_rate": 0.4360719099640846,
      "val_max_prob": 0.7028291523456573,
      "val_conf_over_90": 0.025525538716465235,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1102750638741442e-05,
      "epoch_time": 87.51577067375183,
      "val_boundary_f1": 0.42755825734549135,
      "val_boundary_precision": 0.3747779751332149,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.30958215449201665,
      "val_avg_segment_overlap": 0.6672490421897795,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.38409832248801523,
      "val_pk_metric": 0.2800838250398043
    },
    {
      "epoch": 15,
      "train_loss": 0.45415755063295365,
      "train_chorus_rate": 0.35635942593216896,
      "train_max_prob": 0.6994635432958602,
      "train_conf_over_90": 0.021028565731830894,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4854461997747421,
      "val_macro_f1": 0.7674859162782699,
      "val_verse_f1": 0.841831038332713,
      "val_chorus_f1": 0.6931407942238267,
      "val_chorus_rate": 0.3813169151544571,
      "val_max_prob": 0.6891985535621643,
      "val_conf_over_90": 0.0070199453621171415,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 99.80719995498657,
      "val_boundary_f1": 0.452642073778664,
      "val_boundary_precision": 0.3920552677029361,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.333805552257302,
      "val_avg_segment_overlap": 0.6855261632803318,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.34662794505797145,
      "val_pk_metric": 0.26124752465910295
    }
  ]
}