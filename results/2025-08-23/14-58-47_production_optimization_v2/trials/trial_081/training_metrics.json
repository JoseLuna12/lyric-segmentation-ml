{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.17684458715448795,
      "layer_dropout": 0.21646958726769452,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.17767153981028241,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3526147,
      "lstm_params": 2965504,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0009322767647844197,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015927579951160727,
      "gradient_clip_norm": 0.4123697322330954,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.060071905478395984,
        "ece_after": 0.016624312064736673,
        "improvement": 0.04344759341365931,
        "params": {
          "temperature": 0.7349492359161128
        }
      },
      "platt": {
        "ece_before": 0.060071905478395984,
        "ece_after": 0.01927191939768481,
        "improvement": 0.04079998608071117,
        "params": {
          "A": 1.289730760069967,
          "B": -4.1812407508347086e-07
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6220384836196899,
      "train_chorus_rate": 0.4133712112903595,
      "train_max_prob": 0.6334723353385925,
      "train_conf_over_90": 7.443245267495513e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6068483591079712,
      "val_macro_f1": 0.24094794832826752,
      "val_verse_f1": 0.01875,
      "val_chorus_f1": 0.46314589665653505,
      "val_chorus_rate": 0.9928681254386902,
      "val_max_prob": 0.6062929928302765,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009221014489387203,
      "epoch_time": 211.7291178703308,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.06667091123383656,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.270515878413032,
      "val_pk_metric": 0.27418360536164743
    },
    {
      "epoch": 2,
      "train_loss": 0.5640766322612762,
      "train_chorus_rate": 0.5282993320201058,
      "train_max_prob": 0.5687784254550934,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.592295378446579,
      "val_macro_f1": 0.4588388833082143,
      "val_verse_f1": 0.44422009086320047,
      "val_chorus_f1": 0.47345767575322817,
      "val_chorus_rate": 0.7271770536899567,
      "val_max_prob": 0.5699510276317596,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008920202115306616,
      "epoch_time": 188.55531287193298,
      "val_boundary_f1": 0.05328596802841919,
      "val_boundary_precision": 0.1079136690647482,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.025562739463601533,
      "val_avg_segment_overlap": 0.20481075832871165,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4223904748690348,
      "val_pk_metric": 0.4228039488282586
    },
    {
      "epoch": 3,
      "train_loss": 0.5571732521057129,
      "train_chorus_rate": 0.599800193309784,
      "train_max_prob": 0.5835046172142029,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6047315001487732,
      "val_macro_f1": 0.46001538789603913,
      "val_verse_f1": 0.820844987487119,
      "val_chorus_f1": 0.0991857883049593,
      "val_chorus_rate": 0.031977495178580284,
      "val_max_prob": 0.6222366094589233,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000843347746980768,
      "epoch_time": 141.7733690738678,
      "val_boundary_f1": 0.05371900826446281,
      "val_boundary_precision": 0.21666666666666667,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.06381704980842912,
      "val_avg_segment_overlap": 0.19654071390757444,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.2753580690955673,
      "val_pk_metric": 0.2773397600634038
    },
    {
      "epoch": 4,
      "train_loss": 0.5386616945266723,
      "train_chorus_rate": 0.40727244932204487,
      "train_max_prob": 0.6062029600143433,
      "train_conf_over_90": 6.894174148328603e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5375593602657318,
      "val_macro_f1": 0.6459129340604227,
      "val_verse_f1": 0.7009564293304994,
      "val_chorus_f1": 0.590869438790346,
      "val_chorus_rate": 0.5445824563503265,
      "val_max_prob": 0.6258399486541748,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007782112755462671,
      "epoch_time": 136.084655046463,
      "val_boundary_f1": 0.21917808219178084,
      "val_boundary_precision": 0.1980952380952381,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.09045737547892721,
      "val_avg_segment_overlap": 0.481372960487077,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.4905904355427904,
      "val_pk_metric": 0.4159559554729022
    },
    {
      "epoch": 5,
      "train_loss": 0.5066323280334473,
      "train_chorus_rate": 0.3913313463330269,
      "train_max_prob": 0.6676944851875305,
      "train_conf_over_90": 0.015680146281374617,
      "train_conf_over_95": 8.221430471166968e-05,
      "val_loss": 0.5189665257930756,
      "val_macro_f1": 0.7072429234624708,
      "val_verse_f1": 0.7920792079207921,
      "val_chorus_f1": 0.6224066390041494,
      "val_chorus_rate": 0.4103482812643051,
      "val_max_prob": 0.6631136536598206,
      "val_conf_over_90": 0.0014735684380866587,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006994575735883148,
      "epoch_time": 185.04176592826843,
      "val_boundary_f1": 0.29320229320229324,
      "val_boundary_precision": 0.2245922208281054,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.1760057471264368,
      "val_avg_segment_overlap": 0.6138326761236663,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.49422103201610634,
      "val_pk_metric": 0.36132750618723525
    },
    {
      "epoch": 6,
      "train_loss": 0.48767246305942535,
      "train_chorus_rate": 0.43148012161254884,
      "train_max_prob": 0.6851809978485107,
      "train_conf_over_90": 0.008530268433969469,
      "train_conf_over_95": 7.42115022148937e-05,
      "val_loss": 0.5011838227510452,
      "val_macro_f1": 0.7504427172238048,
      "val_verse_f1": 0.8291954452118723,
      "val_chorus_f1": 0.6716899892357374,
      "val_chorus_rate": 0.38449327647686005,
      "val_max_prob": 0.7181804180145264,
      "val_conf_over_90": 0.0061417983379215,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000610528555784663,
      "epoch_time": 152.27316570281982,
      "val_boundary_f1": 0.3652641002685766,
      "val_boundary_precision": 0.2943722943722944,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2784363026819924,
      "val_avg_segment_overlap": 0.6463963191328883,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.44468563367488123,
      "val_pk_metric": 0.31437599362369195
    },
    {
      "epoch": 7,
      "train_loss": 0.47250505685806277,
      "train_chorus_rate": 0.35421977639198304,
      "train_max_prob": 0.6968131422996521,
      "train_conf_over_90": 0.010510048700962216,
      "train_conf_over_95": 0.00020535513176582753,
      "val_loss": 0.49797241389751434,
      "val_macro_f1": 0.735164429246876,
      "val_verse_f1": 0.8126899696048632,
      "val_chorus_f1": 0.6576388888888888,
      "val_chorus_rate": 0.40722356736660004,
      "val_max_prob": 0.7046557664871216,
      "val_conf_over_90": 0.01841767504811287,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005153108469421036,
      "epoch_time": 175.2327618598938,
      "val_boundary_f1": 0.3462214411247803,
      "val_boundary_precision": 0.2759103641456583,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2420977011494253,
      "val_avg_segment_overlap": 0.6311872583940832,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.45491539518394886,
      "val_pk_metric": 0.3106484695898547
    },
    {
      "epoch": 8,
      "train_loss": 0.4846560209989548,
      "train_chorus_rate": 0.3431472420692444,
      "train_max_prob": 0.7012377440929413,
      "train_conf_over_90": 0.02657472467981279,
      "train_conf_over_95": 0.0033541030716151,
      "val_loss": 0.5006071627140045,
      "val_macro_f1": 0.6806355085809792,
      "val_verse_f1": 0.7376536778495519,
      "val_chorus_f1": 0.6236173393124066,
      "val_chorus_rate": 0.5215042531490326,
      "val_max_prob": 0.6675664484500885,
      "val_conf_over_90": 0.002962576923891902,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004179659178423163,
      "epoch_time": 164.6152560710907,
      "val_boundary_f1": 0.2776831345826235,
      "val_boundary_precision": 0.21733333333333332,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.16954022988505746,
      "val_avg_segment_overlap": 0.5891894143678436,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.5146822621958393,
      "val_pk_metric": 0.38443218250502253
    },
    {
      "epoch": 9,
      "train_loss": 0.4570561021566391,
      "train_chorus_rate": 0.3647590398788452,
      "train_max_prob": 0.7175325810909271,
      "train_conf_over_90": 0.023425516881980003,
      "train_conf_over_95": 0.0003655760549008846,
      "val_loss": 0.49096840620040894,
      "val_macro_f1": 0.7297223434544964,
      "val_verse_f1": 0.8019379844961241,
      "val_chorus_f1": 0.6575067024128687,
      "val_chorus_rate": 0.43285806477069855,
      "val_max_prob": 0.6867277324199677,
      "val_conf_over_90": 0.004180900519713759,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003227482089997568,
      "epoch_time": 250.6516671180725,
      "val_boundary_f1": 0.31055900621118016,
      "val_boundary_precision": 0.24893314366998578,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.20294540229885058,
      "val_avg_segment_overlap": 0.6259612686930975,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.45795623496777593,
      "val_pk_metric": 0.3351668016117939
    },
    {
      "epoch": 10,
      "train_loss": 0.4489142060279846,
      "train_chorus_rate": 0.35997716784477235,
      "train_max_prob": 0.7149648666381836,
      "train_conf_over_90": 0.03607568885199726,
      "train_conf_over_95": 0.004421754507347941,
      "val_loss": 0.49183855950832367,
      "val_macro_f1": 0.7609599042312232,
      "val_verse_f1": 0.843966460080204,
      "val_chorus_f1": 0.6779533483822423,
      "val_chorus_rate": 0.35277101397514343,
      "val_max_prob": 0.7327446043491364,
      "val_conf_over_90": 0.054023122414946556,
      "val_conf_over_95": 0.0017133731162175536,
      "learning_rate": 0.00023381919119610503,
      "epoch_time": 197.2326316833496,
      "val_boundary_f1": 0.4073732718894009,
      "val_boundary_precision": 0.33434190620272314,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.305735153256705,
      "val_avg_segment_overlap": 0.6608257096209489,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.40949809481697663,
      "val_pk_metric": 0.28024381610015225
    },
    {
      "epoch": 11,
      "train_loss": 0.4351819634437561,
      "train_chorus_rate": 0.33143326044082644,
      "train_max_prob": 0.7290693819522858,
      "train_conf_over_90": 0.04516745153814554,
      "train_conf_over_95": 0.003920606285100802,
      "val_loss": 0.4853084981441498,
      "val_macro_f1": 0.7587729456167439,
      "val_verse_f1": 0.8350746268656717,
      "val_chorus_f1": 0.6824712643678161,
      "val_chorus_rate": 0.38370051980018616,
      "val_max_prob": 0.7222734987735748,
      "val_conf_over_90": 0.049296991899609566,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015506548923815272,
      "epoch_time": 166.63375425338745,
      "val_boundary_f1": 0.3747680890538034,
      "val_boundary_precision": 0.308868501529052,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26849856321839083,
      "val_avg_segment_overlap": 0.6599067019334652,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4231483133004081,
      "val_pk_metric": 0.28946249949368086
    },
    {
      "epoch": 12,
      "train_loss": 0.43736971616744996,
      "train_chorus_rate": 0.35105615854263306,
      "train_max_prob": 0.7357856810092926,
      "train_conf_over_90": 0.0614872969686985,
      "train_conf_over_95": 0.007717766554560512,
      "val_loss": 0.48721785843372345,
      "val_macro_f1": 0.7487106794306224,
      "val_verse_f1": 0.82375189107413,
      "val_chorus_f1": 0.6736694677871148,
      "val_chorus_rate": 0.4014103561639786,
      "val_max_prob": 0.7301592528820038,
      "val_conf_over_90": 0.07458359748125076,
      "val_conf_over_95": 0.006412483286112547,
      "learning_rate": 8.992901780365182e-05,
      "epoch_time": 234.48027420043945,
      "val_boundary_f1": 0.36675700090334235,
      "val_boundary_precision": 0.2972181551976574,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2657447318007663,
      "val_avg_segment_overlap": 0.6546026217698437,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.43441149965205594,
      "val_pk_metric": 0.3058470719729111
    },
    {
      "epoch": 13,
      "train_loss": 0.4531674951314926,
      "train_chorus_rate": 0.35911816656589507,
      "train_max_prob": 0.7286506056785583,
      "train_conf_over_90": 0.056243621930480006,
      "train_conf_over_95": 0.006439674834837206,
      "val_loss": 0.4868064522743225,
      "val_macro_f1": 0.7563637226168238,
      "val_verse_f1": 0.8313931656027038,
      "val_chorus_f1": 0.681334279630944,
      "val_chorus_rate": 0.39204302430152893,
      "val_max_prob": 0.7300464510917664,
      "val_conf_over_90": 0.05912463925778866,
      "val_conf_over_95": 0.002455947338603437,
      "learning_rate": 4.1256553253758066e-05,
      "epoch_time": 153.49952292442322,
      "val_boundary_f1": 0.3805970149253731,
      "val_boundary_precision": 0.3148148148148148,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.27131226053639845,
      "val_avg_segment_overlap": 0.652413830937919,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4232813677181944,
      "val_pk_metric": 0.29172298474211666
    },
    {
      "epoch": 14,
      "train_loss": 0.4341104745864868,
      "train_chorus_rate": 0.33288503885269166,
      "train_max_prob": 0.7314440846443176,
      "train_conf_over_90": 0.04729781951755285,
      "train_conf_over_95": 0.0031711933930637314,
      "val_loss": 0.4843354821205139,
      "val_macro_f1": 0.7577649887575777,
      "val_verse_f1": 0.8342665173572229,
      "val_chorus_f1": 0.6812634601579325,
      "val_chorus_rate": 0.3842032849788666,
      "val_max_prob": 0.7221761345863342,
      "val_conf_over_90": 0.05078599974513054,
      "val_conf_over_95": 0.0017249531811103225,
      "learning_rate": 1.1175315845699433e-05,
      "epoch_time": 177.21132922172546,
      "val_boundary_f1": 0.37912087912087905,
      "val_boundary_precision": 0.30988023952095806,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2801724137931034,
      "val_avg_segment_overlap": 0.6537934440073212,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4255494130720993,
      "val_pk_metric": 0.2860569275246271
    },
    {
      "epoch": 15,
      "train_loss": 0.4383878618478775,
      "train_chorus_rate": 0.3513054221868515,
      "train_max_prob": 0.7291235744953155,
      "train_conf_over_90": 0.04862251318991184,
      "train_conf_over_95": 0.0032430457940790802,
      "val_loss": 0.48416943848133087,
      "val_macro_f1": 0.7561487882880975,
      "val_verse_f1": 0.8327415436367035,
      "val_chorus_f1": 0.6795560329394916,
      "val_chorus_rate": 0.38590894639492035,
      "val_max_prob": 0.7263078987598419,
      "val_conf_over_90": 0.05544650927186012,
      "val_conf_over_95": 0.0029471368761733174,
      "learning_rate": 1e-06,
      "epoch_time": 156.6018831729889,
      "val_boundary_f1": 0.37649219467401285,
      "val_boundary_precision": 0.3082706766917293,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.282088122605364,
      "val_avg_segment_overlap": 0.6520280847257982,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.42739452834242586,
      "val_pk_metric": 0.289640382869967
    }
  ]
}