{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19752743041778345,
      "layer_dropout": 0.2631327198020507,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.14127118592115706,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00028314998018235266,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.012548059462792338,
      "gradient_clip_norm": 0.47997776987652313,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06264342019272226,
        "ece_after": 0.032782576685452945,
        "improvement": 0.029860843507269315,
        "params": {
          "temperature": 0.5394402320523296
        }
      },
      "platt": {
        "ece_before": 0.06264342019272226,
        "ece_after": 0.04238762926083417,
        "improvement": 0.02025579093188809,
        "params": {
          "A": 1.4393262303112913,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5815843090415,
      "train_chorus_rate": 0.5545859143137932,
      "train_max_prob": 0.5731481939554215,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6032404899597168,
      "val_macro_f1": 0.3601847088516055,
      "val_verse_f1": 0.2333843797856049,
      "val_chorus_f1": 0.48698503791760606,
      "val_chorus_rate": 0.8984574973583221,
      "val_max_prob": 0.6073183715343475,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00027241128598564675,
      "epoch_time": 74.07469129562378,
      "val_boundary_f1": 0.029411764705882353,
      "val_boundary_precision": 0.06666666666666667,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.018209464577439126,
      "val_avg_segment_overlap": 0.14236653057086782,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40261634493466614,
      "val_pk_metric": 0.39504662121591494
    },
    {
      "epoch": 2,
      "train_loss": 0.5741828858852387,
      "train_chorus_rate": 0.41934125117550136,
      "train_max_prob": 0.5765248477458954,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5939491838216782,
      "val_macro_f1": 0.5328765874986992,
      "val_verse_f1": 0.6362356726322139,
      "val_chorus_f1": 0.4295175023651845,
      "val_chorus_rate": 0.47952184826135635,
      "val_max_prob": 0.5466764122247696,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002418300722404721,
      "epoch_time": 59.562824964523315,
      "val_boundary_f1": 0.05663716814159292,
      "val_boundary_precision": 0.11347517730496454,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.01860455554782172,
      "val_avg_segment_overlap": 0.21987224302020095,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4202265400788826,
      "val_pk_metric": 0.4271174897738651
    },
    {
      "epoch": 3,
      "train_loss": 0.5757636427879333,
      "train_chorus_rate": 0.5705940311949235,
      "train_max_prob": 0.5734393924474717,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.623652845621109,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.6145775318145752,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019606205152013874,
      "epoch_time": 42.262155055999756,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 4,
      "train_loss": 0.5634509444236755,
      "train_chorus_rate": 0.4768897600821219,
      "train_max_prob": 0.5743256747722626,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5911093056201935,
      "val_macro_f1": 0.5488671824510221,
      "val_verse_f1": 0.6129032258064516,
      "val_chorus_f1": 0.48483113909559244,
      "val_chorus_rate": 0.5610333532094955,
      "val_max_prob": 0.5634391605854034,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014207499009117632,
      "epoch_time": 49.28323006629944,
      "val_boundary_f1": 0.07207207207207207,
      "val_boundary_precision": 0.15267175572519084,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.03940721512301576,
      "val_avg_segment_overlap": 0.22182465554073655,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3934581100041311,
      "val_pk_metric": 0.3980602936548216
    },
    {
      "epoch": 5,
      "train_loss": 0.5627406805753707,
      "train_chorus_rate": 0.5213775806128979,
      "train_max_prob": 0.5887482464313507,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5903631001710892,
      "val_macro_f1": 0.585725678240173,
      "val_verse_f1": 0.6870560378847672,
      "val_chorus_f1": 0.48439531859557866,
      "val_chorus_rate": 0.45733366161584854,
      "val_max_prob": 0.5660196989774704,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.808792866221394e-05,
      "epoch_time": 48.65394616127014,
      "val_boundary_f1": 0.06999999999999999,
      "val_boundary_precision": 0.11931818181818182,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.052508338894871234,
      "val_avg_segment_overlap": 0.2612405162768129,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.36501062611160867,
      "val_pk_metric": 0.3560290987847543
    },
    {
      "epoch": 6,
      "train_loss": 0.5516993969678878,
      "train_chorus_rate": 0.4786606326699257,
      "train_max_prob": 0.582748606801033,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5934005677700043,
      "val_macro_f1": 0.5976669698069701,
      "val_verse_f1": 0.7270024159078238,
      "val_chorus_f1": 0.4683315237061165,
      "val_chorus_rate": 0.3798518627882004,
      "val_max_prob": 0.576251208782196,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.231990794188055e-05,
      "epoch_time": 42.72525715827942,
      "val_boundary_f1": 0.08264462809917357,
      "val_boundary_precision": 0.13812154696132597,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.06694233811147915,
      "val_avg_segment_overlap": 0.2800466434674622,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.3580135871796624,
      "val_pk_metric": 0.3507466337904872
    },
    {
      "epoch": 7,
      "train_loss": 0.5560758426785469,
      "train_chorus_rate": 0.5577971369028092,
      "train_max_prob": 0.5872141689062118,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5890369266271591,
      "val_macro_f1": 0.5786911180640835,
      "val_verse_f1": 0.6635322976287817,
      "val_chorus_f1": 0.4938499384993851,
      "val_chorus_rate": 0.5008581951260567,
      "val_max_prob": 0.5758382827043533,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1738694196705935e-05,
      "epoch_time": 84.20399308204651,
      "val_boundary_f1": 0.07578253706754531,
      "val_boundary_precision": 0.12568306010928962,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.04528384997632082,
      "val_avg_segment_overlap": 0.2512478890430202,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.4077431327296146,
      "val_pk_metric": 0.38872439136620823
    },
    {
      "epoch": 8,
      "train_loss": 0.5430065512657165,
      "train_chorus_rate": 0.4905163377523422,
      "train_max_prob": 0.586632588505745,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5858044773340225,
      "val_macro_f1": 0.5697682520650844,
      "val_verse_f1": 0.6322110229466009,
      "val_chorus_f1": 0.5073254811835679,
      "val_chorus_rate": 0.5580677762627602,
      "val_max_prob": 0.5777502655982971,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 59.4506299495697,
      "val_boundary_f1": 0.06568144499178984,
      "val_boundary_precision": 0.10810810810810811,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.04200399270653778,
      "val_avg_segment_overlap": 0.2580623825819094,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4118751618528948,
      "val_pk_metric": 0.40315457046106784
    }
  ]
}