{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.22961636888313067,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.22807861176983377,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008134741470873795,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01847630007448729,
      "gradient_clip_norm": 0.34104789626018633,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12264666763410591,
        "ece_after": 0.020099892480434277,
        "improvement": 0.10254677515367164,
        "params": {
          "temperature": 0.489988754192875
        }
      },
      "platt": {
        "ece_before": 0.12264666763410591,
        "ece_after": 0.02187127100344024,
        "improvement": 0.10077539663066568,
        "params": {
          "A": 1.9841999418819578,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5660748898983001,
      "train_chorus_rate": 0.4848604973871261,
      "train_max_prob": 0.5877283543348313,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5629951804876328,
      "val_macro_f1": 0.48483543692087994,
      "val_verse_f1": 0.4750938673341677,
      "val_chorus_f1": 0.4945770065075922,
      "val_chorus_rate": 0.7193708270788193,
      "val_max_prob": 0.5839732736349106,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008045968923595725,
      "epoch_time": 109.26301693916321,
      "val_boundary_f1": 0.08,
      "val_boundary_precision": 0.12437810945273632,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.027170910495406785,
      "val_avg_segment_overlap": 0.24165318911949116,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4464511719172506,
      "val_pk_metric": 0.45001633986342565
    },
    {
      "epoch": 2,
      "train_loss": 0.532303410768509,
      "train_chorus_rate": 0.4623157516121864,
      "train_max_prob": 0.6176577359437943,
      "train_conf_over_90": 6.87021529302001e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5312706381082535,
      "val_macro_f1": 0.6790402028314582,
      "val_verse_f1": 0.7460381958553434,
      "val_chorus_f1": 0.612042209807573,
      "val_chorus_rate": 0.492543525993824,
      "val_max_prob": 0.6116197109222412,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007783531068055507,
      "epoch_time": 107.38600397109985,
      "val_boundary_f1": 0.3081395348837209,
      "val_boundary_precision": 0.26151315789473684,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.1497414396672085,
      "val_avg_segment_overlap": 0.5476639370809576,
      "val_verse_to_chorus_acc": 0.29646017699115046,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.43351911898276363,
      "val_pk_metric": 0.33688576012492205
    },
    {
      "epoch": 3,
      "train_loss": 0.5081546738743782,
      "train_chorus_rate": 0.38910909593105314,
      "train_max_prob": 0.6472197353839875,
      "train_conf_over_90": 0.0012911521131172775,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5211905539035797,
      "val_macro_f1": 0.6469932339719506,
      "val_verse_f1": 0.6930262872039974,
      "val_chorus_f1": 0.6009601807399039,
      "val_chorus_rate": 0.5703637301921844,
      "val_max_prob": 0.6480998992919922,
      "val_conf_over_90": 0.0009348820603918284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007358897697856802,
      "epoch_time": 124.94432497024536,
      "val_boundary_f1": 0.24171539961013647,
      "val_boundary_precision": 0.2059800664451827,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.09323711872757473,
      "val_avg_segment_overlap": 0.5145566975373677,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.49062586720593715,
      "val_pk_metric": 0.38700206919335134
    },
    {
      "epoch": 4,
      "train_loss": 0.4943080469965935,
      "train_chorus_rate": 0.39798677563667295,
      "train_max_prob": 0.6757915556430817,
      "train_conf_over_90": 0.009691404746263288,
      "train_conf_over_95": 0.00030395886860787866,
      "val_loss": 0.5168790370225906,
      "val_macro_f1": 0.7441410714120046,
      "val_verse_f1": 0.8405280057081698,
      "val_chorus_f1": 0.6477541371158394,
      "val_chorus_rate": 0.3246767520904541,
      "val_max_prob": 0.6555666923522949,
      "val_conf_over_90": 0.0014323900977615267,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000679062732889427,
      "epoch_time": 97.73580980300903,
      "val_boundary_f1": 0.3909774436090225,
      "val_boundary_precision": 0.325,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2720357002965698,
      "val_avg_segment_overlap": 0.6307733003187994,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.39632343270708725,
      "val_pk_metric": 0.290311790606716
    },
    {
      "epoch": 5,
      "train_loss": 0.48277378976345064,
      "train_chorus_rate": 0.3815334662795067,
      "train_max_prob": 0.6693294972181321,
      "train_conf_over_90": 0.014085825748043134,
      "train_conf_over_95": 0.00036254799633752557,
      "val_loss": 0.5238047242164612,
      "val_macro_f1": 0.7495082924469754,
      "val_verse_f1": 0.8526700295703601,
      "val_chorus_f1": 0.6463465553235908,
      "val_chorus_rate": 0.28986721485853195,
      "val_max_prob": 0.720752939581871,
      "val_conf_over_90": 0.01033202453982085,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0006103556103155347,
      "epoch_time": 102.47843623161316,
      "val_boundary_f1": 0.4203045685279188,
      "val_boundary_precision": 0.3689839572192513,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.27742970966724945,
      "val_avg_segment_overlap": 0.6209308064038052,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3290018777179714,
      "val_pk_metric": 0.24192713033220622
    },
    {
      "epoch": 6,
      "train_loss": 0.4880035534501076,
      "train_chorus_rate": 0.3733412273228168,
      "train_max_prob": 0.6817600101232528,
      "train_conf_over_90": 0.010452326765516773,
      "train_conf_over_95": 3.799392143264413e-05,
      "val_loss": 0.49895836412906647,
      "val_macro_f1": 0.6790256100199408,
      "val_verse_f1": 0.7276604819790999,
      "val_chorus_f1": 0.6303907380607815,
      "val_chorus_rate": 0.5488011091947556,
      "val_max_prob": 0.6613469123840332,
      "val_conf_over_90": 0.0037233263719826937,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005327712330138354,
      "epoch_time": 93.76989006996155,
      "val_boundary_f1": 0.28732394366197184,
      "val_boundary_precision": 0.23868954758190328,
      "val_boundary_recall": 0.3608490566037736,
      "val_complete_segments": 0.16843494570164771,
      "val_avg_segment_overlap": 0.5716978005498373,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4758966210907426,
      "val_pk_metric": 0.35486512502919443
    },
    {
      "epoch": 7,
      "train_loss": 0.4764218345284462,
      "train_chorus_rate": 0.3976821832358837,
      "train_max_prob": 0.6893751651048661,
      "train_conf_over_90": 0.011449729540618136,
      "train_conf_over_95": 3.636363544501364e-05,
      "val_loss": 0.48830121010541916,
      "val_macro_f1": 0.751134941813653,
      "val_verse_f1": 0.822946445587955,
      "val_chorus_f1": 0.679323438039351,
      "val_chorus_rate": 0.412098191678524,
      "val_max_prob": 0.7058373838663101,
      "val_conf_over_90": 0.04217986948788166,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004497004105635605,
      "epoch_time": 96.35810399055481,
      "val_boundary_f1": 0.39061032863849765,
      "val_boundary_precision": 0.3244929797191888,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2963954922199885,
      "val_avg_segment_overlap": 0.6617355511720849,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.40653423378402875,
      "val_pk_metric": 0.28957114419869967
    },
    {
      "epoch": 8,
      "train_loss": 0.48078369051218034,
      "train_chorus_rate": 0.3743337370455265,
      "train_max_prob": 0.6750219464302063,
      "train_conf_over_90": 0.008670161859481596,
      "train_conf_over_95": 3.017501439899206e-05,
      "val_loss": 0.4872443452477455,
      "val_macro_f1": 0.7565778330573691,
      "val_verse_f1": 0.8351281099145934,
      "val_chorus_f1": 0.678027556200145,
      "val_chorus_rate": 0.3782637044787407,
      "val_max_prob": 0.6737539917230606,
      "val_conf_over_90": 0.003181032254360616,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003647737365238193,
      "epoch_time": 94.74731993675232,
      "val_boundary_f1": 0.40075258701787386,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.3166304825504189,
      "val_avg_segment_overlap": 0.6730445389308719,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3978577385871195,
      "val_pk_metric": 0.278312598944489
    },
    {
      "epoch": 9,
      "train_loss": 0.46865971833467485,
      "train_chorus_rate": 0.3922119900584221,
      "train_max_prob": 0.6976451218128205,
      "train_conf_over_90": 0.0193055153475143,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4881426468491554,
      "val_macro_f1": 0.7573877102654442,
      "val_verse_f1": 0.8364511946656789,
      "val_chorus_f1": 0.6783242258652095,
      "val_chorus_rate": 0.37519094347953796,
      "val_max_prob": 0.6903926134109497,
      "val_conf_over_90": 0.00665251788450405,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002817029140735444,
      "epoch_time": 97.38801407814026,
      "val_boundary_f1": 0.4277227722772277,
      "val_boundary_precision": 0.36860068259385664,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.32302701883825957,
      "val_avg_segment_overlap": 0.6613199569282056,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3652740064415157,
      "val_pk_metric": 0.2707230974786275
    },
    {
      "epoch": 10,
      "train_loss": 0.4647794172167778,
      "train_chorus_rate": 0.3339351795613766,
      "train_max_prob": 0.6997908234596253,
      "train_conf_over_90": 0.01986682179849595,
      "train_conf_over_95": 2.7533038519322872e-05,
      "val_loss": 0.48324505239725113,
      "val_macro_f1": 0.7518908124597072,
      "val_verse_f1": 0.8218390804597702,
      "val_chorus_f1": 0.6819425444596444,
      "val_chorus_rate": 0.41895272582769394,
      "val_max_prob": 0.7067083567380905,
      "val_conf_over_90": 0.03452985920011997,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000204118536771845,
      "epoch_time": 103.32473802566528,
      "val_boundary_f1": 0.38671875000000006,
      "val_boundary_precision": 0.33,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.28380727531045663,
      "val_avg_segment_overlap": 0.6555445543673764,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3950764155258194,
      "val_pk_metric": 0.2910256681400198
    },
    {
      "epoch": 11,
      "train_loss": 0.4574470967054367,
      "train_chorus_rate": 0.34238648414611816,
      "train_max_prob": 0.7023835331201553,
      "train_conf_over_90": 0.020039018779061734,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4871315136551857,
      "val_macro_f1": 0.7614700508766056,
      "val_verse_f1": 0.8440065681444991,
      "val_chorus_f1": 0.678933533608712,
      "val_chorus_rate": 0.3550206571817398,
      "val_max_prob": 0.6953868418931961,
      "val_conf_over_90": 0.037529833149164915,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013541141419795268,
      "epoch_time": 116.41037106513977,
      "val_boundary_f1": 0.4034582132564842,
      "val_boundary_precision": 0.34035656401944897,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.3003961998659772,
      "val_avg_segment_overlap": 0.6727965709481476,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.39388339859111876,
      "val_pk_metric": 0.2723794354054026
    },
    {
      "epoch": 12,
      "train_loss": 0.4536191612482071,
      "train_chorus_rate": 0.37183641642332077,
      "train_max_prob": 0.7125182420015335,
      "train_conf_over_90": 0.04021943463012576,
      "train_conf_over_95": 0.0001709774776827544,
      "val_loss": 0.4818710535764694,
      "val_macro_f1": 0.7500599971285677,
      "val_verse_f1": 0.8226113437381043,
      "val_chorus_f1": 0.6775086505190312,
      "val_chorus_rate": 0.41050440818071365,
      "val_max_prob": 0.7022480219602585,
      "val_conf_over_90": 0.04394171154126525,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.858437730169942e-05,
      "epoch_time": 98.40589594841003,
      "val_boundary_f1": 0.4031158714703018,
      "val_boundary_precision": 0.34328358208955223,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2929185927330148,
      "val_avg_segment_overlap": 0.6577341186504089,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3959449480609337,
      "val_pk_metric": 0.289470455467866
    },
    {
      "epoch": 13,
      "train_loss": 0.4631366431713104,
      "train_chorus_rate": 0.35806508362293243,
      "train_max_prob": 0.6997216910123825,
      "train_conf_over_90": 0.029238092619925736,
      "train_conf_over_95": 4.2553190723992884e-05,
      "val_loss": 0.485375814139843,
      "val_macro_f1": 0.7736929605032457,
      "val_verse_f1": 0.8598363571682676,
      "val_chorus_f1": 0.6875495638382236,
      "val_chorus_rate": 0.3204469755291939,
      "val_max_prob": 0.689225897192955,
      "val_conf_over_90": 0.011192044243216515,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.6121040281828744e-05,
      "epoch_time": 95.06458616256714,
      "val_boundary_f1": 0.4300202839756592,
      "val_boundary_precision": 0.37722419928825623,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.31925155347742834,
      "val_avg_segment_overlap": 0.6699107058818954,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.34224867872017856,
      "val_pk_metric": 0.23741552545706124
    },
    {
      "epoch": 14,
      "train_loss": 0.45120999664068223,
      "train_chorus_rate": 0.3125771082937717,
      "train_max_prob": 0.6958753257989884,
      "train_conf_over_90": 0.019100010162219405,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48153122514486313,
      "val_macro_f1": 0.7518173758865249,
      "val_verse_f1": 0.824468085106383,
      "val_chorus_f1": 0.6791666666666667,
      "val_chorus_rate": 0.4079822227358818,
      "val_max_prob": 0.7015965282917023,
      "val_conf_over_90": 0.040293848142027855,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.877254727807051e-06,
      "epoch_time": 112.85023713111877,
      "val_boundary_f1": 0.4019047619047619,
      "val_boundary_precision": 0.33706070287539935,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3022143792027143,
      "val_avg_segment_overlap": 0.661778138492135,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3883383931670773,
      "val_pk_metric": 0.2815184615773677
    },
    {
      "epoch": 15,
      "train_loss": 0.44590109437704084,
      "train_chorus_rate": 0.3443953588604927,
      "train_max_prob": 0.7033102959394455,
      "train_conf_over_90": 0.026032770797610284,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4818602353334427,
      "val_macro_f1": 0.7687292939271835,
      "val_verse_f1": 0.8476748443793481,
      "val_chorus_f1": 0.6897837434750187,
      "val_chorus_rate": 0.35940274596214294,
      "val_max_prob": 0.7067243456840515,
      "val_conf_over_90": 0.035279189702123404,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 107.52264285087585,
      "val_boundary_f1": 0.4257425742574258,
      "val_boundary_precision": 0.36689419795221845,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.3258108585786211,
      "val_avg_segment_overlap": 0.678216578053151,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.35789301966929143,
      "val_pk_metric": 0.25240209681980574
    }
  ]
}