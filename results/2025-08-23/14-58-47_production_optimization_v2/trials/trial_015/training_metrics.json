{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.167897163796303,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007322402366575148,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.012087077093475994,
      "gradient_clip_norm": 0.6203366412675902,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07746378789072186,
        "ece_after": 0.011809495832105058,
        "improvement": 0.06565429205861681,
        "params": {
          "temperature": 0.6471547469089572
        }
      },
      "platt": {
        "ece_before": 0.07746378789072186,
        "ece_after": 0.07746378789072186,
        "improvement": 0.0,
        "params": {
          "A": 0.9999999716183253,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5232107013463974,
      "train_chorus_rate": 0.32166917668073436,
      "train_max_prob": 0.5505192041397095,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5497317016124725,
      "val_macro_f1": 0.5687001635832255,
      "val_verse_f1": 0.8029917250159134,
      "val_chorus_f1": 0.3344086021505376,
      "val_chorus_rate": 0.15772433951497078,
      "val_max_prob": 0.5861204266548157,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007242505598520415,
      "epoch_time": 117.5092031955719,
      "val_boundary_f1": 0.16011644832605532,
      "val_boundary_precision": 0.20912547528517111,
      "val_boundary_recall": 0.12971698113207547,
      "val_complete_segments": 0.050370302888860685,
      "val_avg_segment_overlap": 0.2679825015539557,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.09595959595959595,
      "val_window_diff": 0.3785783425243251,
      "val_pk_metric": 0.3606288122254589
    },
    {
      "epoch": 2,
      "train_loss": 0.5181085214018821,
      "train_chorus_rate": 0.33777505457401275,
      "train_max_prob": 0.5771226108074188,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5203780978918076,
      "val_macro_f1": 0.6580045045060954,
      "val_verse_f1": 0.7887724284952922,
      "val_chorus_f1": 0.5272365805168987,
      "val_chorus_rate": 0.31875359266996384,
      "val_max_prob": 0.5833003222942352,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007006307166507439,
      "epoch_time": 98.42192363739014,
      "val_boundary_f1": 0.3139534883720931,
      "val_boundary_precision": 0.26644736842105265,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.16618016857942625,
      "val_avg_segment_overlap": 0.49641816531744015,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.42696226585774205,
      "val_pk_metric": 0.3458345972344969
    },
    {
      "epoch": 3,
      "train_loss": 0.48458070009946824,
      "train_chorus_rate": 0.38947929367423056,
      "train_max_prob": 0.6099435061216354,
      "train_conf_over_90": 3.3579583396203815e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49009969830513,
      "val_macro_f1": 0.6690798727674299,
      "val_verse_f1": 0.7409200968523002,
      "val_chorus_f1": 0.5972396486825595,
      "val_chorus_rate": 0.48348578065633774,
      "val_max_prob": 0.636436939239502,
      "val_conf_over_90": 0.0007735613908153027,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006624130075421013,
      "epoch_time": 123.01244473457336,
      "val_boundary_f1": 0.28446005267778757,
      "val_boundary_precision": 0.22657342657342658,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.14027348436150133,
      "val_avg_segment_overlap": 0.5431846651585265,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4572448714719128,
      "val_pk_metric": 0.36351386455439516
    },
    {
      "epoch": 4,
      "train_loss": 0.4634041115641594,
      "train_chorus_rate": 0.34363267198204994,
      "train_max_prob": 0.6625386238098144,
      "train_conf_over_90": 0.00877745938487351,
      "train_conf_over_95": 6.950642273295671e-05,
      "val_loss": 0.48033538460731506,
      "val_macro_f1": 0.7077066170921271,
      "val_verse_f1": 0.8125790710283751,
      "val_chorus_f1": 0.602834163155879,
      "val_chorus_rate": 0.3429093658924103,
      "val_max_prob": 0.6633341461420059,
      "val_conf_over_90": 0.0037782349390909076,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006112677298030763,
      "epoch_time": 103.19827103614807,
      "val_boundary_f1": 0.34397163120567376,
      "val_boundary_precision": 0.2755681818181818,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2342231452782884,
      "val_avg_segment_overlap": 0.598506447657106,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.43603251283564115,
      "val_pk_metric": 0.3242058730276235
    },
    {
      "epoch": 5,
      "train_loss": 0.44619804471731184,
      "train_chorus_rate": 0.3442686915397644,
      "train_max_prob": 0.6730995565652848,
      "train_conf_over_90": 0.015815450466470794,
      "train_conf_over_95": 0.00025857510627247393,
      "val_loss": 0.46952685713768005,
      "val_macro_f1": 0.7138337716978936,
      "val_verse_f1": 0.8087774294670846,
      "val_chorus_f1": 0.6188901139287026,
      "val_chorus_rate": 0.36985427886247635,
      "val_max_prob": 0.6813366860151291,
      "val_conf_over_90": 0.02623753296211362,
      "val_conf_over_95": 0.0015624707302777097,
      "learning_rate": 0.0005494301774931361,
      "epoch_time": 111.90870499610901,
      "val_boundary_f1": 0.3498694516971279,
      "val_boundary_precision": 0.2772413793103448,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2572453873355252,
      "val_avg_segment_overlap": 0.6231041851627039,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4380730096936477,
      "val_pk_metric": 0.3242290364146617
    },
    {
      "epoch": 6,
      "train_loss": 0.4329411149024963,
      "train_chorus_rate": 0.3342094384133816,
      "train_max_prob": 0.6904558688402176,
      "train_conf_over_90": 0.0321829020511359,
      "train_conf_over_95": 0.001306266218307428,
      "val_loss": 0.4637935981154442,
      "val_macro_f1": 0.687153248876175,
      "val_verse_f1": 0.7503064977523499,
      "val_chorus_f1": 0.6240000000000001,
      "val_chorus_rate": 0.49902401864528656,
      "val_max_prob": 0.6773035526275635,
      "val_conf_over_90": 0.0213967920280993,
      "val_conf_over_95": 0.0009446947660762817,
      "learning_rate": 0.0004796029483777227,
      "epoch_time": 121.14005708694458,
      "val_boundary_f1": 0.31715771230502604,
      "val_boundary_precision": 0.25068493150684934,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.17737450372657157,
      "val_avg_segment_overlap": 0.5844671109266157,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4658141251074085,
      "val_pk_metric": 0.34243770201728635
    },
    {
      "epoch": 7,
      "train_loss": 0.4351934537291527,
      "train_chorus_rate": 0.37231339067220687,
      "train_max_prob": 0.6994855225086212,
      "train_conf_over_90": 0.04747061477974057,
      "train_conf_over_95": 0.0033509999339003116,
      "val_loss": 0.46107618510723114,
      "val_macro_f1": 0.7296435049102642,
      "val_verse_f1": 0.8210680858873187,
      "val_chorus_f1": 0.6382189239332097,
      "val_chorus_rate": 0.3633907437324524,
      "val_max_prob": 0.6966476291418076,
      "val_conf_over_90": 0.03598038339987397,
      "val_conf_over_95": 0.0017084434512071311,
      "learning_rate": 0.00040483782743740013,
      "epoch_time": 129.01988196372986,
      "val_boundary_f1": 0.3522231909328683,
      "val_boundary_precision": 0.2793914246196404,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24444881747373798,
      "val_avg_segment_overlap": 0.6278572952164587,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4361098508946268,
      "val_pk_metric": 0.31588006172271177
    },
    {
      "epoch": 8,
      "train_loss": 0.42887219190597536,
      "train_chorus_rate": 0.3565323777496815,
      "train_max_prob": 0.7065420538187027,
      "train_conf_over_90": 0.04789833119139075,
      "train_conf_over_95": 0.004102741123642772,
      "val_loss": 0.45091067999601364,
      "val_macro_f1": 0.7366547536615138,
      "val_verse_f1": 0.8237682229193578,
      "val_chorus_f1": 0.6495412844036698,
      "val_chorus_rate": 0.3707066997885704,
      "val_max_prob": 0.7075653821229935,
      "val_conf_over_90": 0.03728760778903961,
      "val_conf_over_95": 0.0014474281633738428,
      "learning_rate": 0.0003284024092201149,
      "epoch_time": 109.68615221977234,
      "val_boundary_f1": 0.3775241439859526,
      "val_boundary_precision": 0.3006993006993007,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2875883192691252,
      "val_avg_segment_overlap": 0.6305046166489556,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.419617462987388,
      "val_pk_metric": 0.305268679637828
    },
    {
      "epoch": 9,
      "train_loss": 0.4260698571801186,
      "train_chorus_rate": 0.3415804587304592,
      "train_max_prob": 0.706392815709114,
      "train_conf_over_90": 0.04560338323935866,
      "train_conf_over_95": 0.003045402516727336,
      "val_loss": 0.44676416367292404,
      "val_macro_f1": 0.709533768639976,
      "val_verse_f1": 0.7820789939084298,
      "val_chorus_f1": 0.6369885433715221,
      "val_chorus_rate": 0.45136574655771255,
      "val_max_prob": 0.7029569447040558,
      "val_conf_over_90": 0.0549988504499197,
      "val_conf_over_95": 0.004883940506260842,
      "learning_rate": 0.00025363728827979226,
      "epoch_time": 112.5987160205841,
      "val_boundary_f1": 0.3067590987868284,
      "val_boundary_precision": 0.24246575342465754,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.1989065948238801,
      "val_avg_segment_overlap": 0.5980317268121471,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.45395507902969257,
      "val_pk_metric": 0.33115170670605876
    },
    {
      "epoch": 10,
      "train_loss": 0.4269074946641922,
      "train_chorus_rate": 0.36364877969026566,
      "train_max_prob": 0.714110615849495,
      "train_conf_over_90": 0.06270109247416258,
      "train_conf_over_95": 0.00699821743182838,
      "val_loss": 0.45146167278289795,
      "val_macro_f1": 0.7399190972961465,
      "val_verse_f1": 0.8285714285714286,
      "val_chorus_f1": 0.6512667660208643,
      "val_chorus_rate": 0.36078301072120667,
      "val_max_prob": 0.7057521641254425,
      "val_conf_over_90": 0.043623657431453466,
      "val_conf_over_95": 0.0029595776577480137,
      "learning_rate": 0.0001838100591643788,
      "epoch_time": 106.16473197937012,
      "val_boundary_f1": 0.3593890386343217,
      "val_boundary_precision": 0.29027576197387517,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.23781088314492344,
      "val_avg_segment_overlap": 0.6352584204118616,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4347062319985514,
      "val_pk_metric": 0.3099814306818144
    },
    {
      "epoch": 11,
      "train_loss": 0.4314845442771912,
      "train_chorus_rate": 0.3611883521080017,
      "train_max_prob": 0.7119190931320191,
      "train_conf_over_90": 0.05994982738047838,
      "train_conf_over_95": 0.007319710130104795,
      "val_loss": 0.4461973309516907,
      "val_macro_f1": 0.7547283459824117,
      "val_verse_f1": 0.8427900252981568,
      "val_chorus_f1": 0.6666666666666666,
      "val_chorus_rate": 0.34253719449043274,
      "val_max_prob": 0.709065392613411,
      "val_conf_over_90": 0.047065723687410355,
      "val_conf_over_95": 0.0015075621486175805,
      "learning_rate": 0.00012197250685443858,
      "epoch_time": 100.08422589302063,
      "val_boundary_f1": 0.39019963702359345,
      "val_boundary_precision": 0.31710914454277284,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2930831698991826,
      "val_avg_segment_overlap": 0.647017230226933,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4214152161140377,
      "val_pk_metric": 0.2953984863862297
    },
    {
      "epoch": 12,
      "train_loss": 0.411824432015419,
      "train_chorus_rate": 0.34525998383760453,
      "train_max_prob": 0.7155055373907089,
      "train_conf_over_90": 0.05821907259523869,
      "train_conf_over_95": 0.007020905998069793,
      "val_loss": 0.4446549713611603,
      "val_macro_f1": 0.7447473039937145,
      "val_verse_f1": 0.8286823138052115,
      "val_chorus_f1": 0.6608122941822173,
      "val_chorus_rate": 0.3727618083357811,
      "val_max_prob": 0.709987610578537,
      "val_conf_over_90": 0.05162884294986725,
      "val_conf_over_95": 0.003482246305793524,
      "learning_rate": 7.082722911541348e-05,
      "epoch_time": 114.5528998374939,
      "val_boundary_f1": 0.36250000000000004,
      "val_boundary_precision": 0.2916666666666667,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.25114782635991545,
      "val_avg_segment_overlap": 0.6340079209069394,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4290943086896137,
      "val_pk_metric": 0.30234801666091066
    },
    {
      "epoch": 13,
      "train_loss": 0.4056916877627373,
      "train_chorus_rate": 0.33346838057041167,
      "train_max_prob": 0.7229281365871429,
      "train_conf_over_90": 0.0650759132578969,
      "train_conf_over_95": 0.005251250352011993,
      "val_loss": 0.4431712180376053,
      "val_macro_f1": 0.742733892760574,
      "val_verse_f1": 0.8255619543005759,
      "val_chorus_f1": 0.6599058312205722,
      "val_chorus_rate": 0.3796161860227585,
      "val_max_prob": 0.7131778299808502,
      "val_conf_over_90": 0.05658795591443777,
      "val_conf_over_95": 0.0037484869826585054,
      "learning_rate": 3.26095200067708e-05,
      "epoch_time": 112.70712113380432,
      "val_boundary_f1": 0.3606853020739405,
      "val_boundary_precision": 0.291970802919708,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.24172364684029585,
      "val_avg_segment_overlap": 0.6286774742238777,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.42738788612345885,
      "val_pk_metric": 0.30556611142784074
    },
    {
      "epoch": 14,
      "train_loss": 0.41495059728622435,
      "train_chorus_rate": 0.34530904442071914,
      "train_max_prob": 0.7206730991601944,
      "train_conf_over_90": 0.06931580947712064,
      "train_conf_over_95": 0.007929404987953604,
      "val_loss": 0.4427480176091194,
      "val_macro_f1": 0.7436010452413185,
      "val_verse_f1": 0.8260869565217391,
      "val_chorus_f1": 0.6611151339608979,
      "val_chorus_rate": 0.37992294132709503,
      "val_max_prob": 0.7128253728151321,
      "val_conf_over_90": 0.05677443649619818,
      "val_conf_over_95": 0.003989567048847675,
      "learning_rate": 8.989676805473217e-06,
      "epoch_time": 101.52790307998657,
      "val_boundary_f1": 0.3628158844765343,
      "val_boundary_precision": 0.29385964912280704,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.23971900244434707,
      "val_avg_segment_overlap": 0.6311759822435147,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4280816275205377,
      "val_pk_metric": 0.30503434584078215
    }
  ]
}