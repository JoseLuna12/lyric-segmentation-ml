{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.20941270550660063,
      "layer_dropout": 0.22122468266942763,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.20527784393561632,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 3526147,
      "lstm_params": 2965504,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009551483932481113,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 11,
      "validation_strategy": "composite",
      "weight_decay": 0.005385251446989685,
      "gradient_clip_norm": 0.3549775814534464,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07363901255114373,
        "ece_after": 0.015552106739729952,
        "improvement": 0.05808690581141378,
        "params": {
          "temperature": 0.6431628339036397
        }
      },
      "platt": {
        "ece_before": 0.07363901255114373,
        "ece_after": 0.015141125585452034,
        "improvement": 0.0584978869656917,
        "params": {
          "A": 1.4832343530489533,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5981462627649308,
      "train_chorus_rate": 0.4172673218650743,
      "train_max_prob": 0.6020106941461563,
      "train_conf_over_90": 0.0025342466309666634,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5894063264131546,
      "val_macro_f1": 0.4699829065190459,
      "val_verse_f1": 0.4754496840058338,
      "val_chorus_f1": 0.464516129032258,
      "val_chorus_rate": 0.6901632994413376,
      "val_max_prob": 0.5408153384923935,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009447231774238836,
      "epoch_time": 112.69327020645142,
      "val_boundary_f1": 0.05035971223021582,
      "val_boundary_precision": 0.10606060606060606,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.016178940264306118,
      "val_avg_segment_overlap": 0.2038893339042318,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4249703726859295,
      "val_pk_metric": 0.42590908456309723
    },
    {
      "epoch": 2,
      "train_loss": 0.5466068521142006,
      "train_chorus_rate": 0.35496009251801297,
      "train_max_prob": 0.5951716125011444,
      "train_conf_over_90": 0.009530128657934256,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5576190054416656,
      "val_macro_f1": 0.5637821363435309,
      "val_verse_f1": 0.5935632183908046,
      "val_chorus_f1": 0.5340010542962573,
      "val_chorus_rate": 0.6327924877405167,
      "val_max_prob": 0.6202558726072311,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009139031619084547,
      "epoch_time": 129.31784391403198,
      "val_boundary_f1": 0.15033557046979867,
      "val_boundary_precision": 0.17445482866043613,
      "val_boundary_recall": 0.1320754716981132,
      "val_complete_segments": 0.0560240156077908,
      "val_avg_segment_overlap": 0.33535596282126406,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.4697361476551058,
      "val_pk_metric": 0.42116859559102776
    },
    {
      "epoch": 3,
      "train_loss": 0.5171354010701179,
      "train_chorus_rate": 0.44601278454065324,
      "train_max_prob": 0.6553246915340424,
      "train_conf_over_90": 0.003304944292176515,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5248152241110802,
      "val_macro_f1": 0.731311668931109,
      "val_verse_f1": 0.8294964028776978,
      "val_chorus_f1": 0.6331269349845202,
      "val_chorus_rate": 0.33559492975473404,
      "val_max_prob": 0.6462566554546356,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000864035329270692,
      "epoch_time": 72.17657589912415,
      "val_boundary_f1": 0.3618581907090465,
      "val_boundary_precision": 0.2764632627646326,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.24250823312329145,
      "val_avg_segment_overlap": 0.638248022200051,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4427391865762902,
      "val_pk_metric": 0.3061404931722598
    },
    {
      "epoch": 4,
      "train_loss": 0.509313490986824,
      "train_chorus_rate": 0.40113956704735754,
      "train_max_prob": 0.6666439324617386,
      "train_conf_over_90": 0.0016936938161961734,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5105747282505035,
      "val_macro_f1": 0.7514062512124927,
      "val_verse_f1": 0.838157655197524,
      "val_chorus_f1": 0.6646548472274614,
      "val_chorus_rate": 0.3516571521759033,
      "val_max_prob": 0.6540041118860245,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007972991430892752,
      "epoch_time": 73.97423577308655,
      "val_boundary_f1": 0.39304347826086955,
      "val_boundary_precision": 0.31129476584022037,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.26833169899182624,
      "val_avg_segment_overlap": 0.6544176093768531,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.40769205046955537,
      "val_pk_metric": 0.27734406246348825
    },
    {
      "epoch": 5,
      "train_loss": 0.4799778819084167,
      "train_chorus_rate": 0.3763084903359413,
      "train_max_prob": 0.68584104180336,
      "train_conf_over_90": 0.008849328497308306,
      "train_conf_over_95": 7.418397581204772e-05,
      "val_loss": 0.4944625347852707,
      "val_macro_f1": 0.7125582485802981,
      "val_verse_f1": 0.7805362462760675,
      "val_chorus_f1": 0.6445802508845287,
      "val_chorus_rate": 0.4645790681242943,
      "val_max_prob": 0.6843629032373428,
      "val_conf_over_90": 0.01222203392535448,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007166112949360836,
      "epoch_time": 102.75013709068298,
      "val_boundary_f1": 0.3070175438596492,
      "val_boundary_precision": 0.24441340782122906,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.18357889399776992,
      "val_avg_segment_overlap": 0.6213571156654039,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4632303372375815,
      "val_pk_metric": 0.33426629920542483
    },
    {
      "epoch": 6,
      "train_loss": 0.47287514209747317,
      "train_chorus_rate": 0.36381606832146646,
      "train_max_prob": 0.7042793154716491,
      "train_conf_over_90": 0.018517244650865905,
      "train_conf_over_95": 0.0004278542153770104,
      "val_loss": 0.4834509491920471,
      "val_macro_f1": 0.7737176841476694,
      "val_verse_f1": 0.8524052478134111,
      "val_chorus_f1": 0.6950301204819278,
      "val_chorus_rate": 0.35275017470121384,
      "val_max_prob": 0.7272306829690933,
      "val_conf_over_90": 0.012679343344643712,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006254982309586641,
      "epoch_time": 85.38735485076904,
      "val_boundary_f1": 0.4066543438077634,
      "val_boundary_precision": 0.3343465045592705,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.28092092243735933,
      "val_avg_segment_overlap": 0.658182989909874,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3913608553809027,
      "val_pk_metric": 0.2574791129247141
    },
    {
      "epoch": 7,
      "train_loss": 0.45697122514247895,
      "train_chorus_rate": 0.35727423429489136,
      "train_max_prob": 0.7219913184642792,
      "train_conf_over_90": 0.04016804206185043,
      "train_conf_over_95": 0.005525583890266717,
      "val_loss": 0.49352628737688065,
      "val_macro_f1": 0.7075332529177807,
      "val_verse_f1": 0.7747603833865816,
      "val_chorus_f1": 0.6403061224489797,
      "val_chorus_rate": 0.47086823731660843,
      "val_max_prob": 0.688273012638092,
      "val_conf_over_90": 0.017610544920898974,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005279420292618187,
      "epoch_time": 99.20686388015747,
      "val_boundary_f1": 0.2676864244741874,
      "val_boundary_precision": 0.22508038585209003,
      "val_boundary_recall": 0.330188679245283,
      "val_complete_segments": 0.1661377234680522,
      "val_avg_segment_overlap": 0.5962919792056254,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.46164106449368825,
      "val_pk_metric": 0.3362494061855635
    },
    {
      "epoch": 8,
      "train_loss": 0.4629804387688637,
      "train_chorus_rate": 0.36033571884036064,
      "train_max_prob": 0.7044798552989959,
      "train_conf_over_90": 0.02158263430756051,
      "train_conf_over_95": 0.0007915117486845702,
      "val_loss": 0.49066317826509476,
      "val_macro_f1": 0.762686051317711,
      "val_verse_f1": 0.8460839542067963,
      "val_chorus_f1": 0.6792881484286256,
      "val_chorus_rate": 0.3493076264858246,
      "val_max_prob": 0.7323096841573715,
      "val_conf_over_90": 0.025437336415052414,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004282063639862929,
      "epoch_time": 104.92038607597351,
      "val_boundary_f1": 0.3891050583657588,
      "val_boundary_precision": 0.33112582781456956,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2688173270225232,
      "val_avg_segment_overlap": 0.655614683257362,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.398594758986582,
      "val_pk_metric": 0.27449074611672003
    },
    {
      "epoch": 9,
      "train_loss": 0.43723827302455903,
      "train_chorus_rate": 0.32177530974149704,
      "train_max_prob": 0.731282788515091,
      "train_conf_over_90": 0.04734256248921156,
      "train_conf_over_95": 0.006650452344911173,
      "val_loss": 0.48273415863513947,
      "val_macro_f1": 0.7494327024415658,
      "val_verse_f1": 0.8256120527306968,
      "val_chorus_f1": 0.6732533521524348,
      "val_chorus_rate": 0.3963148221373558,
      "val_max_prob": 0.7123965173959732,
      "val_conf_over_90": 0.02867221739143133,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003306501622894474,
      "epoch_time": 179.43768882751465,
      "val_boundary_f1": 0.3872146118721461,
      "val_boundary_precision": 0.31594634873323396,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.284822375397667,
      "val_avg_segment_overlap": 0.6471790112999946,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4087873640870241,
      "val_pk_metric": 0.28138939041784516
    },
    {
      "epoch": 10,
      "train_loss": 0.4316392719745636,
      "train_chorus_rate": 0.3482361644506454,
      "train_max_prob": 0.735421434044838,
      "train_conf_over_90": 0.059274039161391553,
      "train_conf_over_95": 0.010970297094900161,
      "val_loss": 0.4771924242377281,
      "val_macro_f1": 0.7523434612777243,
      "val_verse_f1": 0.8218600191754554,
      "val_chorus_f1": 0.6828269033799933,
      "val_chorus_rate": 0.42018211632966995,
      "val_max_prob": 0.73930923640728,
      "val_conf_over_90": 0.08167045190930367,
      "val_conf_over_95": 0.00906155671691522,
      "learning_rate": 0.00023953709831202793,
      "epoch_time": 150.34231901168823,
      "val_boundary_f1": 0.373953488372093,
      "val_boundary_precision": 0.3087557603686636,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2593818367678389,
      "val_avg_segment_overlap": 0.6475728421393834,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4124785064366935,
      "val_pk_metric": 0.2803959851346769
    },
    {
      "epoch": 11,
      "train_loss": 0.4212749734520912,
      "train_chorus_rate": 0.3187200628221035,
      "train_max_prob": 0.7502140462398529,
      "train_conf_over_90": 0.059823010582476854,
      "train_conf_over_95": 0.006956971838371828,
      "val_loss": 0.4859188497066498,
      "val_macro_f1": 0.7512859901584611,
      "val_verse_f1": 0.8219544846050869,
      "val_chorus_f1": 0.6806174957118353,
      "val_chorus_rate": 0.417031891644001,
      "val_max_prob": 0.7441198825836182,
      "val_conf_over_90": 0.10905214212834835,
      "val_conf_over_95": 0.013252351549454033,
      "learning_rate": 0.0001588492501588363,
      "epoch_time": 106.56300902366638,
      "val_boundary_f1": 0.37250996015936255,
      "val_boundary_precision": 0.32241379310344825,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.23785406183338315,
      "val_avg_segment_overlap": 0.6424396631131205,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.40081836233876394,
      "val_pk_metric": 0.2854353078366015
    }
  ]
}