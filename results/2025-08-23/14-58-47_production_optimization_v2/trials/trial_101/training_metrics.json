{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.22978828578022256,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.22044435326695355,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00019111317811544934,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.017450993269275038,
      "gradient_clip_norm": 0.3040458480748529,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09530517862915756,
        "ece_after": 0.019014621940249294,
        "improvement": 0.07629055668890827,
        "params": {
          "temperature": 0.5726843556658594
        }
      },
      "platt": {
        "ece_before": 0.09530517862915756,
        "ece_after": 0.01799930585273825,
        "improvement": 0.07730587277641932,
        "params": {
          "A": 1.707361062802107,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5407064661383629,
      "train_chorus_rate": 0.4062932427506894,
      "train_max_prob": 0.5594457030296326,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5710242390632629,
      "val_macro_f1": 0.5552154482786489,
      "val_verse_f1": 0.6493717065261452,
      "val_chorus_f1": 0.46105919003115264,
      "val_chorus_rate": 0.48914431780576706,
      "val_max_prob": 0.5594714879989624,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018903596357847737,
      "epoch_time": 118.25698184967041,
      "val_boundary_f1": 0.11678832116788321,
      "val_boundary_precision": 0.1532567049808429,
      "val_boundary_recall": 0.09433962264150944,
      "val_complete_segments": 0.027367952712597468,
      "val_avg_segment_overlap": 0.29498473934790764,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.47772446841170946,
      "val_pk_metric": 0.45832321988265934
    },
    {
      "epoch": 2,
      "train_loss": 0.5326442211866379,
      "train_chorus_rate": 0.4870896726846695,
      "train_max_prob": 0.5882210940122604,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.569608673453331,
      "val_macro_f1": 0.5885395615359034,
      "val_verse_f1": 0.6867565424266455,
      "val_chorus_f1": 0.4903225806451612,
      "val_chorus_rate": 0.4625913053750992,
      "val_max_prob": 0.5766385644674301,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018289510421040837,
      "epoch_time": 110.72063183784485,
      "val_boundary_f1": 0.1375515818431912,
      "val_boundary_precision": 0.16501650165016502,
      "val_boundary_recall": 0.1179245283018868,
      "val_complete_segments": 0.03402618836075888,
      "val_avg_segment_overlap": 0.3290705013314076,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.09595959595959595,
      "val_window_diff": 0.4716391700823135,
      "val_pk_metric": 0.421210915560827
    },
    {
      "epoch": 3,
      "train_loss": 0.5266956239938736,
      "train_chorus_rate": 0.4591211035847664,
      "train_max_prob": 0.5954716205596924,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.552131250500679,
      "val_macro_f1": 0.6201429607323137,
      "val_verse_f1": 0.7080175508575987,
      "val_chorus_f1": 0.5322683706070288,
      "val_chorus_rate": 0.47088808566331863,
      "val_max_prob": 0.5861484557390213,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017295898503273959,
      "epoch_time": 100.4375810623169,
      "val_boundary_f1": 0.18048780487804877,
      "val_boundary_precision": 0.18686868686868688,
      "val_boundary_recall": 0.17452830188679244,
      "val_complete_segments": 0.07913746006269867,
      "val_avg_segment_overlap": 0.3891146789369847,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.15151515151515152,
      "val_window_diff": 0.4265462228740524,
      "val_pk_metric": 0.3701321139418063
    },
    {
      "epoch": 4,
      "train_loss": 0.5118425980210304,
      "train_chorus_rate": 0.4462956741452217,
      "train_max_prob": 0.6222820818424225,
      "train_conf_over_90": 0.001060614426387474,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5327602922916412,
      "val_macro_f1": 0.6850429980842816,
      "val_verse_f1": 0.7811853245531515,
      "val_chorus_f1": 0.5889006716154118,
      "val_chorus_rate": 0.39676570147275925,
      "val_max_prob": 0.6399561911821365,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015966186213232477,
      "epoch_time": 102.49840688705444,
      "val_boundary_f1": 0.290950744558992,
      "val_boundary_precision": 0.2828507795100223,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.151799839909596,
      "val_avg_segment_overlap": 0.49168120511370106,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.23232323232323232,
      "val_window_diff": 0.3917532389358249,
      "val_pk_metric": 0.3237055803000565
    },
    {
      "epoch": 5,
      "train_loss": 0.4923157155513763,
      "train_chorus_rate": 0.40635099858045576,
      "train_max_prob": 0.6617837518453598,
      "train_conf_over_90": 0.006262498526484706,
      "train_conf_over_95": 3.5410764394328e-05,
      "val_loss": 0.5224984511733055,
      "val_macro_f1": 0.6470876823385894,
      "val_verse_f1": 0.7102686940220787,
      "val_chorus_f1": 0.5839066706551002,
      "val_chorus_rate": 0.5224420577287674,
      "val_max_prob": 0.6456333547830582,
      "val_conf_over_90": 0.007597212854307145,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000143584883586587,
      "epoch_time": 92.47082495689392,
      "val_boundary_f1": 0.24554455445544557,
      "val_boundary_precision": 0.21160409556313994,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.12182811504126456,
      "val_avg_segment_overlap": 0.4665029608600375,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.2878787878787879,
      "val_window_diff": 0.47786448537057563,
      "val_pk_metric": 0.38324595493622887
    },
    {
      "epoch": 6,
      "train_loss": 0.4850186973810196,
      "train_chorus_rate": 0.3562934763729572,
      "train_max_prob": 0.6668593317270279,
      "train_conf_over_90": 0.005979029182344675,
      "train_conf_over_95": 0.00011624394683167339,
      "val_loss": 0.5082072019577026,
      "val_macro_f1": 0.6911312959883508,
      "val_verse_f1": 0.7595496582227583,
      "val_chorus_f1": 0.6227129337539432,
      "val_chorus_rate": 0.48032815754413605,
      "val_max_prob": 0.647191509604454,
      "val_conf_over_90": 0.00240224547451362,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012543069050387727,
      "epoch_time": 111.15456891059875,
      "val_boundary_f1": 0.3139866793529971,
      "val_boundary_precision": 0.2631578947368421,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.1896521616298923,
      "val_avg_segment_overlap": 0.5576923197405619,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.4128044774542487,
      "val_pk_metric": 0.30578548786480103
    },
    {
      "epoch": 7,
      "train_loss": 0.4837702661752701,
      "train_chorus_rate": 0.3885321766138077,
      "train_max_prob": 0.6818243116140366,
      "train_conf_over_90": 0.01776800775260199,
      "train_conf_over_95": 0.0009237744059646502,
      "val_loss": 0.5041107013821602,
      "val_macro_f1": 0.6729102351282178,
      "val_verse_f1": 0.7336371168185586,
      "val_chorus_f1": 0.612183353437877,
      "val_chorus_rate": 0.5157821252942085,
      "val_max_prob": 0.6722456216812134,
      "val_conf_over_90": 0.01344674953725189,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.00010599270823539349,
      "epoch_time": 105.07115697860718,
      "val_boundary_f1": 0.2975206611570248,
      "val_boundary_precision": 0.24360902255639097,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.166399422828373,
      "val_avg_segment_overlap": 0.5452776814944171,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.44727696177234666,
      "val_pk_metric": 0.3335649737520662
    },
    {
      "epoch": 8,
      "train_loss": 0.46672894805669785,
      "train_chorus_rate": 0.38290787637233736,
      "train_max_prob": 0.6805734515190125,
      "train_conf_over_90": 0.017766666924580933,
      "train_conf_over_95": 0.0010909356991760434,
      "val_loss": 0.5067502111196518,
      "val_macro_f1": 0.7423643023643023,
      "val_verse_f1": 0.8354978354978355,
      "val_chorus_f1": 0.6492307692307692,
      "val_chorus_rate": 0.3401446267962456,
      "val_max_prob": 0.6909091621637344,
      "val_conf_over_90": 0.015844717505387962,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.61204698800559e-05,
      "epoch_time": 115.17752289772034,
      "val_boundary_f1": 0.38461538461538464,
      "val_boundary_precision": 0.3143712574850299,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.29738244341902875,
      "val_avg_segment_overlap": 0.6230950976812538,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3619047050202984,
      "val_pk_metric": 0.2588755768771363
    },
    {
      "epoch": 9,
      "train_loss": 0.4903304114937782,
      "train_chorus_rate": 0.3920804925262928,
      "train_max_prob": 0.6774045944213867,
      "train_conf_over_90": 0.020865919976495208,
      "train_conf_over_95": 0.0016815067850984634,
      "val_loss": 0.5248043835163116,
      "val_macro_f1": 0.7431921648516349,
      "val_verse_f1": 0.8528652555498194,
      "val_chorus_f1": 0.6335190741534504,
      "val_chorus_rate": 0.274236798286438,
      "val_max_prob": 0.694521889090538,
      "val_conf_over_90": 0.006986248132307082,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.66824876115721e-05,
      "epoch_time": 96.28217196464539,
      "val_boundary_f1": 0.3981132075471698,
      "val_boundary_precision": 0.33176100628930816,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.28304855188471306,
      "val_avg_segment_overlap": 0.6260666183949991,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.35328377291362456,
      "val_pk_metric": 0.25392780776752455
    },
    {
      "epoch": 10,
      "train_loss": 0.4802651509642601,
      "train_chorus_rate": 0.37926881685853003,
      "train_max_prob": 0.6744854807853699,
      "train_conf_over_90": 0.01079786621266976,
      "train_conf_over_95": 0.0005691623722668737,
      "val_loss": 0.49959784001111984,
      "val_macro_f1": 0.6865409155521095,
      "val_verse_f1": 0.7524350649350648,
      "val_chorus_f1": 0.6206467661691542,
      "val_chorus_rate": 0.4910953864455223,
      "val_max_prob": 0.6791919618844986,
      "val_conf_over_90": 0.020616400986909866,
      "val_conf_over_95": 0.0016581221716478467,
      "learning_rate": 4.8528294528862366e-05,
      "epoch_time": 93.24112105369568,
      "val_boundary_f1": 0.2991985752448798,
      "val_boundary_precision": 0.24034334763948498,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.16463958845984297,
      "val_avg_segment_overlap": 0.5710855869056611,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4605207041252375,
      "val_pk_metric": 0.34182696211256036
    },
    {
      "epoch": 11,
      "train_loss": 0.4665010154247284,
      "train_chorus_rate": 0.3538306728005409,
      "train_max_prob": 0.6866152703762054,
      "train_conf_over_90": 0.015484455047408118,
      "train_conf_over_95": 0.0009058967436430976,
      "val_loss": 0.5012481957674026,
      "val_macro_f1": 0.7407661100262494,
      "val_verse_f1": 0.8298300127947359,
      "val_chorus_f1": 0.6517022072577628,
      "val_chorus_rate": 0.3578275069594383,
      "val_max_prob": 0.6867072880268097,
      "val_conf_over_90": 0.01425528444815427,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.2451315983124586e-05,
      "epoch_time": 108.49190664291382,
      "val_boundary_f1": 0.37636363636363634,
      "val_boundary_precision": 0.3062130177514793,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2848028076554058,
      "val_avg_segment_overlap": 0.6337810338501897,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3695437654307816,
      "val_pk_metric": 0.26079220485736876
    },
    {
      "epoch": 12,
      "train_loss": 0.4716812774538994,
      "train_chorus_rate": 0.403898324072361,
      "train_max_prob": 0.6865375816822052,
      "train_conf_over_90": 0.02310560685582459,
      "train_conf_over_95": 0.0025492560816928744,
      "val_loss": 0.4980604276061058,
      "val_macro_f1": 0.6946461079188362,
      "val_verse_f1": 0.7652104528226612,
      "val_chorus_f1": 0.6240817630150111,
      "val_chorus_rate": 0.47016139328479767,
      "val_max_prob": 0.679854542016983,
      "val_conf_over_90": 0.022123015020042658,
      "val_conf_over_95": 0.0026979242684319615,
      "learning_rate": 1.915419308270975e-05,
      "epoch_time": 99.0972101688385,
      "val_boundary_f1": 0.3153153153153153,
      "val_boundary_precision": 0.25510204081632654,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.1836322404058353,
      "val_avg_segment_overlap": 0.583506447351033,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.44834045475626383,
      "val_pk_metric": 0.32271492638663946
    },
    {
      "epoch": 13,
      "train_loss": 0.4692272663116455,
      "train_chorus_rate": 0.39751177132129667,
      "train_max_prob": 0.686244985461235,
      "train_conf_over_90": 0.02542342330561951,
      "train_conf_over_95": 0.0032307472109096127,
      "val_loss": 0.49643147736787796,
      "val_macro_f1": 0.7013374976799555,
      "val_verse_f1": 0.7730693069306931,
      "val_chorus_f1": 0.6296056884292178,
      "val_chorus_rate": 0.46100134402513504,
      "val_max_prob": 0.6767747700214386,
      "val_conf_over_90": 0.021147934370674193,
      "val_conf_over_95": 0.0011857748322654516,
      "learning_rate": 9.21807390504093e-06,
      "epoch_time": 102.02190709114075,
      "val_boundary_f1": 0.3111510791366906,
      "val_boundary_precision": 0.251453488372093,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.18695486692570468,
      "val_avg_segment_overlap": 0.586248938652002,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.45002487403328223,
      "val_pk_metric": 0.3190273510565307
    },
    {
      "epoch": 14,
      "train_loss": 0.46422622799873353,
      "train_chorus_rate": 0.38806294947862624,
      "train_max_prob": 0.686409592628479,
      "train_conf_over_90": 0.02348827288951725,
      "train_conf_over_95": 0.0025946636713342743,
      "val_loss": 0.49653545767068863,
      "val_macro_f1": 0.7254418026636189,
      "val_verse_f1": 0.8054763262977752,
      "val_chorus_f1": 0.6454072790294627,
      "val_chorus_rate": 0.4100317656993866,
      "val_max_prob": 0.6857745349407196,
      "val_conf_over_90": 0.017892677919007838,
      "val_conf_over_95": 0.0011857748322654516,
      "learning_rate": 3.077214536971957e-06,
      "epoch_time": 96.81918525695801,
      "val_boundary_f1": 0.34507678410117437,
      "val_boundary_precision": 0.2796486090775988,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.22807914716716415,
      "val_avg_segment_overlap": 0.6173998594733673,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.41046398144675833,
      "val_pk_metric": 0.2899942887432786
    },
    {
      "epoch": 15,
      "train_loss": 0.4618750631809235,
      "train_chorus_rate": 0.3581321373581886,
      "train_max_prob": 0.694299966096878,
      "train_conf_over_90": 0.025543246977031232,
      "train_conf_over_95": 0.0032120720599777995,
      "val_loss": 0.4954797253012657,
      "val_macro_f1": 0.7240659857296498,
      "val_verse_f1": 0.803281816447243,
      "val_chorus_f1": 0.6448501550120566,
      "val_chorus_rate": 0.4142737165093422,
      "val_max_prob": 0.6833810955286026,
      "val_conf_over_90": 0.018621143070049584,
      "val_conf_over_95": 0.0011857748322654516,
      "learning_rate": 1e-06,
      "epoch_time": 108.4641809463501,
      "val_boundary_f1": 0.3375451263537906,
      "val_boundary_precision": 0.2733918128654971,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2228185294065464,
      "val_avg_segment_overlap": 0.6155240767018564,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.40759285536791573,
      "val_pk_metric": 0.29055113468326904
    }
  ]
}