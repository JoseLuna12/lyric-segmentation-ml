{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.18241363640576885,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.22243926306352135,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00039152875751860886,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.012141645757854341,
      "gradient_clip_norm": 0.30525353467920735,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08070639245695121,
        "ece_after": 0.017857608251815236,
        "improvement": 0.06284878420513598,
        "params": {
          "temperature": 0.6518838883367809
        }
      },
      "platt": {
        "ece_before": 0.08070639245695121,
        "ece_after": 0.019512937629269693,
        "improvement": 0.06119345482768152,
        "params": {
          "A": 1.5067752046916634,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5654560923576355,
      "train_chorus_rate": 0.4594547494314611,
      "train_max_prob": 0.5638611912727356,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5857301354408264,
      "val_macro_f1": 0.5719362116257846,
      "val_verse_f1": 0.7965856015461427,
      "val_chorus_f1": 0.3472868217054264,
      "val_chorus_rate": 0.1756948959082365,
      "val_max_prob": 0.5804762244224548,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00038726176235149515,
      "epoch_time": 52.66648483276367,
      "val_boundary_f1": 0.182076813655761,
      "val_boundary_precision": 0.22939068100358423,
      "val_boundary_recall": 0.1509433962264151,
      "val_complete_segments": 0.07268326120393989,
      "val_avg_segment_overlap": 0.2938831341697422,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.3247718479222223,
      "val_pk_metric": 0.306207134679904
    },
    {
      "epoch": 2,
      "train_loss": 0.5486653774976731,
      "train_chorus_rate": 0.35045678708702327,
      "train_max_prob": 0.5852231979370117,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.564624011516571,
      "val_macro_f1": 0.6604414913910432,
      "val_verse_f1": 0.8109579717542964,
      "val_chorus_f1": 0.50992501102779,
      "val_chorus_rate": 0.257633525878191,
      "val_max_prob": 0.5938599407672882,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00037464726501427136,
      "epoch_time": 49.43543815612793,
      "val_boundary_f1": 0.2782782782782783,
      "val_boundary_precision": 0.2417391304347826,
      "val_boundary_recall": 0.3278301886792453,
      "val_complete_segments": 0.15996178916380402,
      "val_avg_segment_overlap": 0.4708751938591121,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.3440304990507682,
      "val_pk_metric": 0.28812258737553154
    },
    {
      "epoch": 3,
      "train_loss": 0.5072595700621605,
      "train_chorus_rate": 0.4269540935754776,
      "train_max_prob": 0.6426340222358704,
      "train_conf_over_90": 0.007142687652958557,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5335328951478004,
      "val_macro_f1": 0.6924973467221813,
      "val_verse_f1": 0.7961058045554739,
      "val_chorus_f1": 0.5888888888888888,
      "val_chorus_rate": 0.36460762470960617,
      "val_max_prob": 0.681351438164711,
      "val_conf_over_90": 0.037693667225539684,
      "val_conf_over_95": 0.0012710694136330858,
      "learning_rate": 0.0003542365795716483,
      "epoch_time": 61.61394715309143,
      "val_boundary_f1": 0.29616724738675965,
      "val_boundary_precision": 0.23480662983425415,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.17958576096168885,
      "val_avg_segment_overlap": 0.5560501323658261,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.38362219630981537,
      "val_pk_metric": 0.3097371313741901
    },
    {
      "epoch": 4,
      "train_loss": 0.4945330128073692,
      "train_chorus_rate": 0.3745592460036278,
      "train_max_prob": 0.6689712136983872,
      "train_conf_over_90": 0.02068065768107772,
      "train_conf_over_95": 0.0012648148374864831,
      "val_loss": 0.5408357381820679,
      "val_macro_f1": 0.7133439018413592,
      "val_verse_f1": 0.8466051969823973,
      "val_chorus_f1": 0.5800826067003212,
      "val_chorus_rate": 0.2365795560181141,
      "val_max_prob": 0.7171211093664169,
      "val_conf_over_90": 0.049201635643839836,
      "val_conf_over_95": 0.0015023367595858872,
      "learning_rate": 0.00032692175091880363,
      "epoch_time": 60.592427015304565,
      "val_boundary_f1": 0.35567970204841715,
      "val_boundary_precision": 0.29384615384615387,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.2230112554608843,
      "val_avg_segment_overlap": 0.5714717706780365,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.3407946962425426,
      "val_pk_metric": 0.2719812568180892
    },
    {
      "epoch": 5,
      "train_loss": 0.503505066037178,
      "train_chorus_rate": 0.357535894960165,
      "train_max_prob": 0.6902479112148285,
      "train_conf_over_90": 0.033408445003442463,
      "train_conf_over_95": 0.0019439897267147898,
      "val_loss": 0.5527019798755646,
      "val_macro_f1": 0.6958608301030538,
      "val_verse_f1": 0.843150231634679,
      "val_chorus_f1": 0.5485714285714287,
      "val_chorus_rate": 0.21718857809901237,
      "val_max_prob": 0.7025244981050491,
      "val_conf_over_90": 0.021112585673108697,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002938965681389567,
      "epoch_time": 49.50017309188843,
      "val_boundary_f1": 0.33142857142857146,
      "val_boundary_precision": 0.2779552715654952,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.2049038945778076,
      "val_avg_segment_overlap": 0.5693650248032983,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.36165238572458835,
      "val_pk_metric": 0.2734567698813311
    },
    {
      "epoch": 6,
      "train_loss": 0.5042968258261681,
      "train_chorus_rate": 0.42600774168968203,
      "train_max_prob": 0.6748356461524964,
      "train_conf_over_90": 0.015725774376187475,
      "train_conf_over_95": 0.0004094568139407784,
      "val_loss": 0.5234180986881256,
      "val_macro_f1": 0.7318271940778278,
      "val_verse_f1": 0.8527420446851727,
      "val_chorus_f1": 0.6109123434704831,
      "val_chorus_rate": 0.250753715634346,
      "val_max_prob": 0.6973222196102142,
      "val_conf_over_90": 0.017676852643489838,
      "val_conf_over_95": 0.00048216007417067885,
      "learning_rate": 0.0002566043901919961,
      "epoch_time": 51.54428315162659,
      "val_boundary_f1": 0.35522664199814985,
      "val_boundary_precision": 0.2922374429223744,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.2393150061893434,
      "val_avg_segment_overlap": 0.61329263774893,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.35155645140487224,
      "val_pk_metric": 0.2690595458081059
    },
    {
      "epoch": 7,
      "train_loss": 0.46735169291496276,
      "train_chorus_rate": 0.330797852948308,
      "train_max_prob": 0.7012674987316132,
      "train_conf_over_90": 0.03540492984466255,
      "train_conf_over_95": 0.002750242661568336,
      "val_loss": 0.5070219933986664,
      "val_macro_f1": 0.7087977038265785,
      "val_verse_f1": 0.7902513912876608,
      "val_chorus_f1": 0.6273440163654961,
      "val_chorus_rate": 0.4215215817093849,
      "val_max_prob": 0.6870747059583664,
      "val_conf_over_90": 0.03418469475582242,
      "val_conf_over_95": 0.0039843416307121515,
      "learning_rate": 0.0002166750642019276,
      "epoch_time": 66.70000791549683,
      "val_boundary_f1": 0.2791922739244952,
      "val_boundary_precision": 0.22237762237762237,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.15711394055773695,
      "val_avg_segment_overlap": 0.5877064227670079,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.47259878711618136,
      "val_pk_metric": 0.35314286719388593
    },
    {
      "epoch": 8,
      "train_loss": 0.465134771168232,
      "train_chorus_rate": 0.3278211019933224,
      "train_max_prob": 0.6933291524648666,
      "train_conf_over_90": 0.023960500792600214,
      "train_conf_over_95": 0.0033000399300362913,
      "val_loss": 0.5065333247184753,
      "val_macro_f1": 0.7366769520605382,
      "val_verse_f1": 0.8342590933524457,
      "val_chorus_f1": 0.6390948107686306,
      "val_chorus_rate": 0.33119750022888184,
      "val_max_prob": 0.7190308421850204,
      "val_conf_over_90": 0.05059845093637705,
      "val_conf_over_95": 0.007289919245522469,
      "learning_rate": 0.00017585369331668137,
      "epoch_time": 56.67702293395996,
      "val_boundary_f1": 0.34054054054054056,
      "val_boundary_precision": 0.2755102040816326,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.21396459518145627,
      "val_avg_segment_overlap": 0.6207119493654706,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4048069359886944,
      "val_pk_metric": 0.28748972609311435
    },
    {
      "epoch": 9,
      "train_loss": 0.46774846166372297,
      "train_chorus_rate": 0.36475382894277575,
      "train_max_prob": 0.7045079201459885,
      "train_conf_over_90": 0.04449361292645335,
      "train_conf_over_95": 0.00797467351949308,
      "val_loss": 0.48782820254564285,
      "val_macro_f1": 0.7294490981342341,
      "val_verse_f1": 0.811238921365265,
      "val_chorus_f1": 0.6476592749032032,
      "val_chorus_rate": 0.3992384001612663,
      "val_max_prob": 0.708537682890892,
      "val_conf_over_90": 0.04973289463669062,
      "val_conf_over_95": 0.005033646506490186,
      "learning_rate": 0.0001359243673266129,
      "epoch_time": 325.06708574295044,
      "val_boundary_f1": 0.3394255874673629,
      "val_boundary_precision": 0.2689655172413793,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2427108709982517,
      "val_avg_segment_overlap": 0.623572752105912,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3814367519316963,
      "val_pk_metric": 0.28810570415046766
    },
    {
      "epoch": 10,
      "train_loss": 0.46809588074684144,
      "train_chorus_rate": 0.37159380614757537,
      "train_max_prob": 0.6972926169633865,
      "train_conf_over_90": 0.032672328222543,
      "train_conf_over_95": 0.003579040663316846,
      "val_loss": 0.5029172748327255,
      "val_macro_f1": 0.7528629907201725,
      "val_verse_f1": 0.8571921947850112,
      "val_chorus_f1": 0.6485337866553337,
      "val_chorus_rate": 0.2797375060617924,
      "val_max_prob": 0.7165686935186386,
      "val_conf_over_90": 0.029755003284662962,
      "val_conf_over_95": 0.0009894808172248304,
      "learning_rate": 9.863218937965227e-05,
      "epoch_time": 186.3548309803009,
      "val_boundary_f1": 0.3744207599629287,
      "val_boundary_precision": 0.3083969465648855,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2677298416428851,
      "val_avg_segment_overlap": 0.6480795434650044,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.35502129763217494,
      "val_pk_metric": 0.2561692773082622
    },
    {
      "epoch": 11,
      "train_loss": 0.45526422262191774,
      "train_chorus_rate": 0.3101933814585209,
      "train_max_prob": 0.7112502694129944,
      "train_conf_over_90": 0.037018595775589344,
      "train_conf_over_95": 0.003434663458028808,
      "val_loss": 0.4886411726474762,
      "val_macro_f1": 0.7606836154351619,
      "val_verse_f1": 0.8528368794326241,
      "val_chorus_f1": 0.6685303514376997,
      "val_chorus_rate": 0.31657877564430237,
      "val_max_prob": 0.7118739485740662,
      "val_conf_over_90": 0.03167332382872701,
      "val_conf_over_95": 0.0018133634584955871,
      "learning_rate": 6.560700659980536e-05,
      "epoch_time": 55.88431096076965,
      "val_boundary_f1": 0.3832116788321168,
      "val_boundary_precision": 0.3125,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.28723241496306184,
      "val_avg_segment_overlap": 0.658290727040284,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.35377557864450393,
      "val_pk_metric": 0.25747035169748356
    },
    {
      "epoch": 12,
      "train_loss": 0.44491958171129226,
      "train_chorus_rate": 0.33955163434147834,
      "train_max_prob": 0.7185341536998748,
      "train_conf_over_90": 0.053448318410664795,
      "train_conf_over_95": 0.008838343538809568,
      "val_loss": 0.48359591513872147,
      "val_macro_f1": 0.7544342713491905,
      "val_verse_f1": 0.8401892974153622,
      "val_chorus_f1": 0.6686792452830188,
      "val_chorus_rate": 0.3524036929011345,
      "val_max_prob": 0.7021647244691849,
      "val_conf_over_90": 0.030685353092849255,
      "val_conf_over_95": 0.0028234175842953846,
      "learning_rate": 3.8292177946960646e-05,
      "epoch_time": 48.79434609413147,
      "val_boundary_f1": 0.37871956717763755,
      "val_boundary_precision": 0.30656934306569344,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2692160005786729,
      "val_avg_segment_overlap": 0.6532906365799733,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.38279619372421914,
      "val_pk_metric": 0.2751277200713351
    },
    {
      "epoch": 13,
      "train_loss": 0.4545234560966492,
      "train_chorus_rate": 0.37246683090925214,
      "train_max_prob": 0.7086940050125122,
      "train_conf_over_90": 0.0494032371789217,
      "train_conf_over_95": 0.008865399798378349,
      "val_loss": 0.47993431985378265,
      "val_macro_f1": 0.7509508493024212,
      "val_verse_f1": 0.8337633615923332,
      "val_chorus_f1": 0.6681383370125091,
      "val_chorus_rate": 0.368986077606678,
      "val_max_prob": 0.7022793591022491,
      "val_conf_over_90": 0.03919665887951851,
      "val_conf_over_95": 0.003330738327349536,
      "learning_rate": 1.788149250433749e-05,
      "epoch_time": 53.440359115600586,
      "val_boundary_f1": 0.366696191319752,
      "val_boundary_precision": 0.2936170212765957,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2679945435512774,
      "val_avg_segment_overlap": 0.6539148734946714,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3672959978006695,
      "val_pk_metric": 0.2760719718588445
    },
    {
      "epoch": 14,
      "train_loss": 0.44190204590559007,
      "train_chorus_rate": 0.329852170497179,
      "train_max_prob": 0.7128896921873092,
      "train_conf_over_90": 0.04380837013013661,
      "train_conf_over_95": 0.004571634327294305,
      "val_loss": 0.483169749379158,
      "val_macro_f1": 0.7616275715109104,
      "val_verse_f1": 0.8500806018269749,
      "val_chorus_f1": 0.6731745411948459,
      "val_chorus_rate": 0.33064986020326614,
      "val_max_prob": 0.7138656079769135,
      "val_conf_over_90": 0.04015116719529033,
      "val_conf_over_95": 0.0028181922243675217,
      "learning_rate": 5.266995167113712e-06,
      "epoch_time": 54.2846782207489,
      "val_boundary_f1": 0.3952855847688123,
      "val_boundary_precision": 0.32106038291605304,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.2874533410853665,
      "val_avg_segment_overlap": 0.6588129352652494,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3558237687071083,
      "val_pk_metric": 0.26242838542859703
    },
    {
      "epoch": 15,
      "train_loss": 0.43724225610494616,
      "train_chorus_rate": 0.32478229254484176,
      "train_max_prob": 0.7249041587114334,
      "train_conf_over_90": 0.05602698437869549,
      "train_conf_over_95": 0.008632019444485195,
      "val_loss": 0.4810146242380142,
      "val_macro_f1": 0.7563542206196009,
      "val_verse_f1": 0.8407805945650192,
      "val_chorus_f1": 0.6719278466741826,
      "val_chorus_rate": 0.3548816069960594,
      "val_max_prob": 0.7120095044374466,
      "val_conf_over_90": 0.046845159493386745,
      "val_conf_over_95": 0.004797791916644201,
      "learning_rate": 1e-06,
      "epoch_time": 59.58426904678345,
      "val_boundary_f1": 0.3825929283771532,
      "val_boundary_precision": 0.31075110456553756,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.2764106175558986,
      "val_avg_segment_overlap": 0.6593663887690397,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.363932088644267,
      "val_pk_metric": 0.2733384886641701
    }
  ]
}