{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19042694975494576,
      "layer_dropout": 0.20513400970173437,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17704429127251925,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009623753550721938,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.009210571761454149,
      "gradient_clip_norm": 0.3661192056878284,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1402145421867989,
        "ece_after": 0.024143179633411324,
        "improvement": 0.11607136255338758,
        "params": {
          "temperature": 0.4490796110635013
        }
      },
      "platt": {
        "ece_before": 0.1402145421867989,
        "ece_after": 0.14021463061304132,
        "improvement": -8.842624241167663e-08,
        "params": {
          "A": 0.9999996905404599,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6161685049533844,
      "train_chorus_rate": 0.46105138838174753,
      "train_max_prob": 0.590644484758377,
      "train_conf_over_90": 0.02177121788263321,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5937831550836563,
      "val_macro_f1": 0.4899297303833543,
      "val_verse_f1": 0.48905289052890527,
      "val_chorus_f1": 0.4908065702378034,
      "val_chorus_rate": 0.7022365778684616,
      "val_max_prob": 0.5347567945718765,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009518711760203353,
      "epoch_time": 84.20870280265808,
      "val_boundary_f1": 0.08424908424908424,
      "val_boundary_precision": 0.1885245901639344,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.02883621577948195,
      "val_avg_segment_overlap": 0.21668488228636695,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42831240417117433,
      "val_pk_metric": 0.43662350960112273
    },
    {
      "epoch": 2,
      "train_loss": 0.5660259753465653,
      "train_chorus_rate": 0.5393593764165416,
      "train_max_prob": 0.5570503830909729,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5991633981466293,
      "val_macro_f1": 0.5341325398883086,
      "val_verse_f1": 0.6356120185521275,
      "val_chorus_f1": 0.43265306122448977,
      "val_chorus_rate": 0.48252590745687485,
      "val_max_prob": 0.5677173584699631,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009208177218939694,
      "epoch_time": 73.41773796081543,
      "val_boundary_f1": 0.0736842105263158,
      "val_boundary_precision": 0.14383561643835616,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.012481114655027698,
      "val_avg_segment_overlap": 0.21661311634746117,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.45733573049295406,
      "val_pk_metric": 0.46906769520189096
    },
    {
      "epoch": 3,
      "train_loss": 0.5719949454069138,
      "train_chorus_rate": 0.5331747404765338,
      "train_max_prob": 0.5865194886922837,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5843795835971832,
      "val_macro_f1": 0.433362453741178,
      "val_verse_f1": 0.36837725381414704,
      "val_chorus_f1": 0.4983476536682089,
      "val_chorus_rate": 0.8153469562530518,
      "val_max_prob": 0.5736249834299088,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008705721776494239,
      "epoch_time": 50.8792290687561,
      "val_boundary_f1": 0.06908462867012091,
      "val_boundary_precision": 0.12903225806451613,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.029151670986241503,
      "val_avg_segment_overlap": 0.19912313985973956,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4082067246745668,
      "val_pk_metric": 0.40004222043858884
    },
    {
      "epoch": 4,
      "train_loss": 0.5662246987223625,
      "train_chorus_rate": 0.40645726965740325,
      "train_max_prob": 0.6159844547510147,
      "train_conf_over_90": 0.001431440480519086,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5599378049373627,
      "val_macro_f1": 0.6951838000522645,
      "val_verse_f1": 0.7950425453200147,
      "val_chorus_f1": 0.5953250547845143,
      "val_chorus_rate": 0.3748544678092003,
      "val_max_prob": 0.5773892402648926,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008033305146750567,
      "epoch_time": 58.26055407524109,
      "val_boundary_f1": 0.31898238747553814,
      "val_boundary_precision": 0.2725752508361204,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.18154246694808732,
      "val_avg_segment_overlap": 0.5710651809815184,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.420287418309955,
      "val_pk_metric": 0.32140429705989043
    },
    {
      "epoch": 5,
      "train_loss": 0.5251720786094666,
      "train_chorus_rate": 0.4512912891805172,
      "train_max_prob": 0.6461367934942246,
      "train_conf_over_90": 0.003918616593000479,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5344154015183449,
      "val_macro_f1": 0.7400014844674452,
      "val_verse_f1": 0.8371178258537457,
      "val_chorus_f1": 0.6428851430811446,
      "val_chorus_rate": 0.3275783509016037,
      "val_max_prob": 0.6595182567834854,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007220315163041453,
      "epoch_time": 57.76639008522034,
      "val_boundary_f1": 0.36194029850746273,
      "val_boundary_precision": 0.2993827160493827,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2400892029736144,
      "val_avg_segment_overlap": 0.6345614178851224,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.3634201872085464,
      "val_pk_metric": 0.26333255595627697
    },
    {
      "epoch": 6,
      "train_loss": 0.5153299480676651,
      "train_chorus_rate": 0.4094646990299225,
      "train_max_prob": 0.6533321529626847,
      "train_conf_over_90": 0.004301701721851714,
      "train_conf_over_95": 6.4184854272753e-05,
      "val_loss": 0.5145166143774986,
      "val_macro_f1": 0.6812760358195176,
      "val_verse_f1": 0.7437371663244352,
      "val_chorus_f1": 0.6188149053145999,
      "val_chorus_rate": 0.5046041682362556,
      "val_max_prob": 0.7089567631483078,
      "val_conf_over_90": 0.011279796191956848,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006302283388813755,
      "epoch_time": 51.754953145980835,
      "val_boundary_f1": 0.28014842300556586,
      "val_boundary_precision": 0.2308868501529052,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.15102995928817772,
      "val_avg_segment_overlap": 0.5764735313867331,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4865824777740603,
      "val_pk_metric": 0.35736400030452253
    },
    {
      "epoch": 7,
      "train_loss": 0.5038553953170777,
      "train_chorus_rate": 0.3912170320749283,
      "train_max_prob": 0.6816507518291474,
      "train_conf_over_90": 0.022051207974436694,
      "train_conf_over_95": 0.0011169035162311048,
      "val_loss": 0.519467182457447,
      "val_macro_f1": 0.7149539758314479,
      "val_verse_f1": 0.7959456875119525,
      "val_chorus_f1": 0.6339622641509434,
      "val_chorus_rate": 0.4168892279267311,
      "val_max_prob": 0.6399800330400467,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005319332217806425,
      "epoch_time": 103.24917697906494,
      "val_boundary_f1": 0.29775784753363227,
      "val_boundary_precision": 0.2402315484804631,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.18676780476886523,
      "val_avg_segment_overlap": 0.6135871650956252,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.46625223239312175,
      "val_pk_metric": 0.3470133445345875
    },
    {
      "epoch": 8,
      "train_loss": 0.4923401474952698,
      "train_chorus_rate": 0.3836610019207001,
      "train_max_prob": 0.6686867088079452,
      "train_conf_over_90": 0.009378489200025797,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5017420873045921,
      "val_macro_f1": 0.7616591294273672,
      "val_verse_f1": 0.8453008543901109,
      "val_chorus_f1": 0.6780174044646236,
      "val_chorus_rate": 0.3501024469733238,
      "val_max_prob": 0.7090740948915482,
      "val_conf_over_90": 0.011360099713783711,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004314421332915515,
      "epoch_time": 73.18198704719543,
      "val_boundary_f1": 0.3627546071774976,
      "val_boundary_precision": 0.30807248764415157,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.24483532729821172,
      "val_avg_segment_overlap": 0.6574688148854118,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3732914226815016,
      "val_pk_metric": 0.26123284189894597
    },
    {
      "epoch": 9,
      "train_loss": 0.47892712205648424,
      "train_chorus_rate": 0.31849007681012154,
      "train_max_prob": 0.6917530864477157,
      "train_conf_over_90": 0.017141503730090334,
      "train_conf_over_95": 0.00027316103805787864,
      "val_loss": 0.5058496743440628,
      "val_macro_f1": 0.719136551086711,
      "val_verse_f1": 0.7964567687271327,
      "val_chorus_f1": 0.6418163334462894,
      "val_chorus_rate": 0.42552221566438675,
      "val_max_prob": 0.6909500509500504,
      "val_conf_over_90": 0.024400827009230852,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033314701619081843,
      "epoch_time": 132.63212490081787,
      "val_boundary_f1": 0.2831379621280433,
      "val_boundary_precision": 0.2291970802919708,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.16236625013136147,
      "val_avg_segment_overlap": 0.6151255576824686,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.46958220232663006,
      "val_pk_metric": 0.3400393304846383
    },
    {
      "epoch": 10,
      "train_loss": 0.4745667040348053,
      "train_chorus_rate": 0.34486559256911276,
      "train_max_prob": 0.6982411235570908,
      "train_conf_over_90": 0.022297906642779707,
      "train_conf_over_95": 0.0012912211008369924,
      "val_loss": 0.5008207261562347,
      "val_macro_f1": 0.7296449128153039,
      "val_verse_f1": 0.8098484848484848,
      "val_chorus_f1": 0.6494413407821229,
      "val_chorus_rate": 0.4041613042354584,
      "val_max_prob": 0.6917185038328171,
      "val_conf_over_90": 0.020133077399805188,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002413438387680486,
      "epoch_time": 104.79180884361267,
      "val_boundary_f1": 0.3202911737943585,
      "val_boundary_precision": 0.2607407407407407,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.1941177012491965,
      "val_avg_segment_overlap": 0.6287154671608011,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4522091650906286,
      "val_pk_metric": 0.3200242052710091
    },
    {
      "epoch": 11,
      "train_loss": 0.48054727017879484,
      "train_chorus_rate": 0.36971452087163925,
      "train_max_prob": 0.6891602575778961,
      "train_conf_over_90": 0.0189141275244765,
      "train_conf_over_95": 9.792118507903069e-05,
      "val_loss": 0.5155918672680855,
      "val_macro_f1": 0.7711843333672552,
      "val_verse_f1": 0.8688468158347676,
      "val_chorus_f1": 0.6735218508997429,
      "val_chorus_rate": 0.2741709128022194,
      "val_max_prob": 0.672656387090683,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016004484039713724,
      "epoch_time": 109.19861078262329,
      "val_boundary_f1": 0.41975308641975306,
      "val_boundary_precision": 0.3722627737226277,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2776848238937316,
      "val_avg_segment_overlap": 0.6674909234985682,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.30167079329198654,
      "val_pk_metric": 0.21750244397670776
    },
    {
      "epoch": 12,
      "train_loss": 0.4765723332762718,
      "train_chorus_rate": 0.3321539953351021,
      "train_max_prob": 0.7004663914442062,
      "train_conf_over_90": 0.017382312545669264,
      "train_conf_over_95": 0.00024731620214879513,
      "val_loss": 0.5016788318753242,
      "val_macro_f1": 0.7557481600358933,
      "val_verse_f1": 0.8425439391194057,
      "val_chorus_f1": 0.668952380952381,
      "val_chorus_rate": 0.3454735651612282,
      "val_max_prob": 0.697454184293747,
      "val_conf_over_90": 0.010631962737534195,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.28031774227699e-05,
      "epoch_time": 98.66644930839539,
      "val_boundary_f1": 0.36397400185701023,
      "val_boundary_precision": 0.3001531393568147,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.239622477347822,
      "val_avg_segment_overlap": 0.662697377595858,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3929434903829965,
      "val_pk_metric": 0.2710475928998755
    },
    {
      "epoch": 13,
      "train_loss": 0.47122257500886916,
      "train_chorus_rate": 0.3333362899720669,
      "train_max_prob": 0.6959211140871048,
      "train_conf_over_90": 0.01680605746805668,
      "train_conf_over_95": 6.939625018276274e-05,
      "val_loss": 0.4970015436410904,
      "val_macro_f1": 0.7440193973011986,
      "val_verse_f1": 0.824233358264772,
      "val_chorus_f1": 0.6638054363376251,
      "val_chorus_rate": 0.3873966187238693,
      "val_max_prob": 0.7077383697032928,
      "val_conf_over_90": 0.018406190210953355,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.2557633178224254e-05,
      "epoch_time": 98.27776885032654,
      "val_boundary_f1": 0.36194029850746273,
      "val_boundary_precision": 0.2993827160493827,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2467484451577771,
      "val_avg_segment_overlap": 0.6560053232314389,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4142745551531073,
      "val_pk_metric": 0.29260091254129894
    },
    {
      "epoch": 14,
      "train_loss": 0.46248225718736646,
      "train_chorus_rate": 0.3300223134458065,
      "train_max_prob": 0.7146535813808441,
      "train_conf_over_90": 0.025534512917511167,
      "train_conf_over_95": 9.262409002985805e-05,
      "val_loss": 0.49764883518218994,
      "val_macro_f1": 0.7621126814217127,
      "val_verse_f1": 0.8471141668174416,
      "val_chorus_f1": 0.677111196025984,
      "val_chorus_rate": 0.3436047285795212,
      "val_max_prob": 0.6996826827526093,
      "val_conf_over_90": 0.010607111849822104,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1504179051858454e-05,
      "epoch_time": 105.03115606307983,
      "val_boundary_f1": 0.3869767441860465,
      "val_boundary_precision": 0.3195084485407066,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.26910258614924576,
      "val_avg_segment_overlap": 0.6708626872090031,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3824576398881513,
      "val_pk_metric": 0.26200021207649876
    },
    {
      "epoch": 15,
      "train_loss": 0.46942549049854276,
      "train_chorus_rate": 0.3398172229528427,
      "train_max_prob": 0.7022497385740281,
      "train_conf_over_90": 0.019258152763359248,
      "train_conf_over_95": 6.913886172696949e-05,
      "val_loss": 0.4975784420967102,
      "val_macro_f1": 0.7593238702265805,
      "val_verse_f1": 0.8439033254588406,
      "val_chorus_f1": 0.6747444149943204,
      "val_chorus_rate": 0.3494637459516525,
      "val_max_prob": 0.6969224810600281,
      "val_conf_over_90": 0.010607111849822104,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 103.93675208091736,
      "val_boundary_f1": 0.3723502304147465,
      "val_boundary_precision": 0.30559757942511345,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.25575864836204176,
      "val_avg_segment_overlap": 0.666384489834948,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3893447670966319,
      "val_pk_metric": 0.2654075077929914
    }
  ]
}