{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.21393694904859734,
      "layer_dropout": 0.23375739851500144,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18848384627619105,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006569039509851258,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015141700012960505,
      "gradient_clip_norm": 0.3969614882208266,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14966999843336046,
        "ece_after": 0.025387235454234273,
        "improvement": 0.12428276297912619,
        "params": {
          "temperature": 0.432100029850731
        }
      },
      "platt": {
        "ece_before": 0.14966999843336046,
        "ece_after": 0.02676874896866399,
        "improvement": 0.12290124946469647,
        "params": {
          "A": 2.124390747542007,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.603274741768837,
      "train_chorus_rate": 0.5343011800898239,
      "train_max_prob": 0.5886440396308898,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6082853972911835,
      "val_macro_f1": 0.34540362872497754,
      "val_verse_f1": 0.20506408252578934,
      "val_chorus_f1": 0.4857431749241658,
      "val_chorus_rate": 0.9145188629627228,
      "val_max_prob": 0.6107819378376007,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006497374134765252,
      "epoch_time": 82.17093920707703,
      "val_boundary_f1": 0.003642987249544627,
      "val_boundary_precision": 0.008,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.0020325203252032522,
      "val_avg_segment_overlap": 0.14006824948068314,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4120225226125994,
      "val_pk_metric": 0.39989009666512654
    },
    {
      "epoch": 2,
      "train_loss": 0.57570381462574,
      "train_chorus_rate": 0.5196196041419171,
      "train_max_prob": 0.5672937035560608,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5949970483779907,
      "val_macro_f1": 0.4973796484290782,
      "val_verse_f1": 0.5490981963927856,
      "val_chorus_f1": 0.44566110046537094,
      "val_chorus_rate": 0.5978007018566132,
      "val_max_prob": 0.5696708410978317,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006285510130287113,
      "epoch_time": 72.30264711380005,
      "val_boundary_f1": 0.05454545454545455,
      "val_boundary_precision": 0.11904761904761904,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.012483110667097942,
      "val_avg_segment_overlap": 0.21054796568932554,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.45893508957724816,
      "val_pk_metric": 0.46918356308058384
    },
    {
      "epoch": 3,
      "train_loss": 0.5703254401683807,
      "train_chorus_rate": 0.5531858587637544,
      "train_max_prob": 0.5793673247098923,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5909211486577988,
      "val_macro_f1": 0.4154228106070068,
      "val_verse_f1": 0.3383309759547383,
      "val_chorus_f1": 0.49251464525927535,
      "val_chorus_rate": 0.8327174484729767,
      "val_max_prob": 0.5936075448989868,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005942706970048827,
      "epoch_time": 49.697717905044556,
      "val_boundary_f1": 0.0642857142857143,
      "val_boundary_precision": 0.1323529411764706,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.027490357726306827,
      "val_avg_segment_overlap": 0.18677728698770768,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4081216517334305,
      "val_pk_metric": 0.40215177405099223
    },
    {
      "epoch": 4,
      "train_loss": 0.5634319081902504,
      "train_chorus_rate": 0.45453394334763286,
      "train_max_prob": 0.5910616040229797,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6053118258714676,
      "val_macro_f1": 0.5642807072041751,
      "val_verse_f1": 0.823764814529783,
      "val_chorus_f1": 0.3047965998785671,
      "val_chorus_rate": 0.10527189262211323,
      "val_max_prob": 0.6096534579992294,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000548394679710487,
      "epoch_time": 58.30831694602966,
      "val_boundary_f1": 0.19726858877086492,
      "val_boundary_precision": 0.2765957446808511,
      "val_boundary_recall": 0.15330188679245282,
      "val_complete_segments": 0.0911787184851872,
      "val_avg_segment_overlap": 0.3298269679962006,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.13131313131313133,
      "val_window_diff": 0.34383780505841194,
      "val_pk_metric": 0.30156601913590664
    },
    {
      "epoch": 5,
      "train_loss": 0.5342880561947823,
      "train_chorus_rate": 0.43650400787591936,
      "train_max_prob": 0.6352130562067032,
      "train_conf_over_90": 0.0025955160293960945,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5359970554709435,
      "val_macro_f1": 0.7034112732766084,
      "val_verse_f1": 0.7907417947258585,
      "val_chorus_f1": 0.6160807518273582,
      "val_chorus_rate": 0.40701211243867874,
      "val_max_prob": 0.6598697006702423,
      "val_conf_over_90": 0.0020096574735362083,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004929279632388445,
      "epoch_time": 56.96523690223694,
      "val_boundary_f1": 0.2907317073170732,
      "val_boundary_precision": 0.24792013311148087,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.1463634707272035,
      "val_avg_segment_overlap": 0.5824577082055239,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.46854864570755617,
      "val_pk_metric": 0.35475798159913013
    },
    {
      "epoch": 6,
      "train_loss": 0.5098845422267914,
      "train_chorus_rate": 0.3690424121916294,
      "train_max_prob": 0.6732173413038254,
      "train_conf_over_90": 0.011702011761371978,
      "train_conf_over_95": 0.00013271681673359125,
      "val_loss": 0.53150275349617,
      "val_macro_f1": 0.6076497133796804,
      "val_verse_f1": 0.6488888888888888,
      "val_chorus_f1": 0.566410537870472,
      "val_chorus_rate": 0.595728412270546,
      "val_max_prob": 0.6758382022380829,
      "val_conf_over_90": 0.012219265569001436,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043029470925860124,
      "epoch_time": 50.684895038604736,
      "val_boundary_f1": 0.17058823529411765,
      "val_boundary_precision": 0.14597315436241612,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.0672389079732664,
      "val_avg_segment_overlap": 0.45056116160437953,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.21717171717171718,
      "val_window_diff": 0.5500658148378612,
      "val_pk_metric": 0.45231220564066577
    },
    {
      "epoch": 7,
      "train_loss": 0.4993221253156662,
      "train_chorus_rate": 0.3835029900074005,
      "train_max_prob": 0.6767335385084152,
      "train_conf_over_90": 0.02348909684806131,
      "train_conf_over_95": 0.0012615548796020449,
      "val_loss": 0.5075122192502022,
      "val_macro_f1": 0.7270185432676799,
      "val_verse_f1": 0.8099453757769826,
      "val_chorus_f1": 0.6440917107583773,
      "val_chorus_rate": 0.3970745652914047,
      "val_max_prob": 0.6929882317781448,
      "val_conf_over_90": 0.010139661375433207,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003632322915163918,
      "epoch_time": 101.54619193077087,
      "val_boundary_f1": 0.3178438661710037,
      "val_boundary_precision": 0.26226993865030673,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.1937693715530407,
      "val_avg_segment_overlap": 0.6315611286425499,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.45034935725994363,
      "val_pk_metric": 0.3374248066845195
    },
    {
      "epoch": 8,
      "train_loss": 0.4890176683664322,
      "train_chorus_rate": 0.38725286200642584,
      "train_max_prob": 0.6861401617527008,
      "train_conf_over_90": 0.01511271694325842,
      "train_conf_over_95": 2.915451768785715e-05,
      "val_loss": 0.5196913853287697,
      "val_macro_f1": 0.7568953073700895,
      "val_verse_f1": 0.8605371900826447,
      "val_chorus_f1": 0.6532534246575343,
      "val_chorus_rate": 0.27456382289528847,
      "val_max_prob": 0.7137138396501541,
      "val_conf_over_90": 0.006511132465675473,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002946716594687343,
      "epoch_time": 102.64710402488708,
      "val_boundary_f1": 0.3818369453044375,
      "val_boundary_precision": 0.3394495412844037,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2561656301051847,
      "val_avg_segment_overlap": 0.636361634668323,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.33991165569102055,
      "val_pk_metric": 0.24450299033712636
    },
    {
      "epoch": 9,
      "train_loss": 0.4754314512014389,
      "train_chorus_rate": 0.3053119629621506,
      "train_max_prob": 0.7102613806724548,
      "train_conf_over_90": 0.028662512131268157,
      "train_conf_over_95": 0.0006506728532258421,
      "val_loss": 0.5103768929839134,
      "val_macro_f1": 0.71626982506655,
      "val_verse_f1": 0.798629615531024,
      "val_chorus_f1": 0.6339100346020761,
      "val_chorus_rate": 0.4107181951403618,
      "val_max_prob": 0.6773547828197479,
      "val_conf_over_90": 0.009371635387651622,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002276092417265248,
      "epoch_time": 1028.5284452438354,
      "val_boundary_f1": 0.2819299905392621,
      "val_boundary_precision": 0.2353870458135861,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.152791789668778,
      "val_avg_segment_overlap": 0.602673591100575,
      "val_verse_to_chorus_acc": 0.29646017699115046,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4584719464763536,
      "val_pk_metric": 0.34301109877548547
    },
    {
      "epoch": 10,
      "train_loss": 0.4707262471318245,
      "train_chorus_rate": 0.33226617872715,
      "train_max_prob": 0.7018919259309768,
      "train_conf_over_90": 0.026346840237965807,
      "train_conf_over_95": 0.000558524118969217,
      "val_loss": 0.5034894645214081,
      "val_macro_f1": 0.71351455068756,
      "val_verse_f1": 0.7924528301886793,
      "val_chorus_f1": 0.6345762711864407,
      "val_chorus_rate": 0.4249378591775894,
      "val_max_prob": 0.6894354969263077,
      "val_conf_over_90": 0.020536406547762454,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016497598774628156,
      "epoch_time": 110.3760769367218,
      "val_boundary_f1": 0.30337078651685395,
      "val_boundary_precision": 0.2515527950310559,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.18361535107293325,
      "val_avg_segment_overlap": 0.612812372550288,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.46371648168356355,
      "val_pk_metric": 0.33568161843309274
    },
    {
      "epoch": 11,
      "train_loss": 0.47860655933618546,
      "train_chorus_rate": 0.3429806217551231,
      "train_max_prob": 0.6963557064533233,
      "train_conf_over_90": 0.022841077100019903,
      "train_conf_over_95": 3.0940593569539486e-05,
      "val_loss": 0.5205587819218636,
      "val_macro_f1": 0.766711446191929,
      "val_verse_f1": 0.869090288445127,
      "val_chorus_f1": 0.664332603938731,
      "val_chorus_rate": 0.2619643956422806,
      "val_max_prob": 0.6619214713573456,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000109509271274639,
      "epoch_time": 117.84514808654785,
      "val_boundary_f1": 0.4066736183524504,
      "val_boundary_precision": 0.3644859813084112,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.27092847657534824,
      "val_avg_segment_overlap": 0.6634127339734497,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3104748006224304,
      "val_pk_metric": 0.22517563949363925
    },
    {
      "epoch": 12,
      "train_loss": 0.47482671290636064,
      "train_chorus_rate": 0.3229836568236351,
      "train_max_prob": 0.6974243015050888,
      "train_conf_over_90": 0.01743051212397404,
      "train_conf_over_95": 0.00020362931536510587,
      "val_loss": 0.5044075697660446,
      "val_macro_f1": 0.7551194957346816,
      "val_verse_f1": 0.8446043165467626,
      "val_chorus_f1": 0.6656346749226006,
      "val_chorus_rate": 0.33569396287202835,
      "val_max_prob": 0.7183064073324203,
      "val_conf_over_90": 0.019908199086785316,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.363325398024327e-05,
      "epoch_time": 96.13155102729797,
      "val_boundary_f1": 0.37404580152671757,
      "val_boundary_precision": 0.3141025641025641,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.23910498136373004,
      "val_avg_segment_overlap": 0.6704758346670515,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3913622322433504,
      "val_pk_metric": 0.27398063802964945
    },
    {
      "epoch": 13,
      "train_loss": 0.4689024731516838,
      "train_chorus_rate": 0.3241630017757416,
      "train_max_prob": 0.7055747419595718,
      "train_conf_over_90": 0.021697771572507917,
      "train_conf_over_95": 0.00010510797146707773,
      "val_loss": 0.4978785216808319,
      "val_macro_f1": 0.7371240395641586,
      "val_verse_f1": 0.8207898658718331,
      "val_chorus_f1": 0.6534582132564841,
      "val_chorus_rate": 0.38244204968214035,
      "val_max_prob": 0.7095716744661331,
      "val_conf_over_90": 0.015973540605045855,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.9352937956414468e-05,
      "epoch_time": 98.349436044693,
      "val_boundary_f1": 0.3408239700374532,
      "val_boundary_precision": 0.2826086956521739,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.21947901355377497,
      "val_avg_segment_overlap": 0.6426285057663941,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.41989773508815265,
      "val_pk_metric": 0.2985554909450355
    },
    {
      "epoch": 14,
      "train_loss": 0.45992721170186995,
      "train_chorus_rate": 0.3232539013028145,
      "train_max_prob": 0.7193152338266373,
      "train_conf_over_90": 0.02781404578126967,
      "train_conf_over_95": 6.223106465768069e-05,
      "val_loss": 0.49882739037275314,
      "val_macro_f1": 0.7538989719282873,
      "val_verse_f1": 0.8418958031837916,
      "val_chorus_f1": 0.6659021406727829,
      "val_chorus_rate": 0.34341298043727875,
      "val_max_prob": 0.7107131779193878,
      "val_conf_over_90": 0.01500922057311982,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.166537508600657e-06,
      "epoch_time": 103.26956105232239,
      "val_boundary_f1": 0.3694627709707823,
      "val_boundary_precision": 0.3076923076923077,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.24170175894725204,
      "val_avg_segment_overlap": 0.6652667027422783,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3904517268704589,
      "val_pk_metric": 0.27575029801732326
    },
    {
      "epoch": 15,
      "train_loss": 0.4672168597579002,
      "train_chorus_rate": 0.32778351083397866,
      "train_max_prob": 0.7125747889280319,
      "train_conf_over_90": 0.024956610053777695,
      "train_conf_over_95": 0.00010082453954964876,
      "val_loss": 0.4985947087407112,
      "val_macro_f1": 0.7515481702727729,
      "val_verse_f1": 0.8394703428260476,
      "val_chorus_f1": 0.6636259977194983,
      "val_chorus_rate": 0.34709548205137253,
      "val_max_prob": 0.7063867002725601,
      "val_conf_over_90": 0.014034139341674745,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 102.09420490264893,
      "val_boundary_f1": 0.3696060037523452,
      "val_boundary_precision": 0.3068535825545171,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2416758790300678,
      "val_avg_segment_overlap": 0.6638443193352052,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.39252341960042914,
      "val_pk_metric": 0.2776625968854411
    }
  ]
}