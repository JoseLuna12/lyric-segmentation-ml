{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.18438114790485868,
      "layer_dropout": 0.28728847835094956,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 256,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 2180098,
      "lstm_params": 2179072,
      "attention_params": 0,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00044100925805968513,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.02289629513452356,
      "gradient_clip_norm": 0.5371905349512455,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07632035199984585,
        "ece_after": 0.037651047139832944,
        "improvement": 0.03866930486001291,
        "params": {
          "temperature": 0.4512964332972441
        }
      },
      "platt": {
        "ece_before": 0.07632035199984585,
        "ece_after": 0.04678210248705914,
        "improvement": 0.02953824951278671,
        "params": {
          "A": 1.5081334839461313,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.555259519815445,
      "train_chorus_rate": 0.451932153548114,
      "train_max_prob": 0.546483239531517,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5820657461881638,
      "val_macro_f1": 0.521258649581865,
      "val_verse_f1": 0.6041448607912916,
      "val_chorus_f1": 0.43837243837243833,
      "val_chorus_rate": 0.5271359756588936,
      "val_max_prob": 0.5475320816040039,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043620162906571406,
      "epoch_time": 67.36596894264221,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.008883806166414862,
      "val_avg_segment_overlap": 0.21368584388019413,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.47765732165774144,
      "val_pk_metric": 0.4896354237613158
    },
    {
      "epoch": 2,
      "train_loss": 0.5434940919280052,
      "train_chorus_rate": 0.4297168172895908,
      "train_max_prob": 0.5552536129951477,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5857912749052048,
      "val_macro_f1": 0.5130644010730234,
      "val_verse_f1": 0.780209324452902,
      "val_chorus_f1": 0.24591947769314473,
      "val_chorus_rate": 0.15145961940288544,
      "val_max_prob": 0.553293988108635,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004219888585404007,
      "epoch_time": 93.83760476112366,
      "val_boundary_f1": 0.07207207207207207,
      "val_boundary_precision": 0.15267175572519084,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.01823534449462339,
      "val_avg_segment_overlap": 0.21488145155721206,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.389643757634322,
      "val_pk_metric": 0.409232703789687
    },
    {
      "epoch": 3,
      "train_loss": 0.5504667073488235,
      "train_chorus_rate": 0.44453758653253317,
      "train_max_prob": 0.557569432258606,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5761013180017471,
      "val_macro_f1": 0.4892086230711945,
      "val_verse_f1": 0.5227010831988936,
      "val_chorus_f1": 0.4557161629434954,
      "val_chorus_rate": 0.6349237263202667,
      "val_max_prob": 0.5472736358642578,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003989921127561411,
      "epoch_time": 102.1526939868927,
      "val_boundary_f1": 0.08586762075134169,
      "val_boundary_precision": 0.17777777777777778,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.02014545980611728,
      "val_avg_segment_overlap": 0.21285838214081731,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4478301060576573,
      "val_pk_metric": 0.4610189720529697
    },
    {
      "epoch": 4,
      "train_loss": 0.5359215945005417,
      "train_chorus_rate": 0.4511558713391423,
      "train_max_prob": 0.5713936418294907,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5772942900657654,
      "val_macro_f1": 0.44590839338005983,
      "val_verse_f1": 0.41447539703202296,
      "val_chorus_f1": 0.47734138972809664,
      "val_chorus_rate": 0.7569911330938339,
      "val_max_prob": 0.5625602602958679,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003682164598543368,
      "epoch_time": 108.80734705924988,
      "val_boundary_f1": 0.039711191335740074,
      "val_boundary_precision": 0.08461538461538462,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.012410469475686867,
      "val_avg_segment_overlap": 0.19949838537284106,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44551502092274864,
      "val_pk_metric": 0.45251666949977465
    },
    {
      "epoch": 5,
      "train_loss": 0.5498302087187767,
      "train_chorus_rate": 0.5808820225298404,
      "train_max_prob": 0.5636463195085526,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5737639516592026,
      "val_macro_f1": 0.43675979418722727,
      "val_verse_f1": 0.3750689464975179,
      "val_chorus_f1": 0.49845064187693666,
      "val_chorus_rate": 0.8098825663328171,
      "val_max_prob": 0.5542742609977722,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033100694354476387,
      "epoch_time": 82.25369811058044,
      "val_boundary_f1": 0.0617059891107078,
      "val_boundary_precision": 0.13385826771653545,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.025213027373684853,
      "val_avg_segment_overlap": 0.19615776590838568,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43789692830054006,
      "val_pk_metric": 0.443522670583945
    },
    {
      "epoch": 6,
      "train_loss": 0.536906686425209,
      "train_chorus_rate": 0.5645216666162014,
      "train_max_prob": 0.5688909113407135,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5794879645109177,
      "val_macro_f1": 0.5333761347348304,
      "val_verse_f1": 0.6149665551839465,
      "val_chorus_f1": 0.4517857142857143,
      "val_chorus_rate": 0.5269700735807419,
      "val_max_prob": 0.5635177940130234,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00028898979824121984,
      "epoch_time": 107.8517062664032,
      "val_boundary_f1": 0.057245080500894455,
      "val_boundary_precision": 0.11851851851851852,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.01630134527801548,
      "val_avg_segment_overlap": 0.222554250188972,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.41904440491595796,
      "val_pk_metric": 0.43129233527749794
    },
    {
      "epoch": 7,
      "train_loss": 0.5522832706570625,
      "train_chorus_rate": 0.6200140878558159,
      "train_max_prob": 0.5729174733161926,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5762082040309906,
      "val_macro_f1": 0.5609725779098631,
      "val_verse_f1": 0.6582227583433856,
      "val_chorus_f1": 0.4637223974763407,
      "val_chorus_rate": 0.4789610952138901,
      "val_max_prob": 0.5381532460451126,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002440013748141022,
      "epoch_time": 96.26937294006348,
      "val_boundary_f1": 0.08903020667726551,
      "val_boundary_precision": 0.13658536585365855,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.01603365788148397,
      "val_avg_segment_overlap": 0.2727823061970799,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.4053741188851866,
      "val_pk_metric": 0.41707036476039205
    },
    {
      "epoch": 8,
      "train_loss": 0.5392393678426742,
      "train_chorus_rate": 0.46685277223587035,
      "train_max_prob": 0.5751633763313293,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.578742042183876,
      "val_macro_f1": 0.5770007735527656,
      "val_verse_f1": 0.7127718906860012,
      "val_chorus_f1": 0.4412296564195298,
      "val_chorus_rate": 0.3803129345178604,
      "val_max_prob": 0.5601474046707153,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000198007883245583,
      "epoch_time": 90.70831513404846,
      "val_boundary_f1": 0.08783783783783784,
      "val_boundary_precision": 0.15476190476190477,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.02357559801886419,
      "val_avg_segment_overlap": 0.25713864518572005,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3959548721059418,
      "val_pk_metric": 0.40515416327078907
    },
    {
      "epoch": 9,
      "train_loss": 0.5396781802177429,
      "train_chorus_rate": 0.5528700649738312,
      "train_max_prob": 0.5705542445182801,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.574036255478859,
      "val_macro_f1": 0.5727947376212452,
      "val_verse_f1": 0.6800157047506871,
      "val_chorus_f1": 0.4655737704918033,
      "val_chorus_rate": 0.4501662626862526,
      "val_max_prob": 0.5632058084011078,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015301945981846535,
      "epoch_time": 101.67137813568115,
      "val_boundary_f1": 0.09206349206349206,
      "val_boundary_precision": 0.1407766990291262,
      "val_boundary_recall": 0.06839622641509434,
      "val_complete_segments": 0.01823534449462339,
      "val_avg_segment_overlap": 0.27603418097237686,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.3972045659229535,
      "val_pk_metric": 0.3976513029205474
    },
    {
      "epoch": 10,
      "train_loss": 0.524874421954155,
      "train_chorus_rate": 0.5035942137241364,
      "train_max_prob": 0.5845484077930451,
      "train_conf_over_90": 2.4679172202013434e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5745831727981567,
      "val_macro_f1": 0.5901512252740855,
      "val_verse_f1": 0.7379061371841156,
      "val_chorus_f1": 0.44239631336405527,
      "val_chorus_rate": 0.3402509242296219,
      "val_max_prob": 0.5669534504413605,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011100231451492134,
      "epoch_time": 123.6222620010376,
      "val_boundary_f1": 0.136986301369863,
      "val_boundary_precision": 0.19313304721030042,
      "val_boundary_recall": 0.10613207547169812,
      "val_complete_segments": 0.0460929172620583,
      "val_avg_segment_overlap": 0.2923214412131594,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.37971132304395366,
      "val_pk_metric": 0.3669145032265084
    },
    {
      "epoch": 11,
      "train_loss": 0.523582948744297,
      "train_chorus_rate": 0.45452323704957964,
      "train_max_prob": 0.5962619960308075,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.571779415011406,
      "val_macro_f1": 0.5227714185884125,
      "val_verse_f1": 0.5636733770640127,
      "val_chorus_f1": 0.48186946011281223,
      "val_chorus_rate": 0.6150481253862381,
      "val_max_prob": 0.5702486932277679,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.379279820534842e-05,
      "epoch_time": 107.12442684173584,
      "val_boundary_f1": 0.07260726072607261,
      "val_boundary_precision": 0.12087912087912088,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.022905825079738124,
      "val_avg_segment_overlap": 0.2488416318998845,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.41035805916545376,
      "val_pk_metric": 0.4068295452813616
    },
    {
      "epoch": 12,
      "train_loss": 0.5284984856843948,
      "train_chorus_rate": 0.49315493628382684,
      "train_max_prob": 0.5909838199615478,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5761675089597702,
      "val_macro_f1": 0.5350710747490733,
      "val_verse_f1": 0.5993527508090615,
      "val_chorus_f1": 0.47078939868908526,
      "val_chorus_rate": 0.5632296800613403,
      "val_max_prob": 0.58574178814888,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.301714530354404e-05,
      "epoch_time": 101.72442173957825,
      "val_boundary_f1": 0.08866995073891626,
      "val_boundary_precision": 0.14594594594594595,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.02007281861470621,
      "val_avg_segment_overlap": 0.24946167797599827,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.4092515660166538,
      "val_pk_metric": 0.40244745164048534
    },
    {
      "epoch": 13,
      "train_loss": 0.5164884969592094,
      "train_chorus_rate": 0.42992160767316817,
      "train_max_prob": 0.6021590977907181,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5739095360040665,
      "val_macro_f1": 0.5670857764387451,
      "val_verse_f1": 0.6898794719724507,
      "val_chorus_f1": 0.44429208090503947,
      "val_chorus_rate": 0.4165630415081978,
      "val_max_prob": 0.576592892408371,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.0020399519284383e-05,
      "epoch_time": 101.64001607894897,
      "val_boundary_f1": 0.10687022900763359,
      "val_boundary_precision": 0.15151515151515152,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.04655507082601462,
      "val_avg_segment_overlap": 0.2869047210081564,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.38936235917220746,
      "val_pk_metric": 0.37752260168265106
    },
    {
      "epoch": 14,
      "train_loss": 0.520880900323391,
      "train_chorus_rate": 0.4527144402265549,
      "train_max_prob": 0.6007989406585693,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5750236064195633,
      "val_macro_f1": 0.5589644269908349,
      "val_verse_f1": 0.6484279297672519,
      "val_chorus_f1": 0.4695009242144178,
      "val_chorus_rate": 0.4982188194990158,
      "val_max_prob": 0.580479696393013,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.807628993971083e-06,
      "epoch_time": 119.22022080421448,
      "val_boundary_f1": 0.10493827160493827,
      "val_boundary_precision": 0.15178571428571427,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.02308198593988626,
      "val_avg_segment_overlap": 0.27702188309104936,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.39904389901161536,
      "val_pk_metric": 0.39309655142237254
    },
    {
      "epoch": 15,
      "train_loss": 0.5317790850996971,
      "train_chorus_rate": 0.4296200320124626,
      "train_max_prob": 0.5983094841241836,
      "train_conf_over_90": 2.9868577257730067e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5761326998472214,
      "val_macro_f1": 0.5706339244963161,
      "val_verse_f1": 0.6693290734824281,
      "val_chorus_f1": 0.4719387755102041,
      "val_chorus_rate": 0.47125471383333206,
      "val_max_prob": 0.5808391571044922,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 75.57118797302246,
      "val_boundary_f1": 0.1033434650455927,
      "val_boundary_precision": 0.1452991452991453,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.025088626347905246,
      "val_avg_segment_overlap": 0.28574640156067715,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.40340003108262135,
      "val_pk_metric": 0.3916553865426924
    }
  ]
}