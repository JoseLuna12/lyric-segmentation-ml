{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.17775060442816143,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2976856015424646,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00020046044393918702,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01399206428588458,
      "gradient_clip_norm": 0.5584311657893698,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10635884275956331,
        "ece_after": 0.02017828287860499,
        "improvement": 0.08618055988095832,
        "params": {
          "temperature": 0.5358219764809179
        }
      },
      "platt": {
        "ece_before": 0.10635884275956331,
        "ece_after": 0.10635884275956331,
        "improvement": 0.0,
        "params": {
          "A": 0.9999999720691533,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5626411318778992,
      "train_chorus_rate": 0.4577645960263908,
      "train_max_prob": 0.5532787382602692,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5720016807317734,
      "val_macro_f1": 0.44625779676873395,
      "val_verse_f1": 0.40287769784172667,
      "val_chorus_f1": 0.48963789569574123,
      "val_chorus_rate": 0.7790033668279648,
      "val_max_prob": 0.5631163716316223,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001970622190315653,
      "epoch_time": 73.98490118980408,
      "val_boundary_f1": 0.07523510971786834,
      "val_boundary_precision": 0.11214953271028037,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.02790433404166172,
      "val_avg_segment_overlap": 0.20827223552048638,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4489932821368944,
      "val_pk_metric": 0.44305605889381267
    },
    {
      "epoch": 2,
      "train_loss": 0.5530699789524078,
      "train_chorus_rate": 0.5108140014111996,
      "train_max_prob": 0.576245254278183,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5968198627233505,
      "val_macro_f1": 0.4631401940927164,
      "val_verse_f1": 0.8242548818088387,
      "val_chorus_f1": 0.10202550637659416,
      "val_chorus_rate": 0.02724255877546966,
      "val_max_prob": 0.6152448356151581,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018709912772032244,
      "epoch_time": 56.37210392951965,
      "val_boundary_f1": 0.07569721115537849,
      "val_boundary_precision": 0.24358974358974358,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.06790168634018051,
      "val_avg_segment_overlap": 0.20446808939770286,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.2798802014996497,
      "val_pk_metric": 0.27687180472438433
    },
    {
      "epoch": 3,
      "train_loss": 0.5240835696458817,
      "train_chorus_rate": 0.36752189565449955,
      "train_max_prob": 0.600432100892067,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5522845387458801,
      "val_macro_f1": 0.5874210587260726,
      "val_verse_f1": 0.6526717557251909,
      "val_chorus_f1": 0.5221703617269545,
      "val_chorus_rate": 0.5432109087705612,
      "val_max_prob": 0.5978348702192307,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017125013821353268,
      "epoch_time": 121.04680800437927,
      "val_boundary_f1": 0.19195046439628485,
      "val_boundary_precision": 0.1706422018348624,
      "val_boundary_recall": 0.21933962264150944,
      "val_complete_segments": 0.09140622974133049,
      "val_avg_segment_overlap": 0.38109234491899324,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.18686868686868688,
      "val_window_diff": 0.41450816678492086,
      "val_pk_metric": 0.35244765244843984
    },
    {
      "epoch": 4,
      "train_loss": 0.5133865475654602,
      "train_chorus_rate": 0.4514296382665634,
      "train_max_prob": 0.6242525935173034,
      "train_conf_over_90": 0.0012177460332168267,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5396599918603897,
      "val_macro_f1": 0.6531249225438744,
      "val_verse_f1": 0.7483622350674374,
      "val_chorus_f1": 0.5578876100203114,
      "val_chorus_rate": 0.42630456387996674,
      "val_max_prob": 0.6454702168703079,
      "val_conf_over_90": 0.003150336444377899,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015059533295439027,
      "epoch_time": 105.14834499359131,
      "val_boundary_f1": 0.2555853440571939,
      "val_boundary_precision": 0.20575539568345325,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.12768586454959732,
      "val_avg_segment_overlap": 0.4937957087481145,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.43884225273819755,
      "val_pk_metric": 0.34577301207159655
    },
    {
      "epoch": 5,
      "train_loss": 0.5036825716495514,
      "train_chorus_rate": 0.41233238726854327,
      "train_max_prob": 0.6544105142354966,
      "train_conf_over_90": 0.003761057762312703,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5376675575971603,
      "val_macro_f1": 0.6248866431030304,
      "val_verse_f1": 0.7013463892288863,
      "val_chorus_f1": 0.5484268969771746,
      "val_chorus_rate": 0.4973932206630707,
      "val_max_prob": 0.649626687169075,
      "val_conf_over_90": 0.0040950311231426895,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012654230278762616,
      "epoch_time": 55.22899913787842,
      "val_boundary_f1": 0.2356115107913669,
      "val_boundary_precision": 0.19040697674418605,
      "val_boundary_recall": 0.3089622641509434,
      "val_complete_segments": 0.10645865150106931,
      "val_avg_segment_overlap": 0.4620198465063883,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.4686561099005221,
      "val_pk_metric": 0.3591302353317267
    },
    {
      "epoch": 6,
      "train_loss": 0.5081839263439178,
      "train_chorus_rate": 0.4457522533833981,
      "train_max_prob": 0.6604065865278244,
      "train_conf_over_90": 0.0056555609393399205,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5407298803329468,
      "val_macro_f1": 0.7091477090919016,
      "val_verse_f1": 0.8407169428474804,
      "val_chorus_f1": 0.5775784753363228,
      "val_chorus_rate": 0.24888334423303604,
      "val_max_prob": 0.6620456427335739,
      "val_conf_over_90": 0.0012054002145305276,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010073022196959352,
      "epoch_time": 70.88033080101013,
      "val_boundary_f1": 0.3345454545454546,
      "val_boundary_precision": 0.27218934911242604,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.2026398709723206,
      "val_avg_segment_overlap": 0.5602247268599212,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.3547107056422751,
      "val_pk_metric": 0.27875195735848685
    },
    {
      "epoch": 7,
      "train_loss": 0.4816155031323433,
      "train_chorus_rate": 0.3729549258947372,
      "train_max_prob": 0.6658522754907608,
      "train_conf_over_90": 0.004145544682978652,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5315590426325798,
      "val_macro_f1": 0.6999400758853407,
      "val_verse_f1": 0.8091465610370905,
      "val_chorus_f1": 0.5907335907335908,
      "val_chorus_rate": 0.337582103908062,
      "val_max_prob": 0.6666828393936157,
      "val_conf_over_90": 0.006742634053807706,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.49181411515609e-05,
      "epoch_time": 116.831463098526,
      "val_boundary_f1": 0.3103448275862069,
      "val_boundary_precision": 0.24456521739130435,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.18594444125992377,
      "val_avg_segment_overlap": 0.5750800123193606,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.423453640173689,
      "val_pk_metric": 0.3224912799207142
    },
    {
      "epoch": 8,
      "train_loss": 0.4828259512782097,
      "train_chorus_rate": 0.3482280522584915,
      "train_max_prob": 0.6716145187616348,
      "train_conf_over_90": 0.007569589017657563,
      "train_conf_over_95": 0.00018749065056908876,
      "val_loss": 0.5253438204526901,
      "val_macro_f1": 0.6841178166099301,
      "val_verse_f1": 0.7786807786807786,
      "val_chorus_f1": 0.5895548545390816,
      "val_chorus_rate": 0.402101494371891,
      "val_max_prob": 0.6557640135288239,
      "val_conf_over_90": 0.004155475064180791,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.086511098479678e-05,
      "epoch_time": 92.43178081512451,
      "val_boundary_f1": 0.294167371090448,
      "val_boundary_precision": 0.22924901185770752,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.16968627467036798,
      "val_avg_segment_overlap": 0.5623005138337702,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4475290642091766,
      "val_pk_metric": 0.3466108375230066
    },
    {
      "epoch": 9,
      "train_loss": 0.48295781314373015,
      "train_chorus_rate": 0.3937049299478531,
      "train_max_prob": 0.6774465650320053,
      "train_conf_over_90": 0.015767975663766264,
      "train_conf_over_95": 0.0007067921105772257,
      "val_loss": 0.5097520053386688,
      "val_macro_f1": 0.6844999570976495,
      "val_verse_f1": 0.7605856747130985,
      "val_chorus_f1": 0.6084142394822007,
      "val_chorus_rate": 0.4604317396879196,
      "val_max_prob": 0.6654973924160004,
      "val_conf_over_90": 0.008863074937835336,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 3.021030572565435e-05,
      "epoch_time": 75.44034695625305,
      "val_boundary_f1": 0.2891156462585034,
      "val_boundary_precision": 0.22606382978723405,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.17757454849183377,
      "val_avg_segment_overlap": 0.5555715711732014,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.43551003132091226,
      "val_pk_metric": 0.33493087655485604
    },
    {
      "epoch": 10,
      "train_loss": 0.48366868644952776,
      "train_chorus_rate": 0.40711031705141065,
      "train_max_prob": 0.6708823204040527,
      "train_conf_over_90": 0.011747456944431179,
      "train_conf_over_95": 0.0006920786923728883,
      "val_loss": 0.516194298863411,
      "val_macro_f1": 0.7147145763752927,
      "val_verse_f1": 0.8136396790663748,
      "val_chorus_f1": 0.6157894736842106,
      "val_chorus_rate": 0.3549197316169739,
      "val_max_prob": 0.6648578643798828,
      "val_conf_over_90": 0.006134436698630452,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.4361316218864594e-05,
      "epoch_time": 76.0207040309906,
      "val_boundary_f1": 0.32530120481927716,
      "val_boundary_precision": 0.25609756097560976,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.21218387945588368,
      "val_avg_segment_overlap": 0.5953060952311489,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.41059904679018916,
      "val_pk_metric": 0.3072717845585221
    },
    {
      "epoch": 11,
      "train_loss": 0.47327948212623594,
      "train_chorus_rate": 0.3478120267391205,
      "train_max_prob": 0.6737086296081543,
      "train_conf_over_90": 0.009412685630377383,
      "train_conf_over_95": 0.0003370110091054812,
      "val_loss": 0.5145169496536255,
      "val_macro_f1": 0.7167927838290742,
      "val_verse_f1": 0.8130498533724341,
      "val_chorus_f1": 0.6205357142857143,
      "val_chorus_rate": 0.3618450090289116,
      "val_max_prob": 0.6667188555002213,
      "val_conf_over_90": 0.007345371879637241,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.3982249076217174e-06,
      "epoch_time": 76.9447820186615,
      "val_boundary_f1": 0.3197278911564626,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.2091767081427739,
      "val_avg_segment_overlap": 0.5967796710767784,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4123187401896276,
      "val_pk_metric": 0.3022176129308141
    },
    {
      "epoch": 12,
      "train_loss": 0.46936445981264113,
      "train_chorus_rate": 0.3597258791327477,
      "train_max_prob": 0.6740223556756973,
      "train_conf_over_90": 0.014422406081575901,
      "train_conf_over_95": 0.0009730499092256651,
      "val_loss": 0.511999823153019,
      "val_macro_f1": 0.7110917977027773,
      "val_verse_f1": 0.8027591349739001,
      "val_chorus_f1": 0.6194244604316547,
      "val_chorus_rate": 0.384386770427227,
      "val_max_prob": 0.6678945571184158,
      "val_conf_over_90": 0.008872559468727559,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 139.02698802947998,
      "val_boundary_f1": 0.31239388794567063,
      "val_boundary_precision": 0.2440318302387268,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.19860371278716987,
      "val_avg_segment_overlap": 0.5890607672092888,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4240972749343197,
      "val_pk_metric": 0.316086324639073
    }
  ]
}