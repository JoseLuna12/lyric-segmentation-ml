{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2924261834826333,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2841485370923501,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1867010,
      "lstm_params": 1339392,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008428650014094005,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.023913605906902318,
      "gradient_clip_norm": 0.37516722114442574,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10859637675268946,
        "ece_after": 0.02638771821157402,
        "improvement": 0.08220865854111545,
        "params": {
          "temperature": 0.5473433933770055
        }
      },
      "platt": {
        "ece_before": 0.10859637675268946,
        "ece_after": 0.039732953756754896,
        "improvement": 0.06886342299593456,
        "params": {
          "A": 1.5402016342673015,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5930278047919273,
      "train_chorus_rate": 0.4772109607234597,
      "train_max_prob": 0.618581822514534,
      "train_conf_over_90": 0.00029880478978157045,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5598038136959076,
      "val_macro_f1": 0.4718152037740566,
      "val_verse_f1": 0.438090241343127,
      "val_chorus_f1": 0.5055401662049862,
      "val_chorus_rate": 0.764233335852623,
      "val_max_prob": 0.5697593688964844,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008336666163398838,
      "epoch_time": 110.62913823127747,
      "val_boundary_f1": 0.06942148760330578,
      "val_boundary_precision": 0.11602209944751381,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.024769179117005203,
      "val_avg_segment_overlap": 0.23092481132224515,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.43969487788390604,
      "val_pk_metric": 0.4433469372519794
    },
    {
      "epoch": 2,
      "train_loss": 0.5346522316336632,
      "train_chorus_rate": 0.46550100594758986,
      "train_max_prob": 0.5841023206710816,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5445747524499893,
      "val_macro_f1": 0.6876391672087117,
      "val_verse_f1": 0.7769289533995416,
      "val_chorus_f1": 0.5983493810178817,
      "val_chorus_rate": 0.41501159220933914,
      "val_max_prob": 0.5696130692958832,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00080647347469762,
      "epoch_time": 101.85041928291321,
      "val_boundary_f1": 0.30243024302430244,
      "val_boundary_precision": 0.2445414847161572,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.17786768930724392,
      "val_avg_segment_overlap": 0.5694627776838148,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.4348168038302875,
      "val_pk_metric": 0.34002256700065603
    },
    {
      "epoch": 3,
      "train_loss": 0.5260371565818787,
      "train_chorus_rate": 0.5261030033230781,
      "train_max_prob": 0.6355091899633407,
      "train_conf_over_90": 0.001964651345042512,
      "train_conf_over_95": 3.5038540954701605e-05,
      "val_loss": 0.5452452003955841,
      "val_macro_f1": 0.46541710020467886,
      "val_verse_f1": 0.4060773480662984,
      "val_chorus_f1": 0.5247568523430592,
      "val_chorus_rate": 0.8118866533041,
      "val_max_prob": 0.6568497121334076,
      "val_conf_over_90": 0.001879576884675771,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007624740472595474,
      "epoch_time": 101.91294622421265,
      "val_boundary_f1": 0.07644882860665843,
      "val_boundary_precision": 0.08010335917312661,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.01977425274084871,
      "val_avg_segment_overlap": 0.29242315822551723,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.09595959595959595,
      "val_window_diff": 0.4466749009059188,
      "val_pk_metric": 0.3820959311558153
    },
    {
      "epoch": 4,
      "train_loss": 0.49964779913425444,
      "train_chorus_rate": 0.434970148652792,
      "train_max_prob": 0.6499337553977966,
      "train_conf_over_90": 0.0018146245856769383,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5193817764520645,
      "val_macro_f1": 0.6499093295082035,
      "val_verse_f1": 0.6876524052316559,
      "val_chorus_f1": 0.6121662537847509,
      "val_chorus_rate": 0.5930391997098923,
      "val_max_prob": 0.6803888529539108,
      "val_conf_over_90": 0.015376975759863853,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007035913201373869,
      "epoch_time": 102.50053215026855,
      "val_boundary_f1": 0.2602602602602603,
      "val_boundary_precision": 0.22608695652173913,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.13270308825717098,
      "val_avg_segment_overlap": 0.5299132656041539,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.4673496927046242,
      "val_pk_metric": 0.3619130884134927
    },
    {
      "epoch": 5,
      "train_loss": 0.4896455600857735,
      "train_chorus_rate": 0.3860722191631794,
      "train_max_prob": 0.6642755955457688,
      "train_conf_over_90": 0.004385243321303278,
      "train_conf_over_95": 3.154574078507721e-05,
      "val_loss": 0.5191526412963867,
      "val_macro_f1": 0.7513068536160512,
      "val_verse_f1": 0.8503688092729188,
      "val_chorus_f1": 0.6522448979591837,
      "val_chorus_rate": 0.30324896425008774,
      "val_max_prob": 0.6849211156368256,
      "val_conf_over_90": 0.001166149420896545,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006323987510570505,
      "epoch_time": 86.67467999458313,
      "val_boundary_f1": 0.41666666666666663,
      "val_boundary_precision": 0.3536184210526316,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.33152330864419943,
      "val_avg_segment_overlap": 0.6420703740687839,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.36168081616940573,
      "val_pk_metric": 0.2528223463896429
    },
    {
      "epoch": 6,
      "train_loss": 0.4823776602745056,
      "train_chorus_rate": 0.3620588481426239,
      "train_max_prob": 0.6683474183082581,
      "train_conf_over_90": 0.006183444420457818,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5185080543160439,
      "val_macro_f1": 0.6795065737367336,
      "val_verse_f1": 0.7305084745762711,
      "val_chorus_f1": 0.6285046728971962,
      "val_chorus_rate": 0.5420485436916351,
      "val_max_prob": 0.7233066260814667,
      "val_conf_over_90": 0.05490310676395893,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005520077969071973,
      "epoch_time": 90.81230092048645,
      "val_boundary_f1": 0.3158995815899582,
      "val_boundary_precision": 0.28383458646616544,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.1926265608131992,
      "val_avg_segment_overlap": 0.5516585702626522,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.4505125777380126,
      "val_pk_metric": 0.34583521136868384
    },
    {
      "epoch": 7,
      "train_loss": 0.4814283162355423,
      "train_chorus_rate": 0.4004377260804176,
      "train_max_prob": 0.6747184157371521,
      "train_conf_over_90": 0.014037645957432687,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4928864985704422,
      "val_macro_f1": 0.744109524602958,
      "val_verse_f1": 0.8141149247975319,
      "val_chorus_f1": 0.6741041244083841,
      "val_chorus_rate": 0.42720358073711395,
      "val_max_prob": 0.6631853431463242,
      "val_conf_over_90": 0.0021611654374282807,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004659319281427732,
      "epoch_time": 98.30411314964294,
      "val_boundary_f1": 0.3948339483394834,
      "val_boundary_precision": 0.3242424242424242,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.3133834997700321,
      "val_avg_segment_overlap": 0.6647657249114742,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4181476246402599,
      "val_pk_metric": 0.2892682776046148
    },
    {
      "epoch": 8,
      "train_loss": 0.4786808490753174,
      "train_chorus_rate": 0.35874132364988326,
      "train_max_prob": 0.6768364191055298,
      "train_conf_over_90": 0.008077915551257319,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49436425417661667,
      "val_macro_f1": 0.7333272821930522,
      "val_verse_f1": 0.8024185683635654,
      "val_chorus_f1": 0.664235996022539,
      "val_chorus_rate": 0.4420849606394768,
      "val_max_prob": 0.6899493783712387,
      "val_conf_over_90": 0.0021108441869728267,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003779330732666277,
      "epoch_time": 88.47241187095642,
      "val_boundary_f1": 0.3965351299326275,
      "val_boundary_precision": 0.33495934959349594,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.28479050744427203,
      "val_avg_segment_overlap": 0.652336957125407,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.40367541926625294,
      "val_pk_metric": 0.29467563195026214
    },
    {
      "epoch": 9,
      "train_loss": 0.4795133054256439,
      "train_chorus_rate": 0.3907905757427216,
      "train_max_prob": 0.6734283477067947,
      "train_conf_over_90": 0.005551219690823927,
      "train_conf_over_95": 0.0,
      "val_loss": 0.502496100962162,
      "val_macro_f1": 0.7073255905842686,
      "val_verse_f1": 0.7646817248459958,
      "val_chorus_f1": 0.6499694563225412,
      "val_chorus_rate": 0.5050261840224266,
      "val_max_prob": 0.7047562003135681,
      "val_conf_over_90": 0.069452247582376,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002918572045022035,
      "epoch_time": 90.49648380279541,
      "val_boundary_f1": 0.3408866995073892,
      "val_boundary_precision": 0.2927241962774958,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.23315729189271078,
      "val_avg_segment_overlap": 0.6193120701025215,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.44060641305698867,
      "val_pk_metric": 0.33678306157318133
    },
    {
      "epoch": 10,
      "train_loss": 0.4593659400939941,
      "train_chorus_rate": 0.36580854579806327,
      "train_max_prob": 0.6966135740280152,
      "train_conf_over_90": 0.026255064108408988,
      "train_conf_over_95": 0.00011492337798699737,
      "val_loss": 0.5021448656916618,
      "val_macro_f1": 0.7272352963084039,
      "val_verse_f1": 0.7979719188767549,
      "val_chorus_f1": 0.656498673740053,
      "val_chorus_rate": 0.4415416270494461,
      "val_max_prob": 0.7064548879861832,
      "val_conf_over_90": 0.05088056344538927,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021146625035235028,
      "epoch_time": 99.06231117248535,
      "val_boundary_f1": 0.3827751196172249,
      "val_boundary_precision": 0.322061191626409,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2652689634794619,
      "val_avg_segment_overlap": 0.6413271506178385,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.43132141031658433,
      "val_pk_metric": 0.3233275531280855
    },
    {
      "epoch": 11,
      "train_loss": 0.4722387582063675,
      "train_chorus_rate": 0.37966795861721037,
      "train_max_prob": 0.6773769587278367,
      "train_conf_over_90": 0.015113937575370074,
      "train_conf_over_95": 0.0,
      "val_loss": 0.501419760286808,
      "val_macro_f1": 0.7688522365078416,
      "val_verse_f1": 0.8630256499738266,
      "val_chorus_f1": 0.6746788230418567,
      "val_chorus_rate": 0.29377196729183197,
      "val_max_prob": 0.6987307369709015,
      "val_conf_over_90": 0.0072358648176305,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014027368127201382,
      "epoch_time": 96.13911604881287,
      "val_boundary_f1": 0.4495967741935484,
      "val_boundary_precision": 0.3926056338028169,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.351891110546996,
      "val_avg_segment_overlap": 0.6612347774848251,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3262584145974314,
      "val_pk_metric": 0.23728131633344293
    },
    {
      "epoch": 12,
      "train_loss": 0.46462787687778473,
      "train_chorus_rate": 0.33187671601772306,
      "train_max_prob": 0.6858812600374222,
      "train_conf_over_90": 0.007681097500608303,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49286017566919327,
      "val_macro_f1": 0.744420858426236,
      "val_verse_f1": 0.8164750957854405,
      "val_chorus_f1": 0.6723666210670314,
      "val_chorus_rate": 0.4193514660000801,
      "val_max_prob": 0.7029578983783722,
      "val_conf_over_90": 0.020449563628062606,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.139095414985326e-05,
      "epoch_time": 98.57955598831177,
      "val_boundary_f1": 0.40684793554884185,
      "val_boundary_precision": 0.35500878734622143,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2931544121761513,
      "val_avg_segment_overlap": 0.6536775873949402,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3795367500820531,
      "val_pk_metric": 0.284121718475632
    },
    {
      "epoch": 13,
      "train_loss": 0.45530073195695875,
      "train_chorus_rate": 0.34082231521606443,
      "train_max_prob": 0.6941956430673599,
      "train_conf_over_90": 0.014911402552388608,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4902752414345741,
      "val_macro_f1": 0.7521229068230866,
      "val_verse_f1": 0.8279104758322361,
      "val_chorus_f1": 0.6763353378139371,
      "val_chorus_rate": 0.3952614888548851,
      "val_max_prob": 0.6817230731248856,
      "val_conf_over_90": 0.004824116476811469,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.739152671178041e-05,
      "epoch_time": 104.99276494979858,
      "val_boundary_f1": 0.42645607107601186,
      "val_boundary_precision": 0.366723259762309,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.31562196759704714,
      "val_avg_segment_overlap": 0.6696396461286072,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3690511869014638,
      "val_pk_metric": 0.27680760310243674
    },
    {
      "epoch": 14,
      "train_loss": 0.4591723784804344,
      "train_chorus_rate": 0.3661341562867165,
      "train_max_prob": 0.6935684353113174,
      "train_conf_over_90": 0.018910045898519457,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49116410315036774,
      "val_macro_f1": 0.7427340453771953,
      "val_verse_f1": 0.8095145252485865,
      "val_chorus_f1": 0.6759535655058042,
      "val_chorus_rate": 0.4413129463791847,
      "val_max_prob": 0.7011028826236725,
      "val_conf_over_90": 0.028666045051068068,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0198385069516732e-05,
      "epoch_time": 85.75931215286255,
      "val_boundary_f1": 0.40913604766633566,
      "val_boundary_precision": 0.35334476843910806,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.29856730689180316,
      "val_avg_segment_overlap": 0.6612362180446218,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.38720064184048464,
      "val_pk_metric": 0.28473551683373943
    },
    {
      "epoch": 15,
      "train_loss": 0.4560486972332001,
      "train_chorus_rate": 0.3658041529357433,
      "train_max_prob": 0.700202688574791,
      "train_conf_over_90": 0.022396571468561888,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4891241490840912,
      "val_macro_f1": 0.7562749239041124,
      "val_verse_f1": 0.833426599515016,
      "val_chorus_f1": 0.6791232482932088,
      "val_chorus_rate": 0.3843880966305733,
      "val_max_prob": 0.6893240362405777,
      "val_conf_over_90": 0.008742478850763291,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 97.34665298461914,
      "val_boundary_f1": 0.4433497536945813,
      "val_boundary_precision": 0.38071065989847713,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.3314038208789004,
      "val_avg_segment_overlap": 0.6774244215547396,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.35365161297097325,
      "val_pk_metric": 0.2631221408214266
    }
  ]
}