{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.1869195904073402,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17595037273197336,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007708910922798473,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01092958151751556,
      "gradient_clip_norm": 0.3085783635718896,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07451581616825582,
        "ece_after": 0.007906087357660624,
        "improvement": 0.0666097288105952,
        "params": {
          "temperature": 0.6638641175938386
        }
      },
      "platt": {
        "ece_before": 0.07451581616825582,
        "ece_after": 0.00915057904476736,
        "improvement": 0.06536523712348846,
        "params": {
          "A": 1.48367854360655,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5883409291505813,
      "train_chorus_rate": 0.4971751724369824,
      "train_max_prob": 0.5889840334653854,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5856799632310867,
      "val_macro_f1": 0.514075393914154,
      "val_verse_f1": 0.5319753671245855,
      "val_chorus_f1": 0.4961754207037226,
      "val_chorus_rate": 0.663996085524559,
      "val_max_prob": 0.5518006831407547,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007624791085098545,
      "epoch_time": 903.1177802085876,
      "val_boundary_f1": 0.1205564142194745,
      "val_boundary_precision": 0.17488789237668162,
      "val_boundary_recall": 0.09198113207547169,
      "val_complete_segments": 0.038679370174598174,
      "val_avg_segment_overlap": 0.24892733401740258,
      "val_verse_to_chorus_acc": 0.10619469026548672,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.4407190037395111,
      "val_pk_metric": 0.4423140341031321
    },
    {
      "epoch": 2,
      "train_loss": 0.5500345528125763,
      "train_chorus_rate": 0.43014167472720144,
      "train_max_prob": 0.5833850055932999,
      "train_conf_over_90": 0.0038358414778485892,
      "train_conf_over_95": 8.403361425735056e-05,
      "val_loss": 0.5603511929512024,
      "val_macro_f1": 0.643826855514292,
      "val_verse_f1": 0.7341821743388834,
      "val_chorus_f1": 0.5534715366897005,
      "val_chorus_rate": 0.4473908767104149,
      "val_max_prob": 0.6481901407241821,
      "val_conf_over_90": 0.009317091666162014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007376108012558011,
      "epoch_time": 56.280319929122925,
      "val_boundary_f1": 0.24324324324324328,
      "val_boundary_precision": 0.18947368421052632,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.10689350917346674,
      "val_avg_segment_overlap": 0.5042155462463973,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.49884072319634165,
      "val_pk_metric": 0.3779680440267219
    },
    {
      "epoch": 3,
      "train_loss": 0.5076543673872947,
      "train_chorus_rate": 0.3700601287186146,
      "train_max_prob": 0.6706153392791748,
      "train_conf_over_90": 0.01915802937292028,
      "train_conf_over_95": 0.0008758115844102576,
      "val_loss": 0.5456399172544479,
      "val_macro_f1": 0.5815821459990327,
      "val_verse_f1": 0.5985367004956337,
      "val_chorus_f1": 0.5646275915024316,
      "val_chorus_rate": 0.6603533625602722,
      "val_max_prob": 0.6956749856472015,
      "val_conf_over_90": 0.06269730720669031,
      "val_conf_over_95": 0.009346164704766124,
      "learning_rate": 0.0006973730348760674,
      "epoch_time": 133.19326615333557,
      "val_boundary_f1": 0.17054263565891473,
      "val_boundary_precision": 0.13432835820895522,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.07589878546930508,
      "val_avg_segment_overlap": 0.44692742237915395,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.5505751597450157,
      "val_pk_metric": 0.4111857939963911
    },
    {
      "epoch": 4,
      "train_loss": 0.4946232050657272,
      "train_chorus_rate": 0.3846593573689461,
      "train_max_prob": 0.6860476166009903,
      "train_conf_over_90": 0.03600944611243904,
      "train_conf_over_95": 0.003989324276335538,
      "val_loss": 0.5131301879882812,
      "val_macro_f1": 0.7332623749989214,
      "val_verse_f1": 0.8280485595216525,
      "val_chorus_f1": 0.6384761904761904,
      "val_chorus_rate": 0.34600669890642166,
      "val_max_prob": 0.6554418802261353,
      "val_conf_over_90": 0.0007735613908153027,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006435243928436727,
      "epoch_time": 113.37103915214539,
      "val_boundary_f1": 0.32784041630529054,
      "val_boundary_precision": 0.25925925925925924,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.19553120193364096,
      "val_avg_segment_overlap": 0.6154045305338606,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40515826679833034,
      "val_pk_metric": 0.29701664562074825
    },
    {
      "epoch": 5,
      "train_loss": 0.48296051621437075,
      "train_chorus_rate": 0.3719037719070911,
      "train_max_prob": 0.6983715862035751,
      "train_conf_over_90": 0.035411132778972385,
      "train_conf_over_95": 0.004395362554350868,
      "val_loss": 0.5054701939225197,
      "val_macro_f1": 0.7178272696620118,
      "val_verse_f1": 0.7972403219624378,
      "val_chorus_f1": 0.6384142173615859,
      "val_chorus_rate": 0.4201558455824852,
      "val_max_prob": 0.6810440570116043,
      "val_conf_over_90": 0.025927377166226506,
      "val_conf_over_95": 0.003978806314989924,
      "learning_rate": 0.0005784183192098856,
      "epoch_time": 54.02121686935425,
      "val_boundary_f1": 0.26273458445040215,
      "val_boundary_precision": 0.21151079136690648,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.12476305460133669,
      "val_avg_segment_overlap": 0.5792492899811263,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.46499592432932624,
      "val_pk_metric": 0.3482767551887928
    },
    {
      "epoch": 6,
      "train_loss": 0.48317872136831286,
      "train_chorus_rate": 0.3798889234662056,
      "train_max_prob": 0.6936707973480225,
      "train_conf_over_90": 0.03173224637284875,
      "train_conf_over_95": 0.005337560866610147,
      "val_loss": 0.5067647024989128,
      "val_macro_f1": 0.758601755289567,
      "val_verse_f1": 0.8604490500863557,
      "val_chorus_f1": 0.6567544604927783,
      "val_chorus_rate": 0.2795116491615772,
      "val_max_prob": 0.6943083256483078,
      "val_conf_over_90": 0.009696536406408995,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005049002618061056,
      "epoch_time": 73.82620000839233,
      "val_boundary_f1": 0.3726829268292683,
      "val_boundary_precision": 0.3178036605657238,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.2403001490355679,
      "val_avg_segment_overlap": 0.6372400095740415,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3687034917222155,
      "val_pk_metric": 0.25867806198278426
    },
    {
      "epoch": 7,
      "train_loss": 0.45582073032855985,
      "train_chorus_rate": 0.3279581949114799,
      "train_max_prob": 0.7142572194337845,
      "train_conf_over_90": 0.03761312485439703,
      "train_conf_over_95": 0.005196765618165955,
      "val_loss": 0.5034585744142532,
      "val_macro_f1": 0.7616569624028295,
      "val_verse_f1": 0.8558352402745996,
      "val_chorus_f1": 0.6674786845310596,
      "val_chorus_rate": 0.3060380443930626,
      "val_max_prob": 0.7424209117889404,
      "val_conf_over_90": 0.04524036031216383,
      "val_conf_over_95": 0.0009698554058559239,
      "learning_rate": 0.0004261833125196576,
      "epoch_time": 129.1586949825287,
      "val_boundary_f1": 0.3814133591481123,
      "val_boundary_precision": 0.32348111658456485,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.262161087386432,
      "val_avg_segment_overlap": 0.6518554436522482,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.34267591964963406,
      "val_pk_metric": 0.24712430960513482
    },
    {
      "epoch": 8,
      "train_loss": 0.4568332925438881,
      "train_chorus_rate": 0.3167759940028191,
      "train_max_prob": 0.7146847248077393,
      "train_conf_over_90": 0.039277658052742484,
      "train_conf_over_95": 0.006451969954650849,
      "val_loss": 0.49799178540706635,
      "val_macro_f1": 0.76436906567664,
      "val_verse_f1": 0.8579964850615114,
      "val_chorus_f1": 0.6707416462917686,
      "val_chorus_rate": 0.30370358377695084,
      "val_max_prob": 0.7500122636556625,
      "val_conf_over_90": 0.07070607598870993,
      "val_conf_over_95": 0.010601576301269233,
      "learning_rate": 0.00034570777976019,
      "epoch_time": 97.81842184066772,
      "val_boundary_f1": 0.36289500509684,
      "val_boundary_precision": 0.31956912028725315,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.21528058129330666,
      "val_avg_segment_overlap": 0.6361431483962703,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.33466355344528653,
      "val_pk_metric": 0.25094443694458285
    },
    {
      "epoch": 9,
      "train_loss": 0.4545771196484566,
      "train_chorus_rate": 0.35103863254189493,
      "train_max_prob": 0.7236435145139695,
      "train_conf_over_90": 0.047631010552868246,
      "train_conf_over_95": 0.005936616362305358,
      "val_loss": 0.4896254688501358,
      "val_macro_f1": 0.7773553599270198,
      "val_verse_f1": 0.869595415870811,
      "val_chorus_f1": 0.6851153039832285,
      "val_chorus_rate": 0.28707005083560944,
      "val_max_prob": 0.732296347618103,
      "val_conf_over_90": 0.029710199451074004,
      "val_conf_over_95": 0.0009643201483413577,
      "learning_rate": 0.00026699083047374196,
      "epoch_time": 78.13254284858704,
      "val_boundary_f1": 0.4144329896907216,
      "val_boundary_precision": 0.36813186813186816,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.28696631414022716,
      "val_avg_segment_overlap": 0.6486936371776125,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3022899616594401,
      "val_pk_metric": 0.221523619658102
    },
    {
      "epoch": 10,
      "train_loss": 0.45352020263671877,
      "train_chorus_rate": 0.3489920787513256,
      "train_max_prob": 0.7134957015514374,
      "train_conf_over_90": 0.03671569469152018,
      "train_conf_over_95": 0.003031826892402023,
      "val_loss": 0.47849684208631516,
      "val_macro_f1": 0.7798831247901765,
      "val_verse_f1": 0.8657243816254417,
      "val_chorus_f1": 0.6940418679549114,
      "val_chorus_rate": 0.31126828491687775,
      "val_max_prob": 0.7496890723705292,
      "val_conf_over_90": 0.07545140106230974,
      "val_conf_over_95": 0.016862360178492963,
      "learning_rate": 0.00019347277306996198,
      "epoch_time": 78.17838883399963,
      "val_boundary_f1": 0.4119922630560929,
      "val_boundary_precision": 0.34918032786885245,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.3040940254752556,
      "val_avg_segment_overlap": 0.6586427096159453,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3329716935234027,
      "val_pk_metric": 0.22994579203895832
    },
    {
      "epoch": 11,
      "train_loss": 0.4364200055599213,
      "train_chorus_rate": 0.29624784365296364,
      "train_max_prob": 0.7340150684118271,
      "train_conf_over_90": 0.05886970683932304,
      "train_conf_over_95": 0.009189825120847673,
      "val_loss": 0.4909790903329849,
      "val_macro_f1": 0.7809337452738068,
      "val_verse_f1": 0.8707767328456983,
      "val_chorus_f1": 0.6910907577019151,
      "val_chorus_rate": 0.2913850396871567,
      "val_max_prob": 0.7551680505275726,
      "val_conf_over_90": 0.0809851810336113,
      "val_conf_over_95": 0.016194047057069838,
      "learning_rate": 0.00012836669943617487,
      "epoch_time": 78.77739787101746,
      "val_boundary_f1": 0.40293809024134314,
      "val_boundary_precision": 0.3629489603024575,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.27330992369433516,
      "val_avg_segment_overlap": 0.6375794815441312,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3058876773601054,
      "val_pk_metric": 0.22144430102719975
    },
    {
      "epoch": 12,
      "train_loss": 0.4337270587682724,
      "train_chorus_rate": 0.3214094527065754,
      "train_max_prob": 0.7387402504682541,
      "train_conf_over_90": 0.06959609370678663,
      "train_conf_over_95": 0.018466698325937614,
      "val_loss": 0.4741866886615753,
      "val_macro_f1": 0.7778650700190257,
      "val_verse_f1": 0.8612747723620782,
      "val_chorus_f1": 0.6944553676759734,
      "val_chorus_rate": 0.32570789009332657,
      "val_max_prob": 0.7326889187097549,
      "val_conf_over_90": 0.06548567675054073,
      "val_conf_over_95": 0.006211410684045404,
      "learning_rate": 7.451805740378002e-05,
      "epoch_time": 62.851370096206665,
      "val_boundary_f1": 0.40076335877862596,
      "val_boundary_precision": 0.33653846153846156,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.31014482517663855,
      "val_avg_segment_overlap": 0.6675305797531803,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.33669901903919597,
      "val_pk_metric": 0.23933900482137355
    },
    {
      "epoch": 13,
      "train_loss": 0.4348181366920471,
      "train_chorus_rate": 0.34370789527893064,
      "train_max_prob": 0.7389162540435791,
      "train_conf_over_90": 0.0743919069878757,
      "train_conf_over_95": 0.01578068868839182,
      "val_loss": 0.47466982156038284,
      "val_macro_f1": 0.7702720759187721,
      "val_verse_f1": 0.8520195616736099,
      "val_chorus_f1": 0.6885245901639343,
      "val_chorus_rate": 0.34526223689317703,
      "val_max_prob": 0.7218901365995407,
      "val_conf_over_90": 0.05642160773277283,
      "val_conf_over_95": 0.007080933311954141,
      "learning_rate": 3.4280291024046134e-05,
      "epoch_time": 88.95915794372559,
      "val_boundary_f1": 0.3790720631786772,
      "val_boundary_precision": 0.32597623089983024,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.27682259785918323,
      "val_avg_segment_overlap": 0.6457522617888343,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.34143583427725477,
      "val_pk_metric": 0.24745774717217073
    },
    {
      "epoch": 14,
      "train_loss": 0.42640478163957596,
      "train_chorus_rate": 0.3134707845747471,
      "train_max_prob": 0.73755461871624,
      "train_conf_over_90": 0.061217138171195985,
      "train_conf_over_95": 0.010128412014455534,
      "val_loss": 0.47578582912683487,
      "val_macro_f1": 0.7825496358628017,
      "val_verse_f1": 0.8660159716060337,
      "val_chorus_f1": 0.6990833001195695,
      "val_chorus_rate": 0.3175175115466118,
      "val_max_prob": 0.7402581572532654,
      "val_conf_over_90": 0.07196311186999083,
      "val_conf_over_95": 0.013215697894338518,
      "learning_rate": 9.411983769992838e-06,
      "epoch_time": 81.58438396453857,
      "val_boundary_f1": 0.4114737883283877,
      "val_boundary_precision": 0.3543441226575809,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.302799927256449,
      "val_avg_segment_overlap": 0.66410651602127,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.32855154859191416,
      "val_pk_metric": 0.2298277805805528
    },
    {
      "epoch": 15,
      "train_loss": 0.4176520690321922,
      "train_chorus_rate": 0.30785669535398485,
      "train_max_prob": 0.7492430746555329,
      "train_conf_over_90": 0.07390998620539904,
      "train_conf_over_95": 0.017132508620852603,
      "val_loss": 0.4745192602276802,
      "val_macro_f1": 0.7786215589614202,
      "val_verse_f1": 0.8608773500447628,
      "val_chorus_f1": 0.6963657678780775,
      "val_chorus_rate": 0.3297085613012314,
      "val_max_prob": 0.7399047166109085,
      "val_conf_over_90": 0.07812367379665375,
      "val_conf_over_95": 0.015953821130096912,
      "learning_rate": 1e-06,
      "epoch_time": 106.35156393051147,
      "val_boundary_f1": 0.4027504911591355,
      "val_boundary_precision": 0.3451178451178451,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.30598325942970694,
      "val_avg_segment_overlap": 0.6598920377667457,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3335300814130925,
      "val_pk_metric": 0.2352041276057144
    }
  ]
}