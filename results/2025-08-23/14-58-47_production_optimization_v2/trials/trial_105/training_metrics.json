{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.1841758864605922,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.25571551312161717,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008818287083395568,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01562673192906014,
      "gradient_clip_norm": 0.3714621018652839,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13315471348102056,
        "ece_after": 0.030075789376185793,
        "improvement": 0.10307892410483477,
        "params": {
          "temperature": 0.4629444647340055
        }
      },
      "platt": {
        "ece_before": 0.13315471348102056,
        "ece_after": 0.03422062590806096,
        "improvement": 0.0989340875729596,
        "params": {
          "A": 2.073169589429632,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5733996838331222,
      "train_chorus_rate": 0.5198672258295118,
      "train_max_prob": 0.5865006268024444,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5675462484359741,
      "val_macro_f1": 0.48210666982955896,
      "val_verse_f1": 0.46302906680265177,
      "val_chorus_f1": 0.5011842728564662,
      "val_chorus_rate": 0.7374468594789505,
      "val_max_prob": 0.5786706954240799,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008722045980296757,
      "epoch_time": 106.25083208084106,
      "val_boundary_f1": 0.07643312101910828,
      "val_boundary_precision": 0.11764705882352941,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.027170910495406785,
      "val_avg_segment_overlap": 0.23930267887500453,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.44864395769884424,
      "val_pk_metric": 0.45139688430587166
    },
    {
      "epoch": 2,
      "train_loss": 0.5472992792725563,
      "train_chorus_rate": 0.450983630400151,
      "train_max_prob": 0.6073658883571624,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5470577478408813,
      "val_macro_f1": 0.5699866880526782,
      "val_verse_f1": 0.5803357314148682,
      "val_chorus_f1": 0.5596376446904882,
      "val_chorus_rate": 0.6770622283220291,
      "val_max_prob": 0.5998808741569519,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008437528869021791,
      "epoch_time": 109.83174800872803,
      "val_boundary_f1": 0.1277955271565495,
      "val_boundary_precision": 0.11650485436893204,
      "val_boundary_recall": 0.14150943396226415,
      "val_complete_segments": 0.058331217901737516,
      "val_avg_segment_overlap": 0.3788232832000464,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.12626262626262627,
      "val_window_diff": 0.4981464763408194,
      "val_pk_metric": 0.41099957993020364
    },
    {
      "epoch": 3,
      "train_loss": 0.5207818686962128,
      "train_chorus_rate": 0.4030480321496725,
      "train_max_prob": 0.630054360628128,
      "train_conf_over_90": 0.0006639434053795412,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5315508246421814,
      "val_macro_f1": 0.6277245889058696,
      "val_verse_f1": 0.6633796503809951,
      "val_chorus_f1": 0.5920695274307441,
      "val_chorus_rate": 0.6050231009721756,
      "val_max_prob": 0.6378763020038605,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007977170512597962,
      "epoch_time": 121.58093786239624,
      "val_boundary_f1": 0.20817120622568094,
      "val_boundary_precision": 0.1771523178807947,
      "val_boundary_recall": 0.25235849056603776,
      "val_complete_segments": 0.08226703638951784,
      "val_avg_segment_overlap": 0.49030435648879156,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.49628693184413286,
      "val_pk_metric": 0.3972099045482401
    },
    {
      "epoch": 4,
      "train_loss": 0.5096106365323066,
      "train_chorus_rate": 0.41167065873742104,
      "train_max_prob": 0.6592058837413788,
      "train_conf_over_90": 0.00201428052096162,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5187499076128006,
      "val_macro_f1": 0.6838769760515151,
      "val_verse_f1": 0.7424901595193701,
      "val_chorus_f1": 0.6252637925836599,
      "val_chorus_rate": 0.5153450444340706,
      "val_max_prob": 0.653397262096405,
      "val_conf_over_90": 0.008839172311127186,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007361090780245472,
      "epoch_time": 96.92950201034546,
      "val_boundary_f1": 0.2922794117647059,
      "val_boundary_precision": 0.2394578313253012,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.15129365466056877,
      "val_avg_segment_overlap": 0.5737880799541679,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.47857762621040595,
      "val_pk_metric": 0.3709631098612373
    },
    {
      "epoch": 5,
      "train_loss": 0.5000980272889137,
      "train_chorus_rate": 0.3988666690886021,
      "train_max_prob": 0.659397405385971,
      "train_conf_over_90": 0.009194814716465771,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5156345069408417,
      "val_macro_f1": 0.7433172011801391,
      "val_verse_f1": 0.8325132130490249,
      "val_chorus_f1": 0.6541211893112533,
      "val_chorus_rate": 0.35392363369464874,
      "val_max_prob": 0.6776246130466461,
      "val_conf_over_90": 0.007327022845856845,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006616215312546677,
      "epoch_time": 101.85118103027344,
      "val_boundary_f1": 0.41754051477597715,
      "val_boundary_precision": 0.3504,
      "val_boundary_recall": 0.5165094339622641,
      "val_complete_segments": 0.3232127503203855,
      "val_avg_segment_overlap": 0.6335030937759014,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3901138438883101,
      "val_pk_metric": 0.278316868787027
    },
    {
      "epoch": 6,
      "train_loss": 0.5004058718681336,
      "train_chorus_rate": 0.3731811687350273,
      "train_max_prob": 0.67382433116436,
      "train_conf_over_90": 0.007610319834202528,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5086601004004478,
      "val_macro_f1": 0.6849736210879908,
      "val_verse_f1": 0.7345639719923616,
      "val_chorus_f1": 0.63538327018362,
      "val_chorus_rate": 0.5430018901824951,
      "val_max_prob": 0.6496349573135376,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005775098741749071,
      "epoch_time": 93.2208960056305,
      "val_boundary_f1": 0.3092979127134725,
      "val_boundary_precision": 0.25873015873015875,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1753379913772279,
      "val_avg_segment_overlap": 0.5803493627093319,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.46712857738802993,
      "val_pk_metric": 0.3498764442573839
    },
    {
      "epoch": 7,
      "train_loss": 0.4898438587784767,
      "train_chorus_rate": 0.41628687679767606,
      "train_max_prob": 0.6679166048765183,
      "train_conf_over_90": 0.0038902996806427837,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5018942058086395,
      "val_macro_f1": 0.7564730034198841,
      "val_verse_f1": 0.8374493180980463,
      "val_chorus_f1": 0.6754966887417218,
      "val_chorus_rate": 0.3685266971588135,
      "val_max_prob": 0.690226674079895,
      "val_conf_over_90": 0.011611940688453615,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004874501898121616,
      "epoch_time": 96.28772377967834,
      "val_boundary_f1": 0.4,
      "val_boundary_precision": 0.33438985736925514,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.31621850224713427,
      "val_avg_segment_overlap": 0.6565557449284531,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.39304020660287475,
      "val_pk_metric": 0.27777045698767133
    },
    {
      "epoch": 8,
      "train_loss": 0.4907446354627609,
      "train_chorus_rate": 0.3747342213988304,
      "train_max_prob": 0.6667017966508866,
      "train_conf_over_90": 0.0032060239784186704,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5004495605826378,
      "val_macro_f1": 0.7666170566847337,
      "val_verse_f1": 0.850009046499005,
      "val_chorus_f1": 0.6832250668704624,
      "val_chorus_rate": 0.34373173862695694,
      "val_max_prob": 0.6722155660390854,
      "val_conf_over_90": 0.0024074708635453135,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003953785185273956,
      "epoch_time": 94.96654486656189,
      "val_boundary_f1": 0.41768579492003766,
      "val_boundary_precision": 0.3474178403755869,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.33117598548404487,
      "val_avg_segment_overlap": 0.6795272569681067,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.36867555111763534,
      "val_pk_metric": 0.25828967456886276
    },
    {
      "epoch": 9,
      "train_loss": 0.48122249990701677,
      "train_chorus_rate": 0.39476620852947236,
      "train_max_prob": 0.6830989331007004,
      "train_conf_over_90": 0.010584106657188386,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4958600774407387,
      "val_macro_f1": 0.7654187177378744,
      "val_verse_f1": 0.8429019752630608,
      "val_chorus_f1": 0.687935460212688,
      "val_chorus_rate": 0.3705802708864212,
      "val_max_prob": 0.6772946417331696,
      "val_conf_over_90": 0.00240224547451362,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030531883416465007,
      "epoch_time": 89.22813320159912,
      "val_boundary_f1": 0.4387855044074436,
      "val_boundary_precision": 0.37520938023450584,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3410261344513731,
      "val_avg_segment_overlap": 0.6747545761634164,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3643760738268438,
      "val_pk_metric": 0.26758556158821134
    },
    {
      "epoch": 10,
      "train_loss": 0.47786649167537687,
      "train_chorus_rate": 0.3400427669286728,
      "train_max_prob": 0.684291410446167,
      "train_conf_over_90": 0.010574558650841937,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4968489408493042,
      "val_macro_f1": 0.7514493762901453,
      "val_verse_f1": 0.8268324853966459,
      "val_chorus_f1": 0.6760662671836447,
      "val_chorus_rate": 0.39773470908403397,
      "val_max_prob": 0.6995415985584259,
      "val_conf_over_90": 0.006281357200350612,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022120717708488938,
      "epoch_time": 103.66750884056091,
      "val_boundary_f1": 0.4078048780487805,
      "val_boundary_precision": 0.34775374376039936,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.29767270110589306,
      "val_avg_segment_overlap": 0.6561130099201606,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.39058608576357423,
      "val_pk_metric": 0.28558902850143336
    },
    {
      "epoch": 11,
      "train_loss": 0.470830012857914,
      "train_chorus_rate": 0.34199522584676745,
      "train_max_prob": 0.6879704028367997,
      "train_conf_over_90": 0.007747852394822985,
      "train_conf_over_95": 0.0,
      "val_loss": 0.495308481156826,
      "val_macro_f1": 0.7623949818193607,
      "val_verse_f1": 0.840118430792006,
      "val_chorus_f1": 0.6846715328467153,
      "val_chorus_rate": 0.37395573407411575,
      "val_max_prob": 0.6828912049531937,
      "val_conf_over_90": 0.022954019019380212,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014671963031500984,
      "epoch_time": 121.37117218971252,
      "val_boundary_f1": 0.4163424124513619,
      "val_boundary_precision": 0.3543046357615894,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.3171443959487438,
      "val_avg_segment_overlap": 0.6733672186462025,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.3821567273233,
      "val_pk_metric": 0.2680671983975801
    },
    {
      "epoch": 12,
      "train_loss": 0.4658758282661438,
      "train_chorus_rate": 0.3722348839044571,
      "train_max_prob": 0.698330146074295,
      "train_conf_over_90": 0.0308978708460927,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4947105795145035,
      "val_macro_f1": 0.7451802733618598,
      "val_verse_f1": 0.8175210405508799,
      "val_chorus_f1": 0.6728395061728395,
      "val_chorus_rate": 0.4168021008372307,
      "val_max_prob": 0.694304808974266,
      "val_conf_over_90": 0.04421743704006076,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.511165707976075e-05,
      "epoch_time": 98.17423510551453,
      "val_boundary_f1": 0.4069431051108968,
      "val_boundary_precision": 0.3442088091353997,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.2984518964503058,
      "val_avg_segment_overlap": 0.6538164974518955,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4020406671554099,
      "val_pk_metric": 0.29160652277125
    },
    {
      "epoch": 13,
      "train_loss": 0.47745604515075685,
      "train_chorus_rate": 0.3590843826532364,
      "train_max_prob": 0.6838265925645828,
      "train_conf_over_90": 0.023521500127390026,
      "train_conf_over_95": 0.0,
      "val_loss": 0.493564248085022,
      "val_macro_f1": 0.7778315732685896,
      "val_verse_f1": 0.85863497208716,
      "val_chorus_f1": 0.6970281744500193,
      "val_chorus_rate": 0.33700965344905853,
      "val_max_prob": 0.6742956042289734,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.907582143737765e-05,
      "epoch_time": 94.77484607696533,
      "val_boundary_f1": 0.44511581067472306,
      "val_boundary_precision": 0.3884007029876977,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.3448164931330361,
      "val_avg_segment_overlap": 0.6823453361535613,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.34324813610312194,
      "val_pk_metric": 0.2397239472696989
    },
    {
      "epoch": 14,
      "train_loss": 0.46539007425308226,
      "train_chorus_rate": 0.31098744124174116,
      "train_max_prob": 0.6791362166404724,
      "train_conf_over_90": 0.008616958653146867,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49158889055252075,
      "val_macro_f1": 0.7454087525467384,
      "val_verse_f1": 0.8177471791929622,
      "val_chorus_f1": 0.6730703259005146,
      "val_chorus_rate": 0.4165346398949623,
      "val_max_prob": 0.6881672739982605,
      "val_conf_over_90": 0.01631036587059498,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0624110309881111e-05,
      "epoch_time": 113.44450902938843,
      "val_boundary_f1": 0.39729990356798456,
      "val_boundary_precision": 0.3360522022838499,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.29375353993593656,
      "val_avg_segment_overlap": 0.6523393606249429,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3922069479225421,
      "val_pk_metric": 0.2847544957649494
    },
    {
      "epoch": 15,
      "train_loss": 0.4606031358242035,
      "train_chorus_rate": 0.35005049854516984,
      "train_max_prob": 0.6876212179660797,
      "train_conf_over_90": 0.017208621744066475,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49192169308662415,
      "val_macro_f1": 0.7693864108313516,
      "val_verse_f1": 0.8465218991534781,
      "val_chorus_f1": 0.6922509225092252,
      "val_chorus_rate": 0.36612609773874283,
      "val_max_prob": 0.6918889135122299,
      "val_conf_over_90": 0.01656679413281381,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 108.30583500862122,
      "val_boundary_f1": 0.4362549800796812,
      "val_boundary_precision": 0.3775862068965517,
      "val_boundary_recall": 0.5165094339622641,
      "val_complete_segments": 0.3449607860397892,
      "val_avg_segment_overlap": 0.679913836897184,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3554653134012132,
      "val_pk_metric": 0.2523571613390616
    }
  ]
}