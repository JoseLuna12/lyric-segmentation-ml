{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1976989055723333,
      "layer_dropout": 0.21859423962551347,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.10669315723091116,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008184932505037184,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.020459311770501695,
      "gradient_clip_norm": 0.45555334869504716,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12994387994697848,
        "ece_after": 0.02208995962541089,
        "improvement": 0.1078539203215676,
        "params": {
          "temperature": 0.4852593718799875
        }
      },
      "platt": {
        "ece_before": 0.12994387994697848,
        "ece_after": 0.03692979803253955,
        "improvement": 0.09301408191443894,
        "params": {
          "A": 1.7479370253316793,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6058453232049942,
      "train_chorus_rate": 0.44554121151159054,
      "train_max_prob": 0.5814263492822647,
      "train_conf_over_90": 0.003505535051226616,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5936869829893112,
      "val_macro_f1": 0.39551272057682685,
      "val_verse_f1": 0.2932308601832693,
      "val_chorus_f1": 0.49779458097038437,
      "val_chorus_rate": 0.8694033324718475,
      "val_max_prob": 0.5917654484510422,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008095611560500053,
      "epoch_time": 70.26578378677368,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.02374276829473012,
      "val_avg_segment_overlap": 0.1754991972520145,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4251782688838821,
      "val_pk_metric": 0.4270899453342281
    },
    {
      "epoch": 2,
      "train_loss": 0.5658965796232224,
      "train_chorus_rate": 0.5557078397832811,
      "train_max_prob": 0.5703565955162049,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6208673268556595,
      "val_macro_f1": 0.471621726831547,
      "val_verse_f1": 0.8230088495575222,
      "val_chorus_f1": 0.12023460410557185,
      "val_chorus_rate": 0.03515027230605483,
      "val_max_prob": 0.6016299575567245,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007831552480774375,
      "epoch_time": 57.09135389328003,
      "val_boundary_f1": 0.08438818565400845,
      "val_boundary_precision": 0.4,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.0748067280278309,
      "val_avg_segment_overlap": 0.20046559080350299,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.2663096254231885,
      "val_pk_metric": 0.27256385697937363
    },
    {
      "epoch": 3,
      "train_loss": 0.5755070209503174,
      "train_chorus_rate": 0.493215762055479,
      "train_max_prob": 0.5743534326553345,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5892525762319565,
      "val_macro_f1": 0.5602823853225136,
      "val_verse_f1": 0.6444032158317872,
      "val_chorus_f1": 0.4761615548132402,
      "val_chorus_rate": 0.5103916153311729,
      "val_max_prob": 0.5485879629850388,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007404295914740213,
      "epoch_time": 41.89246106147766,
      "val_boundary_f1": 0.07763975155279502,
      "val_boundary_precision": 0.11363636363636363,
      "val_boundary_recall": 0.0589622641509434,
      "val_complete_segments": 0.04354489696483334,
      "val_avg_segment_overlap": 0.25063312078854666,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.43740123908037026,
      "val_pk_metric": 0.43492272212283833
    },
    {
      "epoch": 4,
      "train_loss": 0.5561519891023636,
      "train_chorus_rate": 0.5402188837528229,
      "train_max_prob": 0.5739871710538864,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5748516619205475,
      "val_macro_f1": 0.5347062344061648,
      "val_verse_f1": 0.5679578271831309,
      "val_chorus_f1": 0.5014546416291986,
      "val_chorus_rate": 0.631473571062088,
      "val_max_prob": 0.5835408717393875,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006832515024537727,
      "epoch_time": 46.50933027267456,
      "val_boundary_f1": 0.07902735562310031,
      "val_boundary_precision": 0.1111111111111111,
      "val_boundary_recall": 0.06132075471698113,
      "val_complete_segments": 0.03287338050063395,
      "val_avg_segment_overlap": 0.24945630388489737,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.44073581239275467,
      "val_pk_metric": 0.4236534789710892
    },
    {
      "epoch": 5,
      "train_loss": 0.5384137406945229,
      "train_chorus_rate": 0.459077475219965,
      "train_max_prob": 0.6248213052749634,
      "train_conf_over_90": 0.0009114350046729669,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5392249152064323,
      "val_macro_f1": 0.698039605226277,
      "val_verse_f1": 0.7835406698564594,
      "val_chorus_f1": 0.6125385405960945,
      "val_chorus_rate": 0.4179028421640396,
      "val_max_prob": 0.6271519362926483,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006141199378777888,
      "epoch_time": 45.99923515319824,
      "val_boundary_f1": 0.3343051506316812,
      "val_boundary_precision": 0.28429752066115704,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.18824806096810337,
      "val_avg_segment_overlap": 0.5863827639006488,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4183317970404452,
      "val_pk_metric": 0.3227413160288054
    },
    {
      "epoch": 6,
      "train_loss": 0.5184097155928612,
      "train_chorus_rate": 0.4082203179597855,
      "train_max_prob": 0.6531443864107132,
      "train_conf_over_90": 0.006900917063467205,
      "train_conf_over_95": 6.195786991156638e-05,
      "val_loss": 0.542641706764698,
      "val_macro_f1": 0.5761866908643831,
      "val_verse_f1": 0.6027270626299976,
      "val_chorus_f1": 0.5496463190987687,
      "val_chorus_rate": 0.637628361582756,
      "val_max_prob": 0.6807631850242615,
      "val_conf_over_90": 0.03457021899521351,
      "val_conf_over_95": 0.0024973528052214533,
      "learning_rate": 0.0005360562788480917,
      "epoch_time": 40.3729681968689,
      "val_boundary_f1": 0.1486910994764398,
      "val_boundary_precision": 0.1337099811676083,
      "val_boundary_recall": 0.16745283018867924,
      "val_complete_segments": 0.04479581649518023,
      "val_avg_segment_overlap": 0.4377153645542804,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.17676767676767677,
      "val_window_diff": 0.5227441198616074,
      "val_pk_metric": 0.43511467451878705
    },
    {
      "epoch": 7,
      "train_loss": 0.5143493235111236,
      "train_chorus_rate": 0.3979717880487442,
      "train_max_prob": 0.6593598455190659,
      "train_conf_over_90": 0.01890332963957917,
      "train_conf_over_95": 0.0027129692636663092,
      "val_loss": 0.5216606184840202,
      "val_macro_f1": 0.7180892316824131,
      "val_verse_f1": 0.8129364204336641,
      "val_chorus_f1": 0.6232420429311621,
      "val_chorus_rate": 0.36490681022405624,
      "val_max_prob": 0.6509597450494766,
      "val_conf_over_90": 0.0036285288515500724,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004524722818552755,
      "epoch_time": 82.85682201385498,
      "val_boundary_f1": 0.31415525114155257,
      "val_boundary_precision": 0.2563338301043219,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.17453649870139795,
      "val_avg_segment_overlap": 0.6211658360882226,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.449962155005262,
      "val_pk_metric": 0.3232216385608069
    },
    {
      "epoch": 8,
      "train_loss": 0.49150545746088026,
      "train_chorus_rate": 0.38349581584334375,
      "train_max_prob": 0.6712613850831985,
      "train_conf_over_90": 0.010543183065601624,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5168951451778412,
      "val_macro_f1": 0.7412521341657143,
      "val_verse_f1": 0.8351054244007929,
      "val_chorus_f1": 0.6473988439306358,
      "val_chorus_rate": 0.3382168114185333,
      "val_max_prob": 0.709450975060463,
      "val_conf_over_90": 0.018763260915875435,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.000367020968648443,
      "epoch_time": 56.84688401222229,
      "val_boundary_f1": 0.3577075098814229,
      "val_boundary_precision": 0.3078231292517007,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.2173449695719049,
      "val_avg_segment_overlap": 0.6260896992651991,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3745401783333747,
      "val_pk_metric": 0.2742760000771617
    },
    {
      "epoch": 9,
      "train_loss": 0.4752161756157875,
      "train_chorus_rate": 0.3230698272585869,
      "train_max_prob": 0.6922582954168319,
      "train_conf_over_90": 0.019002152321627365,
      "train_conf_over_95": 0.0008718208380741998,
      "val_loss": 0.5085093975067139,
      "val_macro_f1": 0.7100075410066967,
      "val_verse_f1": 0.7947548460661346,
      "val_chorus_f1": 0.6252602359472589,
      "val_chorus_rate": 0.40872006863355637,
      "val_max_prob": 0.6725234985351562,
      "val_conf_over_90": 0.015141722746193409,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00028343697165562675,
      "epoch_time": 104.1033308506012,
      "val_boundary_f1": 0.2649006622516556,
      "val_boundary_precision": 0.2211690363349131,
      "val_boundary_recall": 0.330188679245283,
      "val_complete_segments": 0.12400733372366458,
      "val_avg_segment_overlap": 0.5897989356103026,
      "val_verse_to_chorus_acc": 0.23008849557522124,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.45430135109223374,
      "val_pk_metric": 0.3269996274446822
    },
    {
      "epoch": 10,
      "train_loss": 0.47657044529914855,
      "train_chorus_rate": 0.34127328395843504,
      "train_max_prob": 0.6911628127098084,
      "train_conf_over_90": 0.02340458769176621,
      "train_conf_over_95": 0.0009845945052802563,
      "val_loss": 0.5074669346213341,
      "val_macro_f1": 0.7298647684704656,
      "val_verse_f1": 0.8137181409295351,
      "val_chorus_f1": 0.646011396011396,
      "val_chorus_rate": 0.39047450572252274,
      "val_max_prob": 0.7077223658561707,
      "val_conf_over_90": 0.032407581340521574,
      "val_conf_over_95": 0.000693802023306489,
      "learning_rate": 0.0002053733126259297,
      "epoch_time": 81.70011591911316,
      "val_boundary_f1": 0.3629697525206233,
      "val_boundary_precision": 0.29685157421289354,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.22385393081310367,
      "val_avg_segment_overlap": 0.6408441118725308,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4212516250092708,
      "val_pk_metric": 0.2997541809661938
    },
    {
      "epoch": 11,
      "train_loss": 0.48132422715425494,
      "train_chorus_rate": 0.3508083298802376,
      "train_max_prob": 0.6875752031803131,
      "train_conf_over_90": 0.018710781133268028,
      "train_conf_over_95": 0.00027362453110981735,
      "val_loss": 0.519795298576355,
      "val_macro_f1": 0.763241066933587,
      "val_verse_f1": 0.8652823065042047,
      "val_chorus_f1": 0.6611998273629692,
      "val_chorus_rate": 0.2696729637682438,
      "val_max_prob": 0.6772810965776443,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013624174804994577,
      "epoch_time": 89.547847032547,
      "val_boundary_f1": 0.42526315789473684,
      "val_boundary_precision": 0.3840304182509506,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2800586793428787,
      "val_avg_segment_overlap": 0.6573275025166507,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.293586704339283,
      "val_pk_metric": 0.22457553385880746
    },
    {
      "epoch": 12,
      "train_loss": 0.4790565758943558,
      "train_chorus_rate": 0.3355276040732861,
      "train_max_prob": 0.687394505739212,
      "train_conf_over_90": 0.015311306895455346,
      "train_conf_over_95": 0.00015095019480213523,
      "val_loss": 0.5028142407536507,
      "val_macro_f1": 0.7518474411278425,
      "val_verse_f1": 0.8427107675714541,
      "val_chorus_f1": 0.6609841146842309,
      "val_chorus_rate": 0.33472543954849243,
      "val_max_prob": 0.7084564566612244,
      "val_conf_over_90": 0.02453762525692582,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 7.906365902969709e-05,
      "epoch_time": 78.47613430023193,
      "val_boundary_f1": 0.37653736991485337,
      "val_boundary_precision": 0.31437598736176936,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.25217822920633104,
      "val_avg_segment_overlap": 0.6625716554854508,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3683861697458491,
      "val_pk_metric": 0.2525830757216383
    },
    {
      "epoch": 13,
      "train_loss": 0.4710750550031662,
      "train_chorus_rate": 0.33720424249768255,
      "train_max_prob": 0.695058935880661,
      "train_conf_over_90": 0.021238904260098935,
      "train_conf_over_95": 0.0002384675870416686,
      "val_loss": 0.4991803988814354,
      "val_macro_f1": 0.7335328248389698,
      "val_verse_f1": 0.8176218032480866,
      "val_chorus_f1": 0.6494438464298529,
      "val_chorus_rate": 0.38539669662714005,
      "val_max_prob": 0.7053747326135635,
      "val_conf_over_90": 0.024291958659887314,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.633800242628076e-05,
      "epoch_time": 76.98042011260986,
      "val_boundary_f1": 0.3540489642184557,
      "val_boundary_precision": 0.2946708463949843,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22953052090114656,
      "val_avg_segment_overlap": 0.6420970815543559,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.40959266965602004,
      "val_pk_metric": 0.29194847806604834
    },
    {
      "epoch": 14,
      "train_loss": 0.46360834687948227,
      "train_chorus_rate": 0.33847836703062056,
      "train_max_prob": 0.7073206514120102,
      "train_conf_over_90": 0.02839747881516814,
      "train_conf_over_95": 9.80808661552146e-05,
      "val_loss": 0.49951694905757904,
      "val_macro_f1": 0.7545526427155489,
      "val_verse_f1": 0.8442446043165467,
      "val_chorus_f1": 0.664860681114551,
      "val_chorus_rate": 0.3354996368288994,
      "val_max_prob": 0.6979037523269653,
      "val_conf_over_90": 0.016588859260082245,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.932094453713128e-06,
      "epoch_time": 82.22602009773254,
      "val_boundary_f1": 0.38301886792452833,
      "val_boundary_precision": 0.3191823899371069,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.25587206279146896,
      "val_avg_segment_overlap": 0.6633009304106939,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.35464642263013146,
      "val_pk_metric": 0.24866668489481877
    },
    {
      "epoch": 15,
      "train_loss": 0.4716909632086754,
      "train_chorus_rate": 0.33684902638196945,
      "train_max_prob": 0.6985444039106369,
      "train_conf_over_90": 0.021791598154231907,
      "train_conf_over_95": 0.00010002824710682034,
      "val_loss": 0.49895578622817993,
      "val_macro_f1": 0.7504777432109445,
      "val_verse_f1": 0.8404332129963898,
      "val_chorus_f1": 0.6605222734254992,
      "val_chorus_rate": 0.34044404327869415,
      "val_max_prob": 0.6964977979660034,
      "val_conf_over_90": 0.01634255377575755,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 82.39836478233337,
      "val_boundary_f1": 0.3849056603773585,
      "val_boundary_precision": 0.32075471698113206,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2538913023006342,
      "val_avg_segment_overlap": 0.6583922151521133,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.373187350279019,
      "val_pk_metric": 0.25735022528928475
    }
  ]
}