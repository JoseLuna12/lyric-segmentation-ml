{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1901162591933687,
      "layer_dropout": 0.21070665106131423,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1588256714229941,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008894266564556986,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01630517450035133,
      "gradient_clip_norm": 0.339006028161467,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14234573743900755,
        "ece_after": 0.021999063112998058,
        "improvement": 0.1203466743260095,
        "params": {
          "temperature": 0.44286878402042085
        }
      },
      "platt": {
        "ece_before": 0.14234573743900755,
        "ece_after": 0.01348021512298547,
        "improvement": 0.12886552231602208,
        "params": {
          "A": 1.8671937471351554,
          "B": 0.25525645571921196
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6113988876342773,
      "train_chorus_rate": 0.41184721011668446,
      "train_max_prob": 0.5905156016349793,
      "train_conf_over_90": 0.010332103073596954,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5900228470563889,
      "val_macro_f1": 0.5470756843042122,
      "val_verse_f1": 0.6001318971202462,
      "val_chorus_f1": 0.4940194714881781,
      "val_chorus_rate": 0.5845877975225449,
      "val_max_prob": 0.5370206385850906,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008797195294478987,
      "epoch_time": 76.21282362937927,
      "val_boundary_f1": 0.06774193548387096,
      "val_boundary_precision": 0.10714285714285714,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.05292031919815589,
      "val_avg_segment_overlap": 0.26618402276516917,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.38706621987666134,
      "val_pk_metric": 0.3850375730265324
    },
    {
      "epoch": 2,
      "train_loss": 0.5723083913326263,
      "train_chorus_rate": 0.538041246085777,
      "train_max_prob": 0.5857598513364792,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5888619869947433,
      "val_macro_f1": 0.4590638053951622,
      "val_verse_f1": 0.43156532988357055,
      "val_chorus_f1": 0.48656228090675396,
      "val_chorus_rate": 0.7515411823987961,
      "val_max_prob": 0.5640773475170135,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008510223964547027,
      "epoch_time": 63.00382208824158,
      "val_boundary_f1": 0.06871609403254973,
      "val_boundary_precision": 0.14728682170542637,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.024771175129075448,
      "val_avg_segment_overlap": 0.20027119333225718,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42573493869416157,
      "val_pk_metric": 0.42760297774963496
    },
    {
      "epoch": 3,
      "train_loss": 0.5671208918094635,
      "train_chorus_rate": 0.5594756571576,
      "train_max_prob": 0.5798392415046691,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5811540335416794,
      "val_macro_f1": 0.43379338724716215,
      "val_verse_f1": 0.3624613655521214,
      "val_chorus_f1": 0.5051254089422029,
      "val_chorus_rate": 0.8265298306941986,
      "val_max_prob": 0.5853104144334793,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000804589459892036,
      "epoch_time": 45.40532684326172,
      "val_boundary_f1": 0.04735883424408014,
      "val_boundary_precision": 0.104,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.0180422943015732,
      "val_avg_segment_overlap": 0.19482120142726836,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4214782453319649,
      "val_pk_metric": 0.42127937632301116
    },
    {
      "epoch": 4,
      "train_loss": 0.5626108855009079,
      "train_chorus_rate": 0.5150510966777802,
      "train_max_prob": 0.5943965941667557,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.570502519607544,
      "val_macro_f1": 0.656820001680313,
      "val_verse_f1": 0.7541610866653912,
      "val_chorus_f1": 0.5594789166952349,
      "val_chorus_rate": 0.41825269162654877,
      "val_max_prob": 0.5780602693557739,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007424500618976366,
      "epoch_time": 52.40908598899841,
      "val_boundary_f1": 0.24168514412416853,
      "val_boundary_precision": 0.2280334728033473,
      "val_boundary_recall": 0.25707547169811323,
      "val_complete_segments": 0.09782006480044655,
      "val_avg_segment_overlap": 0.46579216750849417,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.2676767676767677,
      "val_window_diff": 0.4285578822370804,
      "val_pk_metric": 0.36376497470157304
    },
    {
      "epoch": 5,
      "train_loss": 0.5196191087365151,
      "train_chorus_rate": 0.43117041140794754,
      "train_max_prob": 0.6458289623260498,
      "train_conf_over_90": 0.00499992266704794,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5211392939090729,
      "val_macro_f1": 0.7090572018490608,
      "val_verse_f1": 0.7900096061479347,
      "val_chorus_f1": 0.6281047975501871,
      "val_chorus_rate": 0.4229607656598091,
      "val_max_prob": 0.6678690165281296,
      "val_conf_over_90": 0.004421715741045773,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000667319992341774,
      "epoch_time": 51.36127996444702,
      "val_boundary_f1": 0.31436837029893927,
      "val_boundary_precision": 0.265905383360522,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.1477312166734224,
      "val_avg_segment_overlap": 0.6002292624534915,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4283312691979907,
      "val_pk_metric": 0.32834224352532276
    },
    {
      "epoch": 6,
      "train_loss": 0.5055073156952858,
      "train_chorus_rate": 0.37105090767145155,
      "train_max_prob": 0.6662612587213517,
      "train_conf_over_90": 0.010948192470823414,
      "train_conf_over_95": 9.931722888723016e-05,
      "val_loss": 0.5202345326542854,
      "val_macro_f1": 0.6520702813870827,
      "val_verse_f1": 0.7081218274111676,
      "val_chorus_f1": 0.5960187353629977,
      "val_chorus_rate": 0.5393979847431183,
      "val_max_prob": 0.6591142266988754,
      "val_conf_over_90": 0.008693415380548686,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005824827957781113,
      "epoch_time": 45.67729091644287,
      "val_boundary_f1": 0.188212927756654,
      "val_boundary_precision": 0.15764331210191082,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.07913945607476891,
      "val_avg_segment_overlap": 0.5174381660663787,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.2676767676767677,
      "val_window_diff": 0.5172371754322675,
      "val_pk_metric": 0.4073367741393925
    },
    {
      "epoch": 7,
      "train_loss": 0.5015175923705101,
      "train_chorus_rate": 0.3982225678861141,
      "train_max_prob": 0.670064952969551,
      "train_conf_over_90": 0.018926103800185955,
      "train_conf_over_95": 0.001097490664687939,
      "val_loss": 0.5087176859378815,
      "val_macro_f1": 0.7416016217394199,
      "val_verse_f1": 0.827840176763027,
      "val_chorus_f1": 0.6553630667158128,
      "val_chorus_rate": 0.36691708117723465,
      "val_max_prob": 0.7134956419467926,
      "val_conf_over_90": 0.024021327262744308,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0004916462647905162,
      "epoch_time": 89.48652505874634,
      "val_boundary_f1": 0.3768939393939394,
      "val_boundary_precision": 0.314873417721519,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.23778000466759747,
      "val_avg_segment_overlap": 0.6487905259345224,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4001948721781523,
      "val_pk_metric": 0.2969998616096139
    },
    {
      "epoch": 8,
      "train_loss": 0.4838125541806221,
      "train_chorus_rate": 0.36843108385801315,
      "train_max_prob": 0.6875002562999726,
      "train_conf_over_90": 0.01771901621250436,
      "train_conf_over_95": 0.0003504600434098393,
      "val_loss": 0.5138528794050217,
      "val_macro_f1": 0.7587104590817015,
      "val_verse_f1": 0.8499643620812546,
      "val_chorus_f1": 0.6674565560821485,
      "val_chorus_rate": 0.3221462368965149,
      "val_max_prob": 0.7242588400840759,
      "val_conf_over_90": 0.034555526450276375,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0003987803916651826,
      "epoch_time": 63.87989401817322,
      "val_boundary_f1": 0.4092339979013641,
      "val_boundary_precision": 0.3686200378071834,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.25303047518052824,
      "val_avg_segment_overlap": 0.6498381084839403,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3074290929946379,
      "val_pk_metric": 0.2423361356028463
    },
    {
      "epoch": 9,
      "train_loss": 0.47164475470781325,
      "train_chorus_rate": 0.31979529485106467,
      "train_max_prob": 0.7025273442268372,
      "train_conf_over_90": 0.02842817711934913,
      "train_conf_over_95": 0.0016499709425261244,
      "val_loss": 0.5089104995131493,
      "val_macro_f1": 0.7107399459535515,
      "val_verse_f1": 0.7910820680376707,
      "val_chorus_f1": 0.6303978238694322,
      "val_chorus_rate": 0.4226320758461952,
      "val_max_prob": 0.6665614396333694,
      "val_conf_over_90": 0.009252859454136342,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030794386067758744,
      "epoch_time": 113.03951692581177,
      "val_boundary_f1": 0.27315247895229183,
      "val_boundary_precision": 0.22635658914728682,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.12307545198584435,
      "val_avg_segment_overlap": 0.6057798875359262,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.45680372201454383,
      "val_pk_metric": 0.3354018500320507
    },
    {
      "epoch": 10,
      "train_loss": 0.47244931012392044,
      "train_chorus_rate": 0.3416797608137131,
      "train_max_prob": 0.6943159461021423,
      "train_conf_over_90": 0.020624060931731948,
      "train_conf_over_95": 0.0003626395162427798,
      "val_loss": 0.503058411180973,
      "val_macro_f1": 0.7353051552581917,
      "val_verse_f1": 0.8190298507462688,
      "val_chorus_f1": 0.6515804597701148,
      "val_chorus_rate": 0.38347477465867996,
      "val_max_prob": 0.6972385346889496,
      "val_conf_over_90": 0.024383219657465816,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022310666411392478,
      "epoch_time": 89.61989688873291,
      "val_boundary_f1": 0.35634328358208955,
      "val_boundary_precision": 0.29475308641975306,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.23444939409944712,
      "val_avg_segment_overlap": 0.6565730191109774,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.38238530493874595,
      "val_pk_metric": 0.2819779727727649
    },
    {
      "epoch": 11,
      "train_loss": 0.47105626910924914,
      "train_chorus_rate": 0.3471888735890388,
      "train_max_prob": 0.6970435827970505,
      "train_conf_over_90": 0.02162046590819955,
      "train_conf_over_95": 0.0002532417624024674,
      "val_loss": 0.5159927532076836,
      "val_macro_f1": 0.7702376689304765,
      "val_verse_f1": 0.8692070030895984,
      "val_chorus_f1": 0.6712683347713546,
      "val_chorus_rate": 0.26985810324549675,
      "val_max_prob": 0.6704231798648834,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014797659455806215,
      "epoch_time": 93.60503196716309,
      "val_boundary_f1": 0.43414120126448896,
      "val_boundary_precision": 0.3923809523809524,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2709487778946952,
      "val_avg_segment_overlap": 0.6508705197426286,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3063047961250799,
      "val_pk_metric": 0.22118399045560333
    },
    {
      "epoch": 12,
      "train_loss": 0.4709866777062416,
      "train_chorus_rate": 0.3319515034556389,
      "train_max_prob": 0.6966210156679153,
      "train_conf_over_90": 0.020895822619786487,
      "train_conf_over_95": 0.00010428738314658404,
      "val_loss": 0.5026913806796074,
      "val_macro_f1": 0.7387623131176733,
      "val_verse_f1": 0.8226765799256506,
      "val_chorus_f1": 0.654848046309696,
      "val_chorus_rate": 0.37944338470697403,
      "val_max_prob": 0.7116492688655853,
      "val_conf_over_90": 0.04873993620276451,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 8.583719656366271e-05,
      "epoch_time": 83.22120118141174,
      "val_boundary_f1": 0.3608736942070276,
      "val_boundary_precision": 0.302066772655008,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.22270112295297873,
      "val_avg_segment_overlap": 0.6560736176361444,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.385407673718532,
      "val_pk_metric": 0.28187747730669627
    },
    {
      "epoch": 13,
      "train_loss": 0.46362489461898804,
      "train_chorus_rate": 0.3412425756454468,
      "train_max_prob": 0.7052394926548005,
      "train_conf_over_90": 0.027042600465938448,
      "train_conf_over_95": 0.00043548776302486657,
      "val_loss": 0.5008060485124588,
      "val_macro_f1": 0.7425060842013012,
      "val_verse_f1": 0.8261030774935114,
      "val_chorus_f1": 0.6589090909090909,
      "val_chorus_rate": 0.37566303461790085,
      "val_max_prob": 0.7158632129430771,
      "val_conf_over_90": 0.039362710900604725,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.9404260000995794e-05,
      "epoch_time": 82.96644306182861,
      "val_boundary_f1": 0.37379576107899803,
      "val_boundary_precision": 0.31596091205211724,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.23893381906372363,
      "val_avg_segment_overlap": 0.6516705057521524,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3670571242937753,
      "val_pk_metric": 0.26966379903718835
    },
    {
      "epoch": 14,
      "train_loss": 0.4577697902917862,
      "train_chorus_rate": 0.3391047239303589,
      "train_max_prob": 0.7147768080234528,
      "train_conf_over_90": 0.03151788252871483,
      "train_conf_over_95": 0.00021651719871442764,
      "val_loss": 0.5017106384038925,
      "val_macro_f1": 0.7547664566872361,
      "val_verse_f1": 0.8454643241305128,
      "val_chorus_f1": 0.6640685892439595,
      "val_chorus_rate": 0.33078768104314804,
      "val_max_prob": 0.707552507519722,
      "val_conf_over_90": 0.02087151736486703,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.070712700779999e-05,
      "epoch_time": 88.60109186172485,
      "val_boundary_f1": 0.3916913946587537,
      "val_boundary_precision": 0.3373083475298126,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.26343589082189295,
      "val_avg_segment_overlap": 0.6670069446046494,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3405679426171219,
      "val_pk_metric": 0.24839920833861243
    },
    {
      "epoch": 15,
      "train_loss": 0.4611861646175385,
      "train_chorus_rate": 0.3405685931444168,
      "train_max_prob": 0.7109255284070969,
      "train_conf_over_90": 0.02593327728100121,
      "train_conf_over_95": 0.0002507617318769917,
      "val_loss": 0.5013538748025894,
      "val_macro_f1": 0.7547852581821732,
      "val_verse_f1": 0.8444524366121202,
      "val_chorus_f1": 0.6651180797522261,
      "val_chorus_rate": 0.3349631130695343,
      "val_max_prob": 0.7056052386760712,
      "val_conf_over_90": 0.020107768126763403,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 89.05678009986877,
      "val_boundary_f1": 0.39219512195121947,
      "val_boundary_precision": 0.33444259567387685,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2615795313568378,
      "val_avg_segment_overlap": 0.66685521178334,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.34027334270558557,
      "val_pk_metric": 0.24686251267112222
    }
  ]
}