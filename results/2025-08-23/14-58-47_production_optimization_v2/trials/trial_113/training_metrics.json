{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.28297084757601043,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.29013848358410826,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1867010,
      "lstm_params": 1339392,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007433074959927462,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.02349317753976897,
      "gradient_clip_norm": 0.3482676883047676,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09048762938011372,
        "ece_after": 0.025724005151708387,
        "improvement": 0.06476362422840533,
        "params": {
          "temperature": 0.623136692262713
        }
      },
      "platt": {
        "ece_before": 0.09048762938011372,
        "ece_after": 0.03530770060121428,
        "improvement": 0.05517992877889944,
        "params": {
          "A": 1.4999997228714654,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5815771579742431,
      "train_chorus_rate": 0.49911175258457663,
      "train_max_prob": 0.6041104316711425,
      "train_conf_over_90": 3.320053219795227e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.562115952372551,
      "val_macro_f1": 0.5553516359023739,
      "val_verse_f1": 0.5822139879573877,
      "val_chorus_f1": 0.5284892838473602,
      "val_chorus_rate": 0.6405355483293533,
      "val_max_prob": 0.5445312857627869,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000735196896102385,
      "epoch_time": 105.80585217475891,
      "val_boundary_f1": 0.1331747919143876,
      "val_boundary_precision": 0.1342925659472422,
      "val_boundary_recall": 0.1320754716981132,
      "val_complete_segments": 0.037649376766555984,
      "val_avg_segment_overlap": 0.3473435472572369,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.4801662238008845,
      "val_pk_metric": 0.4509617574123144
    },
    {
      "epoch": 2,
      "train_loss": 0.534101416170597,
      "train_chorus_rate": 0.4229637835174799,
      "train_max_prob": 0.5851600199937821,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5495623797178268,
      "val_macro_f1": 0.6922650032992876,
      "val_verse_f1": 0.8092526690391459,
      "val_chorus_f1": 0.5752773375594294,
      "val_chorus_rate": 0.3212546333670616,
      "val_max_prob": 0.5851878821849823,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007112195685654863,
      "epoch_time": 102.46884512901306,
      "val_boundary_f1": 0.3297769156159069,
      "val_boundary_precision": 0.2800658978583196,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.21253178265373388,
      "val_avg_segment_overlap": 0.5443987484013814,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4083291911473085,
      "val_pk_metric": 0.3120683674324014
    },
    {
      "epoch": 3,
      "train_loss": 0.5193271785974503,
      "train_chorus_rate": 0.44562768526375296,
      "train_max_prob": 0.6444276809692383,
      "train_conf_over_90": 0.0033595616376260297,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5181543827056885,
      "val_macro_f1": 0.6551686826442802,
      "val_verse_f1": 0.7013212042451809,
      "val_chorus_f1": 0.6090161610433796,
      "val_chorus_rate": 0.5669017732143402,
      "val_max_prob": 0.6491328775882721,
      "val_conf_over_90": 0.0021108441869728267,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006724234376513955,
      "epoch_time": 104.67100524902344,
      "val_boundary_f1": 0.21518987341772153,
      "val_boundary_precision": 0.1744868035190616,
      "val_boundary_recall": 0.2806603773584906,
      "val_complete_segments": 0.10858570091072742,
      "val_avg_segment_overlap": 0.527396592352338,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.5010053285641016,
      "val_pk_metric": 0.38525340311839396
    },
    {
      "epoch": 4,
      "train_loss": 0.49513874799013136,
      "train_chorus_rate": 0.4165597654879093,
      "train_max_prob": 0.6622652024030685,
      "train_conf_over_90": 0.002657694258959964,
      "train_conf_over_95": 0.0,
      "val_loss": 0.53013014793396,
      "val_macro_f1": 0.6044277801706224,
      "val_verse_f1": 0.6235652377605997,
      "val_chorus_f1": 0.5852903225806452,
      "val_chorus_rate": 0.6524518132209778,
      "val_max_prob": 0.6824468076229095,
      "val_conf_over_90": 0.01956742419861257,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000620504080445549,
      "epoch_time": 101.14282298088074,
      "val_boundary_f1": 0.1851063829787234,
      "val_boundary_precision": 0.1686046511627907,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.06489093244130359,
      "val_avg_segment_overlap": 0.4628778949235913,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.4778323917940224,
      "val_pk_metric": 0.3817226068963209
    },
    {
      "epoch": 5,
      "train_loss": 0.49442402422428133,
      "train_chorus_rate": 0.43942693173885344,
      "train_max_prob": 0.6626576572656632,
      "train_conf_over_90": 0.007554453355260194,
      "train_conf_over_95": 3.154574078507721e-05,
      "val_loss": 0.5046019330620766,
      "val_macro_f1": 0.7189633512725467,
      "val_verse_f1": 0.7915690866510537,
      "val_chorus_f1": 0.6463576158940397,
      "val_chorus_rate": 0.4432680606842041,
      "val_max_prob": 0.6903010457754135,
      "val_conf_over_90": 0.007884026621468365,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005577306219945596,
      "epoch_time": 89.14318799972534,
      "val_boundary_f1": 0.3432835820895522,
      "val_boundary_precision": 0.2839506172839506,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.20768097858500825,
      "val_avg_segment_overlap": 0.6182017032479007,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.41567006923328553,
      "val_pk_metric": 0.3076166956258281
    },
    {
      "epoch": 6,
      "train_loss": 0.4825917690992355,
      "train_chorus_rate": 0.3510113552212715,
      "train_max_prob": 0.66487637758255,
      "train_conf_over_90": 0.0034742523333989085,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4939747378230095,
      "val_macro_f1": 0.7362698225216546,
      "val_verse_f1": 0.8049873368400545,
      "val_chorus_f1": 0.6675523082032547,
      "val_chorus_rate": 0.440282940864563,
      "val_max_prob": 0.6695072501897812,
      "val_conf_over_90": 0.003879111784044653,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048684656365320894,
      "epoch_time": 96.07387113571167,
      "val_boundary_f1": 0.38939670932358317,
      "val_boundary_precision": 0.31791044776119404,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.2912552834610099,
      "val_avg_segment_overlap": 0.6404420373633788,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4175603567421209,
      "val_pk_metric": 0.30579828324238967
    },
    {
      "epoch": 7,
      "train_loss": 0.4732512101531029,
      "train_chorus_rate": 0.3884336918592453,
      "train_max_prob": 0.6808192491531372,
      "train_conf_over_90": 0.009517611539922654,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4978771135210991,
      "val_macro_f1": 0.7425228872886179,
      "val_verse_f1": 0.8181473044798785,
      "val_chorus_f1": 0.6668984700973574,
      "val_chorus_rate": 0.40735600143671036,
      "val_max_prob": 0.7006795108318329,
      "val_conf_over_90": 0.03500679321587086,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004109498789104639,
      "epoch_time": 102.39956498146057,
      "val_boundary_f1": 0.4051803885291397,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.5165094339622641,
      "val_complete_segments": 0.316532370880197,
      "val_avg_segment_overlap": 0.6588408734906621,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4101822353427931,
      "val_pk_metric": 0.29330883416898057
    },
    {
      "epoch": 8,
      "train_loss": 0.4773305729031563,
      "train_chorus_rate": 0.3608587957918644,
      "train_max_prob": 0.6879484206438065,
      "train_conf_over_90": 0.01718798727961257,
      "train_conf_over_95": 0.00014596180408261717,
      "val_loss": 0.49926167726516724,
      "val_macro_f1": 0.7108794147105775,
      "val_verse_f1": 0.7712312068264934,
      "val_chorus_f1": 0.6505276225946616,
      "val_chorus_rate": 0.49240563064813614,
      "val_max_prob": 0.6947558373212814,
      "val_conf_over_90": 0.005538181867450476,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033335761708228235,
      "epoch_time": 87.09335899353027,
      "val_boundary_f1": 0.35328185328185324,
      "val_boundary_precision": 0.29901960784313725,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.2374253798564509,
      "val_avg_segment_overlap": 0.6243144219854504,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.43159753647214955,
      "val_pk_metric": 0.30871253109942187
    },
    {
      "epoch": 9,
      "train_loss": 0.4811778724193573,
      "train_chorus_rate": 0.39959362894296646,
      "train_max_prob": 0.6759657502174378,
      "train_conf_over_90": 0.005745239119278267,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49453572928905487,
      "val_macro_f1": 0.7345386303126321,
      "val_verse_f1": 0.8010995483997644,
      "val_chorus_f1": 0.6679777122254998,
      "val_chorus_rate": 0.4505610018968582,
      "val_max_prob": 0.7064339816570282,
      "val_conf_over_90": 0.048715852200984955,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025746093233953727,
      "epoch_time": 89.14242315292358,
      "val_boundary_f1": 0.394990366088632,
      "val_boundary_precision": 0.3338762214983713,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.289726679413848,
      "val_avg_segment_overlap": 0.6595081059999502,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.41386296390922045,
      "val_pk_metric": 0.3049536064861479
    },
    {
      "epoch": 10,
      "train_loss": 0.45600840002298354,
      "train_chorus_rate": 0.36452592760324476,
      "train_max_prob": 0.7005985587835312,
      "train_conf_over_90": 0.024266309395898134,
      "train_conf_over_95": 3.0266345129348336e-05,
      "val_loss": 0.502166174352169,
      "val_macro_f1": 0.7263313532991094,
      "val_verse_f1": 0.7970335675253708,
      "val_chorus_f1": 0.6556291390728478,
      "val_chorus_rate": 0.44262300431728363,
      "val_max_prob": 0.7117907851934433,
      "val_conf_over_90": 0.057908848859369755,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001865768739981866,
      "epoch_time": 98.61456799507141,
      "val_boundary_f1": 0.37940896091515725,
      "val_boundary_precision": 0.3184,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.27092666822253253,
      "val_avg_segment_overlap": 0.6458145840179201,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4375366936974178,
      "val_pk_metric": 0.32355212868358907
    },
    {
      "epoch": 11,
      "train_loss": 0.4719103381037712,
      "train_chorus_rate": 0.38864936083555224,
      "train_max_prob": 0.6814894437789917,
      "train_conf_over_90": 0.02004667605506256,
      "train_conf_over_95": 3.486750356387347e-05,
      "val_loss": 0.49833276122808456,
      "val_macro_f1": 0.7673466577650481,
      "val_verse_f1": 0.8591053187742163,
      "val_chorus_f1": 0.67558799675588,
      "val_chorus_rate": 0.30681734532117844,
      "val_max_prob": 0.6989540159702301,
      "val_conf_over_90": 0.007733372913207859,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001238034155471972,
      "epoch_time": 95.46107006072998,
      "val_boundary_f1": 0.4373119358074222,
      "val_boundary_precision": 0.38045375218150085,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.34736192032056296,
      "val_avg_segment_overlap": 0.6619942272968876,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.33897042564359753,
      "val_pk_metric": 0.2375327994921753
    },
    {
      "epoch": 12,
      "train_loss": 0.462321512401104,
      "train_chorus_rate": 0.33454247042536733,
      "train_max_prob": 0.6939226001501083,
      "train_conf_over_90": 0.010694184235762804,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4910550117492676,
      "val_macro_f1": 0.7479203231933772,
      "val_verse_f1": 0.8206594244330092,
      "val_chorus_f1": 0.6751812219537452,
      "val_chorus_rate": 0.41264212876558304,
      "val_max_prob": 0.7022017985582352,
      "val_conf_over_90": 0.01177296950481832,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.188405834135068e-05,
      "epoch_time": 98.31269192695618,
      "val_boundary_f1": 0.42179616548940463,
      "val_boundary_precision": 0.36860670194003525,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2956460835172394,
      "val_avg_segment_overlap": 0.6570333447775589,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3788665187930833,
      "val_pk_metric": 0.2828455575559148
    },
    {
      "epoch": 13,
      "train_loss": 0.4527843505144119,
      "train_chorus_rate": 0.34406042769551276,
      "train_max_prob": 0.6986853331327438,
      "train_conf_over_90": 0.01479747670236975,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48991888761520386,
      "val_macro_f1": 0.758671946078243,
      "val_verse_f1": 0.833583208395802,
      "val_chorus_f1": 0.6837606837606838,
      "val_chorus_rate": 0.390672892332077,
      "val_max_prob": 0.69090735912323,
      "val_conf_over_90": 0.00655741075752303,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.308792742725983e-05,
      "epoch_time": 102.99965214729309,
      "val_boundary_f1": 0.4374384236453202,
      "val_boundary_precision": 0.3756345177664975,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.33067638536885624,
      "val_avg_segment_overlap": 0.6841844837401233,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3630918772402395,
      "val_pk_metric": 0.2711551209796744
    },
    {
      "epoch": 14,
      "train_loss": 0.45761985778808595,
      "train_chorus_rate": 0.3656808972358704,
      "train_max_prob": 0.6977616727352143,
      "train_conf_over_90": 0.01808309922926128,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49022772163152695,
      "val_macro_f1": 0.7410498529971834,
      "val_verse_f1": 0.8075043971076804,
      "val_chorus_f1": 0.6745953088866865,
      "val_chorus_rate": 0.44442063570022583,
      "val_max_prob": 0.7027094662189484,
      "val_conf_over_90": 0.027621654327958822,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.110599890361211e-06,
      "epoch_time": 83.91878294944763,
      "val_boundary_f1": 0.40832507433102083,
      "val_boundary_precision": 0.35213675213675216,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.28671551607659773,
      "val_avg_segment_overlap": 0.6589618845245513,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.38923586303148383,
      "val_pk_metric": 0.29331102832124395
    },
    {
      "epoch": 15,
      "train_loss": 0.45313564538955686,
      "train_chorus_rate": 0.37026653066277504,
      "train_max_prob": 0.703155466914177,
      "train_conf_over_90": 0.023438344476744533,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48828601837158203,
      "val_macro_f1": 0.7602444219121347,
      "val_verse_f1": 0.8363161819537659,
      "val_chorus_f1": 0.6841726618705035,
      "val_chorus_rate": 0.38367925584316254,
      "val_max_prob": 0.6941169053316116,
      "val_conf_over_90": 0.009914181777276099,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 95.69609475135803,
      "val_boundary_f1": 0.4444444444444444,
      "val_boundary_precision": 0.3787375415282392,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.3284229389213483,
      "val_avg_segment_overlap": 0.6864576586888854,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3532566305219423,
      "val_pk_metric": 0.26217092276755943
    }
  ]
}