{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.19240118216521998,
      "layer_dropout": 0.21360835864899277,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.19897449658624206,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2731266,
      "lstm_params": 2203648,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009912659505864248,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015071872898657244,
      "gradient_clip_norm": 0.3273209927462604,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09303328595426087,
        "ece_after": 0.021338917036890268,
        "improvement": 0.0716943689173706,
        "params": {
          "temperature": 0.608456050343231
        }
      },
      "platt": {
        "ece_before": 0.09303328595426087,
        "ece_after": 0.10973885146011772,
        "improvement": -0.016705565505856848,
        "params": {
          "A": 0.9999999713159701,
          "B": -0.0999083609533307
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5764472126960755,
      "train_chorus_rate": 0.422423985300702,
      "train_max_prob": 0.5801256150007248,
      "train_conf_over_90": 0.00010956902988255024,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5983958691358566,
      "val_macro_f1": 0.3358196453919468,
      "val_verse_f1": 0.19913419913419914,
      "val_chorus_f1": 0.47250509164969445,
      "val_chorus_rate": 0.9057602435350418,
      "val_max_prob": 0.6160411834716797,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009804461071204588,
      "epoch_time": 102.74079895019531,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.13238356192848585,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4091074051948197,
      "val_pk_metric": 0.3938680187523469
    },
    {
      "epoch": 2,
      "train_loss": 0.566199517250061,
      "train_chorus_rate": 0.4052607201039791,
      "train_max_prob": 0.577084156870842,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5829578787088394,
      "val_macro_f1": 0.4129088790942198,
      "val_verse_f1": 0.3432711061577041,
      "val_chorus_f1": 0.4825466520307355,
      "val_chorus_rate": 0.8185261636972427,
      "val_max_prob": 0.6017825305461884,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009484594558013927,
      "epoch_time": 78.73152327537537,
      "val_boundary_f1": 0.05474452554744526,
      "val_boundary_precision": 0.12096774193548387,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.02161372287300177,
      "val_avg_segment_overlap": 0.18309465709394593,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43532699184087764,
      "val_pk_metric": 0.4398570732259358
    },
    {
      "epoch": 3,
      "train_loss": 0.5647069156169892,
      "train_chorus_rate": 0.5579617857700214,
      "train_max_prob": 0.5772068172693252,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5756164789199829,
      "val_macro_f1": 0.4570403891295404,
      "val_verse_f1": 0.42663891779396457,
      "val_chorus_f1": 0.4874418604651163,
      "val_chorus_rate": 0.7560405880212784,
      "val_max_prob": 0.5555298775434494,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008967039667808523,
      "epoch_time": 80.17456793785095,
      "val_boundary_f1": 0.04355716878402904,
      "val_boundary_precision": 0.09448818897637795,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.015007247059208884,
      "val_avg_segment_overlap": 0.2049842207924214,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44736776510677845,
      "val_pk_metric": 0.4509359754657697
    },
    {
      "epoch": 4,
      "train_loss": 0.544902266561985,
      "train_chorus_rate": 0.46390507072210313,
      "train_max_prob": 0.5758779138326645,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5970706939697266,
      "val_macro_f1": 0.6059887370694843,
      "val_verse_f1": 0.7983498349834984,
      "val_chorus_f1": 0.4136276391554703,
      "val_chorus_rate": 0.2122383788228035,
      "val_max_prob": 0.6261890381574631,
      "val_conf_over_90": 0.00024630542611703277,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008274416032794253,
      "epoch_time": 70.97185373306274,
      "val_boundary_f1": 0.24751066856330017,
      "val_boundary_precision": 0.3118279569892473,
      "val_boundary_recall": 0.20518867924528303,
      "val_complete_segments": 0.10981614852240515,
      "val_avg_segment_overlap": 0.3549680031408026,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.13131313131313133,
      "val_window_diff": 0.31786154084776,
      "val_pk_metric": 0.29226715900781713
    },
    {
      "epoch": 5,
      "train_loss": 0.5256769359111786,
      "train_chorus_rate": 0.4309866841882467,
      "train_max_prob": 0.6359687328338623,
      "train_conf_over_90": 0.0025048246170626953,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5329074263572693,
      "val_macro_f1": 0.6864004396706983,
      "val_verse_f1": 0.7784317448262768,
      "val_chorus_f1": 0.5943691345151199,
      "val_chorus_rate": 0.4080870822072029,
      "val_max_prob": 0.6390452533960342,
      "val_conf_over_90": 0.00024108003708533943,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007436994629398187,
      "epoch_time": 80.59839010238647,
      "val_boundary_f1": 0.27342256214149135,
      "val_boundary_precision": 0.22990353697749197,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.12211809976921324,
      "val_avg_segment_overlap": 0.5529202510232343,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.45950329954038494,
      "val_pk_metric": 0.354426047317019
    },
    {
      "epoch": 6,
      "train_loss": 0.4968497440218925,
      "train_chorus_rate": 0.3762006491422653,
      "train_max_prob": 0.6565218597650528,
      "train_conf_over_90": 0.006251980006345548,
      "train_conf_over_95": 9.778357343748212e-05,
      "val_loss": 0.5202046632766724,
      "val_macro_f1": 0.6293616808130571,
      "val_verse_f1": 0.6800604882263988,
      "val_chorus_f1": 0.5786628733997156,
      "val_chorus_rate": 0.5648044049739838,
      "val_max_prob": 0.6912639439105988,
      "val_conf_over_90": 0.01279866328695789,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006491374791342461,
      "epoch_time": 83.88670611381531,
      "val_boundary_f1": 0.17255717255717257,
      "val_boundary_precision": 0.15427509293680297,
      "val_boundary_recall": 0.1957547169811321,
      "val_complete_segments": 0.08079877332263334,
      "val_avg_segment_overlap": 0.4851521151254582,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.4960130931081702,
      "val_pk_metric": 0.39505254602491763
    },
    {
      "epoch": 7,
      "train_loss": 0.49889079928398133,
      "train_chorus_rate": 0.39588857591152193,
      "train_max_prob": 0.6758498519659042,
      "train_conf_over_90": 0.008818849333329127,
      "train_conf_over_95": 7.552870083600282e-05,
      "val_loss": 0.50749122351408,
      "val_macro_f1": 0.6790168069608593,
      "val_verse_f1": 0.7483844911147011,
      "val_chorus_f1": 0.6096491228070176,
      "val_chorus_rate": 0.48526594042778015,
      "val_max_prob": 0.6649173945188522,
      "val_conf_over_90": 0.011049710970837623,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005478884643137531,
      "epoch_time": 58.639150857925415,
      "val_boundary_f1": 0.2738669238187078,
      "val_boundary_precision": 0.23164763458401305,
      "val_boundary_recall": 0.33490566037735847,
      "val_complete_segments": 0.1362761034022964,
      "val_avg_segment_overlap": 0.5767420072223864,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4599252386379886,
      "val_pk_metric": 0.338691835490466
    },
    {
      "epoch": 8,
      "train_loss": 0.4758386746048927,
      "train_chorus_rate": 0.3736941270530224,
      "train_max_prob": 0.6879920393228531,
      "train_conf_over_90": 0.02207962866232265,
      "train_conf_over_95": 0.001612916827434674,
      "val_loss": 0.4968385547399521,
      "val_macro_f1": 0.7272389878093458,
      "val_verse_f1": 0.8093620234050585,
      "val_chorus_f1": 0.6451159522136332,
      "val_chorus_rate": 0.3996073380112648,
      "val_max_prob": 0.6913354396820068,
      "val_conf_over_90": 0.013738150824792683,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004443774862726721,
      "epoch_time": 99.77894186973572,
      "val_boundary_f1": 0.36758893280632415,
      "val_boundary_precision": 0.3163265306122449,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.23877922195790702,
      "val_avg_segment_overlap": 0.6384636652809634,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.39996922742709595,
      "val_pk_metric": 0.2775604638583222
    },
    {
      "epoch": 9,
      "train_loss": 0.4706632122397423,
      "train_chorus_rate": 0.3788589537143707,
      "train_max_prob": 0.7059874206781387,
      "train_conf_over_90": 0.022337506056646816,
      "train_conf_over_95": 0.0004029181902296841,
      "val_loss": 0.5024784207344055,
      "val_macro_f1": 0.7475522673478553,
      "val_verse_f1": 0.8386863948033201,
      "val_chorus_f1": 0.6564181398923905,
      "val_chorus_rate": 0.3396667614579201,
      "val_max_prob": 0.6589968502521515,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000343128471452179,
      "epoch_time": 124.16345405578613,
      "val_boundary_f1": 0.37169811320754714,
      "val_boundary_precision": 0.30974842767295596,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.25152761457109285,
      "val_avg_segment_overlap": 0.6542838088970983,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3494324778239217,
      "val_pk_metric": 0.2572261527108879
    },
    {
      "epoch": 10,
      "train_loss": 0.4658456727862358,
      "train_chorus_rate": 0.3544428162276745,
      "train_max_prob": 0.7006901800632477,
      "train_conf_over_90": 0.026017789356410505,
      "train_conf_over_95": 0.0014066213014302775,
      "val_loss": 0.5042320191860199,
      "val_macro_f1": 0.7643321101004695,
      "val_verse_f1": 0.863125108150199,
      "val_chorus_f1": 0.66553911205074,
      "val_chorus_rate": 0.28145185112953186,
      "val_max_prob": 0.7122282236814499,
      "val_conf_over_90": 0.006154061877168715,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002485664876466064,
      "epoch_time": 89.21900296211243,
      "val_boundary_f1": 0.41067761806981523,
      "val_boundary_precision": 0.36363636363636365,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.3014341773223003,
      "val_avg_segment_overlap": 0.6640303429094592,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.28891598958408493,
      "val_pk_metric": 0.22426017894223382
    },
    {
      "epoch": 11,
      "train_loss": 0.4700797453522682,
      "train_chorus_rate": 0.3439178004860878,
      "train_max_prob": 0.6980164527893067,
      "train_conf_over_90": 0.016219162760535255,
      "train_conf_over_95": 0.0007835967262508348,
      "val_loss": 0.48690322041511536,
      "val_macro_f1": 0.7566638671748821,
      "val_verse_f1": 0.8350668647845468,
      "val_chorus_f1": 0.6782608695652174,
      "val_chorus_rate": 0.378488153219223,
      "val_max_prob": 0.7392296940088272,
      "val_conf_over_90": 0.07437380030751228,
      "val_conf_over_95": 0.009641843556892127,
      "learning_rate": 0.0001648243473069998,
      "epoch_time": 109.01871490478516,
      "val_boundary_f1": 0.37258687258687256,
      "val_boundary_precision": 0.315359477124183,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2674238888183745,
      "val_avg_segment_overlap": 0.6687969376327569,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3479520378636522,
      "val_pk_metric": 0.2523319105269118
    },
    {
      "epoch": 12,
      "train_loss": 0.46297316551208495,
      "train_chorus_rate": 0.36533589884638784,
      "train_max_prob": 0.7000257968902588,
      "train_conf_over_90": 0.039213382615707816,
      "train_conf_over_95": 0.00410882449359633,
      "val_loss": 0.4895900636911392,
      "val_macro_f1": 0.7733388212696732,
      "val_verse_f1": 0.8622331980949021,
      "val_chorus_f1": 0.6844444444444444,
      "val_chorus_rate": 0.3085951432585716,
      "val_max_prob": 0.7185624837875366,
      "val_conf_over_90": 0.018281006952747703,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.556198380557265e-05,
      "epoch_time": 109.04150700569153,
      "val_boundary_f1": 0.43286573146292584,
      "val_boundary_precision": 0.37630662020905925,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.32349434156167983,
      "val_avg_segment_overlap": 0.6813260120144172,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.31782301254808687,
      "val_pk_metric": 0.22287582989728674
    },
    {
      "epoch": 13,
      "train_loss": 0.45948158800601957,
      "train_chorus_rate": 0.36050802916288377,
      "train_max_prob": 0.7172711193561554,
      "train_conf_over_90": 0.03759076735004783,
      "train_conf_over_95": 0.002389389876043424,
      "val_loss": 0.48211168497800827,
      "val_macro_f1": 0.7575410946520449,
      "val_verse_f1": 0.838579053929689,
      "val_chorus_f1": 0.6765031353744007,
      "val_chorus_rate": 0.3668486624956131,
      "val_max_prob": 0.7069710791110992,
      "val_conf_over_90": 0.025802540127187967,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.380649478503204e-05,
      "epoch_time": 99.61977291107178,
      "val_boundary_f1": 0.3837784371909001,
      "val_boundary_precision": 0.33049403747870526,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2566170700317042,
      "val_avg_segment_overlap": 0.6630176150533598,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.33638913214451993,
      "val_pk_metric": 0.2368849409092808
    },
    {
      "epoch": 14,
      "train_loss": 0.4546553134918213,
      "train_chorus_rate": 0.3361198350787163,
      "train_max_prob": 0.7074191212654114,
      "train_conf_over_90": 0.029067663406021894,
      "train_conf_over_95": 0.00043553395662456753,
      "val_loss": 0.4829355627298355,
      "val_macro_f1": 0.7483243882940728,
      "val_verse_f1": 0.8307123034227568,
      "val_chorus_f1": 0.6659364731653887,
      "val_chorus_rate": 0.37380240857601166,
      "val_max_prob": 0.7094004601240158,
      "val_conf_over_90": 0.02339013502933085,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1819843465966003e-05,
      "epoch_time": 66.57174825668335,
      "val_boundary_f1": 0.35398230088495575,
      "val_boundary_precision": 0.30354131534569984,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.23409376275229932,
      "val_avg_segment_overlap": 0.6495830183077624,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3457476740340272,
      "val_pk_metric": 0.24257512540152626
    },
    {
      "epoch": 15,
      "train_loss": 0.45420290231704713,
      "train_chorus_rate": 0.3503425374627113,
      "train_max_prob": 0.7110856741666793,
      "train_conf_over_90": 0.029181356285698713,
      "train_conf_over_95": 0.0008411336748395115,
      "val_loss": 0.4836810827255249,
      "val_macro_f1": 0.7626391731261033,
      "val_verse_f1": 0.8457620953073844,
      "val_chorus_f1": 0.6795162509448223,
      "val_chorus_rate": 0.3508286848664284,
      "val_max_prob": 0.7129240036010742,
      "val_conf_over_90": 0.020415519829839468,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 58.99847888946533,
      "val_boundary_f1": 0.39043824701195223,
      "val_boundary_precision": 0.33793103448275863,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2670139045271601,
      "val_avg_segment_overlap": 0.6723364479343396,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3267852737870987,
      "val_pk_metric": 0.22430047191568092
    }
  ]
}