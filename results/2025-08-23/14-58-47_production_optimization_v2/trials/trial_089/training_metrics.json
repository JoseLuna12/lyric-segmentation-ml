{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.20113244705068445,
      "layer_dropout": 0.24028170301402027,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.12715980293368723,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2731266,
      "lstm_params": 2203648,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009965666920914047,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.014398179148700082,
      "gradient_clip_norm": 0.998814046846271,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06720640882117809,
        "ece_after": 0.015644341809693395,
        "improvement": 0.0515620670114847,
        "params": {
          "temperature": 0.6771039434887334
        }
      },
      "platt": {
        "ece_before": 0.06720640882117809,
        "ece_after": 0.021368073559346033,
        "improvement": 0.045838335261832064,
        "params": {
          "A": 1.3928513059002245,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5788161441683769,
      "train_chorus_rate": 0.4885402429383248,
      "train_max_prob": 0.567664909362793,
      "train_conf_over_90": 0.00010956902988255024,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6045341193675995,
      "val_macro_f1": 0.5578989317053961,
      "val_verse_f1": 0.7704809286898839,
      "val_chorus_f1": 0.3453169347209082,
      "val_chorus_rate": 0.2198096290230751,
      "val_max_prob": 0.55473293364048,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009796051358878346,
      "epoch_time": 86.42915105819702,
      "val_boundary_f1": 0.07246376811594203,
      "val_boundary_precision": 0.15625,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.062025051486875454,
      "val_avg_segment_overlap": 0.2357695766687844,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3558696370946171,
      "val_pk_metric": 0.3385569033871015
    },
    {
      "epoch": 2,
      "train_loss": 0.5720023006200791,
      "train_chorus_rate": 0.46050601929891855,
      "train_max_prob": 0.5690766543149948,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5987161099910736,
      "val_macro_f1": 0.3741749648443088,
      "val_verse_f1": 0.2556800969403211,
      "val_chorus_f1": 0.49266983274829645,
      "val_chorus_rate": 0.8894539028406143,
      "val_max_prob": 0.6152869910001755,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009298763693021009,
      "epoch_time": 67.76503491401672,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.02374276829473012,
      "val_avg_segment_overlap": 0.1623313967186325,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4175943495734764,
      "val_pk_metric": 0.41011380144320875
    },
    {
      "epoch": 3,
      "train_loss": 0.5762716561555863,
      "train_chorus_rate": 0.5103130846982822,
      "train_max_prob": 0.5705108314752578,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5892953127622604,
      "val_macro_f1": 0.4220007142990033,
      "val_verse_f1": 0.3605386095081067,
      "val_chorus_f1": 0.4834628190899,
      "val_chorus_rate": 0.8066090643405914,
      "val_max_prob": 0.5489630699157715,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008507693255963483,
      "epoch_time": 67.36960101127625,
      "val_boundary_f1": 0.05714285714285715,
      "val_boundary_precision": 0.11764705882352941,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.02374276829473012,
      "val_avg_segment_overlap": 0.1869800682605369,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4332637856804288,
      "val_pk_metric": 0.4291115808722849
    },
    {
      "epoch": 4,
      "train_loss": 0.5608449041843414,
      "train_chorus_rate": 0.4702511202543974,
      "train_max_prob": 0.5639934331178665,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5855584442615509,
      "val_macro_f1": 0.5253318567952323,
      "val_verse_f1": 0.5640326975476839,
      "val_chorus_f1": 0.48663101604278075,
      "val_chorus_rate": 0.619523823261261,
      "val_max_prob": 0.5664165169000626,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007476750190685536,
      "epoch_time": 62.202807664871216,
      "val_boundary_f1": 0.0600375234521576,
      "val_boundary_precision": 0.14678899082568808,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.061683716362931636,
      "val_avg_segment_overlap": 0.222581994335452,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3154542410793615,
      "val_pk_metric": 0.31330228639980806
    },
    {
      "epoch": 5,
      "train_loss": 0.5479519337415695,
      "train_chorus_rate": 0.5423032373189927,
      "train_max_prob": 0.582463800907135,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5683323889970779,
      "val_macro_f1": 0.506139221134811,
      "val_verse_f1": 0.5057753747849595,
      "val_chorus_f1": 0.5065030674846626,
      "val_chorus_rate": 0.7030443400144577,
      "val_max_prob": 0.6160588711500168,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006276191563371888,
      "epoch_time": 68.71730303764343,
      "val_boundary_f1": 0.09455587392550142,
      "val_boundary_precision": 0.12043795620437957,
      "val_boundary_recall": 0.07783018867924528,
      "val_complete_segments": 0.02709327074385399,
      "val_avg_segment_overlap": 0.26534924925210746,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.06565656565656566,
      "val_window_diff": 0.48073768699653563,
      "val_pk_metric": 0.4249920939205624
    },
    {
      "epoch": 6,
      "train_loss": 0.5195929020643234,
      "train_chorus_rate": 0.4245678953826427,
      "train_max_prob": 0.6291805297136307,
      "train_conf_over_90": 0.004810102391638793,
      "train_conf_over_95": 0.00010799135779961943,
      "val_loss": 0.5392191112041473,
      "val_macro_f1": 0.6475942764226428,
      "val_verse_f1": 0.7092998955067921,
      "val_chorus_f1": 0.5858886573384936,
      "val_chorus_rate": 0.5261809378862381,
      "val_max_prob": 0.6846859306097031,
      "val_conf_over_90": 0.012814227025955915,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004987833460457024,
      "epoch_time": 71.72329688072205,
      "val_boundary_f1": 0.24819027921406409,
      "val_boundary_precision": 0.22099447513812154,
      "val_boundary_recall": 0.2830188679245283,
      "val_complete_segments": 0.11829188111001472,
      "val_avg_segment_overlap": 0.5285675832890743,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.47259374794645026,
      "val_pk_metric": 0.37876723854043304
    },
    {
      "epoch": 7,
      "train_loss": 0.5223195999860764,
      "train_chorus_rate": 0.4365186966955662,
      "train_max_prob": 0.6474862813949585,
      "train_conf_over_90": 0.0026096268440596758,
      "train_conf_over_95": 0.0,
      "val_loss": 0.52925044298172,
      "val_macro_f1": 0.6440656104898195,
      "val_verse_f1": 0.700445198219207,
      "val_chorus_f1": 0.5876860227604319,
      "val_chorus_rate": 0.5425397977232933,
      "val_max_prob": 0.6641577780246735,
      "val_conf_over_90": 0.006266319192945957,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00036994753575421614,
      "epoch_time": 52.32403588294983,
      "val_boundary_f1": 0.21930646672914716,
      "val_boundary_precision": 0.18195956454121306,
      "val_boundary_recall": 0.2759433962264151,
      "val_complete_segments": 0.08768492966531143,
      "val_avg_segment_overlap": 0.5398998103821255,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.5006308082955007,
      "val_pk_metric": 0.3760817833771184
    },
    {
      "epoch": 8,
      "train_loss": 0.4986824721097946,
      "train_chorus_rate": 0.3837973468005657,
      "train_max_prob": 0.667197972536087,
      "train_conf_over_90": 0.00277765117934905,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5167299956083298,
      "val_macro_f1": 0.6774838403368253,
      "val_verse_f1": 0.7442522889114953,
      "val_chorus_f1": 0.6107153917621554,
      "val_chorus_rate": 0.4938426688313484,
      "val_max_prob": 0.6686294227838516,
      "val_conf_over_90": 0.009280805476009846,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00024989167302285134,
      "epoch_time": 83.45200610160828,
      "val_boundary_f1": 0.28873917228103946,
      "val_boundary_precision": 0.24390243902439024,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.15636381533783444,
      "val_avg_segment_overlap": 0.5718250635121773,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.47208110788269797,
      "val_pk_metric": 0.3594959123523734
    },
    {
      "epoch": 9,
      "train_loss": 0.4893833711743355,
      "train_chorus_rate": 0.3967862531542778,
      "train_max_prob": 0.6858727216720581,
      "train_conf_over_90": 0.014932044892339036,
      "train_conf_over_95": 6.551690748892724e-05,
      "val_loss": 0.519911877810955,
      "val_macro_f1": 0.7276906418585579,
      "val_verse_f1": 0.8122188905547226,
      "val_chorus_f1": 0.6431623931623932,
      "val_chorus_rate": 0.3905469924211502,
      "val_max_prob": 0.6467921584844589,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001467973664950565,
      "epoch_time": 99.05338335037231,
      "val_boundary_f1": 0.31718898385565053,
      "val_boundary_precision": 0.2655007949125596,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.19367385299251683,
      "val_avg_segment_overlap": 0.6184078218737805,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.406128358975284,
      "val_pk_metric": 0.3021608399150307
    },
    {
      "epoch": 10,
      "train_loss": 0.48923499435186385,
      "train_chorus_rate": 0.3831664100289345,
      "train_max_prob": 0.672970387339592,
      "train_conf_over_90": 0.008482839143835009,
      "train_conf_over_95": 0.00018370001926086842,
      "val_loss": 0.5094435960054398,
      "val_macro_f1": 0.7290353196932642,
      "val_verse_f1": 0.8103513411409142,
      "val_chorus_f1": 0.6477192982456141,
      "val_chorus_rate": 0.40106409043073654,
      "val_max_prob": 0.6903886795043945,
      "val_conf_over_90": 0.011014737712685019,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.7690322789304e-05,
      "epoch_time": 68.88775205612183,
      "val_boundary_f1": 0.33333333333333337,
      "val_boundary_precision": 0.2774294670846395,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.20589285884885036,
      "val_avg_segment_overlap": 0.6279622444141884,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4076832943840567,
      "val_pk_metric": 0.2929971282770445
    },
    {
      "epoch": 11,
      "train_loss": 0.4898979365825653,
      "train_chorus_rate": 0.3670131050050259,
      "train_max_prob": 0.6762739419937134,
      "train_conf_over_90": 0.009221220365725457,
      "train_conf_over_95": 6.674179749097676e-05,
      "val_loss": 0.5084320977330208,
      "val_macro_f1": 0.7200169922320382,
      "val_verse_f1": 0.7991575722764694,
      "val_chorus_f1": 0.6408764121876069,
      "val_chorus_rate": 0.41826119273900986,
      "val_max_prob": 0.680586963891983,
      "val_conf_over_90": 0.009004751918837428,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.7961556203570143e-05,
      "epoch_time": 81.41320586204529,
      "val_boundary_f1": 0.3207547169811321,
      "val_boundary_precision": 0.2672955974842767,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.18562499402902372,
      "val_avg_segment_overlap": 0.6157287904356956,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.41979246240719664,
      "val_pk_metric": 0.3069163230831481
    },
    {
      "epoch": 12,
      "train_loss": 0.48768646866083143,
      "train_chorus_rate": 0.3986040860414505,
      "train_max_prob": 0.6842654377222062,
      "train_conf_over_90": 0.01642067946959287,
      "train_conf_over_95": 0.0005132813763339073,
      "val_loss": 0.5076335519552231,
      "val_macro_f1": 0.7271778047201684,
      "val_verse_f1": 0.8081802688884681,
      "val_chorus_f1": 0.6461753405518686,
      "val_chorus_rate": 0.4040500149130821,
      "val_max_prob": 0.6839797496795654,
      "val_conf_over_90": 0.009004751918837428,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 86.69790697097778,
      "val_boundary_f1": 0.3422053231939164,
      "val_boundary_precision": 0.28662420382165604,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.20001822000761554,
      "val_avg_segment_overlap": 0.6231335598186816,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4073019893224271,
      "val_pk_metric": 0.296936431063924
    }
  ]
}