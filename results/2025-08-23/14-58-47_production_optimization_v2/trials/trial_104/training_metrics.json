{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.25020405344060376,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.25770157168917035,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000950846139652669,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.018524388202873145,
      "gradient_clip_norm": 0.34138084415693126,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1295925951279217,
        "ece_after": 0.027474377823953323,
        "improvement": 0.10211821730396839,
        "params": {
          "temperature": 0.46915103604969444
        }
      },
      "platt": {
        "ece_before": 0.1295925951279217,
        "ece_after": 0.0687908966438241,
        "improvement": 0.06080169848409761,
        "params": {
          "A": 1.4999997236065443,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5745274424552917,
      "train_chorus_rate": 0.5035129978088662,
      "train_max_prob": 0.5902178764343262,
      "train_conf_over_90": 4.0650405571796e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5652936697006226,
      "val_macro_f1": 0.47483036327982703,
      "val_verse_f1": 0.44374836857217437,
      "val_chorus_f1": 0.5059123579874797,
      "val_chorus_rate": 0.7597918808460236,
      "val_max_prob": 0.581231102347374,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009404679311100972,
      "epoch_time": 93.7647659778595,
      "val_boundary_f1": 0.05993690851735015,
      "val_boundary_precision": 0.09047619047619047,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.01838362942551702,
      "val_avg_segment_overlap": 0.2322273274957847,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.45021481007120134,
      "val_pk_metric": 0.4526117548705925
    },
    {
      "epoch": 2,
      "train_loss": 0.5501589372754097,
      "train_chorus_rate": 0.4307118227239698,
      "train_max_prob": 0.6132613271474838,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.544875755906105,
      "val_macro_f1": 0.5752696479896159,
      "val_verse_f1": 0.5877862595419847,
      "val_chorus_f1": 0.5627530364372471,
      "val_chorus_rate": 0.6715715974569321,
      "val_max_prob": 0.6002823859453201,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000909786882995862,
      "epoch_time": 102.44916081428528,
      "val_boundary_f1": 0.1457663451232583,
      "val_boundary_precision": 0.13359528487229863,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.0713079406478134,
      "val_avg_segment_overlap": 0.38753535301823533,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.14646464646464646,
      "val_window_diff": 0.49509136093271866,
      "val_pk_metric": 0.41030574526452135
    },
    {
      "epoch": 3,
      "train_loss": 0.520078432559967,
      "train_chorus_rate": 0.39261346086859705,
      "train_max_prob": 0.6334983259439468,
      "train_conf_over_90": 0.0016825807222630828,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5289379954338074,
      "val_macro_f1": 0.6235412001617217,
      "val_verse_f1": 0.6553442028985507,
      "val_chorus_f1": 0.5917381974248926,
      "val_chorus_rate": 0.6163443177938461,
      "val_max_prob": 0.6420354545116425,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008601439043365588,
      "epoch_time": 121.32031893730164,
      "val_boundary_f1": 0.202729044834308,
      "val_boundary_precision": 0.17275747508305647,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.07683924835303414,
      "val_avg_segment_overlap": 0.49246974491369655,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.49447855266679147,
      "val_pk_metric": 0.3980156329013631
    },
    {
      "epoch": 4,
      "train_loss": 0.5111097306013107,
      "train_chorus_rate": 0.4063751265406609,
      "train_max_prob": 0.6592074394226074,
      "train_conf_over_90": 0.0014588233141694217,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5133802220225334,
      "val_macro_f1": 0.7300970567347904,
      "val_verse_f1": 0.8077803203661327,
      "val_chorus_f1": 0.6524137931034483,
      "val_chorus_rate": 0.41323087364435196,
      "val_max_prob": 0.6582084447145462,
      "val_conf_over_90": 0.0032107802690006793,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00079370863151304,
      "epoch_time": 96.7011787891388,
      "val_boundary_f1": 0.3598173515981735,
      "val_boundary_precision": 0.293591654247392,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.24698825662505408,
      "val_avg_segment_overlap": 0.6280081682217429,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4419029547507796,
      "val_pk_metric": 0.31755355559906473
    },
    {
      "epoch": 5,
      "train_loss": 0.4920528411865234,
      "train_chorus_rate": 0.4022148162126541,
      "train_max_prob": 0.6628289669752121,
      "train_conf_over_90": 0.011420963177806697,
      "train_conf_over_95": 0.000189231542753987,
      "val_loss": 0.5272580608725548,
      "val_macro_f1": 0.755891202579025,
      "val_verse_f1": 0.854745673833246,
      "val_chorus_f1": 0.657036731324804,
      "val_chorus_rate": 0.2966421991586685,
      "val_max_prob": 0.7031216323375702,
      "val_conf_over_90": 0.011497864034026861,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007133846047395017,
      "epoch_time": 100.2689459323883,
      "val_boundary_f1": 0.42714570858283435,
      "val_boundary_precision": 0.370242214532872,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.30421509981425143,
      "val_avg_segment_overlap": 0.6318709966615554,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.34637422003660184,
      "val_pk_metric": 0.24977811607057956
    },
    {
      "epoch": 6,
      "train_loss": 0.4961211755871773,
      "train_chorus_rate": 0.378421401232481,
      "train_max_prob": 0.6703573822975158,
      "train_conf_over_90": 0.006125088120461442,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5075801908969879,
      "val_macro_f1": 0.6858307540722935,
      "val_verse_f1": 0.735749099385463,
      "val_chorus_f1": 0.6359124087591241,
      "val_chorus_rate": 0.541159600019455,
      "val_max_prob": 0.6358331590890884,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006226823694233917,
      "epoch_time": 91.28570008277893,
      "val_boundary_f1": 0.31550317316409787,
      "val_boundary_precision": 0.25625920471281294,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.19560386018498427,
      "val_avg_segment_overlap": 0.5949647190075765,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.47454220331856284,
      "val_pk_metric": 0.34655114234456313
    },
    {
      "epoch": 7,
      "train_loss": 0.48819019496440885,
      "train_chorus_rate": 0.4086983799934387,
      "train_max_prob": 0.6792501628398895,
      "train_conf_over_90": 0.008387989134644159,
      "train_conf_over_95": 3.660322108771652e-05,
      "val_loss": 0.4987952634692192,
      "val_macro_f1": 0.753220976918691,
      "val_verse_f1": 0.8282485875706215,
      "val_chorus_f1": 0.6781933662667607,
      "val_chorus_rate": 0.3968598172068596,
      "val_max_prob": 0.6922629177570343,
      "val_conf_over_90": 0.012345631374046206,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005255660484856378,
      "epoch_time": 94.46406507492065,
      "val_boundary_f1": 0.3950850661625709,
      "val_boundary_precision": 0.32965299684542587,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.3065560978339345,
      "val_avg_segment_overlap": 0.6616139514960979,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3918456415845815,
      "val_pk_metric": 0.28976923173712194
    },
    {
      "epoch": 8,
      "train_loss": 0.49106491804122926,
      "train_chorus_rate": 0.3691298425197601,
      "train_max_prob": 0.6594168424606324,
      "train_conf_over_90": 0.0031646939227357508,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4960891976952553,
      "val_macro_f1": 0.7593266008276651,
      "val_verse_f1": 0.8381128584643848,
      "val_chorus_f1": 0.6805403431909456,
      "val_chorus_rate": 0.3735159635543823,
      "val_max_prob": 0.6630581468343735,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004262800911670314,
      "epoch_time": 92.25362420082092,
      "val_boundary_f1": 0.40487347703842547,
      "val_boundary_precision": 0.3359253499222395,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.34307953613361886,
      "val_avg_segment_overlap": 0.6775529000746796,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4021481270998019,
      "val_pk_metric": 0.27742565352310583
    },
    {
      "epoch": 9,
      "train_loss": 0.4794077381491661,
      "train_chorus_rate": 0.39737668484449384,
      "train_max_prob": 0.6827592343091965,
      "train_conf_over_90": 0.008479059665114618,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4948870465159416,
      "val_macro_f1": 0.7595207684387504,
      "val_verse_f1": 0.8398379970544918,
      "val_chorus_f1": 0.679203539823009,
      "val_chorus_rate": 0.36712596565485,
      "val_max_prob": 0.6755315661430359,
      "val_conf_over_90": 0.003372100938577205,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032916377022927743,
      "epoch_time": 87.14828300476074,
      "val_boundary_f1": 0.41399416909620995,
      "val_boundary_precision": 0.35206611570247937,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.3108185901399051,
      "val_avg_segment_overlap": 0.6585942155062943,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.39008853078228095,
      "val_pk_metric": 0.2780941250918675
    },
    {
      "epoch": 10,
      "train_loss": 0.47563604861497877,
      "train_chorus_rate": 0.34180713817477226,
      "train_max_prob": 0.6871537238359451,
      "train_conf_over_90": 0.012681262113619595,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4910130202770233,
      "val_macro_f1": 0.7530385807553548,
      "val_verse_f1": 0.8229665071770336,
      "val_chorus_f1": 0.6831106543336759,
      "val_chorus_rate": 0.4178467094898224,
      "val_max_prob": 0.7039288133382797,
      "val_conf_over_90": 0.019842295441776514,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023846153491316737,
      "epoch_time": 99.24295496940613,
      "val_boundary_f1": 0.404692082111437,
      "val_boundary_precision": 0.34557595993322204,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2946804231136151,
      "val_avg_segment_overlap": 0.6590811028459089,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3901945513556206,
      "val_pk_metric": 0.2851703768704031
    },
    {
      "epoch": 11,
      "train_loss": 0.4677416294813156,
      "train_chorus_rate": 0.3436242565512657,
      "train_max_prob": 0.6904939502477646,
      "train_conf_over_90": 0.011952191177988425,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4922894388437271,
      "val_macro_f1": 0.7680208661146666,
      "val_verse_f1": 0.8481197517342095,
      "val_chorus_f1": 0.6879219804951238,
      "val_chorus_rate": 0.3557828292250633,
      "val_max_prob": 0.6873092651367188,
      "val_conf_over_90": 0.03067705314606428,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001581375081396291,
      "epoch_time": 116.50899291038513,
      "val_boundary_f1": 0.4203323558162268,
      "val_boundary_precision": 0.3589315525876461,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.30543947409005734,
      "val_avg_segment_overlap": 0.6783701427339153,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.381830123577856,
      "val_pk_metric": 0.26179572233045156
    },
    {
      "epoch": 12,
      "train_loss": 0.4648753732442856,
      "train_chorus_rate": 0.3760516807436943,
      "train_max_prob": 0.7015355408191681,
      "train_conf_over_90": 0.028856270015239716,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48870207369327545,
      "val_macro_f1": 0.7471051285109598,
      "val_verse_f1": 0.8148004649360713,
      "val_chorus_f1": 0.6794097920858484,
      "val_chorus_rate": 0.4330788552761078,
      "val_max_prob": 0.6985719054937363,
      "val_conf_over_90": 0.025692779570817947,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.170223531611011e-05,
      "epoch_time": 94.53159689903259,
      "val_boundary_f1": 0.4114737883283877,
      "val_boundary_precision": 0.3543441226575809,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.29903503905359685,
      "val_avg_segment_overlap": 0.6595678386446896,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3955143587700014,
      "val_pk_metric": 0.28674032737185534
    },
    {
      "epoch": 13,
      "train_loss": 0.4740596726536751,
      "train_chorus_rate": 0.3570858746767044,
      "train_max_prob": 0.6861744672060013,
      "train_conf_over_90": 0.016323837637901305,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48810210824012756,
      "val_macro_f1": 0.7794783424232459,
      "val_verse_f1": 0.8583830710797613,
      "val_chorus_f1": 0.7005736137667304,
      "val_chorus_rate": 0.34277423471212387,
      "val_max_prob": 0.6783161163330078,
      "val_conf_over_90": 0.0013974167814012617,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.205925665680681e-05,
      "epoch_time": 92.5993299484253,
      "val_boundary_f1": 0.45582329317269077,
      "val_boundary_precision": 0.3968531468531469,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.35472870613379626,
      "val_avg_segment_overlap": 0.6866010328462854,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.3400918053218695,
      "val_pk_metric": 0.2383088029991715
    },
    {
      "epoch": 14,
      "train_loss": 0.4626006484031677,
      "train_chorus_rate": 0.3146372318267822,
      "train_max_prob": 0.6842924863100052,
      "train_conf_over_90": 0.011688629807031248,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48736572265625,
      "val_macro_f1": 0.7518239220225875,
      "val_verse_f1": 0.8231928285332825,
      "val_chorus_f1": 0.6804550155118925,
      "val_chorus_rate": 0.4131370261311531,
      "val_max_prob": 0.6933936476707458,
      "val_conf_over_90": 0.0207581901922822,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1378208542571744e-05,
      "epoch_time": 110.9648699760437,
      "val_boundary_f1": 0.41015625,
      "val_boundary_precision": 0.35,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.31022205548981796,
      "val_avg_segment_overlap": 0.6649471906327967,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3894564051466092,
      "val_pk_metric": 0.27857463984344843
    },
    {
      "epoch": 15,
      "train_loss": 0.45761213898658754,
      "train_chorus_rate": 0.34593589305877687,
      "train_max_prob": 0.692154398560524,
      "train_conf_over_90": 0.01860793710220605,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48685745149850845,
      "val_macro_f1": 0.7710151253236754,
      "val_verse_f1": 0.8465373961218836,
      "val_chorus_f1": 0.6954928545254673,
      "val_chorus_rate": 0.370843842625618,
      "val_max_prob": 0.6976294666528702,
      "val_conf_over_90": 0.01955184224061668,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 110.53124284744263,
      "val_boundary_f1": 0.4426559356136821,
      "val_boundary_precision": 0.38596491228070173,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.3350121159638657,
      "val_avg_segment_overlap": 0.6836704185628685,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.35690586068701563,
      "val_pk_metric": 0.2573583051311752
    }
  ]
}