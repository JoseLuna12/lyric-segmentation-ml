{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.16559430380869009,
      "layer_dropout": 0.25551695198284213,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1373403399356196,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2706690,
      "lstm_params": 2179072,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007082411717628773,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 13,
      "validation_strategy": "composite",
      "weight_decay": 0.013335267761714212,
      "gradient_clip_norm": 0.31784568046959466,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10774970256626487,
        "ece_after": 0.032487932892702874,
        "improvement": 0.07526176967356199,
        "params": {
          "temperature": 0.5707371905413073
        }
      },
      "platt": {
        "ece_before": 0.10774970256626487,
        "ece_after": 0.12125087700681743,
        "improvement": -0.013501174440552557,
        "params": {
          "A": 0.9999990802476918,
          "B": -0.08414299497526424
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5662204056978226,
      "train_chorus_rate": 0.5103959505446255,
      "train_max_prob": 0.568370395898819,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5720479935407639,
      "val_macro_f1": 0.4898045057892156,
      "val_verse_f1": 0.503586800573888,
      "val_chorus_f1": 0.4760222110045431,
      "val_chorus_rate": 0.6732814162969589,
      "val_max_prob": 0.5702347755432129,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007005137135314506,
      "epoch_time": 78.06167697906494,
      "val_boundary_f1": 0.06354515050167224,
      "val_boundary_precision": 0.10919540229885058,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.014320584787180759,
      "val_avg_segment_overlap": 0.2293598772238799,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4505471366716471,
      "val_pk_metric": 0.4570674950760798
    },
    {
      "epoch": 2,
      "train_loss": 0.5491410657763481,
      "train_chorus_rate": 0.4220989075896796,
      "train_max_prob": 0.594605565071106,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5484741628170013,
      "val_macro_f1": 0.6562294411916414,
      "val_verse_f1": 0.7423409269442263,
      "val_chorus_f1": 0.5701179554390564,
      "val_chorus_rate": 0.45107708126306534,
      "val_max_prob": 0.5810976773500443,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006776690658423421,
      "epoch_time": 42.33094596862793,
      "val_boundary_f1": 0.17458279845956354,
      "val_boundary_precision": 0.19154929577464788,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.05656638497306578,
      "val_avg_segment_overlap": 0.4157280137209608,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.15151515151515152,
      "val_window_diff": 0.4123182544474351,
      "val_pk_metric": 0.39462622912039713
    },
    {
      "epoch": 3,
      "train_loss": 0.5293654844164848,
      "train_chorus_rate": 0.46519483625888824,
      "train_max_prob": 0.6154428213834763,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5281464457511902,
      "val_macro_f1": 0.7240191388364648,
      "val_verse_f1": 0.82710531020919,
      "val_chorus_f1": 0.6209329674637397,
      "val_chorus_rate": 0.3279636278748512,
      "val_max_prob": 0.6513711512088776,
      "val_conf_over_90": 0.0018385240982752293,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006407056494203481,
      "epoch_time": 91.83548593521118,
      "val_boundary_f1": 0.30078125,
      "val_boundary_precision": 0.25666666666666665,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.16325626679550326,
      "val_avg_segment_overlap": 0.6004194370331061,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.4235259388362239,
      "val_pk_metric": 0.32723835817224817
    },
    {
      "epoch": 4,
      "train_loss": 0.5022065475583076,
      "train_chorus_rate": 0.3751992240548134,
      "train_max_prob": 0.6614447593688965,
      "train_conf_over_90": 0.0016246784391114489,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5077227056026459,
      "val_macro_f1": 0.7005029296270145,
      "val_verse_f1": 0.7769953051643192,
      "val_chorus_f1": 0.6240105540897098,
      "val_chorus_rate": 0.4457472190260887,
      "val_max_prob": 0.6650531440973282,
      "val_conf_over_90": 0.0027734061586670578,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005912389429332603,
      "epoch_time": 47.12646698951721,
      "val_boundary_f1": 0.29074074074074074,
      "val_boundary_precision": 0.23932926829268292,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.18088917390348994,
      "val_avg_segment_overlap": 0.608118987463089,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.4743016361036031,
      "val_pk_metric": 0.346416712895051
    },
    {
      "epoch": 5,
      "train_loss": 0.4878879517316818,
      "train_chorus_rate": 0.4056285321712494,
      "train_max_prob": 0.6783025205135346,
      "train_conf_over_90": 0.011572997603798285,
      "train_conf_over_95": 0.00037308555911295114,
      "val_loss": 0.5051249414682388,
      "val_macro_f1": 0.7627028731854741,
      "val_verse_f1": 0.8534375555160775,
      "val_chorus_f1": 0.6719681908548708,
      "val_chorus_rate": 0.31866852939128876,
      "val_max_prob": 0.6755760014057159,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005314308788221579,
      "epoch_time": 108.87974810600281,
      "val_boundary_f1": 0.36277302943969614,
      "val_boundary_precision": 0.3036565977742448,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.22612525606958267,
      "val_avg_segment_overlap": 0.6553056364957328,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3937520498565569,
      "val_pk_metric": 0.2754468759636508
    },
    {
      "epoch": 6,
      "train_loss": 0.49488071650266646,
      "train_chorus_rate": 0.37631394490599634,
      "train_max_prob": 0.6728452622890473,
      "train_conf_over_90": 0.0058249617170076816,
      "train_conf_over_95": 6.720430101267994e-05,
      "val_loss": 0.4983498454093933,
      "val_macro_f1": 0.7130961144305967,
      "val_verse_f1": 0.7873585641825984,
      "val_chorus_f1": 0.6388336646785951,
      "val_chorus_rate": 0.4422146826982498,
      "val_max_prob": 0.6711227297782898,
      "val_conf_over_90": 0.013943637488409877,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004638953564796288,
      "epoch_time": 95.01409101486206,
      "val_boundary_f1": 0.31368993653671806,
      "val_boundary_precision": 0.2547864506627393,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.1992007421752915,
      "val_avg_segment_overlap": 0.6295111297283864,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.45875073489776413,
      "val_pk_metric": 0.33956776715614856
    },
    {
      "epoch": 7,
      "train_loss": 0.47491070479154585,
      "train_chorus_rate": 0.3463696017861366,
      "train_max_prob": 0.6876684457063675,
      "train_conf_over_90": 0.02112806177174207,
      "train_conf_over_95": 0.00030065623577684163,
      "val_loss": 0.49979788810014725,
      "val_macro_f1": 0.7577689128118786,
      "val_verse_f1": 0.8557440111907676,
      "val_chorus_f1": 0.6597938144329897,
      "val_chorus_rate": 0.2968122959136963,
      "val_max_prob": 0.689049243927002,
      "val_conf_over_90": 0.00487412785878405,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003915840023034327,
      "epoch_time": 70.66860795021057,
      "val_boundary_f1": 0.3897131552917903,
      "val_boundary_precision": 0.33560477001703576,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.259128036156138,
      "val_avg_segment_overlap": 0.6575696925458018,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.36827986848705385,
      "val_pk_metric": 0.25829877729510275
    },
    {
      "epoch": 8,
      "train_loss": 0.4728312656283379,
      "train_chorus_rate": 0.3587914928793907,
      "train_max_prob": 0.6953703403472901,
      "train_conf_over_90": 0.018223902673344127,
      "train_conf_over_95": 3.010234795510769e-05,
      "val_loss": 0.4877944737672806,
      "val_macro_f1": 0.7320586522260554,
      "val_verse_f1": 0.7989781882491648,
      "val_chorus_f1": 0.665139116202946,
      "val_chorus_rate": 0.45159076899290085,
      "val_max_prob": 0.6851363182067871,
      "val_conf_over_90": 0.016295561799779534,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003176571694594447,
      "epoch_time": 71.06159996986389,
      "val_boundary_f1": 0.3388581952117864,
      "val_boundary_precision": 0.27794561933534745,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.231073011733139,
      "val_avg_segment_overlap": 0.6287859577310512,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.41717075844975354,
      "val_pk_metric": 0.30378467974072587
    },
    {
      "epoch": 9,
      "train_loss": 0.4580604612827301,
      "train_chorus_rate": 0.34454233944416046,
      "train_max_prob": 0.7056614071130752,
      "train_conf_over_90": 0.026471770531497896,
      "train_conf_over_95": 0.0001435204205336049,
      "val_loss": 0.494695819914341,
      "val_macro_f1": 0.7561521121943162,
      "val_verse_f1": 0.8453793599424667,
      "val_chorus_f1": 0.6669248644461658,
      "val_chorus_rate": 0.3354666009545326,
      "val_max_prob": 0.6941277533769608,
      "val_conf_over_90": 0.0021010315394960344,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002453458152832486,
      "epoch_time": 70.19483208656311,
      "val_boundary_f1": 0.3925049309664694,
      "val_boundary_precision": 0.33728813559322035,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2716177319570745,
      "val_avg_segment_overlap": 0.655103532187556,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3640573339274218,
      "val_pk_metric": 0.25510590194030297
    },
    {
      "epoch": 10,
      "train_loss": 0.4694531187415123,
      "train_chorus_rate": 0.350721774995327,
      "train_max_prob": 0.692569962143898,
      "train_conf_over_90": 0.014470946439541877,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49187102913856506,
      "val_macro_f1": 0.7405458701622449,
      "val_verse_f1": 0.8193633452627613,
      "val_chorus_f1": 0.6617283950617285,
      "val_chorus_rate": 0.39775923639535904,
      "val_max_prob": 0.7096421718597412,
      "val_conf_over_90": 0.02582427766174078,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001778102929407194,
      "epoch_time": 47.45665884017944,
      "val_boundary_f1": 0.3625843780135005,
      "val_boundary_precision": 0.3066884176182708,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.2535435697021063,
      "val_avg_segment_overlap": 0.6419263934967883,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.39650784043744663,
      "val_pk_metric": 0.2833573645926149
    },
    {
      "epoch": 11,
      "train_loss": 0.45367497205734253,
      "train_chorus_rate": 0.3442879907786846,
      "train_max_prob": 0.7089242249727249,
      "train_conf_over_90": 0.0321137533755973,
      "train_conf_over_95": 3.328894672449678e-05,
      "val_loss": 0.4861563667654991,
      "val_macro_f1": 0.7642467522710003,
      "val_verse_f1": 0.8499909958580947,
      "val_chorus_f1": 0.6785025086839058,
      "val_chorus_rate": 0.3375123664736748,
      "val_max_prob": 0.6878518909215927,
      "val_conf_over_90": 0.012582433875650167,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011800222882961701,
      "epoch_time": 55.26721787452698,
      "val_boundary_f1": 0.4039408866995074,
      "val_boundary_precision": 0.34686971235194586,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.27912580812898946,
      "val_avg_segment_overlap": 0.6550857997641832,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.36824517077689367,
      "val_pk_metric": 0.25644789248073296
    },
    {
      "epoch": 12,
      "train_loss": 0.45699405372142793,
      "train_chorus_rate": 0.3284441851079464,
      "train_max_prob": 0.7096963793039321,
      "train_conf_over_90": 0.037874116003513335,
      "train_conf_over_95": 0.000818756443914026,
      "val_loss": 0.47880979627370834,
      "val_macro_f1": 0.7605663139662009,
      "val_verse_f1": 0.833301940101714,
      "val_chorus_f1": 0.6878306878306879,
      "val_chorus_rate": 0.39740239828824997,
      "val_max_prob": 0.6923443078994751,
      "val_conf_over_90": 0.027818388771265745,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.853552234252921e-05,
      "epoch_time": 85.03285193443298,
      "val_boundary_f1": 0.37664783427495296,
      "val_boundary_precision": 0.31347962382445144,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2791019242238755,
      "val_avg_segment_overlap": 0.6624813579914688,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3907963036728077,
      "val_pk_metric": 0.266950715730934
    },
    {
      "epoch": 13,
      "train_loss": 0.4586262807250023,
      "train_chorus_rate": 0.32962958365678785,
      "train_max_prob": 0.7002504765987396,
      "train_conf_over_90": 0.025845385435968638,
      "train_conf_over_95": 7.056336326058955e-05,
      "val_loss": 0.48368192464113235,
      "val_macro_f1": 0.7621108735696658,
      "val_verse_f1": 0.840686726970648,
      "val_chorus_f1": 0.6835350201686835,
      "val_chorus_rate": 0.370902381837368,
      "val_max_prob": 0.6998667418956757,
      "val_conf_over_90": 0.02200955874286592,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.1572105920535094e-05,
      "epoch_time": 43.72074794769287,
      "val_boundary_f1": 0.39999999999999997,
      "val_boundary_precision": 0.3410981697171381,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.27751625470342334,
      "val_avg_segment_overlap": 0.6614943940394307,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.37020316278375626,
      "val_pk_metric": 0.2587854924956253
    }
  ]
}