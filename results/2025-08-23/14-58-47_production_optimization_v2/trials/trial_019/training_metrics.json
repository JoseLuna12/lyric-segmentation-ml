{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.18755372573568715,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.29031038711324586,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0004061937504318641,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.013493165968857515,
      "gradient_clip_norm": 0.5537281444218475,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08816875114832037,
        "ece_after": 0.023446415432075634,
        "improvement": 0.06472233571624474,
        "params": {
          "temperature": 0.6201274296161198
        }
      },
      "platt": {
        "ece_before": 0.08816875114832037,
        "ece_after": 0.024702036734999745,
        "improvement": 0.06346671441332064,
        "params": {
          "A": 1.5813809075620742,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5690973103046417,
      "train_chorus_rate": 0.46557791556697337,
      "train_max_prob": 0.5701966881752014,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5693491548299789,
      "val_macro_f1": 0.47734862132752465,
      "val_verse_f1": 0.4604060913705584,
      "val_chorus_f1": 0.49429115128449097,
      "val_chorus_rate": 0.7331969738006592,
      "val_max_prob": 0.5609856694936752,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00040176652262456224,
      "epoch_time": 55.732057094573975,
      "val_boundary_f1": 0.06720000000000001,
      "val_boundary_precision": 0.1044776119402985,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.02555436249762867,
      "val_avg_segment_overlap": 0.22555071816204275,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4458821857561376,
      "val_pk_metric": 0.44171952412317056
    },
    {
      "epoch": 2,
      "train_loss": 0.5451257765293122,
      "train_chorus_rate": 0.40717949271202086,
      "train_max_prob": 0.5902898669242859,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5563624650239944,
      "val_macro_f1": 0.6302738145507709,
      "val_verse_f1": 0.7214342001576045,
      "val_chorus_f1": 0.5391134289439374,
      "val_chorus_rate": 0.4545571208000183,
      "val_max_prob": 0.5753601491451263,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003886783303020316,
      "epoch_time": 50.965747117996216,
      "val_boundary_f1": 0.2053941908713693,
      "val_boundary_precision": 0.18333333333333332,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.10296186013312206,
      "val_avg_segment_overlap": 0.4340741248035278,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.4057633256085032,
      "val_pk_metric": 0.34215963186651477
    },
    {
      "epoch": 3,
      "train_loss": 0.5090957343578338,
      "train_chorus_rate": 0.42171926200389864,
      "train_max_prob": 0.6256914526224137,
      "train_conf_over_90": 0.0023469646141165866,
      "train_conf_over_95": 0.0,
      "val_loss": 0.528887927532196,
      "val_macro_f1": 0.6420001841539497,
      "val_verse_f1": 0.7162904209884076,
      "val_chorus_f1": 0.5677099473194918,
      "val_chorus_rate": 0.4933996647596359,
      "val_max_prob": 0.6626408696174622,
      "val_conf_over_90": 0.01060809614136815,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003675011902728817,
      "epoch_time": 64.67273306846619,
      "val_boundary_f1": 0.224977856510186,
      "val_boundary_precision": 0.18014184397163122,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.10813054191898307,
      "val_avg_segment_overlap": 0.4818965864576198,
      "val_verse_to_chorus_acc": 0.23008849557522124,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.43360340508283784,
      "val_pk_metric": 0.3458656320687926
    },
    {
      "epoch": 4,
      "train_loss": 0.5062346965074539,
      "train_chorus_rate": 0.40502381063997744,
      "train_max_prob": 0.6529912948608398,
      "train_conf_over_90": 0.010511400733958,
      "train_conf_over_95": 0.00042215238499920815,
      "val_loss": 0.5677896589040756,
      "val_macro_f1": 0.6799358180354573,
      "val_verse_f1": 0.8449197860962566,
      "val_chorus_f1": 0.5149518499746579,
      "val_chorus_rate": 0.18543680757284164,
      "val_max_prob": 0.7099030762910843,
      "val_conf_over_90": 0.025271025020629168,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003391606451755786,
      "epoch_time": 62.791098833084106,
      "val_boundary_f1": 0.3211382113821138,
      "val_boundary_precision": 0.28214285714285714,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.19733847997368675,
      "val_avg_segment_overlap": 0.5242365560704161,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.33404326498903997,
      "val_pk_metric": 0.2720975182318901
    },
    {
      "epoch": 5,
      "train_loss": 0.4962314948439598,
      "train_chorus_rate": 0.36321086063981056,
      "train_max_prob": 0.6790887117385864,
      "train_conf_over_90": 0.01854485105141066,
      "train_conf_over_95": 0.0009003088751342147,
      "val_loss": 0.5200592055916786,
      "val_macro_f1": 0.6934559626205682,
      "val_verse_f1": 0.7828897338403041,
      "val_chorus_f1": 0.6040221914008322,
      "val_chorus_rate": 0.4094877541065216,
      "val_max_prob": 0.6710167974233627,
      "val_conf_over_90": 0.016813445603474975,
      "val_conf_over_95": 0.0009545074863126501,
      "learning_rate": 0.0003048953128238981,
      "epoch_time": 51.575629234313965,
      "val_boundary_f1": 0.2720970537261698,
      "val_boundary_precision": 0.21506849315068494,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.14946716713683839,
      "val_avg_segment_overlap": 0.5777560172436664,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.43609578233323265,
      "val_pk_metric": 0.33466875535308216
    },
    {
      "epoch": 6,
      "train_loss": 0.5060534417629242,
      "train_chorus_rate": 0.4653876945376396,
      "train_max_prob": 0.6724419891834259,
      "train_conf_over_90": 0.020409584138542415,
      "train_conf_over_95": 0.0018195575918070971,
      "val_loss": 0.5482340455055237,
      "val_macro_f1": 0.6989380912952219,
      "val_verse_f1": 0.850799869409076,
      "val_chorus_f1": 0.5470763131813677,
      "val_chorus_rate": 0.196965042501688,
      "val_max_prob": 0.6968487650156021,
      "val_conf_over_90": 0.002396710275206715,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002662027526649157,
      "epoch_time": 54.68673300743103,
      "val_boundary_f1": 0.328,
      "val_boundary_precision": 0.2847222222222222,
      "val_boundary_recall": 0.3867924528301887,
      "val_complete_segments": 0.1914578530962412,
      "val_avg_segment_overlap": 0.5525203002875942,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3282828282828283,
      "val_window_diff": 0.33017403190796707,
      "val_pk_metric": 0.27215867515652753
    },
    {
      "epoch": 7,
      "train_loss": 0.47958032339811324,
      "train_chorus_rate": 0.33554832376539706,
      "train_max_prob": 0.6751201242208481,
      "train_conf_over_90": 0.012727255417848938,
      "train_conf_over_95": 0.0003390445664990693,
      "val_loss": 0.5130494460463524,
      "val_macro_f1": 0.7154743597347315,
      "val_verse_f1": 0.8045633065270246,
      "val_chorus_f1": 0.6263854129424383,
      "val_chorus_rate": 0.38773178309202194,
      "val_max_prob": 0.6797486692667007,
      "val_conf_over_90": 0.018711682176217437,
      "val_conf_over_95": 0.0017182561859954149,
      "learning_rate": 0.000224774015245082,
      "epoch_time": 67.39735913276672,
      "val_boundary_f1": 0.3047285464098074,
      "val_boundary_precision": 0.24233983286908078,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.18360777646302567,
      "val_avg_segment_overlap": 0.6030041294014239,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.43983399882070784,
      "val_pk_metric": 0.32999726936042184
    },
    {
      "epoch": 8,
      "train_loss": 0.4713486015796661,
      "train_chorus_rate": 0.3378489129245281,
      "train_max_prob": 0.6782379448413849,
      "train_conf_over_90": 0.01746602962957695,
      "train_conf_over_95": 0.0015595367673086002,
      "val_loss": 0.5075505375862122,
      "val_macro_f1": 0.7412196015857905,
      "val_verse_f1": 0.8368005738880918,
      "val_chorus_f1": 0.6456386292834891,
      "val_chorus_rate": 0.33200014382600784,
      "val_max_prob": 0.7086261212825775,
      "val_conf_over_90": 0.03528865333646536,
      "val_conf_over_95": 0.0034966462990269065,
      "learning_rate": 0.00018241973518678218,
      "epoch_time": 59.06156325340271,
      "val_boundary_f1": 0.3492647058823529,
      "val_boundary_precision": 0.286144578313253,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.21489947946734794,
      "val_avg_segment_overlap": 0.6302009746719414,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.39060914816829284,
      "val_pk_metric": 0.28959632837311916
    },
    {
      "epoch": 9,
      "train_loss": 0.47294130027294157,
      "train_chorus_rate": 0.36521377712488173,
      "train_max_prob": 0.6936996042728424,
      "train_conf_over_90": 0.034919693041592835,
      "train_conf_over_95": 0.004773499205475673,
      "val_loss": 0.4932849705219269,
      "val_macro_f1": 0.7112526873221833,
      "val_verse_f1": 0.7927996936039832,
      "val_chorus_f1": 0.6297056810403834,
      "val_chorus_rate": 0.4187469109892845,
      "val_max_prob": 0.6777758747339249,
      "val_conf_over_90": 0.024284563958644867,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 0.00014099099776694848,
      "epoch_time": 55.54328489303589,
      "val_boundary_f1": 0.32229965156794427,
      "val_boundary_precision": 0.255524861878453,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.1995246079286376,
      "val_avg_segment_overlap": 0.6077525645618682,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4118263246364519,
      "val_pk_metric": 0.30260582325942176
    },
    {
      "epoch": 10,
      "train_loss": 0.47064628452062607,
      "train_chorus_rate": 0.3752802059054375,
      "train_max_prob": 0.6843313604593277,
      "train_conf_over_90": 0.022832649329211564,
      "train_conf_over_95": 0.001414272584952414,
      "val_loss": 0.5032713040709496,
      "val_macro_f1": 0.7461448910243118,
      "val_verse_f1": 0.8486968689872311,
      "val_chorus_f1": 0.6435929130613927,
      "val_chorus_rate": 0.2975482940673828,
      "val_max_prob": 0.7076072990894318,
      "val_conf_over_90": 0.01569603173993528,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010229843760796607,
      "epoch_time": 55.810888051986694,
      "val_boundary_f1": 0.3568075117370892,
      "val_boundary_precision": 0.296411856474259,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.2405101738611813,
      "val_avg_segment_overlap": 0.6354650207600602,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.35198404932449634,
      "val_pk_metric": 0.2682882750318131
    },
    {
      "epoch": 11,
      "train_loss": 0.4589974582195282,
      "train_chorus_rate": 0.32066854611039164,
      "train_max_prob": 0.6970068544149399,
      "train_conf_over_90": 0.02468577604740858,
      "train_conf_over_95": 0.0015886140754446387,
      "val_loss": 0.4969366118311882,
      "val_macro_f1": 0.752950063071355,
      "val_verse_f1": 0.8520855240098143,
      "val_chorus_f1": 0.6538146021328959,
      "val_chorus_rate": 0.3001490607857704,
      "val_max_prob": 0.7046204209327698,
      "val_conf_over_90": 0.019959851168096066,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.803310525628557e-05,
      "epoch_time": 567.1691601276398,
      "val_boundary_f1": 0.3781749764816557,
      "val_boundary_precision": 0.3145539906103286,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2534530326417919,
      "val_avg_segment_overlap": 0.6410364035501882,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3556183383020517,
      "val_pk_metric": 0.2636194190303258
    },
    {
      "epoch": 12,
      "train_loss": 0.4510733813047409,
      "train_chorus_rate": 0.34350217282772066,
      "train_max_prob": 0.7082057893276215,
      "train_conf_over_90": 0.04282530974596739,
      "train_conf_over_95": 0.005790489207720384,
      "val_loss": 0.490507036447525,
      "val_macro_f1": 0.7545047755983857,
      "val_verse_f1": 0.8478918341932041,
      "val_chorus_f1": 0.6611177170035673,
      "val_chorus_rate": 0.3209425359964371,
      "val_max_prob": 0.6947510242462158,
      "val_conf_over_90": 0.02212068857625127,
      "val_conf_over_95": 0.00026624067686498165,
      "learning_rate": 3.969256015898244e-05,
      "epoch_time": 51.315855979919434,
      "val_boundary_f1": 0.3796548592188919,
      "val_boundary_precision": 0.3087149187592319,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.26767509632037734,
      "val_avg_segment_overlap": 0.6514916153385242,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.36508029577011714,
      "val_pk_metric": 0.27175596428815463
    },
    {
      "epoch": 13,
      "train_loss": 0.4591424509882927,
      "train_chorus_rate": 0.37066531777381895,
      "train_max_prob": 0.6974987298250198,
      "train_conf_over_90": 0.03939696284942329,
      "train_conf_over_95": 0.005042207892984152,
      "val_loss": 0.4854109510779381,
      "val_macro_f1": 0.7391736437283671,
      "val_verse_f1": 0.8227636228380137,
      "val_chorus_f1": 0.6555836646187206,
      "val_chorus_rate": 0.3809504508972168,
      "val_max_prob": 0.6942204684019089,
      "val_conf_over_90": 0.04058948904275894,
      "val_conf_over_95": 0.0017682675970718265,
      "learning_rate": 1.8515420129832482e-05,
      "epoch_time": 55.543561935424805,
      "val_boundary_f1": 0.3431111111111111,
      "val_boundary_precision": 0.275320970042796,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.23014254596969336,
      "val_avg_segment_overlap": 0.6317599938415244,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3938338858455533,
      "val_pk_metric": 0.28922129505537336
    },
    {
      "epoch": 14,
      "train_loss": 0.4468867048621178,
      "train_chorus_rate": 0.33582971692085267,
      "train_max_prob": 0.704513418674469,
      "train_conf_over_90": 0.03857315797358751,
      "train_conf_over_95": 0.0038577923929551615,
      "val_loss": 0.48765286803245544,
      "val_macro_f1": 0.7577229214675761,
      "val_verse_f1": 0.848517327617006,
      "val_chorus_f1": 0.6669285153181462,
      "val_chorus_rate": 0.3266013115644455,
      "val_max_prob": 0.7036351710557938,
      "val_conf_over_90": 0.03214352345094085,
      "val_conf_over_95": 0.0012808821047656238,
      "learning_rate": 5.4272278073018945e-06,
      "epoch_time": 57.23487687110901,
      "val_boundary_f1": 0.38086476540938363,
      "val_boundary_precision": 0.31221719457013575,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2590639761106357,
      "val_avg_segment_overlap": 0.651833568174266,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3570076184410545,
      "val_pk_metric": 0.26289039961021315
    },
    {
      "epoch": 15,
      "train_loss": 0.4429110839962959,
      "train_chorus_rate": 0.3279927097260952,
      "train_max_prob": 0.7110533028841018,
      "train_conf_over_90": 0.04111877572722733,
      "train_conf_over_95": 0.006233183684526011,
      "val_loss": 0.48619237542152405,
      "val_macro_f1": 0.7564452680920448,
      "val_verse_f1": 0.8431727634914886,
      "val_chorus_f1": 0.669717772692601,
      "val_chorus_rate": 0.34520843625068665,
      "val_max_prob": 0.7024787962436676,
      "val_conf_over_90": 0.03856051480397582,
      "val_conf_over_95": 0.0020093476050533354,
      "learning_rate": 1e-06,
      "epoch_time": 62.54351592063904,
      "val_boundary_f1": 0.3779385171790235,
      "val_boundary_precision": 0.3064516129032258,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.26013315618299715,
      "val_avg_segment_overlap": 0.6499022932641666,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.36969331496254126,
      "val_pk_metric": 0.2717223629198011
    }
  ]
}