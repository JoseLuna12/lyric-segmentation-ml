{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1935825774557275,
      "layer_dropout": 0.2249401988853642,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18531907083615407,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000998721494025949,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01657368310800925,
      "gradient_clip_norm": 0.380389184864072,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13573051744629216,
        "ece_after": 0.019115179250188796,
        "improvement": 0.11661533819610337,
        "params": {
          "temperature": 0.4733229460952583
        }
      },
      "platt": {
        "ece_before": 0.13573051744629216,
        "ece_after": 0.01984174176318708,
        "improvement": 0.11588877568310509,
        "params": {
          "A": 1.978701061491522,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6128157019615174,
      "train_chorus_rate": 0.5884514443576336,
      "train_max_prob": 0.5878804147243499,
      "train_conf_over_90": 0.027460023760795593,
      "train_conf_over_95": 0.0,
      "val_loss": 0.60548996925354,
      "val_macro_f1": 0.3715271523038655,
      "val_verse_f1": 0.25098754178061383,
      "val_chorus_f1": 0.4920667628271172,
      "val_chorus_rate": 0.891961082816124,
      "val_max_prob": 0.6091153919696808,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009878201898039895,
      "epoch_time": 85.3801851272583,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.02374276829473012,
      "val_avg_segment_overlap": 0.16092512956899047,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4168201174340078,
      "val_pk_metric": 0.4102601009152811
    },
    {
      "epoch": 2,
      "train_loss": 0.575665345788002,
      "train_chorus_rate": 0.5124334264080972,
      "train_max_prob": 0.5727133452892303,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6119430661201477,
      "val_macro_f1": 0.5546083022581367,
      "val_verse_f1": 0.8024613442726412,
      "val_chorus_f1": 0.30675526024363237,
      "val_chorus_rate": 0.1445277165621519,
      "val_max_prob": 0.5833224505186081,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000955592716442872,
      "epoch_time": 73.40542316436768,
      "val_boundary_f1": 0.07763401109057302,
      "val_boundary_precision": 0.1794871794871795,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.03787030288886069,
      "val_avg_segment_overlap": 0.22874527910085848,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.34292595215155075,
      "val_pk_metric": 0.3443445155583
    },
    {
      "epoch": 3,
      "train_loss": 0.5808384358882904,
      "train_chorus_rate": 0.5048852582694963,
      "train_max_prob": 0.5721627593040466,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5881361663341522,
      "val_macro_f1": 0.4691892328977186,
      "val_verse_f1": 0.44507332132750194,
      "val_chorus_f1": 0.4933051444679352,
      "val_chorus_rate": 0.7461936771869659,
      "val_max_prob": 0.5590019971132278,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009034475691730523,
      "epoch_time": 50.63826632499695,
      "val_boundary_f1": 0.05536332179930795,
      "val_boundary_precision": 0.1038961038961039,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.019607082464982783,
      "val_avg_segment_overlap": 0.21099851808303655,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.43870550703373185,
      "val_pk_metric": 0.4392259554643352
    },
    {
      "epoch": 4,
      "train_loss": 0.5611634969711303,
      "train_chorus_rate": 0.4858553010970354,
      "train_max_prob": 0.5831285655498505,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5639868378639221,
      "val_macro_f1": 0.6031564172273189,
      "val_verse_f1": 0.6562703053931125,
      "val_chorus_f1": 0.5500425290615254,
      "val_chorus_rate": 0.5682549029588699,
      "val_max_prob": 0.5829460471868515,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008336637411503992,
      "epoch_time": 58.34213995933533,
      "val_boundary_f1": 0.1558164354322305,
      "val_boundary_precision": 0.14230019493177387,
      "val_boundary_recall": 0.1721698113207547,
      "val_complete_segments": 0.055544972710932415,
      "val_avg_segment_overlap": 0.4105829778283218,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.520214117753355,
      "val_pk_metric": 0.43179779949534225
    },
    {
      "epoch": 5,
      "train_loss": 0.5349227756261825,
      "train_chorus_rate": 0.4606922559440136,
      "train_max_prob": 0.6392522543668747,
      "train_conf_over_90": 0.008651995190302842,
      "train_conf_over_95": 0.00010467550018802285,
      "val_loss": 0.5456830859184265,
      "val_macro_f1": 0.7344098006123131,
      "val_verse_f1": 0.8347888076991623,
      "val_chorus_f1": 0.6340307935254639,
      "val_chorus_rate": 0.32305754721164703,
      "val_max_prob": 0.6231839507818222,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007492911205194618,
      "epoch_time": 57.484599113464355,
      "val_boundary_f1": 0.3862815884476535,
      "val_boundary_precision": 0.3128654970760234,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.2646570237105762,
      "val_avg_segment_overlap": 0.6384950112470321,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.36005004126549106,
      "val_pk_metric": 0.25662354843277724
    },
    {
      "epoch": 6,
      "train_loss": 0.5240748599171638,
      "train_chorus_rate": 0.42933887615799904,
      "train_max_prob": 0.6608032912015915,
      "train_conf_over_90": 0.005429944308707491,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5191177353262901,
      "val_macro_f1": 0.7073345456116441,
      "val_verse_f1": 0.7894131185270425,
      "val_chorus_f1": 0.6252559726962457,
      "val_chorus_rate": 0.4206053987145424,
      "val_max_prob": 0.6641863435506821,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000654017195666565,
      "epoch_time": 81.68832993507385,
      "val_boundary_f1": 0.3125581395348837,
      "val_boundary_precision": 0.25806451612903225,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.18239230747184088,
      "val_avg_segment_overlap": 0.6098824962310178,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.454051290414072,
      "val_pk_metric": 0.3311108696767737
    },
    {
      "epoch": 7,
      "train_loss": 0.49705721586942675,
      "train_chorus_rate": 0.3833576738834381,
      "train_max_prob": 0.6820953279733658,
      "train_conf_over_90": 0.01729312988463789,
      "train_conf_over_95": 0.00025835214473772793,
      "val_loss": 0.5094037130475044,
      "val_macro_f1": 0.7665947931979593,
      "val_verse_f1": 0.8520582419557792,
      "val_chorus_f1": 0.6811313444401396,
      "val_chorus_rate": 0.33484818041324615,
      "val_max_prob": 0.7017104178667068,
      "val_conf_over_90": 0.00456747246789746,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005520058942827945,
      "epoch_time": 1660.4907677173615,
      "val_boundary_f1": 0.36666666666666664,
      "val_boundary_precision": 0.3018292682926829,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.24465717042599333,
      "val_avg_segment_overlap": 0.6744388400952809,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.37178820006301766,
      "val_pk_metric": 0.258840233078803
    },
    {
      "epoch": 8,
      "train_loss": 0.4865130990743637,
      "train_chorus_rate": 0.34793223440647125,
      "train_max_prob": 0.6857364058494568,
      "train_conf_over_90": 0.013933295919559895,
      "train_conf_over_95": 0.0001239599077962339,
      "val_loss": 0.5017784982919693,
      "val_macro_f1": 0.7423196860401532,
      "val_verse_f1": 0.8247115742463714,
      "val_chorus_f1": 0.659927797833935,
      "val_chorus_rate": 0.3811348080635071,
      "val_max_prob": 0.7156048715114594,
      "val_conf_over_90": 0.02131941739935428,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0004477155997431548,
      "epoch_time": 74.3473379611969,
      "val_boundary_f1": 0.33659491193737767,
      "val_boundary_precision": 0.28762541806020064,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.2261840104761632,
      "val_avg_segment_overlap": 0.6298193454264263,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.3599386675435304,
      "val_pk_metric": 0.26996065146337667
    },
    {
      "epoch": 9,
      "train_loss": 0.47593015879392625,
      "train_chorus_rate": 0.329591516405344,
      "train_max_prob": 0.7052963256835938,
      "train_conf_over_90": 0.02054743471671827,
      "train_conf_over_95": 0.0004598634521244094,
      "val_loss": 0.5035183653235435,
      "val_macro_f1": 0.7162581085659268,
      "val_verse_f1": 0.7924893534649632,
      "val_chorus_f1": 0.6400268636668904,
      "val_chorus_rate": 0.43239744007587433,
      "val_max_prob": 0.6910571306943893,
      "val_conf_over_90": 0.0163431738037616,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003457042983593842,
      "epoch_time": 134.45693492889404,
      "val_boundary_f1": 0.2833935018050541,
      "val_boundary_precision": 0.22953216374269006,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.16241202192951928,
      "val_avg_segment_overlap": 0.6114592391825169,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4676715968366256,
      "val_pk_metric": 0.3335965679023782
    },
    {
      "epoch": 10,
      "train_loss": 0.47054253071546553,
      "train_chorus_rate": 0.34538252726197244,
      "train_max_prob": 0.709601491689682,
      "train_conf_over_90": 0.025568168866448103,
      "train_conf_over_95": 0.0011526856280397624,
      "val_loss": 0.4985857680439949,
      "val_macro_f1": 0.740206920239727,
      "val_verse_f1": 0.8216155572176516,
      "val_chorus_f1": 0.6587982832618026,
      "val_chorus_rate": 0.3874037340283394,
      "val_max_prob": 0.6821019500494003,
      "val_conf_over_90": 0.010774277907330543,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002504303735064874,
      "epoch_time": 105.59966897964478,
      "val_boundary_f1": 0.33303491495076104,
      "val_boundary_precision": 0.2683982683982684,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.21835249504920767,
      "val_avg_segment_overlap": 0.646941797949414,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4386605599629987,
      "val_pk_metric": 0.29831496849761946
    },
    {
      "epoch": 11,
      "train_loss": 0.47675002068281175,
      "train_chorus_rate": 0.3461229711771011,
      "train_max_prob": 0.6963287383317948,
      "train_conf_over_90": 0.017472654313314705,
      "train_conf_over_95": 0.0004053326149005443,
      "val_loss": 0.5252173840999603,
      "val_macro_f1": 0.7697363367105678,
      "val_verse_f1": 0.8749157113958194,
      "val_chorus_f1": 0.6645569620253164,
      "val_chorus_rate": 0.24403275176882744,
      "val_max_prob": 0.6819547116756439,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016605775287555007,
      "epoch_time": 109.29347801208496,
      "val_boundary_f1": 0.42598509052183176,
      "val_boundary_precision": 0.3883495145631068,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.2727679467075013,
      "val_avg_segment_overlap": 0.651977120454575,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.29222841122101495,
      "val_pk_metric": 0.21901861660656166
    },
    {
      "epoch": 12,
      "train_loss": 0.47337287813425066,
      "train_chorus_rate": 0.3280309274792671,
      "train_max_prob": 0.70786252617836,
      "train_conf_over_90": 0.025719158380525187,
      "train_conf_over_95": 0.0011492993915453553,
      "val_loss": 0.4956444278359413,
      "val_macro_f1": 0.7521049321149487,
      "val_verse_f1": 0.8355686202461877,
      "val_chorus_f1": 0.6686412439837097,
      "val_chorus_rate": 0.3643015995621681,
      "val_max_prob": 0.7091471999883652,
      "val_conf_over_90": 0.02297149715013802,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 9.627392485289688e-05,
      "epoch_time": 97.17474293708801,
      "val_boundary_f1": 0.35634328358208955,
      "val_boundary_precision": 0.29475308641975306,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.24496273087206283,
      "val_avg_segment_overlap": 0.6598248101879072,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.3959259383614109,
      "val_pk_metric": 0.28414073100977894
    },
    {
      "epoch": 13,
      "train_loss": 0.4659241706132889,
      "train_chorus_rate": 0.33130267187952994,
      "train_max_prob": 0.704491376876831,
      "train_conf_over_90": 0.022742908028885723,
      "train_conf_over_95": 0.0008354798017535358,
      "val_loss": 0.4942217469215393,
      "val_macro_f1": 0.74208293829699,
      "val_verse_f1": 0.8217636022514071,
      "val_chorus_f1": 0.6624022743425728,
      "val_chorus_rate": 0.39184781163930893,
      "val_max_prob": 0.716534435749054,
      "val_conf_over_90": 0.03493125829845667,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 4.412877758307692e-05,
      "epoch_time": 98.18508386611938,
      "val_boundary_f1": 0.34726090993500464,
      "val_boundary_precision": 0.28637059724349156,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2399916884010203,
      "val_avg_segment_overlap": 0.648739233379561,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.40941892499049687,
      "val_pk_metric": 0.2909531104471559
    },
    {
      "epoch": 14,
      "train_loss": 0.4565772548317909,
      "train_chorus_rate": 0.33049256503582003,
      "train_max_prob": 0.7258946359157562,
      "train_conf_over_90": 0.03761050924658775,
      "train_conf_over_95": 0.0012821187148801983,
      "val_loss": 0.49449407309293747,
      "val_macro_f1": 0.7629938079388427,
      "val_verse_f1": 0.8483206933911159,
      "val_chorus_f1": 0.6776669224865695,
      "val_chorus_rate": 0.3408045545220375,
      "val_max_prob": 0.7131766080856323,
      "val_conf_over_90": 0.020408767042681575,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1.1901304221959473e-05,
      "epoch_time": 103.23839282989502,
      "val_boundary_f1": 0.3815028901734104,
      "val_boundary_precision": 0.32247557003257327,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.264081779855905,
      "val_avg_segment_overlap": 0.6737314412483628,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.34519766874292324,
      "val_pk_metric": 0.2546979502589436
    },
    {
      "epoch": 15,
      "train_loss": 0.4640957787632942,
      "train_chorus_rate": 0.3392146334052086,
      "train_max_prob": 0.715985831618309,
      "train_conf_over_90": 0.030211078887805342,
      "train_conf_over_95": 0.000700918902293779,
      "val_loss": 0.4945865571498871,
      "val_macro_f1": 0.7612200551432353,
      "val_verse_f1": 0.8465991316931983,
      "val_chorus_f1": 0.6758409785932722,
      "val_chorus_rate": 0.34328655153512955,
      "val_max_prob": 0.7084164768457413,
      "val_conf_over_90": 0.019438911462202668,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 102.49557685852051,
      "val_boundary_f1": 0.37428023032629565,
      "val_boundary_precision": 0.3155339805825243,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2549491716379309,
      "val_avg_segment_overlap": 0.6700597905498253,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.34854689747048523,
      "val_pk_metric": 0.25812494889810256
    }
  ]
}