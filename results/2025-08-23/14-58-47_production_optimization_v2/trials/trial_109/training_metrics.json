{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.27317445571097543,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.2595771380461574,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000951636484328313,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "composite",
      "weight_decay": 0.02124686386245611,
      "gradient_clip_norm": 0.3736744151177367,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14662353290438887,
        "ece_after": 0.038141132089033095,
        "improvement": 0.10848240081535578,
        "params": {
          "temperature": 0.4210655893485809
        }
      },
      "platt": {
        "ece_before": 0.14662353290438887,
        "ece_after": 0.0532095416911927,
        "improvement": 0.09341399121319617,
        "params": {
          "A": 1.956040248694071,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.558937506377697,
      "train_chorus_rate": 0.5202889220265206,
      "train_max_prob": 0.5859528124332428,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.57304747402668,
      "val_macro_f1": 0.5801282044914287,
      "val_verse_f1": 0.7056154282473057,
      "val_chorus_f1": 0.45464098073555165,
      "val_chorus_rate": 0.4017830416560173,
      "val_max_prob": 0.5481379926204681,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009354404079768367,
      "epoch_time": 118.24151015281677,
      "val_boundary_f1": 0.17534942820838625,
      "val_boundary_precision": 0.19008264462809918,
      "val_boundary_recall": 0.16273584905660377,
      "val_complete_segments": 0.04609890529826903,
      "val_avg_segment_overlap": 0.31203547817274513,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.1414141414141414,
      "val_window_diff": 0.4485004364992333,
      "val_pk_metric": 0.4389654549712253
    },
    {
      "epoch": 2,
      "train_loss": 0.5479749277234077,
      "train_chorus_rate": 0.42172639491036534,
      "train_max_prob": 0.5865015298128128,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5799930095672607,
      "val_macro_f1": 0.5938056346878096,
      "val_verse_f1": 0.8056810845706909,
      "val_chorus_f1": 0.3819301848049282,
      "val_chorus_rate": 0.1797010451555252,
      "val_max_prob": 0.5947082191705704,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008879559147604798,
      "epoch_time": 109.04733419418335,
      "val_boundary_f1": 0.24078624078624078,
      "val_boundary_precision": 0.2512820512820513,
      "val_boundary_recall": 0.23113207547169812,
      "val_complete_segments": 0.10476946231188013,
      "val_avg_segment_overlap": 0.35502696291860614,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.4082969488392228,
      "val_pk_metric": 0.3496389167768136
    },
    {
      "epoch": 3,
      "train_loss": 0.5252730891108512,
      "train_chorus_rate": 0.46687607914209367,
      "train_max_prob": 0.6106120347976685,
      "train_conf_over_90": 0.0014259914925787598,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5324489921331406,
      "val_macro_f1": 0.6712970422541762,
      "val_verse_f1": 0.7472571314582087,
      "val_chorus_f1": 0.5953369530501437,
      "val_chorus_rate": 0.4703705310821533,
      "val_max_prob": 0.6378087550401688,
      "val_conf_over_90": 0.00047234738303814083,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000812418994420101,
      "epoch_time": 99.10925507545471,
      "val_boundary_f1": 0.25383304940374785,
      "val_boundary_precision": 0.19866666666666666,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.12938535793784997,
      "val_avg_segment_overlap": 0.5469025517950405,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4760313314204181,
      "val_pk_metric": 0.3586876016544408
    },
    {
      "epoch": 4,
      "train_loss": 0.5099112659692764,
      "train_chorus_rate": 0.4605947583913803,
      "train_max_prob": 0.6378846406936646,
      "train_conf_over_90": 0.0026373661356046798,
      "train_conf_over_95": 3.4083164064213636e-05,
      "val_loss": 0.5484424531459808,
      "val_macro_f1": 0.7209804115955889,
      "val_verse_f1": 0.8369188063844551,
      "val_chorus_f1": 0.6050420168067226,
      "val_chorus_rate": 0.2860375642776489,
      "val_max_prob": 0.6839085519313812,
      "val_conf_over_90": 0.0011759620974771678,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007139773632462347,
      "epoch_time": 100.81001305580139,
      "val_boundary_f1": 0.35762876579203107,
      "val_boundary_precision": 0.30413223140495865,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.2258701418431005,
      "val_avg_segment_overlap": 0.5877090848170368,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.3757966077742712,
      "val_pk_metric": 0.28036917539928163
    },
    {
      "epoch": 5,
      "train_loss": 0.49611523002386093,
      "train_chorus_rate": 0.4204570442438126,
      "train_max_prob": 0.6582790344953537,
      "train_conf_over_90": 0.010598871926777064,
      "train_conf_over_95": 0.0002047860063612461,
      "val_loss": 0.5292206183075905,
      "val_macro_f1": 0.7398865081124298,
      "val_verse_f1": 0.8503964150293003,
      "val_chorus_f1": 0.6293766011955594,
      "val_chorus_rate": 0.27659663930535316,
      "val_max_prob": 0.6571629494428635,
      "val_conf_over_90": 0.0037432616227306426,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005993396557208922,
      "epoch_time": 90.5572259426117,
      "val_boundary_f1": 0.3727530747398297,
      "val_boundary_precision": 0.31121642969984203,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2450479452335232,
      "val_avg_segment_overlap": 0.6262857396160163,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3889906410246851,
      "val_pk_metric": 0.2784545671596701
    },
    {
      "epoch": 6,
      "train_loss": 0.4917293682694435,
      "train_chorus_rate": 0.35294456630945203,
      "train_max_prob": 0.6556395411491394,
      "train_conf_over_90": 0.005778507827199064,
      "train_conf_over_95": 6.164413352962583e-05,
      "val_loss": 0.5215789899230003,
      "val_macro_f1": 0.7293149685859499,
      "val_verse_f1": 0.8194546794399411,
      "val_chorus_f1": 0.6391752577319587,
      "val_chorus_rate": 0.36825986951589584,
      "val_max_prob": 0.7013356685638428,
      "val_conf_over_90": 0.02577770734205842,
      "val_conf_over_95": 0.0016832828405313194,
      "learning_rate": 0.0004763182421641565,
      "epoch_time": 106.64871287345886,
      "val_boundary_f1": 0.3675464320625611,
      "val_boundary_precision": 0.31385642737896496,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.2532854529275526,
      "val_avg_segment_overlap": 0.6205303886010622,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.38290694210878107,
      "val_pk_metric": 0.2788771712430732
    },
    {
      "epoch": 7,
      "train_loss": 0.4922496870160103,
      "train_chorus_rate": 0.37875996232032777,
      "train_max_prob": 0.6776662796735764,
      "train_conf_over_90": 0.017328943515894934,
      "train_conf_over_95": 0.00024811999755911527,
      "val_loss": 0.5205823332071304,
      "val_macro_f1": 0.7429080938440605,
      "val_verse_f1": 0.8449367088607596,
      "val_chorus_f1": 0.6408794788273615,
      "val_chorus_rate": 0.304910771548748,
      "val_max_prob": 0.6706244051456451,
      "val_conf_over_90": 0.003477020945865661,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00035329682860742086,
      "epoch_time": 102.01005101203918,
      "val_boundary_f1": 0.38257575757575757,
      "val_boundary_precision": 0.31962025316455694,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2665840283549722,
      "val_avg_segment_overlap": 0.6324349099420032,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.39860611718283634,
      "val_pk_metric": 0.2762772092259006
    },
    {
      "epoch": 8,
      "train_loss": 0.47748417854309083,
      "train_chorus_rate": 0.3731296621263027,
      "train_max_prob": 0.6644575774669648,
      "train_conf_over_90": 0.005596914852503687,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5055331513285637,
      "val_macro_f1": 0.749923404418836,
      "val_verse_f1": 0.8369466205137548,
      "val_chorus_f1": 0.6629001883239172,
      "val_chorus_rate": 0.3534432575106621,
      "val_max_prob": 0.6467479169368744,
      "val_conf_over_90": 0.0007385880599031225,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023865912108207834,
      "epoch_time": 111.66121006011963,
      "val_boundary_f1": 0.3869767441860465,
      "val_boundary_precision": 0.3195084485407066,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.26623071715860686,
      "val_avg_segment_overlap": 0.6547644635129521,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.40902073126338767,
      "val_pk_metric": 0.28470262630176857
    },
    {
      "epoch": 9,
      "train_loss": 0.4895060479640961,
      "train_chorus_rate": 0.36460800692439077,
      "train_max_prob": 0.6664836972951889,
      "train_conf_over_90": 0.010315875874948689,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5112323313951492,
      "val_macro_f1": 0.7522533994836114,
      "val_verse_f1": 0.8474095102909865,
      "val_chorus_f1": 0.6570972886762361,
      "val_chorus_rate": 0.317225381731987,
      "val_max_prob": 0.6423138827085495,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014021748990821191,
      "epoch_time": 94.24096012115479,
      "val_boundary_f1": 0.40674789128397376,
      "val_boundary_precision": 0.33748055987558323,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3055489817950051,
      "val_avg_segment_overlap": 0.6637928698312019,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3782630647937298,
      "val_pk_metric": 0.2685008478506963
    },
    {
      "epoch": 10,
      "train_loss": 0.4793954610824585,
      "train_chorus_rate": 0.34184708148241044,
      "train_max_prob": 0.6685742169618607,
      "train_conf_over_90": 0.009373081164085306,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5024457201361656,
      "val_macro_f1": 0.7441682562660381,
      "val_verse_f1": 0.8205031208624929,
      "val_chorus_f1": 0.6678333916695834,
      "val_chorus_rate": 0.4028555229306221,
      "val_max_prob": 0.6970280706882477,
      "val_conf_over_90": 0.019842004170641303,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.468056956783324e-05,
      "epoch_time": 91.0592360496521,
      "val_boundary_f1": 0.39413382218148485,
      "val_boundary_precision": 0.32233883058470764,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.3049415458482267,
      "val_avg_segment_overlap": 0.6564386297962774,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.41284456308386575,
      "val_pk_metric": 0.28767088371300276
    },
    {
      "epoch": 11,
      "train_loss": 0.47386376559734344,
      "train_chorus_rate": 0.33616695180535316,
      "train_max_prob": 0.6786184906959534,
      "train_conf_over_90": 0.00805963330785744,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5009232312440872,
      "val_macro_f1": 0.7536615640959929,
      "val_verse_f1": 0.8352702453421879,
      "val_chorus_f1": 0.672052882849798,
      "val_chorus_rate": 0.36985648423433304,
      "val_max_prob": 0.6722443401813507,
      "val_conf_over_90": 0.0024820048711262643,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.7196076351476217e-05,
      "epoch_time": 105.54626893997192,
      "val_boundary_f1": 0.4071294559099437,
      "val_boundary_precision": 0.338006230529595,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.29546760250630877,
      "val_avg_segment_overlap": 0.6618497242615162,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.39374062543575417,
      "val_pk_metric": 0.26742976397428125
    },
    {
      "epoch": 12,
      "train_loss": 0.4794315665960312,
      "train_chorus_rate": 0.3806469224393368,
      "train_max_prob": 0.6755740821361542,
      "train_conf_over_90": 0.0042134983377764,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49963491410017014,
      "val_macro_f1": 0.7327341230177908,
      "val_verse_f1": 0.8057859209257473,
      "val_chorus_f1": 0.6596823251098344,
      "val_chorus_rate": 0.4279315546154976,
      "val_max_prob": 0.6779429465532303,
      "val_conf_over_90": 0.005476555845234543,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 97.2080090045929,
      "val_boundary_f1": 0.3658088235294118,
      "val_boundary_precision": 0.2996987951807229,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2814568943280502,
      "val_avg_segment_overlap": 0.6431246729559126,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.41948745766323564,
      "val_pk_metric": 0.29486172928621923
    }
  ]
}