{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.2775658491581152,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 514562,
      "lstm_params": 514048,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00048664473839295176,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01237361891315188,
      "gradient_clip_norm": 0.7565424108567761,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09447701639826968,
        "ece_after": 0.041164087288974534,
        "improvement": 0.053312929109295144,
        "params": {
          "temperature": 0.6018249869995683
        }
      },
      "platt": {
        "ece_before": 0.09447701639826968,
        "ece_after": 0.04549543372188898,
        "improvement": 0.0489815826763807,
        "params": {
          "A": 1.4999999413409135,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5355882674455643,
      "train_chorus_rate": 0.23253123280592264,
      "train_max_prob": 0.5423814594745636,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5572348535060883,
      "val_macro_f1": 0.538647938143844,
      "val_verse_f1": 0.6312129269789324,
      "val_chorus_f1": 0.44608294930875575,
      "val_chorus_rate": 0.5001051723957062,
      "val_max_prob": 0.5332990884780884,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004813384870305071,
      "epoch_time": 220.25289702415466,
      "val_boundary_f1": 0.10455311973018548,
      "val_boundary_precision": 0.1834319526627219,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.020216104985458113,
      "val_avg_segment_overlap": 0.22693604099229986,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4427050638706738,
      "val_pk_metric": 0.45915914512742195
    },
    {
      "epoch": 2,
      "train_loss": 0.5299237370491028,
      "train_chorus_rate": 0.29769753813743594,
      "train_max_prob": 0.5465595990419387,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.557570293545723,
      "val_macro_f1": 0.5711164333621443,
      "val_verse_f1": 0.7632293080054274,
      "val_chorus_f1": 0.37900355871886127,
      "val_chorus_rate": 0.25253524258732796,
      "val_max_prob": 0.5559831857681274,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000465651641589931,
      "epoch_time": 149.64271593093872,
      "val_boundary_f1": 0.17991004497751126,
      "val_boundary_precision": 0.24691358024691357,
      "val_boundary_recall": 0.14150943396226415,
      "val_complete_segments": 0.04741489141011941,
      "val_avg_segment_overlap": 0.29149316823976223,
      "val_verse_to_chorus_acc": 0.12831858407079647,
      "val_chorus_to_verse_acc": 0.12626262626262627,
      "val_window_diff": 0.383833287697453,
      "val_pk_metric": 0.37664596132326705
    },
    {
      "epoch": 3,
      "train_loss": 0.5091874659061432,
      "train_chorus_rate": 0.3326459489762783,
      "train_max_prob": 0.5784652203321456,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5471000373363495,
      "val_macro_f1": 0.5526118203694381,
      "val_verse_f1": 0.6287513116474291,
      "val_chorus_f1": 0.4764723290914471,
      "val_chorus_rate": 0.5308083742856979,
      "val_max_prob": 0.5654493272304535,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044026979249081263,
      "epoch_time": 145.12312602996826,
      "val_boundary_f1": 0.17974322396576317,
      "val_boundary_precision": 0.22743682310469315,
      "val_boundary_recall": 0.14858490566037735,
      "val_complete_segments": 0.05718898719959165,
      "val_avg_segment_overlap": 0.28287521419835,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.41462833488285433,
      "val_pk_metric": 0.41661885637835283
    },
    {
      "epoch": 4,
      "train_loss": 0.5148436248302459,
      "train_chorus_rate": 0.4031775176525116,
      "train_max_prob": 0.5894118428230286,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5355340093374252,
      "val_macro_f1": 0.5159045017796386,
      "val_verse_f1": 0.5037783375314862,
      "val_chorus_f1": 0.5280306660277911,
      "val_chorus_rate": 0.7261317372322083,
      "val_max_prob": 0.5784047991037369,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004063022483344083,
      "epoch_time": 142.97167420387268,
      "val_boundary_f1": 0.11830985915492957,
      "val_boundary_precision": 0.14685314685314685,
      "val_boundary_recall": 0.09905660377358491,
      "val_complete_segments": 0.04100146578937671,
      "val_avg_segment_overlap": 0.26660941125414483,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.45303218229062725,
      "val_pk_metric": 0.42423028634903254
    },
    {
      "epoch": 5,
      "train_loss": 0.49223091155290605,
      "train_chorus_rate": 0.3968499042093754,
      "train_max_prob": 0.6060777008533478,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5236276090145111,
      "val_macro_f1": 0.6756330148106511,
      "val_verse_f1": 0.7852422907488987,
      "val_chorus_f1": 0.5660237388724035,
      "val_chorus_rate": 0.3638342544436455,
      "val_max_prob": 0.5960057526826859,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003652335537947138,
      "epoch_time": 151.35842299461365,
      "val_boundary_f1": 0.37590861889927313,
      "val_boundary_precision": 0.3358070500927644,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.185946437271994,
      "val_avg_segment_overlap": 0.5354261826371979,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.3886363284150287,
      "val_pk_metric": 0.33342874116119753
    },
    {
      "epoch": 6,
      "train_loss": 0.4793636992573738,
      "train_chorus_rate": 0.34004578813910485,
      "train_max_prob": 0.6262775987386704,
      "train_conf_over_90": 0.00078396811732091,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5153647810220718,
      "val_macro_f1": 0.7043461377008473,
      "val_verse_f1": 0.8058500914076783,
      "val_chorus_f1": 0.6028421839940165,
      "val_chorus_rate": 0.3584103137254715,
      "val_max_prob": 0.6003572940826416,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003188586078925747,
      "epoch_time": 143.60804390907288,
      "val_boundary_f1": 0.35624394966118106,
      "val_boundary_precision": 0.3021346469622332,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.22364057930070652,
      "val_avg_segment_overlap": 0.5713434371173964,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.40972126858562175,
      "val_pk_metric": 0.31709625965924637
    },
    {
      "epoch": 7,
      "train_loss": 0.4750216960906982,
      "train_chorus_rate": 0.34416008591651914,
      "train_max_prob": 0.6320655196905136,
      "train_conf_over_90": 0.0010172558046178891,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5067375004291534,
      "val_macro_f1": 0.7014736657697851,
      "val_verse_f1": 0.8019110621095185,
      "val_chorus_f1": 0.6010362694300518,
      "val_chorus_rate": 0.36494434624910355,
      "val_max_prob": 0.6264993399381638,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002692042182955943,
      "epoch_time": 145.01614904403687,
      "val_boundary_f1": 0.36153846153846153,
      "val_boundary_precision": 0.3051948051948052,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22359980606269048,
      "val_avg_segment_overlap": 0.5908201363137638,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.40698884197511564,
      "val_pk_metric": 0.33435896843171514
    },
    {
      "epoch": 8,
      "train_loss": 0.46165332943201065,
      "train_chorus_rate": 0.30028249248862265,
      "train_max_prob": 0.6523849666118622,
      "train_conf_over_90": 0.008624744284315967,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5074909552931786,
      "val_macro_f1": 0.6981461074452218,
      "val_verse_f1": 0.8060781476121562,
      "val_chorus_f1": 0.5902140672782874,
      "val_chorus_rate": 0.34364282339811325,
      "val_max_prob": 0.642615556716919,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002184405200973575,
      "epoch_time": 148.52557802200317,
      "val_boundary_f1": 0.3679694947569113,
      "val_boundary_precision": 0.3088,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.22246330749777196,
      "val_avg_segment_overlap": 0.5915870101674408,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.39738983367702463,
      "val_pk_metric": 0.3220770372801208
    },
    {
      "epoch": 9,
      "train_loss": 0.46153836250305175,
      "train_chorus_rate": 0.34220619797706603,
      "train_max_prob": 0.6595191538333893,
      "train_conf_over_90": 0.009445931238587946,
      "train_conf_over_95": 0.0004008331714430824,
      "val_loss": 0.49640268087387085,
      "val_macro_f1": 0.6895583493305267,
      "val_verse_f1": 0.7647291419533412,
      "val_chorus_f1": 0.6143875567077123,
      "val_chorus_rate": 0.45853547751903534,
      "val_max_prob": 0.6357740163803101,
      "val_conf_over_90": 0.002135694958269596,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001687861305003771,
      "epoch_time": 320.2152290344238,
      "val_boundary_f1": 0.2894491129785247,
      "val_boundary_precision": 0.23956723338485317,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.17333892557911645,
      "val_avg_segment_overlap": 0.5753996590084933,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.4438744278964029,
      "val_pk_metric": 0.34753942644436947
    },
    {
      "epoch": 10,
      "train_loss": 0.4593550533056259,
      "train_chorus_rate": 0.3606561116874218,
      "train_max_prob": 0.6605548173189163,
      "train_conf_over_90": 0.005038080297526904,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49423403292894363,
      "val_macro_f1": 0.7060560952348589,
      "val_verse_f1": 0.7991046446558477,
      "val_chorus_f1": 0.61300754581387,
      "val_chorus_rate": 0.38447634130716324,
      "val_max_prob": 0.649517834186554,
      "val_conf_over_90": 0.0007134274201234803,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012241118459823799,
      "epoch_time": 160.50427913665771,
      "val_boundary_f1": 0.3299908842297174,
      "val_boundary_precision": 0.2689450222882615,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.20361552849622838,
      "val_avg_segment_overlap": 0.5992117666787686,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.41867814958426963,
      "val_pk_metric": 0.3392566079726195
    },
    {
      "epoch": 11,
      "train_loss": 0.4563332125544548,
      "train_chorus_rate": 0.372885100543499,
      "train_max_prob": 0.6690611422061921,
      "train_conf_over_90": 0.013046181201934815,
      "train_conf_over_95": 0.0002541672060033306,
      "val_loss": 0.4929916337132454,
      "val_macro_f1": 0.6994776291217928,
      "val_verse_f1": 0.7712133227597147,
      "val_chorus_f1": 0.627741935483871,
      "val_chorus_rate": 0.46208444982767105,
      "val_max_prob": 0.6513396054506302,
      "val_conf_over_90": 0.0037840044242329895,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.13424900585435e-05,
      "epoch_time": 145.2668581008911,
      "val_boundary_f1": 0.31379962192816635,
      "val_boundary_precision": 0.2618296529968454,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.18380440924184294,
      "val_avg_segment_overlap": 0.5846407792093089,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.42884472098186666,
      "val_pk_metric": 0.3438718098625338
    },
    {
      "epoch": 12,
      "train_loss": 0.45169859677553176,
      "train_chorus_rate": 0.37444315776228904,
      "train_max_prob": 0.6760379374027252,
      "train_conf_over_90": 0.015301868229289538,
      "train_conf_over_95": 9.784361755009741e-05,
      "val_loss": 0.4918443039059639,
      "val_macro_f1": 0.7079153585764048,
      "val_verse_f1": 0.7901896915117839,
      "val_chorus_f1": 0.6256410256410256,
      "val_chorus_rate": 0.41938863694667816,
      "val_max_prob": 0.6553836762905121,
      "val_conf_over_90": 0.0033018444082699716,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.737494590213915e-05,
      "epoch_time": 256.39624190330505,
      "val_boundary_f1": 0.3503787878787879,
      "val_boundary_precision": 0.2927215189873418,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.22625566219150528,
      "val_avg_segment_overlap": 0.6070216292833542,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4045659153325144,
      "val_pk_metric": 0.3383135575246299
    },
    {
      "epoch": 13,
      "train_loss": 0.43526956140995027,
      "train_chorus_rate": 0.35868544355034826,
      "train_max_prob": 0.6845416188240051,
      "train_conf_over_90": 0.024234021198935807,
      "train_conf_over_95": 0.0016185146669158712,
      "val_loss": 0.4975742995738983,
      "val_macro_f1": 0.6992504412912861,
      "val_verse_f1": 0.7896525679758306,
      "val_chorus_f1": 0.6088483146067416,
      "val_chorus_rate": 0.4005274325609207,
      "val_max_prob": 0.6601560711860657,
      "val_conf_over_90": 0.0037840044242329895,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.1993096803020702e-05,
      "epoch_time": 233.71811485290527,
      "val_boundary_f1": 0.3460803059273422,
      "val_boundary_precision": 0.2909967845659164,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.21739773594227466,
      "val_avg_segment_overlap": 0.5928443428517538,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.40758018870602986,
      "val_pk_metric": 0.33491544080680524
    },
    {
      "epoch": 14,
      "train_loss": 0.44002643823623655,
      "train_chorus_rate": 0.3471332907676697,
      "train_max_prob": 0.681835213303566,
      "train_conf_over_90": 0.016627956472802907,
      "train_conf_over_95": 0.00033293862361460924,
      "val_loss": 0.49392326921224594,
      "val_macro_f1": 0.7026848531202146,
      "val_verse_f1": 0.790521327014218,
      "val_chorus_f1": 0.6148483792262112,
      "val_chorus_rate": 0.40567921847105026,
      "val_max_prob": 0.6602396070957184,
      "val_conf_over_90": 0.0037840044242329895,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.306251362444633e-06,
      "epoch_time": 146.42266702651978,
      "val_boundary_f1": 0.3409961685823755,
      "val_boundary_precision": 0.2870967741935484,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.21190919748714024,
      "val_avg_segment_overlap": 0.5938268379606892,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.40877202269543206,
      "val_pk_metric": 0.33536530752330235
    },
    {
      "epoch": 15,
      "train_loss": 0.4399831220507622,
      "train_chorus_rate": 0.34899955689907075,
      "train_max_prob": 0.68468177318573,
      "train_conf_over_90": 0.03294249610044062,
      "train_conf_over_95": 0.0005583600577665493,
      "val_loss": 0.49703478068113327,
      "val_macro_f1": 0.7081005365896699,
      "val_verse_f1": 0.8052330937903077,
      "val_chorus_f1": 0.610967979389032,
      "val_chorus_rate": 0.3683784306049347,
      "val_max_prob": 0.6644139140844345,
      "val_conf_over_90": 0.0033018444082699716,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 209.74148297309875,
      "val_boundary_f1": 0.3510737628384687,
      "val_boundary_precision": 0.29057187017001546,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.23235521917918525,
      "val_avg_segment_overlap": 0.605942857063234,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4081878878755074,
      "val_pk_metric": 0.3317112328323488
    }
  ]
}