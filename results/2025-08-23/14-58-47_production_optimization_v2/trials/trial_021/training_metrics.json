{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.1827137381470021,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.224178746545034,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0003892521290548651,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.013159697690786218,
      "gradient_clip_norm": 0.5088281304125487,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08160875354159791,
        "ece_after": 0.023487684563944053,
        "improvement": 0.05812106897765386,
        "params": {
          "temperature": 0.6425923891012103
        }
      },
      "platt": {
        "ece_before": 0.08160875354159791,
        "ece_after": 0.024649727057614357,
        "improvement": 0.05695902648398356,
        "params": {
          "A": 1.5273765982902086,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5636683583259583,
      "train_chorus_rate": 0.5091686107218265,
      "train_max_prob": 0.5590442925691604,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5880083739757538,
      "val_macro_f1": 0.5687207569436383,
      "val_verse_f1": 0.8050134856417578,
      "val_chorus_f1": 0.33242802824551876,
      "val_chorus_rate": 0.15243625827133656,
      "val_max_prob": 0.5966870486736298,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003850100087848366,
      "epoch_time": 52.208658933639526,
      "val_boundary_f1": 0.20461095100864551,
      "val_boundary_precision": 0.26296296296296295,
      "val_boundary_recall": 0.16745283018867924,
      "val_complete_segments": 0.08475239555568294,
      "val_avg_segment_overlap": 0.29493249568523117,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.13131313131313133,
      "val_window_diff": 0.31447120083322366,
      "val_pk_metric": 0.2920017634348052
    },
    {
      "epoch": 2,
      "train_loss": 0.5552995055913925,
      "train_chorus_rate": 0.4216375095769763,
      "train_max_prob": 0.5875015676021575,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5834832638502121,
      "val_macro_f1": 0.5490105946659926,
      "val_verse_f1": 0.8273348519362186,
      "val_chorus_f1": 0.27068633739576653,
      "val_chorus_rate": 0.08308759145438671,
      "val_max_prob": 0.6136405020952225,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00037246904898650295,
      "epoch_time": 49.76736617088318,
      "val_boundary_f1": 0.22707423580786024,
      "val_boundary_precision": 0.2965779467680608,
      "val_boundary_recall": 0.18396226415094338,
      "val_complete_segments": 0.10666268829047196,
      "val_avg_segment_overlap": 0.3112611192170147,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.13636363636363635,
      "val_window_diff": 0.29778904908536596,
      "val_pk_metric": 0.2753838197610779
    },
    {
      "epoch": 3,
      "train_loss": 0.5082939937710762,
      "train_chorus_rate": 0.3885659150779247,
      "train_max_prob": 0.6403804332017898,
      "train_conf_over_90": 0.007915018318453804,
      "train_conf_over_95": 0.00011765288072638214,
      "val_loss": 0.5448523759841919,
      "val_macro_f1": 0.5746022430692144,
      "val_verse_f1": 0.6000926784059314,
      "val_chorus_f1": 0.5491118077324973,
      "val_chorus_rate": 0.6413542628288269,
      "val_max_prob": 0.6828921437263489,
      "val_conf_over_90": 0.01973346248269081,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00035217734978125313,
      "epoch_time": 61.466517210006714,
      "val_boundary_f1": 0.1851106639839034,
      "val_boundary_precision": 0.16140350877192983,
      "val_boundary_recall": 0.2169811320754717,
      "val_complete_segments": 0.06197129564043667,
      "val_avg_segment_overlap": 0.4013049412654712,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.49026279461667677,
      "val_pk_metric": 0.3883521800799835
    },
    {
      "epoch": 4,
      "train_loss": 0.4994931861758232,
      "train_chorus_rate": 0.40329704955220225,
      "train_max_prob": 0.6605394542217254,
      "train_conf_over_90": 0.011698531376896425,
      "train_conf_over_95": 0.0004234547057421878,
      "val_loss": 0.5513212829828262,
      "val_macro_f1": 0.7018478192231,
      "val_verse_f1": 0.8422107196526967,
      "val_chorus_f1": 0.5614849187935034,
      "val_chorus_rate": 0.23071276396512985,
      "val_max_prob": 0.701892226934433,
      "val_conf_over_90": 0.03203092189505696,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032502175579473234,
      "epoch_time": 60.1393768787384,
      "val_boundary_f1": 0.32866479925303455,
      "val_boundary_precision": 0.27202472952086554,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.20162045472225748,
      "val_avg_segment_overlap": 0.5532176035512951,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.3650264860524753,
      "val_pk_metric": 0.2848133792408527
    },
    {
      "epoch": 5,
      "train_loss": 0.49113098084926604,
      "train_chorus_rate": 0.37835162654519083,
      "train_max_prob": 0.6835916042327881,
      "train_conf_over_90": 0.025381938903592527,
      "train_conf_over_95": 0.0012278006295673549,
      "val_loss": 0.5197140350937843,
      "val_macro_f1": 0.6832817778169575,
      "val_verse_f1": 0.7634724671761709,
      "val_chorus_f1": 0.6030910884577442,
      "val_chorus_rate": 0.44844889640808105,
      "val_max_prob": 0.667633131146431,
      "val_conf_over_90": 0.017621633829548955,
      "val_conf_over_95": 0.0012207481631776318,
      "learning_rate": 0.00029218909679114887,
      "epoch_time": 49.16994380950928,
      "val_boundary_f1": 0.2549187339606501,
      "val_boundary_precision": 0.2,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.12275800076701457,
      "val_avg_segment_overlap": 0.5551149729922766,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.48259868946897966,
      "val_pk_metric": 0.3553684803038518
    },
    {
      "epoch": 6,
      "train_loss": 0.501286293566227,
      "train_chorus_rate": 0.4457688473165035,
      "train_max_prob": 0.6835055142641068,
      "train_conf_over_90": 0.031625451368745415,
      "train_conf_over_95": 0.003261850227136165,
      "val_loss": 0.5524965226650238,
      "val_macro_f1": 0.706362618586369,
      "val_verse_f1": 0.8555609835531673,
      "val_chorus_f1": 0.5571642536195707,
      "val_chorus_rate": 0.19289201870560646,
      "val_max_prob": 0.7169995754957199,
      "val_conf_over_90": 0.01568095711991191,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002551143175175369,
      "epoch_time": 50.62759780883789,
      "val_boundary_f1": 0.34136546184738953,
      "val_boundary_precision": 0.2972027972027972,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.21485729025495728,
      "val_avg_segment_overlap": 0.5662846642491226,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.32749305404903917,
      "val_pk_metric": 0.26682524750581005
    },
    {
      "epoch": 7,
      "train_loss": 0.46986769437789916,
      "train_chorus_rate": 0.33620325811207297,
      "train_max_prob": 0.6883860141038894,
      "train_conf_over_90": 0.022407613205723466,
      "train_conf_over_95": 0.0014804863661993296,
      "val_loss": 0.5207369551062584,
      "val_macro_f1": 0.7316641094381404,
      "val_verse_f1": 0.832619557458958,
      "val_chorus_f1": 0.6307086614173227,
      "val_chorus_rate": 0.32536353170871735,
      "val_max_prob": 0.7040326446294785,
      "val_conf_over_90": 0.03946299385279417,
      "val_conf_over_95": 0.0024820048711262643,
      "learning_rate": 0.00021541776373268246,
      "epoch_time": 66.48953986167908,
      "val_boundary_f1": 0.33094812164579607,
      "val_boundary_precision": 0.2665706051873199,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.20020668107889739,
      "val_avg_segment_overlap": 0.6244174258313564,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4111346904787402,
      "val_pk_metric": 0.3038427894803475
    },
    {
      "epoch": 8,
      "train_loss": 0.4674362614750862,
      "train_chorus_rate": 0.34143818691372874,
      "train_max_prob": 0.6873883128166198,
      "train_conf_over_90": 0.022655359184136616,
      "train_conf_over_95": 0.002684801019495353,
      "val_loss": 0.507892407476902,
      "val_macro_f1": 0.7357886025886675,
      "val_verse_f1": 0.828638924223151,
      "val_chorus_f1": 0.642938280954184,
      "val_chorus_rate": 0.3503132089972496,
      "val_max_prob": 0.7115822732448578,
      "val_conf_over_90": 0.04317788640037179,
      "val_conf_over_95": 0.006038785097189248,
      "learning_rate": 0.00017483436532218276,
      "epoch_time": 58.21924710273743,
      "val_boundary_f1": 0.3236889692585895,
      "val_boundary_precision": 0.2624633431085044,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.1925164560106236,
      "val_avg_segment_overlap": 0.6187160791665486,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4085303582131257,
      "val_pk_metric": 0.3035895330040769
    },
    {
      "epoch": 9,
      "train_loss": 0.47181725054979323,
      "train_chorus_rate": 0.35671414732933043,
      "train_max_prob": 0.7026174098253251,
      "train_conf_over_90": 0.04251563972793519,
      "train_conf_over_95": 0.006904299126472324,
      "val_loss": 0.49140116572380066,
      "val_macro_f1": 0.7168448112145303,
      "val_verse_f1": 0.7950740812006928,
      "val_chorus_f1": 0.6386155412283678,
      "val_chorus_rate": 0.425065316259861,
      "val_max_prob": 0.6873877942562103,
      "val_conf_over_90": 0.02885898668318987,
      "val_conf_over_95": 0.0015219621709547937,
      "learning_rate": 0.0001351378115373283,
      "epoch_time": 53.746888875961304,
      "val_boundary_f1": 0.3472222222222222,
      "val_boundary_precision": 0.27472527472527475,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.23191894553241318,
      "val_avg_segment_overlap": 0.6170394957128399,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39022749248511057,
      "val_pk_metric": 0.298025417764002
    },
    {
      "epoch": 10,
      "train_loss": 0.46986730545759203,
      "train_chorus_rate": 0.3728336997330189,
      "train_max_prob": 0.6917327463626861,
      "train_conf_over_90": 0.027642851392738522,
      "train_conf_over_95": 0.0027599665074376388,
      "val_loss": 0.5024948269128799,
      "val_macro_f1": 0.7474254582083975,
      "val_verse_f1": 0.8499563318777293,
      "val_chorus_f1": 0.6448945845390657,
      "val_chorus_rate": 0.2959844246506691,
      "val_max_prob": 0.713842362165451,
      "val_conf_over_90": 0.030910720117390156,
      "val_conf_over_95": 0.0007484007510356605,
      "learning_rate": 9.806303226371633e-05,
      "epoch_time": 54.417476654052734,
      "val_boundary_f1": 0.36312849162011174,
      "val_boundary_precision": 0.3,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2548861010684977,
      "val_avg_segment_overlap": 0.6340791972628128,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.3572743740543223,
      "val_pk_metric": 0.2594011014089485
    },
    {
      "epoch": 11,
      "train_loss": 0.45720980763435365,
      "train_chorus_rate": 0.3126326039433479,
      "train_max_prob": 0.7038804799318313,
      "train_conf_over_90": 0.03054460701532662,
      "train_conf_over_95": 0.00279925168142654,
      "val_loss": 0.49273520708084106,
      "val_macro_f1": 0.7574941920193743,
      "val_verse_f1": 0.8515307025305257,
      "val_chorus_f1": 0.6634576815082229,
      "val_chorus_rate": 0.3142256736755371,
      "val_max_prob": 0.7049020528793335,
      "val_conf_over_90": 0.02440299279987812,
      "val_conf_over_95": 0.0015471227816306055,
      "learning_rate": 6.523037326013283e-05,
      "epoch_time": 382.06853199005127,
      "val_boundary_f1": 0.38025594149908587,
      "val_boundary_precision": 0.31044776119402984,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.26957862649803266,
      "val_avg_segment_overlap": 0.6510139199777463,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3553893896842351,
      "val_pk_metric": 0.2594099959011584
    },
    {
      "epoch": 12,
      "train_loss": 0.44710317701101304,
      "train_chorus_rate": 0.3407884478569031,
      "train_max_prob": 0.715440160036087,
      "train_conf_over_90": 0.05219872575253248,
      "train_conf_over_95": 0.00943612541886978,
      "val_loss": 0.48672907054424286,
      "val_macro_f1": 0.7577434623137895,
      "val_verse_f1": 0.8444846292947559,
      "val_chorus_f1": 0.6710022953328232,
      "val_chorus_rate": 0.34379617124795914,
      "val_max_prob": 0.7016624808311462,
      "val_conf_over_90": 0.030851242132484913,
      "val_conf_over_95": 0.00231087148131337,
      "learning_rate": 3.807477927361198e-05,
      "epoch_time": 48.54238414764404,
      "val_boundary_f1": 0.37130044843049326,
      "val_boundary_precision": 0.2995658465991317,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2680098463104826,
      "val_avg_segment_overlap": 0.6519183620006084,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3706346384292923,
      "val_pk_metric": 0.2710813653459935
    },
    {
      "epoch": 13,
      "train_loss": 0.45611333698034284,
      "train_chorus_rate": 0.372749499976635,
      "train_max_prob": 0.7065429329872132,
      "train_conf_over_90": 0.047079970594495535,
      "train_conf_over_95": 0.01010075478698127,
      "val_loss": 0.4828829765319824,
      "val_macro_f1": 0.7471370554563062,
      "val_verse_f1": 0.8273676360924683,
      "val_chorus_f1": 0.666906474820144,
      "val_chorus_rate": 0.38430794328451157,
      "val_max_prob": 0.7013767063617706,
      "val_conf_over_90": 0.04143323004245758,
      "val_conf_over_95": 0.0030592722323490307,
      "learning_rate": 1.7783080068362092e-05,
      "epoch_time": 53.40122199058533,
      "val_boundary_f1": 0.3489813994685562,
      "val_boundary_precision": 0.2794326241134752,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.23962048133575176,
      "val_avg_segment_overlap": 0.6383734713577901,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.38713862137742605,
      "val_pk_metric": 0.2886228696729164
    },
    {
      "epoch": 14,
      "train_loss": 0.44458222985267637,
      "train_chorus_rate": 0.3352046459913254,
      "train_max_prob": 0.7107634246349335,
      "train_conf_over_90": 0.043877335265278816,
      "train_conf_over_95": 0.005822476686444133,
      "val_loss": 0.4852325990796089,
      "val_macro_f1": 0.757021107554054,
      "val_verse_f1": 0.8455723542116631,
      "val_chorus_f1": 0.6684698608964451,
      "val_chorus_rate": 0.33747363090515137,
      "val_max_prob": 0.7077605873346329,
      "val_conf_over_90": 0.03748351614922285,
      "val_conf_over_95": 0.0022857108706375584,
      "learning_rate": 5.242120270028456e-06,
      "epoch_time": 54.52168416976929,
      "val_boundary_f1": 0.3813868613138687,
      "val_boundary_precision": 0.31101190476190477,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2678442626083135,
      "val_avg_segment_overlap": 0.6505703874795186,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3565614770167117,
      "val_pk_metric": 0.2632068983417494
    },
    {
      "epoch": 15,
      "train_loss": 0.43852960765361787,
      "train_chorus_rate": 0.326560627669096,
      "train_max_prob": 0.7184438854455948,
      "train_conf_over_90": 0.04891826314851642,
      "train_conf_over_95": 0.009466221599723212,
      "val_loss": 0.4838123768568039,
      "val_macro_f1": 0.7534802583842548,
      "val_verse_f1": 0.8382970948291613,
      "val_chorus_f1": 0.6686634219393485,
      "val_chorus_rate": 0.357699915766716,
      "val_max_prob": 0.7066411972045898,
      "val_conf_over_90": 0.04263957869261503,
      "val_conf_over_95": 0.003762886975891888,
      "learning_rate": 1e-06,
      "epoch_time": 59.29489064216614,
      "val_boundary_f1": 0.368755676657584,
      "val_boundary_precision": 0.2998522895125554,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2598107064040256,
      "val_avg_segment_overlap": 0.6489281062564317,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3692633026057406,
      "val_pk_metric": 0.27529168759046113
    }
  ]
}