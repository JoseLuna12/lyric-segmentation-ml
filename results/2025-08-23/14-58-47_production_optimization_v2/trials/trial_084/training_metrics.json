{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2017721266997783,
      "layer_dropout": 0.23187267043003934,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1835847931140983,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008771292290505689,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.016613814371476004,
      "gradient_clip_norm": 0.38267739359303576,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.129717721627597,
        "ece_after": 0.02748144937638918,
        "improvement": 0.10223627225120784,
        "params": {
          "temperature": 0.49073137808847495
        }
      },
      "platt": {
        "ece_before": 0.129717721627597,
        "ece_after": 0.03467644254854478,
        "improvement": 0.09504127907905223,
        "params": {
          "A": 1.8835434436924157,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5970043689012527,
      "train_chorus_rate": 0.38928342462750154,
      "train_max_prob": 0.5906848937273026,
      "train_conf_over_90": 0.0075338251888751985,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5760454386472702,
      "val_macro_f1": 0.5090733871214337,
      "val_verse_f1": 0.5065415946679832,
      "val_chorus_f1": 0.511605179574884,
      "val_chorus_rate": 0.7060356587171555,
      "val_max_prob": 0.5423776060342789,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008675564661895709,
      "epoch_time": 80.29487991333008,
      "val_boundary_f1": 0.05714285714285714,
      "val_boundary_precision": 0.08737864077669903,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.03835292837148617,
      "val_avg_segment_overlap": 0.24790116002809004,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.4312790416235301,
      "val_pk_metric": 0.4217442339927595
    },
    {
      "epoch": 2,
      "train_loss": 0.5574744120240211,
      "train_chorus_rate": 0.47170893078437076,
      "train_max_prob": 0.5900258392095565,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5829884856939316,
      "val_macro_f1": 0.5392808172339042,
      "val_verse_f1": 0.6373759870419113,
      "val_chorus_f1": 0.441185647425897,
      "val_chorus_rate": 0.48838692903518677,
      "val_max_prob": 0.5641602277755737,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008392565532788149,
      "epoch_time": 68.8615779876709,
      "val_boundary_f1": 0.04642857142857144,
      "val_boundary_precision": 0.09558823529411764,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.02161372287300177,
      "val_avg_segment_overlap": 0.21123516253156677,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42757917132994877,
      "val_pk_metric": 0.42820826666826467
    },
    {
      "epoch": 3,
      "train_loss": 0.5612172722816468,
      "train_chorus_rate": 0.4914258354110643,
      "train_max_prob": 0.5764867186546325,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5811005979776382,
      "val_macro_f1": 0.5782481532112602,
      "val_verse_f1": 0.7963742311427646,
      "val_chorus_f1": 0.36012207527975587,
      "val_chorus_rate": 0.18276908062398434,
      "val_max_prob": 0.5574396401643753,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00079346633231055,
      "epoch_time": 46.93816590309143,
      "val_boundary_f1": 0.16828478964401292,
      "val_boundary_precision": 0.26804123711340205,
      "val_boundary_recall": 0.12264150943396226,
      "val_complete_segments": 0.07574219235141823,
      "val_avg_segment_overlap": 0.28114611262879186,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.3370042573481591,
      "val_pk_metric": 0.31647156437640117
    },
    {
      "epoch": 4,
      "train_loss": 0.5432492420077324,
      "train_chorus_rate": 0.4914835751056671,
      "train_max_prob": 0.5811842828989029,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5558111518621445,
      "val_macro_f1": 0.638534859475383,
      "val_verse_f1": 0.7350261678619888,
      "val_chorus_f1": 0.5420435510887772,
      "val_chorus_rate": 0.43487823009490967,
      "val_max_prob": 0.5825778245925903,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007321870556669475,
      "epoch_time": 54.82709503173828,
      "val_boundary_f1": 0.20902612826603326,
      "val_boundary_precision": 0.21052631578947367,
      "val_boundary_recall": 0.20754716981132076,
      "val_complete_segments": 0.07047299344489165,
      "val_avg_segment_overlap": 0.4249667583850122,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.21717171717171718,
      "val_window_diff": 0.4442128160740112,
      "val_pk_metric": 0.3761123460590733
    },
    {
      "epoch": 5,
      "train_loss": 0.5089125290513039,
      "train_chorus_rate": 0.40311045944690704,
      "train_max_prob": 0.6578221291303634,
      "train_conf_over_90": 0.0132290620385902,
      "train_conf_over_95": 0.00010124999971594661,
      "val_loss": 0.515523761510849,
      "val_macro_f1": 0.6916545211519138,
      "val_verse_f1": 0.7780548628428927,
      "val_chorus_f1": 0.6052541794609348,
      "val_chorus_rate": 0.4212370812892914,
      "val_max_prob": 0.6652495861053467,
      "val_conf_over_90": 0.00641143781831488,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006580969217879267,
      "epoch_time": 54.219781160354614,
      "val_boundary_f1": 0.26171875000000006,
      "val_boundary_precision": 0.22333333333333333,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.11898693686869721,
      "val_avg_segment_overlap": 0.557895678858482,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.45289195285028255,
      "val_pk_metric": 0.3433770476530087
    },
    {
      "epoch": 6,
      "train_loss": 0.5001420170068741,
      "train_chorus_rate": 0.3651992931962013,
      "train_max_prob": 0.6693140625953674,
      "train_conf_over_90": 0.014852855671779252,
      "train_conf_over_95": 0.0004980146884918212,
      "val_loss": 0.4983738884329796,
      "val_macro_f1": 0.6971199320604963,
      "val_verse_f1": 0.7724680432645034,
      "val_chorus_f1": 0.6217718208564892,
      "val_chorus_rate": 0.45203550159931183,
      "val_max_prob": 0.7015461623668671,
      "val_conf_over_90": 0.04327351925894618,
      "val_conf_over_95": 0.0017783901275834069,
      "learning_rate": 0.0005744340250479078,
      "epoch_time": 47.68260598182678,
      "val_boundary_f1": 0.29182156133828996,
      "val_boundary_precision": 0.24079754601226994,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.145012034076191,
      "val_avg_segment_overlap": 0.5980094927854276,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4581401631915103,
      "val_pk_metric": 0.35183726109915936
    },
    {
      "epoch": 7,
      "train_loss": 0.48306813687086103,
      "train_chorus_rate": 0.36168714091181753,
      "train_max_prob": 0.6784702241420746,
      "train_conf_over_90": 0.029331464890856297,
      "train_conf_over_95": 0.003970380109967664,
      "val_loss": 0.49072281271219254,
      "val_macro_f1": 0.7263842930870997,
      "val_verse_f1": 0.8088318550669938,
      "val_chorus_f1": 0.6439367311072056,
      "val_chorus_rate": 0.39922887086868286,
      "val_max_prob": 0.6999023109674454,
      "val_conf_over_90": 0.024149625096470118,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004848548354935495,
      "epoch_time": 99.0755467414856,
      "val_boundary_f1": 0.36363636363636365,
      "val_boundary_precision": 0.2996941896024465,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.23837713641531244,
      "val_avg_segment_overlap": 0.6440464076308489,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4279825316312574,
      "val_pk_metric": 0.31379195085493894
    },
    {
      "epoch": 8,
      "train_loss": 0.4737081915140152,
      "train_chorus_rate": 0.38350203856825826,
      "train_max_prob": 0.6933406203985214,
      "train_conf_over_90": 0.02137397285550833,
      "train_conf_over_95": 0.0004286612820578739,
      "val_loss": 0.5071851760149002,
      "val_macro_f1": 0.7517178872843373,
      "val_verse_f1": 0.8553110379483625,
      "val_chorus_f1": 0.648124736620312,
      "val_chorus_rate": 0.2836461067199707,
      "val_max_prob": 0.7260789573192596,
      "val_conf_over_90": 0.019590162904933095,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00039327439355701964,
      "epoch_time": 68.54194211959839,
      "val_boundary_f1": 0.39794871794871794,
      "val_boundary_precision": 0.35208711433756806,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2648066222562511,
      "val_avg_segment_overlap": 0.642476350173246,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3273758044517359,
      "val_pk_metric": 0.23623321721234608
    },
    {
      "epoch": 9,
      "train_loss": 0.45767892599105836,
      "train_chorus_rate": 0.296604410558939,
      "train_max_prob": 0.720754075050354,
      "train_conf_over_90": 0.04087759256362915,
      "train_conf_over_95": 0.0034563148044981064,
      "val_loss": 0.49401091784238815,
      "val_macro_f1": 0.7136328479394736,
      "val_verse_f1": 0.7971097166761741,
      "val_chorus_f1": 0.6301559792027729,
      "val_chorus_rate": 0.4095357283949852,
      "val_max_prob": 0.6904404014348984,
      "val_conf_over_90": 0.014797888114117086,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030369520400266127,
      "epoch_time": 126.70809698104858,
      "val_boundary_f1": 0.2967244701348748,
      "val_boundary_precision": 0.250814332247557,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.1587938320838639,
      "val_avg_segment_overlap": 0.6024803479541314,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.4287519928834137,
      "val_pk_metric": 0.32413131445048793
    },
    {
      "epoch": 10,
      "train_loss": 0.45651439726352694,
      "train_chorus_rate": 0.3315066613256931,
      "train_max_prob": 0.7059595793485641,
      "train_conf_over_90": 0.025518635316984728,
      "train_conf_over_95": 0.0015752650913782417,
      "val_loss": 0.4875844120979309,
      "val_macro_f1": 0.7226710887641525,
      "val_verse_f1": 0.8036494962934803,
      "val_chorus_f1": 0.6416926812348248,
      "val_chorus_rate": 0.40839726477861404,
      "val_max_prob": 0.7092756778001785,
      "val_conf_over_90": 0.04162127897143364,
      "val_conf_over_95": 0.00047234738303814083,
      "learning_rate": 0.00022003230726264238,
      "epoch_time": 100.56245803833008,
      "val_boundary_f1": 0.33333333333333326,
      "val_boundary_precision": 0.27245508982035926,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.19222488470897803,
      "val_avg_segment_overlap": 0.6291970819704441,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.445873497147566,
      "val_pk_metric": 0.3152865800687345
    },
    {
      "epoch": 11,
      "train_loss": 0.45876446813344957,
      "train_chorus_rate": 0.3314830273389816,
      "train_max_prob": 0.7043960750102997,
      "train_conf_over_90": 0.027853196440264582,
      "train_conf_over_95": 0.0009973811567761004,
      "val_loss": 0.49892912060022354,
      "val_macro_f1": 0.7670996048015504,
      "val_verse_f1": 0.8678210183439055,
      "val_chorus_f1": 0.6663781912591952,
      "val_chorus_rate": 0.26817742735147476,
      "val_max_prob": 0.681012898683548,
      "val_conf_over_90": 0.00048216007417067885,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014594217338362154,
      "epoch_time": 106.12722396850586,
      "val_boundary_f1": 0.39614561027837253,
      "val_boundary_precision": 0.3627450980392157,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.24918794722612325,
      "val_avg_segment_overlap": 0.6486756182374263,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.31191932112650655,
      "val_pk_metric": 0.23602929463968483
    },
    {
      "epoch": 12,
      "train_loss": 0.4545499712228775,
      "train_chorus_rate": 0.32137988954782487,
      "train_max_prob": 0.7055066436529159,
      "train_conf_over_90": 0.021845406363718213,
      "train_conf_over_95": 0.0003565377148333937,
      "val_loss": 0.48566631972789764,
      "val_macro_f1": 0.7453873171553539,
      "val_verse_f1": 0.8333637525095821,
      "val_chorus_f1": 0.6574108818011257,
      "val_chorus_rate": 0.3550554886460304,
      "val_max_prob": 0.7075068056583405,
      "val_conf_over_90": 0.022938361624255776,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.466289674001893e-05,
      "epoch_time": 93.87628221511841,
      "val_boundary_f1": 0.3530482256596906,
      "val_boundary_precision": 0.2874074074074074,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.22807324443061455,
      "val_avg_segment_overlap": 0.6585949927538164,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.40338553536834326,
      "val_pk_metric": 0.2822848132095832
    },
    {
      "epoch": 13,
      "train_loss": 0.4466859459877014,
      "train_chorus_rate": 0.3215706765651703,
      "train_max_prob": 0.7175285965204239,
      "train_conf_over_90": 0.031040998362004756,
      "train_conf_over_95": 0.0007686565571930259,
      "val_loss": 0.4823853373527527,
      "val_macro_f1": 0.7373371232671457,
      "val_verse_f1": 0.8225477470795475,
      "val_chorus_f1": 0.6521264994547439,
      "val_chorus_rate": 0.37603146582841873,
      "val_max_prob": 0.7281447201967239,
      "val_conf_over_90": 0.04113625781610608,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 3.8872675771753886e-05,
      "epoch_time": 93.66922211647034,
      "val_boundary_f1": 0.3622782446311858,
      "val_boundary_precision": 0.29984544049459044,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2407082226143732,
      "val_avg_segment_overlap": 0.6502503257836103,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4038960437038679,
      "val_pk_metric": 0.2856812739559224
    },
    {
      "epoch": 14,
      "train_loss": 0.4386505141854286,
      "train_chorus_rate": 0.32161104306578636,
      "train_max_prob": 0.7279922574758529,
      "train_conf_over_90": 0.03772642787080258,
      "train_conf_over_95": 0.0014994255063356832,
      "val_loss": 0.4826536774635315,
      "val_macro_f1": 0.7509928671053347,
      "val_verse_f1": 0.8428417653390743,
      "val_chorus_f1": 0.6591439688715953,
      "val_chorus_rate": 0.331745021045208,
      "val_max_prob": 0.7163611501455307,
      "val_conf_over_90": 0.020821982296183705,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0572762860998024e-05,
      "epoch_time": 100.7123589515686,
      "val_boundary_f1": 0.36654135338345867,
      "val_boundary_precision": 0.3046875,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2625169916924954,
      "val_avg_segment_overlap": 0.6642536525986318,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3689571802639145,
      "val_pk_metric": 0.26252371430284255
    },
    {
      "epoch": 15,
      "train_loss": 0.4455441564321518,
      "train_chorus_rate": 0.3242660403251648,
      "train_max_prob": 0.7205183178186416,
      "train_conf_over_90": 0.029957938054576517,
      "train_conf_over_95": 0.0004812917992239818,
      "val_loss": 0.4818621277809143,
      "val_macro_f1": 0.7474734618168951,
      "val_verse_f1": 0.8377058078523612,
      "val_chorus_f1": 0.6572411157814291,
      "val_chorus_rate": 0.34328310936689377,
      "val_max_prob": 0.7163256406784058,
      "val_conf_over_90": 0.023047558264806867,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 103.89704608917236,
      "val_boundary_f1": 0.3714821763602251,
      "val_boundary_precision": 0.308411214953271,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.2621975444615954,
      "val_avg_segment_overlap": 0.6610999684667366,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3777644051304708,
      "val_pk_metric": 0.2706671441354302
    }
  ]
}