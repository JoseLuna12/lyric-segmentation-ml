{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.29616254224068694,
      "layer_dropout": 0.20673195274160727,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.11495981424532142,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2788867,
      "lstm_params": 2228224,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005956922327280767,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "composite",
      "weight_decay": 0.007034122927341671,
      "gradient_clip_norm": 0.46508980485730844,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07167211466254793,
        "ece_after": 0.03118522296895682,
        "improvement": 0.04048689169359111,
        "params": {
          "temperature": 0.6064281823247074
        }
      },
      "platt": {
        "ece_before": 0.07167211466254793,
        "ece_after": 0.07167212023950512,
        "improvement": -5.576957187725107e-09,
        "params": {
          "A": 0.9999997991558279,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6051837027072906,
      "train_chorus_rate": 0.6295652446802705,
      "train_max_prob": 0.6028815388679505,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5832005739212036,
      "val_macro_f1": 0.5284298208731923,
      "val_verse_f1": 0.6576715497301465,
      "val_chorus_f1": 0.39918809201623817,
      "val_chorus_rate": 0.42605090141296387,
      "val_max_prob": 0.5353518724441528,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005855604095068175,
      "epoch_time": 155.62701511383057,
      "val_boundary_f1": 0.06557377049180327,
      "val_boundary_precision": 0.144,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.003651819923371647,
      "val_avg_segment_overlap": 0.21464184665321295,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.47334892134302375,
      "val_pk_metric": 0.4998421106884689
    },
    {
      "epoch": 2,
      "train_loss": 0.5565664589405059,
      "train_chorus_rate": 0.37593166845617815,
      "train_max_prob": 0.5605448722839356,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5839095711708069,
      "val_macro_f1": 0.5475027549794331,
      "val_verse_f1": 0.6997427416391032,
      "val_chorus_f1": 0.39526276831976315,
      "val_chorus_rate": 0.36360807716846466,
      "val_max_prob": 0.5400457680225372,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005558554068519394,
      "epoch_time": 116.51608896255493,
      "val_boundary_f1": 0.06629834254143646,
      "val_boundary_precision": 0.15126050420168066,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.003651819923371647,
      "val_avg_segment_overlap": 0.21973085363494296,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43225709028910053,
      "val_pk_metric": 0.4533572329608596
    },
    {
      "epoch": 3,
      "train_loss": 0.5458308160305023,
      "train_chorus_rate": 0.597520625591278,
      "train_max_prob": 0.55623077750206,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5797451436519623,
      "val_macro_f1": 0.5084797806117054,
      "val_verse_f1": 0.5516930022573364,
      "val_chorus_f1": 0.46526655896607433,
      "val_chorus_rate": 0.6120109856128693,
      "val_max_prob": 0.556540459394455,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000508601571604534,
      "epoch_time": 107.38200116157532,
      "val_boundary_f1": 0.06509945750452079,
      "val_boundary_precision": 0.13953488372093023,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.01670258620689655,
      "val_avg_segment_overlap": 0.21426058328231917,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4501075831201421,
      "val_pk_metric": 0.4626170831950528
    },
    {
      "epoch": 4,
      "train_loss": 0.5537251174449921,
      "train_chorus_rate": 0.6631023198366165,
      "train_max_prob": 0.5653731226921082,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5750109553337097,
      "val_macro_f1": 0.5287137899742866,
      "val_verse_f1": 0.5942216472617508,
      "val_chorus_f1": 0.4632059326868226,
      "val_chorus_rate": 0.5615796148777008,
      "val_max_prob": 0.5552219152450562,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044701917454605745,
      "epoch_time": 95.22628688812256,
      "val_boundary_f1": 0.07567567567567568,
      "val_boundary_precision": 0.16030534351145037,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.053220785440613025,
      "val_avg_segment_overlap": 0.2289984175219586,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.341316171861466,
      "val_pk_metric": 0.33412935080489825
    },
    {
      "epoch": 5,
      "train_loss": 0.5290305376052856,
      "train_chorus_rate": 0.4468813970685005,
      "train_max_prob": 0.5869123280048371,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5809438526630402,
      "val_macro_f1": 0.4845182222455645,
      "val_verse_f1": 0.5005953798523457,
      "val_chorus_f1": 0.4684410646387833,
      "val_chorus_rate": 0.6688611209392548,
      "val_max_prob": 0.5753193497657776,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00037530495426632175,
      "epoch_time": 100.35989189147949,
      "val_boundary_f1": 0.061433447098976114,
      "val_boundary_precision": 0.1111111111111111,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.029214559386973177,
      "val_avg_segment_overlap": 0.20209734606619606,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.41783144091049096,
      "val_pk_metric": 0.4036174745955283
    },
    {
      "epoch": 6,
      "train_loss": 0.5426851332187652,
      "train_chorus_rate": 0.5722706586122512,
      "train_max_prob": 0.5671086847782135,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5769773423671722,
      "val_macro_f1": 0.6105594035060599,
      "val_verse_f1": 0.7555476020042949,
      "val_chorus_f1": 0.46557120500782473,
      "val_chorus_rate": 0.3279403746128082,
      "val_max_prob": 0.5603008568286896,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002983461163640383,
      "epoch_time": 99.17714405059814,
      "val_boundary_f1": 0.16352201257861634,
      "val_boundary_precision": 0.24528301886792453,
      "val_boundary_recall": 0.12264150943396226,
      "val_complete_segments": 0.08279454022988506,
      "val_avg_segment_overlap": 0.31034214830667606,
      "val_verse_to_chorus_acc": 0.11061946902654868,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.3144775426493184,
      "val_pk_metric": 0.30529757264679114
    },
    {
      "epoch": 7,
      "train_loss": 0.5358798205852509,
      "train_chorus_rate": 0.5777277410030365,
      "train_max_prob": 0.5655487537384033,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5692092478275299,
      "val_macro_f1": 0.5658282165132553,
      "val_verse_f1": 0.6402515723270441,
      "val_chorus_f1": 0.49140486069946643,
      "val_chorus_rate": 0.5287982523441315,
      "val_max_prob": 0.5745287537574768,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002213872784617549,
      "epoch_time": 91.22027015686035,
      "val_boundary_f1": 0.1214814814814815,
      "val_boundary_precision": 0.16334661354581673,
      "val_boundary_recall": 0.09669811320754718,
      "val_complete_segments": 0.053220785440613025,
      "val_avg_segment_overlap": 0.2732471586957484,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.06060606060606061,
      "val_window_diff": 0.4321633503698874,
      "val_pk_metric": 0.3810985144317621
    },
    {
      "epoch": 8,
      "train_loss": 0.5277301609516144,
      "train_chorus_rate": 0.5003427922725677,
      "train_max_prob": 0.5941079974174499,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5669550895690918,
      "val_macro_f1": 0.6326338928198316,
      "val_verse_f1": 0.7607428987618352,
      "val_chorus_f1": 0.504524886877828,
      "val_chorus_rate": 0.35148273408412933,
      "val_max_prob": 0.5989173650741577,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001496730581820192,
      "epoch_time": 293.7466330528259,
      "val_boundary_f1": 0.1754874651810585,
      "val_boundary_precision": 0.21428571428571427,
      "val_boundary_recall": 0.14858490566037735,
      "val_complete_segments": 0.07130028735632184,
      "val_avg_segment_overlap": 0.3700619414864751,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.13636363636363635,
      "val_window_diff": 0.39215582204404636,
      "val_pk_metric": 0.3492060953002744
    },
    {
      "epoch": 9,
      "train_loss": 0.5074823826551438,
      "train_chorus_rate": 0.4131725698709488,
      "train_max_prob": 0.6132858395576477,
      "train_conf_over_90": 0.00020545046427287162,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5484947860240936,
      "val_macro_f1": 0.6114807312709609,
      "val_verse_f1": 0.6798914178325328,
      "val_chorus_f1": 0.5430700447093889,
      "val_chorus_rate": 0.5243269056081772,
      "val_max_prob": 0.6050575077533722,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.809066112354258e-05,
      "epoch_time": 118.6529188156128,
      "val_boundary_f1": 0.15947712418300652,
      "val_boundary_precision": 0.17888563049853373,
      "val_boundary_recall": 0.14386792452830188,
      "val_complete_segments": 0.06645114942528736,
      "val_avg_segment_overlap": 0.36903282769846457,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.46007745817478674,
      "val_pk_metric": 0.3969766484572647
    },
    {
      "epoch": 10,
      "train_loss": 0.5218856692314148,
      "train_chorus_rate": 0.4625260025262833,
      "train_max_prob": 0.6102653622627259,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5443095564842224,
      "val_macro_f1": 0.5961000529913533,
      "val_verse_f1": 0.6530348687042618,
      "val_chorus_f1": 0.5391652372784448,
      "val_chorus_rate": 0.5593987107276917,
      "val_max_prob": 0.6133164465427399,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.083682587613733e-05,
      "epoch_time": 91.31842684745789,
      "val_boundary_f1": 0.13048933500627352,
      "val_boundary_precision": 0.13941018766756033,
      "val_boundary_recall": 0.12264150943396226,
      "val_complete_segments": 0.048012452107279696,
      "val_avg_segment_overlap": 0.3627495837679444,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.47977765971795366,
      "val_pk_metric": 0.40899353218161
    },
    {
      "epoch": 11,
      "train_loss": 0.5030312865972519,
      "train_chorus_rate": 0.4043730884790421,
      "train_max_prob": 0.6204235970973968,
      "train_conf_over_90": 0.00019929205009248108,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5416588187217712,
      "val_macro_f1": 0.628717780502894,
      "val_verse_f1": 0.7032112906524852,
      "val_chorus_f1": 0.5542242703533027,
      "val_chorus_rate": 0.4996825009584427,
      "val_max_prob": 0.6208484768867493,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1131823221259182e-05,
      "epoch_time": 93.8625500202179,
      "val_boundary_f1": 0.15625,
      "val_boundary_precision": 0.15931372549019607,
      "val_boundary_recall": 0.15330188679245282,
      "val_complete_segments": 0.060883620689655166,
      "val_avg_segment_overlap": 0.4033629962784162,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.15656565656565657,
      "val_window_diff": 0.46425795262706443,
      "val_pk_metric": 0.3973148672036647
    },
    {
      "epoch": 12,
      "train_loss": 0.49317343831062316,
      "train_chorus_rate": 0.4486509203910828,
      "train_max_prob": 0.6355921745300293,
      "train_conf_over_90": 0.001757851504953578,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5429215133190155,
      "val_macro_f1": 0.6577573374912122,
      "val_verse_f1": 0.7537399309551208,
      "val_chorus_f1": 0.5617747440273038,
      "val_chorus_rate": 0.4198159724473953,
      "val_max_prob": 0.6228793859481812,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 112.51393795013428,
      "val_boundary_f1": 0.19431279620853084,
      "val_boundary_precision": 0.19523809523809524,
      "val_boundary_recall": 0.19339622641509435,
      "val_complete_segments": 0.07393438697318008,
      "val_avg_segment_overlap": 0.4495727386443483,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.4171263059228624,
      "val_pk_metric": 0.3557137287037556
    }
  ]
}