{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.2035961091991367,
      "layer_dropout": 0.22178195129913178,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.18737995636313973,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2715139,
      "lstm_params": 2154496,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005695395104215452,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "composite",
      "weight_decay": 0.017082874219027995,
      "gradient_clip_norm": 0.43581773448487726,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1202233696323481,
        "ece_after": 0.09431743557420369,
        "improvement": 0.02590593405814441,
        "params": {
          "temperature": 0.37165197450607385
        }
      },
      "platt": {
        "ece_before": 0.1202233696323481,
        "ece_after": 0.09107481082260957,
        "improvement": 0.02914855880973853,
        "params": {
          "A": 1.6190782321352861,
          "B": 4.258072572893722e-09
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6295588076114654,
      "train_chorus_rate": 0.47768560926779174,
      "train_max_prob": 0.6390298485755921,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6046904027462006,
      "val_macro_f1": 0.23068203287360667,
      "val_verse_f1": 0.0,
      "val_chorus_f1": 0.46136406574721334,
      "val_chorus_rate": 1.0,
      "val_max_prob": 0.5954238474369049,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005598532534017293,
      "epoch_time": 27.05659294128418,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.06144865862462465,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26503295450423625,
      "val_pk_metric": 0.2713936688312747
    },
    {
      "epoch": 2,
      "train_loss": 0.5786402583122253,
      "train_chorus_rate": 0.48149019652046265,
      "train_max_prob": 0.5562595009803772,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6000300347805023,
      "val_macro_f1": 0.3204063905021899,
      "val_verse_f1": 0.16202369516490553,
      "val_chorus_f1": 0.4787890858394742,
      "val_chorus_rate": 0.9332098364830017,
      "val_max_prob": 0.5753980278968811,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005314545847508855,
      "epoch_time": 30.068447828292847,
      "val_boundary_f1": 0.003642987249544627,
      "val_boundary_precision": 0.008,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.001736111111111111,
      "val_avg_segment_overlap": 0.12168837965615724,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.3875294018726273,
      "val_pk_metric": 0.3657053090539152
    },
    {
      "epoch": 3,
      "train_loss": 0.5760787606239319,
      "train_chorus_rate": 0.4220643687993288,
      "train_max_prob": 0.5529401361942291,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5973334610462189,
      "val_macro_f1": 0.3689775667148345,
      "val_verse_f1": 0.24794895168641748,
      "val_chorus_f1": 0.49000618174325156,
      "val_chorus_rate": 0.8919692039489746,
      "val_max_prob": 0.5708574056625366,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048627882680654975,
      "epoch_time": 34.36309814453125,
      "val_boundary_f1": 0.029143897996357016,
      "val_boundary_precision": 0.064,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.009039750957854406,
      "val_avg_segment_overlap": 0.1569709252203177,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.40658587919103173,
      "val_pk_metric": 0.39758845439411683
    },
    {
      "epoch": 4,
      "train_loss": 0.5598986387252808,
      "train_chorus_rate": 0.5894508704543113,
      "train_max_prob": 0.5575643241405487,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5964977741241455,
      "val_macro_f1": 0.43547749104095046,
      "val_verse_f1": 0.3987391646966115,
      "val_chorus_f1": 0.47221581738528934,
      "val_chorus_rate": 0.7653928697109222,
      "val_max_prob": 0.5673740804195404,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004274046328161589,
      "epoch_time": 36.391762018203735,
      "val_boundary_f1": 0.04701627486437613,
      "val_boundary_precision": 0.10077519379844961,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.014607279693486588,
      "val_avg_segment_overlap": 0.1948071071985402,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4584870503195022,
      "val_pk_metric": 0.46712065829636107
    },
    {
      "epoch": 5,
      "train_loss": 0.5714956879615783,
      "train_chorus_rate": 0.6345413416624069,
      "train_max_prob": 0.5668745040893555,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6016621887683868,
      "val_macro_f1": 0.4488314247489701,
      "val_verse_f1": 0.4309644670050762,
      "val_chorus_f1": 0.46669838249286394,
      "val_chorus_rate": 0.7327461242675781,
      "val_max_prob": 0.5686438381671906,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003588441818059521,
      "epoch_time": 28.01084280014038,
      "val_boundary_f1": 0.053859964093357277,
      "val_boundary_precision": 0.11278195488721804,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.01496647509578544,
      "val_avg_segment_overlap": 0.19477491755722864,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.45095574896321666,
      "val_pk_metric": 0.4632800117798791
    },
    {
      "epoch": 6,
      "train_loss": 0.5692918300628662,
      "train_chorus_rate": 0.6811240613460541,
      "train_max_prob": 0.559344756603241,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5965510606765747,
      "val_macro_f1": 0.5214162048386999,
      "val_verse_f1": 0.5658426966292135,
      "val_chorus_f1": 0.4769897130481862,
      "val_chorus_rate": 0.6073808670043945,
      "val_max_prob": 0.5677043497562408,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002852697552107726,
      "epoch_time": 26.80318021774292,
      "val_boundary_f1": 0.05576208178438662,
      "val_boundary_precision": 0.13157894736842105,
      "val_boundary_recall": 0.03537735849056604,
      "val_complete_segments": 0.05495689655172414,
      "val_avg_segment_overlap": 0.23035994214495079,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3220706523361524,
      "val_pk_metric": 0.3269043809142822
    },
    {
      "epoch": 7,
      "train_loss": 0.5606992483139038,
      "train_chorus_rate": 0.6081434398889541,
      "train_max_prob": 0.5650106728076935,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5988850891590118,
      "val_macro_f1": 0.5272428808254214,
      "val_verse_f1": 0.6272045408473547,
      "val_chorus_f1": 0.427281220803488,
      "val_chorus_rate": 0.48895740509033203,
      "val_max_prob": 0.5420520305633545,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021169532861559312,
      "epoch_time": 29.57041311264038,
      "val_boundary_f1": 0.05893186003683241,
      "val_boundary_precision": 0.13445378151260504,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.05148467432950191,
      "val_avg_segment_overlap": 0.22387046139323402,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.3118533567325946,
      "val_pk_metric": 0.3010082462521768
    },
    {
      "epoch": 8,
      "train_loss": 0.5758942067623138,
      "train_chorus_rate": 0.6217471987009049,
      "train_max_prob": 0.5639813184738159,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5941814482212067,
      "val_macro_f1": 0.4250912274273875,
      "val_verse_f1": 0.3693228175142779,
      "val_chorus_f1": 0.48085963734049697,
      "val_chorus_rate": 0.7974128127098083,
      "val_max_prob": 0.5797752141952515,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014313487760538634,
      "epoch_time": 28.466906309127808,
      "val_boundary_f1": 0.043321299638989175,
      "val_boundary_precision": 0.09230769230769231,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.012871168582375478,
      "val_avg_segment_overlap": 0.19027704286275704,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44740576176145275,
      "val_pk_metric": 0.4570407214952235
    }
  ]
}