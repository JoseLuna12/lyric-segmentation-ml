{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.17245424727799044,
      "layer_dropout": 0.39694321891601053,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.11140268407792936,
      "attention_dim": 128,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 730883,
      "lstm_params": 589824,
      "attention_params": 140545,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0005312620340594232,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.013911935884814437,
      "gradient_clip_norm": 0.4055708904458351,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09517550140560727,
        "ece_after": 0.012305341558512633,
        "improvement": 0.08287015984709463,
        "params": {
          "temperature": 0.5649057168495911
        }
      },
      "platt": {
        "ece_before": 0.09517550140560727,
        "ece_after": 0.030992231472653342,
        "improvement": 0.06418326993295392,
        "params": {
          "A": 1.5224931840457385,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5779734253883362,
      "train_chorus_rate": 0.5979855519835837,
      "train_max_prob": 0.5537334203720092,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.601711630821228,
      "val_macro_f1": 0.5315286788912004,
      "val_verse_f1": 0.6107960512497375,
      "val_chorus_f1": 0.45226130653266333,
      "val_chorus_rate": 0.5305684581398964,
      "val_max_prob": 0.5536657720804214,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005254682852174377,
      "epoch_time": 84.81042098999023,
      "val_boundary_f1": 0.04643449419568823,
      "val_boundary_precision": 0.0782122905027933,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.025335432387394212,
      "val_avg_segment_overlap": 0.23169115487702144,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.45644574608957056,
      "val_pk_metric": 0.4567140749732048
    },
    {
      "epoch": 2,
      "train_loss": 0.5633515387773513,
      "train_chorus_rate": 0.5734349802136421,
      "train_max_prob": 0.5753726810216904,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6153649538755417,
      "val_macro_f1": 0.5511596091367343,
      "val_verse_f1": 0.7750286744224152,
      "val_chorus_f1": 0.3272905438510534,
      "val_chorus_rate": 0.2014283835887909,
      "val_max_prob": 0.5818146914243698,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005083402533173677,
      "epoch_time": 94.8455171585083,
      "val_boundary_f1": 0.07307692307692307,
      "val_boundary_precision": 0.19791666666666666,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.06805396329521463,
      "val_avg_segment_overlap": 0.22647426121874406,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.30960543919916045,
      "val_pk_metric": 0.308947072956637
    },
    {
      "epoch": 3,
      "train_loss": 0.565821173787117,
      "train_chorus_rate": 0.4544792503118515,
      "train_max_prob": 0.582352003455162,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5930231362581253,
      "val_macro_f1": 0.5344697564126675,
      "val_verse_f1": 0.5853442550365288,
      "val_chorus_f1": 0.4835952577888062,
      "val_chorus_rate": 0.5920961946249008,
      "val_max_prob": 0.5537494570016861,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004806265155426619,
      "epoch_time": 95.75541973114014,
      "val_boundary_f1": 0.06988352745424294,
      "val_boundary_precision": 0.11864406779661017,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.029203430820610034,
      "val_avg_segment_overlap": 0.23326986031288321,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.433789402269694,
      "val_pk_metric": 0.43511571956337525
    },
    {
      "epoch": 4,
      "train_loss": 0.5478211760520935,
      "train_chorus_rate": 0.5693996101617813,
      "train_max_prob": 0.5915595233440399,
      "train_conf_over_90": 0.00019178311922587454,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5981486588716507,
      "val_macro_f1": 0.6209630690667289,
      "val_verse_f1": 0.7605886575735822,
      "val_chorus_f1": 0.4813374805598756,
      "val_chorus_rate": 0.33280646055936813,
      "val_max_prob": 0.5880803167819977,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044353829521934327,
      "epoch_time": 133.00516414642334,
      "val_boundary_f1": 0.1527165932452276,
      "val_boundary_precision": 0.20233463035019456,
      "val_boundary_recall": 0.12264150943396226,
      "val_complete_segments": 0.07573860976565112,
      "val_avg_segment_overlap": 0.3462297559351365,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.1111111111111111,
      "val_window_diff": 0.3573328624118549,
      "val_pk_metric": 0.3394629836341844
    },
    {
      "epoch": 5,
      "train_loss": 0.5514942958950997,
      "train_chorus_rate": 0.5134842291474342,
      "train_max_prob": 0.6046275556087494,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5741212218999863,
      "val_macro_f1": 0.6276289675062681,
      "val_verse_f1": 0.701883701883702,
      "val_chorus_f1": 0.5533742331288343,
      "val_chorus_rate": 0.5028641149401665,
      "val_max_prob": 0.5969942659139633,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00039869652554456737,
      "epoch_time": 109.5030882358551,
      "val_boundary_f1": 0.1619631901840491,
      "val_boundary_precision": 0.16879795396419436,
      "val_boundary_recall": 0.15566037735849056,
      "val_complete_segments": 0.04624319820502217,
      "val_avg_segment_overlap": 0.40380618293676124,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.15656565656565657,
      "val_window_diff": 0.473927430194928,
      "val_pk_metric": 0.4115247435927699
    },
    {
      "epoch": 6,
      "train_loss": 0.5224231615662575,
      "train_chorus_rate": 0.45697489827871324,
      "train_max_prob": 0.6394376188516617,
      "train_conf_over_90": 0.004739011015044525,
      "train_conf_over_95": 3.19488812237978e-05,
      "val_loss": 0.562147319316864,
      "val_macro_f1": 0.7191586843180462,
      "val_verse_f1": 0.8353022932592078,
      "val_chorus_f1": 0.6030150753768845,
      "val_chorus_rate": 0.2878829650580883,
      "val_max_prob": 0.6405289620161057,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034806100702780606,
      "epoch_time": 127.63040208816528,
      "val_boundary_f1": 0.3182844243792325,
      "val_boundary_precision": 0.3051948051948052,
      "val_boundary_recall": 0.33254716981132076,
      "val_complete_segments": 0.16799607894517757,
      "val_avg_segment_overlap": 0.5533775350147819,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.32266054904030417,
      "val_pk_metric": 0.27208521203059033
    },
    {
      "epoch": 7,
      "train_loss": 0.5190164014697075,
      "train_chorus_rate": 0.40637810006737707,
      "train_max_prob": 0.6509950250387192,
      "train_conf_over_90": 0.004505874941241927,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5382213816046715,
      "val_macro_f1": 0.6710279898218829,
      "val_verse_f1": 0.746,
      "val_chorus_f1": 0.596055979643766,
      "val_chorus_rate": 0.4732964262366295,
      "val_max_prob": 0.6412612497806549,
      "val_conf_over_90": 0.00319543230580166,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002938447548044174,
      "epoch_time": 102.14040994644165,
      "val_boundary_f1": 0.25120772946859904,
      "val_boundary_precision": 0.2127659574468085,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.11316564443552779,
      "val_avg_segment_overlap": 0.5631161046717753,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.489914945960345,
      "val_pk_metric": 0.37731739073533
    },
    {
      "epoch": 8,
      "train_loss": 0.5163935869932175,
      "train_chorus_rate": 0.38328041061758994,
      "train_max_prob": 0.6515363216400146,
      "train_conf_over_90": 0.003980597099871375,
      "train_conf_over_95": 0.00028918157331645487,
      "val_loss": 0.5362346172332764,
      "val_macro_f1": 0.6594112784585626,
      "val_verse_f1": 0.7271609995903319,
      "val_chorus_f1": 0.5916615573267934,
      "val_chorus_rate": 0.5022610574960709,
      "val_max_prob": 0.6516500562429428,
      "val_conf_over_90": 0.0034266996663063765,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002384172792550058,
      "epoch_time": 105.22110605239868,
      "val_boundary_f1": 0.20164609053497942,
      "val_boundary_precision": 0.17883211678832117,
      "val_boundary_recall": 0.23113207547169812,
      "val_complete_segments": 0.08517967861817279,
      "val_avg_segment_overlap": 0.5363401663977279,
      "val_verse_to_chorus_acc": 0.18141592920353983,
      "val_chorus_to_verse_acc": 0.2777777777777778,
      "val_window_diff": 0.4903328342461438,
      "val_pk_metric": 0.40940556229000935
    },
    {
      "epoch": 9,
      "train_loss": 0.5150977730751037,
      "train_chorus_rate": 0.42178005874156954,
      "train_max_prob": 0.6571276426315308,
      "train_conf_over_90": 0.009560672380030156,
      "train_conf_over_95": 0.0002643511921633035,
      "val_loss": 0.5327227413654327,
      "val_macro_f1": 0.6864790763529293,
      "val_verse_f1": 0.7686320295777388,
      "val_chorus_f1": 0.6043261231281197,
      "val_chorus_rate": 0.4392184391617775,
      "val_max_prob": 0.6485217809677124,
      "val_conf_over_90": 0.0040193149470724165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018420102703161712,
      "epoch_time": 96.24487209320068,
      "val_boundary_f1": 0.26503759398496246,
      "val_boundary_precision": 0.2203125,
      "val_boundary_recall": 0.33254716981132076,
      "val_complete_segments": 0.131231822642215,
      "val_avg_segment_overlap": 0.5866658044829597,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4758491064740172,
      "val_pk_metric": 0.3650513436852089
    },
    {
      "epoch": 10,
      "train_loss": 0.5124196127057076,
      "train_chorus_rate": 0.4234083220362663,
      "train_max_prob": 0.6587878346443177,
      "train_conf_over_90": 0.01169106196030043,
      "train_conf_over_95": 0.00021727914281655103,
      "val_loss": 0.5331843197345734,
      "val_macro_f1": 0.729194188667162,
      "val_verse_f1": 0.8224333211545488,
      "val_chorus_f1": 0.6359550561797752,
      "val_chorus_rate": 0.35696084797382355,
      "val_max_prob": 0.6716282963752747,
      "val_conf_over_90": 0.0052103151683695614,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013356550851485583,
      "epoch_time": 65.71294403076172,
      "val_boundary_f1": 0.3468208092485549,
      "val_boundary_precision": 0.2931596091205212,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.20936875179982284,
      "val_avg_segment_overlap": 0.6341674362773455,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39990523477435125,
      "val_pk_metric": 0.3001898251449797
    },
    {
      "epoch": 11,
      "train_loss": 0.4989226371049881,
      "train_chorus_rate": 0.40050514340400695,
      "train_max_prob": 0.6619283378124237,
      "train_conf_over_90": 0.012426377812516876,
      "train_conf_over_95": 0.0003463799104792997,
      "val_loss": 0.5329468622803688,
      "val_macro_f1": 0.6836779241871302,
      "val_verse_f1": 0.7600395647873393,
      "val_chorus_f1": 0.6073162835869214,
      "val_chorus_rate": 0.4595911279320717,
      "val_max_prob": 0.6861473023891449,
      "val_conf_over_90": 0.019360370002686977,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 8.872373884007998e-05,
      "epoch_time": 92.82970094680786,
      "val_boundary_f1": 0.22653061224489798,
      "val_boundary_precision": 0.19964028776978418,
      "val_boundary_recall": 0.2617924528301887,
      "val_complete_segments": 0.09830627286883914,
      "val_avg_segment_overlap": 0.5648378814657644,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.47007176970772724,
      "val_pk_metric": 0.37296984631487023
    },
    {
      "epoch": 12,
      "train_loss": 0.49852497428655623,
      "train_chorus_rate": 0.38838359117507937,
      "train_max_prob": 0.6772462964057923,
      "train_conf_over_90": 0.016810234170407057,
      "train_conf_over_95": 0.00039412760233972224,
      "val_loss": 0.5273564606904984,
      "val_macro_f1": 0.725346915455092,
      "val_verse_f1": 0.8169429097605894,
      "val_chorus_f1": 0.6337509211495947,
      "val_chorus_rate": 0.36815421283245087,
      "val_max_prob": 0.666866198182106,
      "val_conf_over_90": 0.007114742766134441,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.163551851676132e-05,
      "epoch_time": 506.94987297058105,
      "val_boundary_f1": 0.33493743984600577,
      "val_boundary_precision": 0.28292682926829266,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.20679785413348512,
      "val_avg_segment_overlap": 0.6282542365023487,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3891646851819488,
      "val_pk_metric": 0.28812543264974994
    },
    {
      "epoch": 13,
      "train_loss": 0.49302868247032167,
      "train_chorus_rate": 0.3653562530875206,
      "train_max_prob": 0.6707527458667755,
      "train_conf_over_90": 0.014418125269003212,
      "train_conf_over_95": 0.0003362079412909225,
      "val_loss": 0.5276497527956963,
      "val_macro_f1": 0.7086971238378255,
      "val_verse_f1": 0.7894635646990963,
      "val_chorus_f1": 0.6279306829765546,
      "val_chorus_rate": 0.42419496923685074,
      "val_max_prob": 0.6862452775239944,
      "val_conf_over_90": 0.020726235816255212,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 2.3921780742055476e-05,
      "epoch_time": 1877.704777956009,
      "val_boundary_f1": 0.28007889546351084,
      "val_boundary_precision": 0.24067796610169492,
      "val_boundary_recall": 0.33490566037735847,
      "val_complete_segments": 0.15651349918317045,
      "val_avg_segment_overlap": 0.608267171327442,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4419523218949217,
      "val_pk_metric": 0.3379783869674482
    },
    {
      "epoch": 14,
      "train_loss": 0.49564396440982816,
      "train_chorus_rate": 0.40614307671785355,
      "train_max_prob": 0.6833692997694015,
      "train_conf_over_90": 0.02861693543381989,
      "train_conf_over_95": 0.001383949865703471,
      "val_loss": 0.5267188027501106,
      "val_macro_f1": 0.7164053747526102,
      "val_verse_f1": 0.7989347536617842,
      "val_chorus_f1": 0.6338759958434361,
      "val_chorus_rate": 0.4104257598519325,
      "val_max_prob": 0.6835549622774124,
      "val_conf_over_90": 0.017540927045047283,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 6.79374884198542e-06,
      "epoch_time": 1879.7932538986206,
      "val_boundary_f1": 0.2984189723320158,
      "val_boundary_precision": 0.2568027210884354,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.17660520314284897,
      "val_avg_segment_overlap": 0.6159665667262444,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4243076340953244,
      "val_pk_metric": 0.3225872105802569
    },
    {
      "epoch": 15,
      "train_loss": 0.49523026794195174,
      "train_chorus_rate": 0.3935844823718071,
      "train_max_prob": 0.681845822930336,
      "train_conf_over_90": 0.02217771578580141,
      "train_conf_over_95": 0.000916905963094905,
      "val_loss": 0.5272737890481949,
      "val_macro_f1": 0.7191858642962744,
      "val_verse_f1": 0.8032508032508032,
      "val_chorus_f1": 0.6351209253417456,
      "val_chorus_rate": 0.4021199941635132,
      "val_max_prob": 0.6865705251693726,
      "val_conf_over_90": 0.017309659626334906,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1e-06,
      "epoch_time": 79.12745332717896,
      "val_boundary_f1": 0.3028515240904621,
      "val_boundary_precision": 0.2596964586846543,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.18380181613214486,
      "val_avg_segment_overlap": 0.6194449614861594,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.41937215178845977,
      "val_pk_metric": 0.31454735690270275
    }
  ]
}