{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.17341813585688834,
      "layer_dropout": 0.0,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 219650,
      "lstm_params": 219136,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007708342954226108,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 6,
      "validation_strategy": "composite",
      "weight_decay": 0.009642815391662002,
      "gradient_clip_norm": 0.6240260991284059,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10112664981768969,
        "ece_after": 0.04347252450546722,
        "improvement": 0.05765412531222247,
        "params": {
          "temperature": 0.5361101277447121
        }
      },
      "platt": {
        "ece_before": 0.10112664981768969,
        "ece_after": 0.06501317600955664,
        "improvement": 0.036113473808133054,
        "params": {
          "A": 1.382643762419264,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5338949412107468,
      "train_chorus_rate": 0.570561826787889,
      "train_max_prob": 0.5412052989006042,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5475144684314728,
      "val_macro_f1": 0.6036802681358351,
      "val_verse_f1": 0.6997430322198063,
      "val_chorus_f1": 0.5076175040518638,
      "val_chorus_rate": 0.4580203667283058,
      "val_max_prob": 0.5439674556255341,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007624229322264187,
      "epoch_time": 1654.9319188594818,
      "val_boundary_f1": 0.2280701754385965,
      "val_boundary_precision": 0.21311475409836064,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.07814591974189006,
      "val_avg_segment_overlap": 0.3796167316798326,
      "val_verse_to_chorus_acc": 0.1902654867256637,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.46092149132483295,
      "val_pk_metric": 0.4196381979525122
    },
    {
      "epoch": 2,
      "train_loss": 0.5266813635826111,
      "train_chorus_rate": 0.5219824194908143,
      "train_max_prob": 0.5592871516942978,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5288471281528473,
      "val_macro_f1": 0.5349919872447433,
      "val_verse_f1": 0.5273408239700375,
      "val_chorus_f1": 0.5426431505194491,
      "val_chorus_rate": 0.7173747420310974,
      "val_max_prob": 0.5819543451070786,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007375564595717144,
      "epoch_time": 1145.9331510066986,
      "val_boundary_f1": 0.15354713313896987,
      "val_boundary_precision": 0.1305785123966942,
      "val_boundary_recall": 0.18632075471698112,
      "val_complete_segments": 0.054487103373635715,
      "val_avg_segment_overlap": 0.3561282131224417,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.4918836586109852,
      "val_pk_metric": 0.3996710236657828
    },
    {
      "epoch": 3,
      "train_loss": 0.5058394104242325,
      "train_chorus_rate": 0.5207781508564949,
      "train_max_prob": 0.5991514384746551,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.512478306889534,
      "val_macro_f1": 0.6996266977581411,
      "val_verse_f1": 0.7710317460317461,
      "val_chorus_f1": 0.6282216494845361,
      "val_chorus_rate": 0.46351274102926254,
      "val_max_prob": 0.6156183183193207,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006973216616360834,
      "epoch_time": 117.05055117607117,
      "val_boundary_f1": 0.3066666666666667,
      "val_boundary_precision": 0.23711340206185566,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.18589667344969574,
      "val_avg_segment_overlap": 0.5847687045889156,
      "val_verse_to_chorus_acc": 0.35398230088495575,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.45737006314925965,
      "val_pk_metric": 0.33615498538506516
    },
    {
      "epoch": 4,
      "train_loss": 0.49647135436534884,
      "train_chorus_rate": 0.43182463198900223,
      "train_max_prob": 0.6251265525817871,
      "train_conf_over_90": 0.0007030450564343482,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5086852461099625,
      "val_macro_f1": 0.6619631443248739,
      "val_verse_f1": 0.7122702009405729,
      "val_chorus_f1": 0.6116560877091749,
      "val_chorus_rate": 0.551912322640419,
      "val_max_prob": 0.6187151819467545,
      "val_conf_over_90": 0.0014072294579818845,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006434769921572934,
      "epoch_time": 99.74838399887085,
      "val_boundary_f1": 0.2504288164665523,
      "val_boundary_precision": 0.1967654986522911,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.11815816536124066,
      "val_avg_segment_overlap": 0.5297255430790697,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.4845177928301293,
      "val_pk_metric": 0.36128858709046885
    },
    {
      "epoch": 5,
      "train_loss": 0.4913162633776665,
      "train_chorus_rate": 0.41462877914309504,
      "train_max_prob": 0.6303821593523026,
      "train_conf_over_90": 0.0010424305277410895,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5065267235040665,
      "val_macro_f1": 0.658092837676389,
      "val_verse_f1": 0.706792777300086,
      "val_chorus_f1": 0.6093928980526919,
      "val_chorus_rate": 0.5581718981266022,
      "val_max_prob": 0.6291613429784775,
      "val_conf_over_90": 0.002367272216361016,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005783757215669581,
      "epoch_time": 109.67901420593262,
      "val_boundary_f1": 0.24247491638795987,
      "val_boundary_precision": 0.1878238341968912,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.1366900797176513,
      "val_avg_segment_overlap": 0.5392482301206583,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.490309606227886,
      "val_pk_metric": 0.3663990048834598
    },
    {
      "epoch": 6,
      "train_loss": 0.48353114575147627,
      "train_chorus_rate": 0.43176618665456773,
      "train_max_prob": 0.6349828034639359,
      "train_conf_over_90": 0.002952946414006874,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5051527097821236,
      "val_macro_f1": 0.6618164402193143,
      "val_verse_f1": 0.7187894073139977,
      "val_chorus_f1": 0.6048434731246308,
      "val_chorus_rate": 0.5321655869483948,
      "val_max_prob": 0.6334143131971359,
      "val_conf_over_90": 0.002884405548684299,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005048630877804307,
      "epoch_time": 115.8851158618927,
      "val_boundary_f1": 0.25263157894736843,
      "val_boundary_precision": 0.2011173184357542,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.10983503386737746,
      "val_avg_segment_overlap": 0.5483510465860648,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.4749862986331749,
      "val_pk_metric": 0.3598224732846081
    }
  ]
}