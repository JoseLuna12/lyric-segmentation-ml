{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.27753127081919693,
      "layer_dropout": 0.37039352968512945,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 553474,
      "lstm_params": 552960,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00010307245765631671,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "line_f1",
      "weight_decay": 0.010455332516352094,
      "gradient_clip_norm": 0.4475011224069123,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09261200317933654,
        "ece_after": 0.06169262450839778,
        "improvement": 0.030919378670938767,
        "params": {
          "temperature": 0.2687292640974935
        }
      },
      "platt": {
        "ece_before": 0.09261200317933654,
        "ece_after": 0.08822326253814172,
        "improvement": 0.0043887406411948215,
        "params": {
          "A": 1.4999998317255911,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5513248682022095,
      "train_chorus_rate": 0.7468223094940185,
      "train_max_prob": 0.5224428951740265,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5614595115184784,
      "val_macro_f1": 0.46900048373224157,
      "val_verse_f1": 0.46352357320099263,
      "val_chorus_f1": 0.4744773942634905,
      "val_chorus_rate": 0.7104341685771942,
      "val_max_prob": 0.5297060012817383,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.918755605905636e-05,
      "epoch_time": 67.79913425445557,
      "val_boundary_f1": 0.04744525547445255,
      "val_boundary_precision": 0.10483870967741936,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.010955459770114941,
      "val_avg_segment_overlap": 0.19778668130338217,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4073252536636385,
      "val_pk_metric": 0.40232403442072195
    },
    {
      "epoch": 2,
      "train_loss": 0.5339482069015503,
      "train_chorus_rate": 0.43198966085910795,
      "train_max_prob": 0.5342195391654968,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5654822885990143,
      "val_macro_f1": 0.5317050770199704,
      "val_verse_f1": 0.6794847862609669,
      "val_chorus_f1": 0.38392536777897385,
      "val_chorus_rate": 0.3845318704843521,
      "val_max_prob": 0.5323593318462372,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.812429231873749e-05,
      "epoch_time": 73.31826186180115,
      "val_boundary_f1": 0.05828779599271403,
      "val_boundary_precision": 0.128,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.0,
      "val_avg_segment_overlap": 0.2107419434806379,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.469492424081158,
      "val_pk_metric": 0.49408609037996976
    },
    {
      "epoch": 3,
      "train_loss": 0.5393116861581803,
      "train_chorus_rate": 0.4586798667907715,
      "train_max_prob": 0.5358286738395691,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5608408749103546,
      "val_macro_f1": 0.4805188409960183,
      "val_verse_f1": 0.4935313847628175,
      "val_chorus_f1": 0.46750629722921916,
      "val_chorus_rate": 0.6751573085784912,
      "val_max_prob": 0.5323364436626434,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.156694805108814e-05,
      "epoch_time": 99.55339288711548,
      "val_boundary_f1": 0.04735883424408014,
      "val_boundary_precision": 0.104,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.012691570881226053,
      "val_avg_segment_overlap": 0.20507169170222322,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4537925379637462,
      "val_pk_metric": 0.45621762365670837
    },
    {
      "epoch": 4,
      "train_loss": 0.5406421422958374,
      "train_chorus_rate": 0.5833320915699005,
      "train_max_prob": 0.540232264995575,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5624206960201263,
      "val_macro_f1": 0.5022163375881086,
      "val_verse_f1": 0.5450022614201719,
      "val_chorus_f1": 0.4594304137560451,
      "val_chorus_rate": 0.6140220761299133,
      "val_max_prob": 0.5381438434123993,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.2036228828158354e-05,
      "epoch_time": 85.34069490432739,
      "val_boundary_f1": 0.05100182149362477,
      "val_boundary_precision": 0.112,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.01825909961685824,
      "val_avg_segment_overlap": 0.20644732975945335,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4559973962674431,
      "val_pk_metric": 0.46277011637605636
    },
    {
      "epoch": 5,
      "train_loss": 0.531764829158783,
      "train_chorus_rate": 0.5220009297132492,
      "train_max_prob": 0.552567970752716,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5642806887626648,
      "val_macro_f1": 0.5193863385438713,
      "val_verse_f1": 0.5906757912745938,
      "val_chorus_f1": 0.44809688581314877,
      "val_chorus_rate": 0.5515715181827545,
      "val_max_prob": 0.5426964163780212,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.2505509605228575e-05,
      "epoch_time": 90.20395016670227,
      "val_boundary_f1": 0.04044117647058823,
      "val_boundary_precision": 0.09166666666666666,
      "val_boundary_recall": 0.025943396226415096,
      "val_complete_segments": 0.00748323754789272,
      "val_avg_segment_overlap": 0.2072604348381521,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.45775603056864417,
      "val_pk_metric": 0.47082118034874854
    },
    {
      "epoch": 6,
      "train_loss": 0.5382904231548309,
      "train_chorus_rate": 0.5387055277824402,
      "train_max_prob": 0.5526549994945527,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5619094669818878,
      "val_macro_f1": 0.4912409214450082,
      "val_verse_f1": 0.5201022542412271,
      "val_chorus_f1": 0.4623795886487893,
      "val_chorus_rate": 0.6434311866760254,
      "val_max_prob": 0.5444332659244537,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.594816533757922e-05,
      "epoch_time": 64.15106201171875,
      "val_boundary_f1": 0.05090909090909091,
      "val_boundary_precision": 0.1111111111111111,
      "val_boundary_recall": 0.0330188679245283,
      "val_complete_segments": 0.013050766283524903,
      "val_avg_segment_overlap": 0.2044778409479437,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4663496577961141,
      "val_pk_metric": 0.4776809356458724
    },
    {
      "epoch": 7,
      "train_loss": 0.5404088199138641,
      "train_chorus_rate": 0.6409702181816102,
      "train_max_prob": 0.5555557906627655,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5616663694381714,
      "val_macro_f1": 0.4947950470886251,
      "val_verse_f1": 0.5266805266805267,
      "val_chorus_f1": 0.4629095674967235,
      "val_chorus_rate": 0.6370380222797394,
      "val_max_prob": 0.5441884696483612,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.884901597260359e-06,
      "epoch_time": 74.32079005241394,
      "val_boundary_f1": 0.03272727272727272,
      "val_boundary_precision": 0.07142857142857142,
      "val_boundary_recall": 0.02122641509433962,
      "val_complete_segments": 0.009219348659003831,
      "val_avg_segment_overlap": 0.20491865205137316,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4686292408260846,
      "val_pk_metric": 0.4823964392198204
    },
    {
      "epoch": 8,
      "train_loss": 0.5294812351465226,
      "train_chorus_rate": 0.5813533425331116,
      "train_max_prob": 0.5599453806877136,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5617168247699738,
      "val_macro_f1": 0.49637379157947387,
      "val_verse_f1": 0.531127957730301,
      "val_chorus_f1": 0.46161962542864676,
      "val_chorus_rate": 0.6311553120613098,
      "val_max_prob": 0.544400155544281,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 85.50650024414062,
      "val_boundary_f1": 0.03636363636363637,
      "val_boundary_precision": 0.07936507936507936,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.009219348659003831,
      "val_avg_segment_overlap": 0.20511939502970952,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.4681759926321571,
      "val_pk_metric": 0.4815327993348101
    }
  ]
}