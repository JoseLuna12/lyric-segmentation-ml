{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.15546104535241762,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.19265291704223497,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0006810683268704416,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01922643029220703,
      "gradient_clip_norm": 0.32189236313726177,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0731466554237021,
        "ece_after": 0.023388994392922434,
        "improvement": 0.04975766103077967,
        "params": {
          "temperature": 0.6902929031324494
        }
      },
      "platt": {
        "ece_before": 0.0731466554237021,
        "ece_after": 0.15882185394262754,
        "improvement": -0.08567519851892544,
        "params": {
          "A": 0.49999952906629525,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5589473634958267,
      "train_chorus_rate": 0.3988275730982423,
      "train_max_prob": 0.5954469054937362,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5751999616622925,
      "val_macro_f1": 0.41804128806623275,
      "val_verse_f1": 0.3475831237775915,
      "val_chorus_f1": 0.48849945235487396,
      "val_chorus_rate": 0.8212843984365463,
      "val_max_prob": 0.6025830954313278,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006736377645669087,
      "epoch_time": 65.09101581573486,
      "val_boundary_f1": 0.05765765765765766,
      "val_boundary_precision": 0.12213740458015267,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.023672123115389285,
      "val_avg_segment_overlap": 0.19215921337526998,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43702882279537103,
      "val_pk_metric": 0.43898555068310957
    },
    {
      "epoch": 2,
      "train_loss": 0.5373142018914223,
      "train_chorus_rate": 0.471479033306241,
      "train_max_prob": 0.5897603988647461,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5798305869102478,
      "val_macro_f1": 0.6099475186008902,
      "val_verse_f1": 0.8047821814608581,
      "val_chorus_f1": 0.4151128557409225,
      "val_chorus_rate": 0.20144490525126457,
      "val_max_prob": 0.5931585431098938,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006516708288847685,
      "epoch_time": 60.41538691520691,
      "val_boundary_f1": 0.24435590969455512,
      "val_boundary_precision": 0.2796352583586626,
      "val_boundary_recall": 0.2169811320754717,
      "val_complete_segments": 0.09182761006727073,
      "val_avg_segment_overlap": 0.3613574061581082,
      "val_verse_to_chorus_acc": 0.18141592920353983,
      "val_chorus_to_verse_acc": 0.1919191919191919,
      "val_window_diff": 0.4008928150539903,
      "val_pk_metric": 0.3572773728169316
    },
    {
      "epoch": 3,
      "train_loss": 0.5207809776067733,
      "train_chorus_rate": 0.41922769173979757,
      "train_max_prob": 0.6155420660972595,
      "train_conf_over_90": 0.0032365466468036175,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5464369505643845,
      "val_macro_f1": 0.6949840485093324,
      "val_verse_f1": 0.7999269139411658,
      "val_chorus_f1": 0.590041183077499,
      "val_chorus_rate": 0.3579314947128296,
      "val_max_prob": 0.6597595661878586,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006161275803223828,
      "epoch_time": 53.31546759605408,
      "val_boundary_f1": 0.32359081419624214,
      "val_boundary_precision": 0.2902621722846442,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.19708609533636046,
      "val_avg_segment_overlap": 0.5366707061299169,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.38265489460411944,
      "val_pk_metric": 0.3041790942209501
    },
    {
      "epoch": 4,
      "train_loss": 0.4986871376633644,
      "train_chorus_rate": 0.37616344913840294,
      "train_max_prob": 0.6605268478393554,
      "train_conf_over_90": 0.00989973351242952,
      "train_conf_over_95": 0.00014725282380823046,
      "val_loss": 0.524091824889183,
      "val_macro_f1": 0.6441149981039059,
      "val_verse_f1": 0.6979522184300341,
      "val_chorus_f1": 0.5902777777777778,
      "val_chorus_rate": 0.549717091023922,
      "val_max_prob": 0.6898874789476395,
      "val_conf_over_90": 0.05033890809863806,
      "val_conf_over_95": 0.00679912866326049,
      "learning_rate": 0.0005685614293973572,
      "epoch_time": 54.13101315498352,
      "val_boundary_f1": 0.2620423892100192,
      "val_boundary_precision": 0.22149837133550487,
      "val_boundary_recall": 0.32075471698113206,
      "val_complete_segments": 0.17632021697504202,
      "val_avg_segment_overlap": 0.5222789763454264,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.30303030303030304,
      "val_window_diff": 0.4524096896204801,
      "val_pk_metric": 0.34223666567327904
    },
    {
      "epoch": 5,
      "train_loss": 0.5087915495038032,
      "train_chorus_rate": 0.42141680121421815,
      "train_max_prob": 0.6833797097206116,
      "train_conf_over_90": 0.027338854849222115,
      "train_conf_over_95": 0.0015155083732679487,
      "val_loss": 0.5391570329666138,
      "val_macro_f1": 0.727411782505515,
      "val_verse_f1": 0.8554720133667502,
      "val_chorus_f1": 0.5993515516442798,
      "val_chorus_rate": 0.23136399686336517,
      "val_max_prob": 0.6916843354701996,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005110512451528312,
      "epoch_time": 46.87330102920532,
      "val_boundary_f1": 0.35922330097087374,
      "val_boundary_precision": 0.30528052805280526,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.23888146213172723,
      "val_avg_segment_overlap": 0.603601401845923,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.35421908401367197,
      "val_pk_metric": 0.2649296675315296
    },
    {
      "epoch": 6,
      "train_loss": 0.48313445746898653,
      "train_chorus_rate": 0.3444913372397423,
      "train_max_prob": 0.6657272398471832,
      "train_conf_over_90": 0.005549149634316563,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5035803914070129,
      "val_macro_f1": 0.6930635519117928,
      "val_verse_f1": 0.7573604060913706,
      "val_chorus_f1": 0.628766697732215,
      "val_chorus_rate": 0.4918094426393509,
      "val_max_prob": 0.6562555134296417,
      "val_conf_over_90": 0.009557187149766833,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044611049860477243,
      "epoch_time": 59.786771059036255,
      "val_boundary_f1": 0.28347996089931576,
      "val_boundary_precision": 0.24207011686143573,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.15204106735124762,
      "val_avg_segment_overlap": 0.5851469826990322,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4362012949909427,
      "val_pk_metric": 0.34181870521095314
    },
    {
      "epoch": 7,
      "train_loss": 0.48351758271455764,
      "train_chorus_rate": 0.35594484210014343,
      "train_max_prob": 0.696022430062294,
      "train_conf_over_90": 0.019899997394531965,
      "train_conf_over_95": 0.0009143874165602028,
      "val_loss": 0.5251532718539238,
      "val_macro_f1": 0.7372314493816616,
      "val_verse_f1": 0.8528057308545113,
      "val_chorus_f1": 0.6216571679088119,
      "val_chorus_rate": 0.26185115799307823,
      "val_max_prob": 0.6913832873106003,
      "val_conf_over_90": 0.0016538447234779596,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003765774119976066,
      "epoch_time": 56.92871975898743,
      "val_boundary_f1": 0.40812379110251445,
      "val_boundary_precision": 0.34590163934426227,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3008480321709378,
      "val_avg_segment_overlap": 0.6227833545270048,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.34900627504553533,
      "val_pk_metric": 0.2580080792928257
    },
    {
      "epoch": 8,
      "train_loss": 0.4724570482969284,
      "train_chorus_rate": 0.38959360793232917,
      "train_max_prob": 0.6781589478254318,
      "train_conf_over_90": 0.015028666355647147,
      "train_conf_over_95": 0.00026279420126229525,
      "val_loss": 0.5152232125401497,
      "val_macro_f1": 0.7479172464836913,
      "val_verse_f1": 0.8628773823579018,
      "val_chorus_f1": 0.6329571106094808,
      "val_chorus_rate": 0.2451946996152401,
      "val_max_prob": 0.6819199770689011,
      "val_conf_over_90": 0.0009348820603918284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030549091487283515,
      "epoch_time": 64.33958411216736,
      "val_boundary_f1": 0.3875502008032129,
      "val_boundary_precision": 0.3374125874125874,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2741149818959999,
      "val_avg_segment_overlap": 0.6224504995936238,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.3240084570384014,
      "val_pk_metric": 0.24588782270010384
    },
    {
      "epoch": 9,
      "train_loss": 0.4854485481977463,
      "train_chorus_rate": 0.3655757144093513,
      "train_max_prob": 0.6781791180372239,
      "train_conf_over_90": 0.01830806927755475,
      "train_conf_over_95": 0.00011083357967436313,
      "val_loss": 0.5151610225439072,
      "val_macro_f1": 0.7468607966537981,
      "val_verse_f1": 0.8610594009138602,
      "val_chorus_f1": 0.6326621923937361,
      "val_chorus_rate": 0.2500566728413105,
      "val_max_prob": 0.6748747229576111,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023595782826566928,
      "epoch_time": 49.22136211395264,
      "val_boundary_f1": 0.4127290260366442,
      "val_boundary_precision": 0.34910277324632955,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.30322587964422537,
      "val_avg_segment_overlap": 0.6338393994808855,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3386484329428221,
      "val_pk_metric": 0.25022111419034404
    },
    {
      "epoch": 10,
      "train_loss": 0.4711684718728065,
      "train_chorus_rate": 0.3500730372965336,
      "train_max_prob": 0.6904410481452942,
      "train_conf_over_90": 0.018015619798097758,
      "train_conf_over_95": 0.000166279636323452,
      "val_loss": 0.4866402819752693,
      "val_macro_f1": 0.7416858727729007,
      "val_verse_f1": 0.8204742190440346,
      "val_chorus_f1": 0.6628975265017667,
      "val_chorus_rate": 0.3959513455629349,
      "val_max_prob": 0.6861195266246796,
      "val_conf_over_90": 0.011250282463151962,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001710170817176105,
      "epoch_time": 46.688727140426636,
      "val_boundary_f1": 0.39399624765478425,
      "val_boundary_precision": 0.32710280373831774,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.29925995720004206,
      "val_avg_segment_overlap": 0.6625555526159319,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3958608254712219,
      "val_pk_metric": 0.2848047893598779
    },
    {
      "epoch": 11,
      "train_loss": 0.4629974991083145,
      "train_chorus_rate": 0.33744345903396605,
      "train_max_prob": 0.6915929257869721,
      "train_conf_over_90": 0.01064249052433297,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48902343958616257,
      "val_macro_f1": 0.7465357807074182,
      "val_verse_f1": 0.8293224731580897,
      "val_chorus_f1": 0.6637490882567468,
      "val_chorus_rate": 0.37468402087688446,
      "val_max_prob": 0.7134199887514114,
      "val_conf_over_90": 0.020012480788864195,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011350689747308452,
      "epoch_time": 58.621514081954956,
      "val_boundary_f1": 0.4063670411985019,
      "val_boundary_precision": 0.33695652173913043,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.2897087835449447,
      "val_avg_segment_overlap": 0.6599439852163855,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3881204316591892,
      "val_pk_metric": 0.2708947606686853
    },
    {
      "epoch": 12,
      "train_loss": 0.46715419739484787,
      "train_chorus_rate": 0.39689937233924866,
      "train_max_prob": 0.6993627637624741,
      "train_conf_over_90": 0.017978396057151257,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48362863063812256,
      "val_macro_f1": 0.7399991556906451,
      "val_verse_f1": 0.8161094224924013,
      "val_chorus_f1": 0.663888888888889,
      "val_chorus_rate": 0.4084940180182457,
      "val_max_prob": 0.6983603686094284,
      "val_conf_over_90": 0.017765692726243287,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.594074654805884e-05,
      "epoch_time": 52.205111026763916,
      "val_boundary_f1": 0.38387715930902105,
      "val_boundary_precision": 0.32362459546925565,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.27325516131189515,
      "val_avg_segment_overlap": 0.6557075316573737,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.392718907831957,
      "val_pk_metric": 0.28653895928315426
    },
    {
      "epoch": 13,
      "train_loss": 0.4611692100763321,
      "train_chorus_rate": 0.3823900446295738,
      "train_max_prob": 0.6989464551210404,
      "train_conf_over_90": 0.025172621151432394,
      "train_conf_over_95": 0.0002324316301383078,
      "val_loss": 0.4817713275551796,
      "val_macro_f1": 0.7473055772429479,
      "val_verse_f1": 0.8232628398791542,
      "val_chorus_f1": 0.6713483146067416,
      "val_chorus_rate": 0.40049000084400177,
      "val_max_prob": 0.7106842249631882,
      "val_conf_over_90": 0.03335744235664606,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.0397497985673037e-05,
      "epoch_time": 53.97909712791443,
      "val_boundary_f1": 0.3878326996197719,
      "val_boundary_precision": 0.3248407643312102,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2759484639919422,
      "val_avg_segment_overlap": 0.6666630667926067,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.39211868705679387,
      "val_pk_metric": 0.27809388257654505
    },
    {
      "epoch": 14,
      "train_loss": 0.4559927970170975,
      "train_chorus_rate": 0.3614463061094284,
      "train_max_prob": 0.7127031743526459,
      "train_conf_over_90": 0.03769132969900966,
      "train_conf_over_95": 0.00033006529847625645,
      "val_loss": 0.4829728901386261,
      "val_macro_f1": 0.7465029931410929,
      "val_verse_f1": 0.8270592620201267,
      "val_chorus_f1": 0.6659467242620591,
      "val_chorus_rate": 0.3834640383720398,
      "val_max_prob": 0.7063398957252502,
      "val_conf_over_90": 0.024228107882663608,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.430562303532816e-06,
      "epoch_time": 49.24026417732239,
      "val_boundary_f1": 0.4131274131274131,
      "val_boundary_precision": 0.34967320261437906,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.3141362180996327,
      "val_avg_segment_overlap": 0.6664312395451187,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3836882650730746,
      "val_pk_metric": 0.27652087166102
    },
    {
      "epoch": 15,
      "train_loss": 0.453936779499054,
      "train_chorus_rate": 0.33488563299179075,
      "train_max_prob": 0.7058034867048264,
      "train_conf_over_90": 0.02648292211815715,
      "train_conf_over_95": 0.00010336425621062517,
      "val_loss": 0.48147282749414444,
      "val_macro_f1": 0.7473302813522225,
      "val_verse_f1": 0.8244590780809031,
      "val_chorus_f1": 0.6702014846235419,
      "val_chorus_rate": 0.39584222435951233,
      "val_max_prob": 0.6975536048412323,
      "val_conf_over_90": 0.022153401281684637,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 64.91669082641602,
      "val_boundary_f1": 0.4041944709246902,
      "val_boundary_precision": 0.3392,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.3004519517244862,
      "val_avg_segment_overlap": 0.6670732012054559,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.38985634344214204,
      "val_pk_metric": 0.28043554561224215
    }
  ]
}