{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.21867874277235988,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.1705407783024487,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0008933538696579929,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.014170694320011546,
      "gradient_clip_norm": 0.32562564261699234,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13169381424989587,
        "ece_after": 0.02614421892201269,
        "improvement": 0.10554959532788319,
        "params": {
          "temperature": 0.4594558326754548
        }
      },
      "platt": {
        "ece_before": 0.13169381424989587,
        "ece_after": 0.02645477270506218,
        "improvement": 0.1052390415448337,
        "params": {
          "A": 2.015073418937051,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5905892789363861,
      "train_chorus_rate": 0.4054713390767574,
      "train_max_prob": 0.5980582654476165,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5925340354442596,
      "val_macro_f1": 0.4800765709240477,
      "val_verse_f1": 0.4920787325972155,
      "val_chorus_f1": 0.4680744092508799,
      "val_chorus_rate": 0.6769213080406189,
      "val_max_prob": 0.568951278924942,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008836038331347429,
      "epoch_time": 103.32726979255676,
      "val_boundary_f1": 0.06354515050167224,
      "val_boundary_precision": 0.10919540229885058,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.016522988505747127,
      "val_avg_segment_overlap": 0.2311714961152514,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.44400719437652414,
      "val_pk_metric": 0.45109968287736213
    },
    {
      "epoch": 2,
      "train_loss": 0.577852475643158,
      "train_chorus_rate": 0.5127856391016394,
      "train_max_prob": 0.6177565634250641,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5897835493087769,
      "val_macro_f1": 0.5200541136789427,
      "val_verse_f1": 0.5514061779621945,
      "val_chorus_f1": 0.48870204939569095,
      "val_chorus_rate": 0.6347523629665375,
      "val_max_prob": 0.5387048125267029,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008547798469469249,
      "epoch_time": 78.89969396591187,
      "val_boundary_f1": 0.11881188118811882,
      "val_boundary_precision": 0.14840989399293286,
      "val_boundary_recall": 0.09905660377358491,
      "val_complete_segments": 0.0326867816091954,
      "val_avg_segment_overlap": 0.26479875843092326,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.46334947560127204,
      "val_pk_metric": 0.42385201116580684
    },
    {
      "epoch": 3,
      "train_loss": 0.5642482697963714,
      "train_chorus_rate": 0.4148280023015104,
      "train_max_prob": 0.594051468372345,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5933837294578552,
      "val_macro_f1": 0.6118027654185947,
      "val_verse_f1": 0.7982747179827472,
      "val_chorus_f1": 0.4253308128544423,
      "val_chorus_rate": 0.21991343796253204,
      "val_max_prob": 0.565979540348053,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000808141657603778,
      "epoch_time": 67.35658693313599,
      "val_boundary_f1": 0.24435590969455512,
      "val_boundary_precision": 0.2796352583586626,
      "val_boundary_recall": 0.2169811320754717,
      "val_complete_segments": 0.1027897509578544,
      "val_avg_segment_overlap": 0.3479347551315505,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.3550683801825535,
      "val_pk_metric": 0.3167116259115077
    },
    {
      "epoch": 4,
      "train_loss": 0.5462741076946258,
      "train_chorus_rate": 0.47179669588804246,
      "train_max_prob": 0.5917006850242614,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5744170546531677,
      "val_macro_f1": 0.5661109588520032,
      "val_verse_f1": 0.6108637577916296,
      "val_chorus_f1": 0.5213581599123768,
      "val_chorus_rate": 0.5970543026924133,
      "val_max_prob": 0.6136640906333923,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007457275777744596,
      "epoch_time": 64.86562204360962,
      "val_boundary_f1": 0.11904761904761905,
      "val_boundary_precision": 0.16129032258064516,
      "val_boundary_recall": 0.09433962264150944,
      "val_complete_segments": 0.039990421455938695,
      "val_avg_segment_overlap": 0.3100791272783189,
      "val_verse_to_chorus_acc": 0.09292035398230089,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.4232956539917776,
      "val_pk_metric": 0.41104710151939694
    },
    {
      "epoch": 5,
      "train_loss": 0.542186051607132,
      "train_chorus_rate": 0.4090599611401558,
      "train_max_prob": 0.6347058355808258,
      "train_conf_over_90": 0.0010056611004984005,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5662874579429626,
      "val_macro_f1": 0.689841839877621,
      "val_verse_f1": 0.8267166467882091,
      "val_chorus_f1": 0.552967032967033,
      "val_chorus_rate": 0.25887230038642883,
      "val_max_prob": 0.6412168741226196,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006702654022434947,
      "epoch_time": 54.23996591567993,
      "val_boundary_f1": 0.3414634146341463,
      "val_boundary_precision": 0.32217573221757323,
      "val_boundary_recall": 0.3632075471698113,
      "val_complete_segments": 0.19444444444444442,
      "val_avg_segment_overlap": 0.5108676769992815,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.3385823223545775,
      "val_pk_metric": 0.2681704884502034
    },
    {
      "epoch": 6,
      "train_loss": 0.5106689006090164,
      "train_chorus_rate": 0.4278972089290619,
      "train_max_prob": 0.6327749729156494,
      "train_conf_over_90": 0.00010917073814198375,
      "train_conf_over_95": 0.0,
      "val_loss": 0.544717937707901,
      "val_macro_f1": 0.7004482308843812,
      "val_verse_f1": 0.794315632011967,
      "val_chorus_f1": 0.6065808297567955,
      "val_chorus_rate": 0.3868059068918228,
      "val_max_prob": 0.6409481167793274,
      "val_conf_over_90": 0.0002475247601978481,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005850531901892798,
      "epoch_time": 72.53400087356567,
      "val_boundary_f1": 0.31124497991967875,
      "val_boundary_precision": 0.270979020979021,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.18612308429118773,
      "val_avg_segment_overlap": 0.567797230867799,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4026692162322235,
      "val_pk_metric": 0.31143293811689665
    },
    {
      "epoch": 7,
      "train_loss": 0.4965436190366745,
      "train_chorus_rate": 0.40017518401145935,
      "train_max_prob": 0.6741463363170623,
      "train_conf_over_90": 0.01516161902982276,
      "train_conf_over_95": 0.0004959451645845548,
      "val_loss": 0.5226783752441406,
      "val_macro_f1": 0.7061164236492559,
      "val_verse_f1": 0.7852167182662538,
      "val_chorus_f1": 0.627016129032258,
      "val_chorus_rate": 0.4310592859983444,
      "val_max_prob": 0.6566966772079468,
      "val_conf_over_90": 0.009611004963517189,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 0.0004938151241721435,
      "epoch_time": 70.42672610282898,
      "val_boundary_f1": 0.34838709677419355,
      "val_boundary_precision": 0.2859304084720121,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.22527538314176243,
      "val_avg_segment_overlap": 0.6040533927726421,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4271170346510029,
      "val_pk_metric": 0.32747997657272004
    },
    {
      "epoch": 8,
      "train_loss": 0.48651649355888366,
      "train_chorus_rate": 0.3698710426688194,
      "train_max_prob": 0.6778773486614227,
      "train_conf_over_90": 0.029163456242531537,
      "train_conf_over_95": 0.0014822036377154292,
      "val_loss": 0.535097748041153,
      "val_macro_f1": 0.7449344073216244,
      "val_verse_f1": 0.8578723404255318,
      "val_chorus_f1": 0.6319964742177171,
      "val_chorus_rate": 0.2573871463537216,
      "val_max_prob": 0.663263201713562,
      "val_conf_over_90": 0.0012337637599557638,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00040053874548584957,
      "epoch_time": 78.04404211044312,
      "val_boundary_f1": 0.4056338028169014,
      "val_boundary_precision": 0.3369734789391576,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.29495929118773945,
      "val_avg_segment_overlap": 0.6356295148772126,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3558289963179289,
      "val_pk_metric": 0.24711934864547055
    },
    {
      "epoch": 9,
      "train_loss": 0.5059631288051605,
      "train_chorus_rate": 0.35447046160697937,
      "train_max_prob": 0.6589776337146759,
      "train_conf_over_90": 0.0075605599209666256,
      "train_conf_over_95": 7.0821528788656e-05,
      "val_loss": 0.528313010931015,
      "val_macro_f1": 0.7411898999188669,
      "val_verse_f1": 0.8419936373276775,
      "val_chorus_f1": 0.6403861625100563,
      "val_chorus_rate": 0.3107140064239502,
      "val_max_prob": 0.6744465529918671,
      "val_conf_over_90": 0.0061610983684659,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030930067946871326,
      "epoch_time": 56.64714074134827,
      "val_boundary_f1": 0.3841911764705882,
      "val_boundary_precision": 0.3147590361445783,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.27143199233716475,
      "val_avg_segment_overlap": 0.6412432119409615,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3910550245364497,
      "val_pk_metric": 0.27807065172459927
    },
    {
      "epoch": 10,
      "train_loss": 0.494721582531929,
      "train_chorus_rate": 0.35720460712909696,
      "train_max_prob": 0.6689798295497894,
      "train_conf_over_90": 0.011224570265039802,
      "train_conf_over_95": 0.0002403008082183078,
      "val_loss": 0.51109179854393,
      "val_macro_f1": 0.7122778191137566,
      "val_verse_f1": 0.7863281249999999,
      "val_chorus_f1": 0.6382275132275133,
      "val_chorus_rate": 0.4427976459264755,
      "val_max_prob": 0.6834559440612793,
      "val_conf_over_90": 0.016739042475819588,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 0.00022408846741449833,
      "epoch_time": 53.39393186569214,
      "val_boundary_f1": 0.35486981677917073,
      "val_boundary_precision": 0.300163132137031,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.22156369731800765,
      "val_avg_segment_overlap": 0.6143017804841475,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.41677974886906655,
      "val_pk_metric": 0.3219561727146494
    },
    {
      "epoch": 11,
      "train_loss": 0.4832275420427322,
      "train_chorus_rate": 0.3472077488899231,
      "train_max_prob": 0.6713605403900147,
      "train_conf_over_90": 0.01167118176817894,
      "train_conf_over_95": 0.000194098221254535,
      "val_loss": 0.5112542659044266,
      "val_macro_f1": 0.7224523562688367,
      "val_verse_f1": 0.7972920696324952,
      "val_chorus_f1": 0.6476126429051782,
      "val_chorus_rate": 0.4305719584226608,
      "val_max_prob": 0.6761658787727356,
      "val_conf_over_90": 0.017470036633312702,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 0.0001486262918835334,
      "epoch_time": 71.85199403762817,
      "val_boundary_f1": 0.3684210526315789,
      "val_boundary_precision": 0.30625,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2445522030651341,
      "val_avg_segment_overlap": 0.6331180896508806,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40975184799848746,
      "val_pk_metric": 0.3091693804685086
    },
    {
      "epoch": 12,
      "train_loss": 0.49034861028194426,
      "train_chorus_rate": 0.40466607809066774,
      "train_max_prob": 0.6862173974514008,
      "train_conf_over_90": 0.024409323930740356,
      "train_conf_over_95": 0.0014348059281473978,
      "val_loss": 0.5102761685848236,
      "val_macro_f1": 0.7264586438096964,
      "val_verse_f1": 0.8045845272206303,
      "val_chorus_f1": 0.6483327603987624,
      "val_chorus_rate": 0.4145793467760086,
      "val_max_prob": 0.6752762198448181,
      "val_conf_over_90": 0.012809526175260544,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.621221205421496e-05,
      "epoch_time": 63.290101051330566,
      "val_boundary_f1": 0.3800383877159309,
      "val_boundary_precision": 0.32038834951456313,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.26299090038314177,
      "val_avg_segment_overlap": 0.634939756997231,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.39488322241619006,
      "val_pk_metric": 0.2969468655875859
    },
    {
      "epoch": 13,
      "train_loss": 0.48293068408966067,
      "train_chorus_rate": 0.38588557541370394,
      "train_max_prob": 0.6770907878875733,
      "train_conf_over_90": 0.016242437530308962,
      "train_conf_over_95": 0.0005760285363066942,
      "val_loss": 0.509546160697937,
      "val_macro_f1": 0.7155811460449635,
      "val_verse_f1": 0.7889908256880734,
      "val_chorus_f1": 0.6421714664018536,
      "val_chorus_rate": 0.44207051396369934,
      "val_max_prob": 0.6823119223117828,
      "val_conf_over_90": 0.020161928609013557,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 3.957402271106793e-05,
      "epoch_time": 65.6945059299469,
      "val_boundary_f1": 0.3459669582118562,
      "val_boundary_precision": 0.29421487603305785,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.2127035440613027,
      "val_avg_segment_overlap": 0.6190588897052771,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.40872622267350456,
      "val_pk_metric": 0.3095790622124832
    },
    {
      "epoch": 14,
      "train_loss": 0.478627547621727,
      "train_chorus_rate": 0.3801144003868103,
      "train_max_prob": 0.6926425993442535,
      "train_conf_over_90": 0.032362798042595384,
      "train_conf_over_95": 0.0014167739573167637,
      "val_loss": 0.5121242552995682,
      "val_macro_f1": 0.7373515963346472,
      "val_verse_f1": 0.8210094989756007,
      "val_chorus_f1": 0.6536936936936937,
      "val_chorus_rate": 0.3816928267478943,
      "val_max_prob": 0.6988636255264282,
      "val_conf_over_90": 0.019674599170684814,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 1.0750036523249989e-05,
      "epoch_time": 56.36487579345703,
      "val_boundary_f1": 0.40038684719535783,
      "val_boundary_precision": 0.33934426229508197,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2881944444444444,
      "val_avg_segment_overlap": 0.6452999014903866,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.38288847655040104,
      "val_pk_metric": 0.28218265147922306
    },
    {
      "epoch": 15,
      "train_loss": 0.4785118728876114,
      "train_chorus_rate": 0.3251248776912689,
      "train_max_prob": 0.7029402911663055,
      "train_conf_over_90": 0.02672201134264469,
      "train_conf_over_95": 0.00173230076325126,
      "val_loss": 0.5087045729160309,
      "val_macro_f1": 0.7330465686041261,
      "val_verse_f1": 0.8119787717968157,
      "val_chorus_f1": 0.6541143654114366,
      "val_chorus_rate": 0.404508039355278,
      "val_max_prob": 0.6889594793319702,
      "val_conf_over_90": 0.019674599170684814,
      "val_conf_over_95": 0.0002475247601978481,
      "learning_rate": 1e-06,
      "epoch_time": 64.55609393119812,
      "val_boundary_f1": 0.3827751196172249,
      "val_boundary_precision": 0.322061191626409,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.266463122605364,
      "val_avg_segment_overlap": 0.6406924194756464,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3932758763301566,
      "val_pk_metric": 0.28949085836372423
    }
  ]
}