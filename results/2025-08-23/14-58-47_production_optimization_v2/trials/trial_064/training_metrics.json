{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1804950358784696,
      "layer_dropout": 0.21074540914434528,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1586862336675532,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007424577829721735,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.016098712113689538,
      "gradient_clip_norm": 0.3290259593410053,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11782976894224088,
        "ece_after": 0.03027541654400364,
        "improvement": 0.08755435239823725,
        "params": {
          "temperature": 0.5243410636619308
        }
      },
      "platt": {
        "ece_before": 0.11782976894224088,
        "ece_after": 0.027018239857054396,
        "improvement": 0.09081152908518648,
        "params": {
          "A": 1.804524842699873,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5938275456428528,
      "train_chorus_rate": 0.4851631373167038,
      "train_max_prob": 0.5861802816390991,
      "train_conf_over_90": 0.0002767527708783746,
      "train_conf_over_95": 0.0,
      "val_loss": 0.59537373483181,
      "val_macro_f1": 0.3597799428847782,
      "val_verse_f1": 0.2306982466933251,
      "val_chorus_f1": 0.4888616390762313,
      "val_chorus_rate": 0.9018704891204834,
      "val_max_prob": 0.6051239222288132,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007343564672159059,
      "epoch_time": 77.7273600101471,
      "val_boundary_f1": 0.014571948998178508,
      "val_boundary_precision": 0.032,
      "val_boundary_recall": 0.009433962264150943,
      "val_complete_segments": 0.0056039488966318236,
      "val_avg_segment_overlap": 0.14769174788386502,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4273265151031269,
      "val_pk_metric": 0.42336099183162956
    },
    {
      "epoch": 2,
      "train_loss": 0.5659445703029633,
      "train_chorus_rate": 0.5131616286351346,
      "train_max_prob": 0.5796264499425888,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6080613732337952,
      "val_macro_f1": 0.5649021983387116,
      "val_verse_f1": 0.7733687531130667,
      "val_chorus_f1": 0.3564356435643565,
      "val_chorus_rate": 0.22087789699435234,
      "val_max_prob": 0.5968740433454514,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007104065863200779,
      "epoch_time": 62.81647491455078,
      "val_boundary_f1": 0.07460035523978685,
      "val_boundary_precision": 0.1510791366906475,
      "val_boundary_recall": 0.049528301886792456,
      "val_complete_segments": 0.054858310438904295,
      "val_avg_segment_overlap": 0.23368082422921468,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.33741584028292904,
      "val_pk_metric": 0.3339852940291149
    },
    {
      "epoch": 3,
      "train_loss": 0.5707290202379227,
      "train_chorus_rate": 0.4359964394941926,
      "train_max_prob": 0.5823124825954438,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5980582535266876,
      "val_macro_f1": 0.43877460196361584,
      "val_verse_f1": 0.8230320699708454,
      "val_chorus_f1": 0.0545171339563863,
      "val_chorus_rate": 0.01572144730016589,
      "val_max_prob": 0.5875352174043655,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006716548650041167,
      "epoch_time": 45.616400718688965,
      "val_boundary_f1": 0.026315789473684213,
      "val_boundary_precision": 0.1875,
      "val_boundary_recall": 0.014150943396226415,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.1774541230281571,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.27199404347340844,
      "val_pk_metric": 0.2741241704165612
    },
    {
      "epoch": 4,
      "train_loss": 0.5541096240282058,
      "train_chorus_rate": 0.5015788448043168,
      "train_max_prob": 0.584969237446785,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5748410820960999,
      "val_macro_f1": 0.4724535288371297,
      "val_verse_f1": 0.4601458385717877,
      "val_chorus_f1": 0.4847612191024717,
      "val_chorus_rate": 0.7260596305131912,
      "val_max_prob": 0.5669925510883331,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006197949394409193,
      "epoch_time": 52.03083896636963,
      "val_boundary_f1": 0.03284072249589492,
      "val_boundary_precision": 0.05405405405405406,
      "val_boundary_recall": 0.02358490566037736,
      "val_complete_segments": 0.01285232172029627,
      "val_avg_segment_overlap": 0.19905101150226004,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.425860245803956,
      "val_pk_metric": 0.41432385853319564
    },
    {
      "epoch": 5,
      "train_loss": 0.5343422308564186,
      "train_chorus_rate": 0.4988894298672676,
      "train_max_prob": 0.6206475228071213,
      "train_conf_over_90": 0.0010266599943861364,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5447527170181274,
      "val_macro_f1": 0.6881577037976532,
      "val_verse_f1": 0.7977466836271125,
      "val_chorus_f1": 0.5785687239681939,
      "val_chorus_rate": 0.3500763550400734,
      "val_max_prob": 0.6659977585077286,
      "val_conf_over_90": 0.007507640577387065,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005570933372291301,
      "epoch_time": 51.702370166778564,
      "val_boundary_f1": 0.3186372745490981,
      "val_boundary_precision": 0.2770034843205575,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.15598370298794476,
      "val_avg_segment_overlap": 0.5461868396248368,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4237257895767404,
      "val_pk_metric": 0.33716562109563164
    },
    {
      "epoch": 6,
      "train_loss": 0.5080476567149163,
      "train_chorus_rate": 0.41587772965431213,
      "train_max_prob": 0.6638798475265503,
      "train_conf_over_90": 0.011640358544536867,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5099036172032356,
      "val_macro_f1": 0.6843979156531588,
      "val_verse_f1": 0.7586481113320079,
      "val_chorus_f1": 0.6101477199743095,
      "val_chorus_rate": 0.4650999382138252,
      "val_max_prob": 0.6765057444572449,
      "val_conf_over_90": 0.011200580920558423,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004862904192610733,
      "epoch_time": 45.95483708381653,
      "val_boundary_f1": 0.2868068833652007,
      "val_boundary_precision": 0.24115755627009647,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.13127459189230134,
      "val_avg_segment_overlap": 0.5802336957597007,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.47758277054124215,
      "val_pk_metric": 0.36772062372750614
    },
    {
      "epoch": 7,
      "train_loss": 0.4852913126349449,
      "train_chorus_rate": 0.37053667604923246,
      "train_max_prob": 0.678981825709343,
      "train_conf_over_90": 0.023190113238524646,
      "train_conf_over_95": 0.0012085660826414823,
      "val_loss": 0.5047097504138947,
      "val_macro_f1": 0.7426132377558746,
      "val_verse_f1": 0.836036036036036,
      "val_chorus_f1": 0.6491904394757132,
      "val_chorus_rate": 0.33812177926301956,
      "val_max_prob": 0.7140048742294312,
      "val_conf_over_90": 0.02094552479684353,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00041048061280204805,
      "epoch_time": 87.6056399345398,
      "val_boundary_f1": 0.35181644359464626,
      "val_boundary_precision": 0.2958199356913183,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.19686907593853512,
      "val_avg_segment_overlap": 0.6329970791042169,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4044791054205378,
      "val_pk_metric": 0.30589544748005687
    },
    {
      "epoch": 8,
      "train_loss": 0.4722700461745262,
      "train_chorus_rate": 0.3453234426677227,
      "train_max_prob": 0.6986988991498947,
      "train_conf_over_90": 0.019190211690147407,
      "train_conf_over_95": 0.00036450517363846303,
      "val_loss": 0.4952443614602089,
      "val_macro_f1": 0.757410623457935,
      "val_verse_f1": 0.8486795146324055,
      "val_chorus_f1": 0.6661417322834645,
      "val_chorus_rate": 0.324837364256382,
      "val_max_prob": 0.7201920747756958,
      "val_conf_over_90": 0.02815785096026957,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.0003329771701701255,
      "epoch_time": 63.6592230796814,
      "val_boundary_f1": 0.39087301587301587,
      "val_boundary_precision": 0.3373287671232877,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2614551303310582,
      "val_avg_segment_overlap": 0.6427040660561666,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.36276086288957116,
      "val_pk_metric": 0.25653706003958954
    },
    {
      "epoch": 9,
      "train_loss": 0.4571832060813904,
      "train_chorus_rate": 0.31947638317942617,
      "train_max_prob": 0.7095417141914367,
      "train_conf_over_90": 0.03129167405422777,
      "train_conf_over_95": 0.003130205048364587,
      "val_loss": 0.49567198753356934,
      "val_macro_f1": 0.7315255334209728,
      "val_verse_f1": 0.8186874304783093,
      "val_chorus_f1": 0.6443636363636364,
      "val_chorus_rate": 0.3759835660457611,
      "val_max_prob": 0.6903132796287537,
      "val_conf_over_90": 0.0155480726971291,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00025716736371110023,
      "epoch_time": 111.46219229698181,
      "val_boundary_f1": 0.31954887218045114,
      "val_boundary_precision": 0.265625,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.18517814322427262,
      "val_avg_segment_overlap": 0.6283154027855073,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.40867239182797155,
      "val_pk_metric": 0.30052085658445316
    },
    {
      "epoch": 10,
      "train_loss": 0.45967642962932587,
      "train_chorus_rate": 0.33477846905589104,
      "train_max_prob": 0.7041856795549393,
      "train_conf_over_90": 0.02371694409812335,
      "train_conf_over_95": 0.0013991480664117262,
      "val_loss": 0.49272268265485764,
      "val_macro_f1": 0.720371392104721,
      "val_verse_f1": 0.8009912314144111,
      "val_chorus_f1": 0.6397515527950309,
      "val_chorus_rate": 0.4119565263390541,
      "val_max_prob": 0.7076320946216583,
      "val_conf_over_90": 0.04086537519469857,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 0.00018636444574304345,
      "epoch_time": 88.28696703910828,
      "val_boundary_f1": 0.33059360730593607,
      "val_boundary_precision": 0.2697466467958271,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.18637372033448385,
      "val_avg_segment_overlap": 0.6306363811826152,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.44572490740429793,
      "val_pk_metric": 0.3211828902937576
    },
    {
      "epoch": 11,
      "train_loss": 0.46068041026592255,
      "train_chorus_rate": 0.3527303524315357,
      "train_max_prob": 0.705928036570549,
      "train_conf_over_90": 0.029329411149956287,
      "train_conf_over_95": 0.00121035969350487,
      "val_loss": 0.5004552453756332,
      "val_macro_f1": 0.7651623513675012,
      "val_verse_f1": 0.8633766233766234,
      "val_chorus_f1": 0.6669480793583791,
      "val_chorus_rate": 0.28260600194334984,
      "val_max_prob": 0.6914079040288925,
      "val_conf_over_90": 0.0011857748322654516,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012366284353125428,
      "epoch_time": 92.18518495559692,
      "val_boundary_f1": 0.4190283400809716,
      "val_boundary_precision": 0.3670212765957447,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28805878102007476,
      "val_avg_segment_overlap": 0.6576812522121909,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.32462589936603364,
      "val_pk_metric": 0.24157511054780786
    },
    {
      "epoch": 12,
      "train_loss": 0.4603557035326958,
      "train_chorus_rate": 0.3279140703380108,
      "train_max_prob": 0.7033633708953857,
      "train_conf_over_90": 0.022841781296301635,
      "train_conf_over_95": 0.0006672361952951178,
      "val_loss": 0.4893326386809349,
      "val_macro_f1": 0.757902421551419,
      "val_verse_f1": 0.8480944712828772,
      "val_chorus_f1": 0.6677103718199608,
      "val_chorus_rate": 0.3282087445259094,
      "val_max_prob": 0.7217929810285568,
      "val_conf_over_90": 0.03575316909700632,
      "val_conf_over_95": 0.0007036147289909422,
      "learning_rate": 7.180291796805683e-05,
      "epoch_time": 82.04764294624329,
      "val_boundary_f1": 0.39414634146341465,
      "val_boundary_precision": 0.33610648918469216,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.2604211448988755,
      "val_avg_segment_overlap": 0.6606106587543421,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.35400289049059086,
      "val_pk_metric": 0.2539537575821848
    },
    {
      "epoch": 13,
      "train_loss": 0.4535697132349014,
      "train_chorus_rate": 0.31939227506518364,
      "train_max_prob": 0.7116035431623459,
      "train_conf_over_90": 0.03110855179838836,
      "train_conf_over_95": 0.0013555959914810956,
      "val_loss": 0.4841245710849762,
      "val_macro_f1": 0.7482821447162935,
      "val_verse_f1": 0.831858407079646,
      "val_chorus_f1": 0.6647058823529411,
      "val_chorus_rate": 0.3684556260704994,
      "val_max_prob": 0.7112692296504974,
      "val_conf_over_90": 0.03478757245466113,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 3.305119665209547e-05,
      "epoch_time": 82.09071683883667,
      "val_boundary_f1": 0.3760523854069224,
      "val_boundary_precision": 0.3116279069767442,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.23205266128118723,
      "val_avg_segment_overlap": 0.6593702921482825,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3944721693428843,
      "val_pk_metric": 0.2824616081404061
    },
    {
      "epoch": 14,
      "train_loss": 0.4463447242975235,
      "train_chorus_rate": 0.3210316672921181,
      "train_max_prob": 0.7237395823001862,
      "train_conf_over_90": 0.03767832049634308,
      "train_conf_over_95": 0.0006316040584351867,
      "val_loss": 0.48607558012008667,
      "val_macro_f1": 0.7614726594017498,
      "val_verse_f1": 0.851799073744211,
      "val_chorus_f1": 0.6711462450592885,
      "val_chorus_rate": 0.321965754032135,
      "val_max_prob": 0.7080290168523788,
      "val_conf_over_90": 0.021995355957187712,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.101315756267595e-06,
      "epoch_time": 87.45024275779724,
      "val_boundary_f1": 0.39539347408829173,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.26326472852188654,
      "val_avg_segment_overlap": 0.6709280689838801,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.35251389925094795,
      "val_pk_metric": 0.25349256056174596
    },
    {
      "epoch": 15,
      "train_loss": 0.45126998126506807,
      "train_chorus_rate": 0.3260002344846725,
      "train_max_prob": 0.7146673053503036,
      "train_conf_over_90": 0.028575071273371576,
      "train_conf_over_95": 0.000510005807154812,
      "val_loss": 0.4850233420729637,
      "val_macro_f1": 0.7592543014207183,
      "val_verse_f1": 0.8477011494252874,
      "val_chorus_f1": 0.6708074534161491,
      "val_chorus_rate": 0.33325499296188354,
      "val_max_prob": 0.7068174481391907,
      "val_conf_over_90": 0.02223643579054624,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 87.02188682556152,
      "val_boundary_f1": 0.39885496183206104,
      "val_boundary_precision": 0.3349358974358974,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2629194013738022,
      "val_avg_segment_overlap": 0.671952822036193,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3645368181126374,
      "val_pk_metric": 0.2610725531828308
    }
  ]
}