{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.17264711947623362,
      "layer_dropout": 0.20451588988997663,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17051797015152606,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2739715,
      "lstm_params": 2179072,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008544897098265953,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.01694382941042033,
      "gradient_clip_norm": 0.3643606928138598,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07451536998240559,
        "ece_after": 0.024679098505168157,
        "improvement": 0.04983627147723743,
        "params": {
          "temperature": 0.6939506381198431
        }
      },
      "platt": {
        "ece_before": 0.07451536998240559,
        "ece_after": 0.02744345630433093,
        "improvement": 0.04707191367807466,
        "params": {
          "A": 1.3629999883851494,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5895529180765152,
      "train_chorus_rate": 0.40188012532889844,
      "train_max_prob": 0.5934558302164078,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5971092730760574,
      "val_macro_f1": 0.47961768147999106,
      "val_verse_f1": 0.49559208958780077,
      "val_chorus_f1": 0.4636432733721813,
      "val_chorus_rate": 0.6695172935724258,
      "val_max_prob": 0.5425222814083099,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008451643108722358,
      "epoch_time": 46.448307037353516,
      "val_boundary_f1": 0.06115107913669065,
      "val_boundary_precision": 0.12878787878787878,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.018949882695906025,
      "val_avg_segment_overlap": 0.20968672373024258,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.43754922990216333,
      "val_pk_metric": 0.4433633249160236
    },
    {
      "epoch": 2,
      "train_loss": 0.5744565576314926,
      "train_chorus_rate": 0.4977277402067557,
      "train_max_prob": 0.5725991129875183,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6146448850631714,
      "val_macro_f1": 0.34366719985521904,
      "val_verse_f1": 0.2119815668202765,
      "val_chorus_f1": 0.47535283289016156,
      "val_chorus_rate": 0.9008836299180984,
      "val_max_prob": 0.6244946718215942,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008175956786916915,
      "epoch_time": 40.10901403427124,
      "val_boundary_f1": 0.029357798165137616,
      "val_boundary_precision": 0.06611570247933884,
      "val_boundary_recall": 0.018867924528301886,
      "val_complete_segments": 0.011163132531107081,
      "val_avg_segment_overlap": 0.13273628121580533,
      "val_verse_to_chorus_acc": 0.02654867256637168,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.37909888701032474,
      "val_pk_metric": 0.36157208853631895
    },
    {
      "epoch": 3,
      "train_loss": 0.559722238779068,
      "train_chorus_rate": 0.524871958210133,
      "train_max_prob": 0.5856126636266709,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6314832717180252,
      "val_macro_f1": 0.41181568684096487,
      "val_verse_f1": 0.8236313736819297,
      "val_chorus_f1": 0.0,
      "val_chorus_rate": 0.0,
      "val_max_prob": 0.6079498380422592,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007729886948002267,
      "epoch_time": 51.14607286453247,
      "val_boundary_f1": 0.0,
      "val_boundary_precision": 0.0,
      "val_boundary_recall": 0.0,
      "val_complete_segments": 0.05911640128236099,
      "val_avg_segment_overlap": 0.16672167678962696,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.26458863159601387,
      "val_pk_metric": 0.271007419880346
    },
    {
      "epoch": 4,
      "train_loss": 0.5644015043973922,
      "train_chorus_rate": 0.4826692094298778,
      "train_max_prob": 0.5850254893302917,
      "train_conf_over_90": 3.415300452616066e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6050344705581665,
      "val_macro_f1": 0.5042103829264488,
      "val_verse_f1": 0.8143224051971598,
      "val_chorus_f1": 0.19409836065573774,
      "val_chorus_rate": 0.07458549831062555,
      "val_max_prob": 0.5609459578990936,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007132928984419555,
      "epoch_time": 43.857394218444824,
      "val_boundary_f1": 0.08921933085501858,
      "val_boundary_precision": 0.21052631578947367,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.06293463589327852,
      "val_avg_segment_overlap": 0.24705395150947304,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3143207862654189,
      "val_pk_metric": 0.29339960215866845
    },
    {
      "epoch": 5,
      "train_loss": 0.5525888502597809,
      "train_chorus_rate": 0.5584247829392552,
      "train_max_prob": 0.5967891871929168,
      "train_conf_over_90": 0.00045931428903713825,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5913731008768082,
      "val_macro_f1": 0.6052511497724458,
      "val_verse_f1": 0.7272045028142589,
      "val_chorus_f1": 0.4832977967306326,
      "val_chorus_rate": 0.39204323291778564,
      "val_max_prob": 0.5592368096113205,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006411172823699465,
      "epoch_time": 48.38915395736694,
      "val_boundary_f1": 0.1987261146496815,
      "val_boundary_precision": 0.21606648199445982,
      "val_boundary_recall": 0.18396226415094338,
      "val_complete_segments": 0.03742503865780643,
      "val_avg_segment_overlap": 0.35619343919000257,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.1414141414141414,
      "val_window_diff": 0.4476057209875956,
      "val_pk_metric": 0.4284097456437479
    },
    {
      "epoch": 6,
      "train_loss": 0.5453739032149315,
      "train_chorus_rate": 0.4639245834201574,
      "train_max_prob": 0.6024894267320633,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.598008319735527,
      "val_macro_f1": 0.6183398966194996,
      "val_verse_f1": 0.8309148264984227,
      "val_chorus_f1": 0.40576496674057644,
      "val_chorus_rate": 0.1433656383305788,
      "val_max_prob": 0.6632274687290192,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000559616267343578,
      "epoch_time": 46.226415157318115,
      "val_boundary_f1": 0.25207756232686984,
      "val_boundary_precision": 0.3053691275167785,
      "val_boundary_recall": 0.21462264150943397,
      "val_complete_segments": 0.14951892697120694,
      "val_avg_segment_overlap": 0.382604299713577,
      "val_verse_to_chorus_acc": 0.22123893805309736,
      "val_chorus_to_verse_acc": 0.15151515151515152,
      "val_window_diff": 0.3401097237876207,
      "val_pk_metric": 0.3069579226637208
    },
    {
      "epoch": 7,
      "train_loss": 0.5191940605640412,
      "train_chorus_rate": 0.3855838295072317,
      "train_max_prob": 0.649967610836029,
      "train_conf_over_90": 0.005980994377750903,
      "train_conf_over_95": 0.0,
      "val_loss": 0.549026370048523,
      "val_macro_f1": 0.7238860150484341,
      "val_verse_f1": 0.837193104649138,
      "val_chorus_f1": 0.6105789254477302,
      "val_chorus_rate": 0.2901975139975548,
      "val_max_prob": 0.6130675971508026,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00047235183880476255,
      "epoch_time": 38.83774709701538,
      "val_boundary_f1": 0.3365570599613153,
      "val_boundary_precision": 0.28524590163934427,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.1962786146243198,
      "val_avg_segment_overlap": 0.5981772049981998,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4097983464671776,
      "val_pk_metric": 0.2993954898266774
    },
    {
      "epoch": 8,
      "train_loss": 0.5069488823413849,
      "train_chorus_rate": 0.3569589026272297,
      "train_max_prob": 0.6573953539133072,
      "train_conf_over_90": 0.012031668319832534,
      "train_conf_over_95": 0.0003265477367676795,
      "val_loss": 0.5333767607808113,
      "val_macro_f1": 0.6671250975611001,
      "val_verse_f1": 0.7446215139442232,
      "val_chorus_f1": 0.589628681177977,
      "val_chorus_rate": 0.4682198837399483,
      "val_max_prob": 0.6694637089967728,
      "val_conf_over_90": 0.020525980624370277,
      "val_conf_over_95": 0.0009643201483413577,
      "learning_rate": 0.0003831378710218331,
      "epoch_time": 42.19844698905945,
      "val_boundary_f1": 0.2440419447092469,
      "val_boundary_precision": 0.2048,
      "val_boundary_recall": 0.3018867924528302,
      "val_complete_segments": 0.11862231493726723,
      "val_avg_segment_overlap": 0.5510304560744796,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.4756319711128675,
      "val_pk_metric": 0.3749252091598991
    },
    {
      "epoch": 9,
      "train_loss": 0.5014363527297974,
      "train_chorus_rate": 0.3827223017811775,
      "train_max_prob": 0.6652063637971878,
      "train_conf_over_90": 0.015050545037956909,
      "train_conf_over_95": 0.0001799607154680416,
      "val_loss": 0.526836208999157,
      "val_macro_f1": 0.6812233477076894,
      "val_verse_f1": 0.7552809884416103,
      "val_chorus_f1": 0.6071657069737685,
      "val_chorus_rate": 0.46829406172037125,
      "val_max_prob": 0.6366692036390305,
      "val_conf_over_90": 0.002892960561439395,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002958734424830175,
      "epoch_time": 49.818617820739746,
      "val_boundary_f1": 0.23540489642184556,
      "val_boundary_precision": 0.19592476489028213,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.10710486467379363,
      "val_avg_segment_overlap": 0.5647788272039304,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.49006017877093844,
      "val_pk_metric": 0.3823171883087722
    },
    {
      "epoch": 10,
      "train_loss": 0.48917986899614335,
      "train_chorus_rate": 0.3346442572772503,
      "train_max_prob": 0.67328921854496,
      "train_conf_over_90": 0.011886161105940119,
      "train_conf_over_95": 0.0005148796160938218,
      "val_loss": 0.5273548141121864,
      "val_macro_f1": 0.7365224266519947,
      "val_verse_f1": 0.8326736236056137,
      "val_chorus_f1": 0.6403712296983759,
      "val_chorus_rate": 0.33547674119472504,
      "val_max_prob": 0.6987351179122925,
      "val_conf_over_90": 0.013558544393163174,
      "val_conf_over_95": 0.00024108003708533943,
      "learning_rate": 0.00021437242745664893,
      "epoch_time": 41.99907302856445,
      "val_boundary_f1": 0.33878729547641967,
      "val_boundary_precision": 0.2861788617886179,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.2055813956662313,
      "val_avg_segment_overlap": 0.6268070951374181,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.405532944346535,
      "val_pk_metric": 0.29230343568071276
    },
    {
      "epoch": 11,
      "train_loss": 0.4762855425477028,
      "train_chorus_rate": 0.34237400591373446,
      "train_max_prob": 0.6916954338550567,
      "train_conf_over_90": 0.019105003937147556,
      "train_conf_over_95": 0.0008733396214665845,
      "val_loss": 0.5192859172821045,
      "val_macro_f1": 0.7310769544834038,
      "val_verse_f1": 0.8193751155481604,
      "val_chorus_f1": 0.6427787934186472,
      "val_chorus_rate": 0.3720536381006241,
      "val_max_prob": 0.682016909122467,
      "val_conf_over_90": 0.02078856440493837,
      "val_conf_over_95": 0.0007232401403598487,
      "learning_rate": 0.00014219681138463996,
      "epoch_time": 50.80085301399231,
      "val_boundary_f1": 0.3313725490196079,
      "val_boundary_precision": 0.2835570469798658,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.18732549395327763,
      "val_avg_segment_overlap": 0.6203857399002825,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4061880100889357,
      "val_pk_metric": 0.29857218943749947
    },
    {
      "epoch": 12,
      "train_loss": 0.48850945979356764,
      "train_chorus_rate": 0.35504832565784455,
      "train_max_prob": 0.6865318804979325,
      "train_conf_over_90": 0.023239468201063575,
      "train_conf_over_95": 0.0006941458093933761,
      "val_loss": 0.5308875665068626,
      "val_macro_f1": 0.6761935295758541,
      "val_verse_f1": 0.744421906693712,
      "val_chorus_f1": 0.6079651524579962,
      "val_chorus_rate": 0.4900517612695694,
      "val_max_prob": 0.7119681388139725,
      "val_conf_over_90": 0.06504946947097778,
      "val_conf_over_95": 0.003134040394797921,
      "learning_rate": 8.25010150263686e-05,
      "epoch_time": 45.07858991622925,
      "val_boundary_f1": 0.26452905811623245,
      "val_boundary_precision": 0.22996515679442509,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.12162749023830678,
      "val_avg_segment_overlap": 0.55710650253278,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.45830508370604617,
      "val_pk_metric": 0.36414142064618904
    },
    {
      "epoch": 13,
      "train_loss": 0.488466913998127,
      "train_chorus_rate": 0.370398211479187,
      "train_max_prob": 0.6815255492925644,
      "train_conf_over_90": 0.01913549472519662,
      "train_conf_over_95": 0.0007535242388257757,
      "val_loss": 0.5192574635148048,
      "val_macro_f1": 0.7003299498765376,
      "val_verse_f1": 0.779074290159471,
      "val_chorus_f1": 0.6215856095936043,
      "val_chorus_rate": 0.4382574334740639,
      "val_max_prob": 0.6680205315351486,
      "val_conf_over_90": 0.005466339294798672,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.789403113490379e-05,
      "epoch_time": 40.94027495384216,
      "val_boundary_f1": 0.23461538461538464,
      "val_boundary_precision": 0.19805194805194806,
      "val_boundary_recall": 0.28773584905660377,
      "val_complete_segments": 0.11506777569874072,
      "val_avg_segment_overlap": 0.5668084354255567,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.464230751158219,
      "val_pk_metric": 0.3577668549974011
    },
    {
      "epoch": 14,
      "train_loss": 0.4863527700304985,
      "train_chorus_rate": 0.3837007910013199,
      "train_max_prob": 0.6891346484422683,
      "train_conf_over_90": 0.016848933952860533,
      "train_conf_over_95": 0.00023500372481066734,
      "val_loss": 0.5168884918093681,
      "val_macro_f1": 0.7221036111052623,
      "val_verse_f1": 0.8089803554724041,
      "val_chorus_f1": 0.6352268667381207,
      "val_chorus_rate": 0.3881423845887184,
      "val_max_prob": 0.6794735342264175,
      "val_conf_over_90": 0.010088316339533776,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0325398954359546e-05,
      "epoch_time": 41.398508071899414,
      "val_boundary_f1": 0.31171345595353334,
      "val_boundary_precision": 0.26436781609195403,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.16504957275105736,
      "val_avg_segment_overlap": 0.603852549170879,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.4280346951257431,
      "val_pk_metric": 0.30911735986524974
    },
    {
      "epoch": 15,
      "train_loss": 0.484153687953949,
      "train_chorus_rate": 0.3508926570415497,
      "train_max_prob": 0.6867840677499771,
      "train_conf_over_90": 0.010314924694830552,
      "train_conf_over_95": 0.00020598069531843066,
      "val_loss": 0.5167999267578125,
      "val_macro_f1": 0.7253138371002351,
      "val_verse_f1": 0.811659192825112,
      "val_chorus_f1": 0.6389684813753582,
      "val_chorus_rate": 0.38634800910949707,
      "val_max_prob": 0.6730741113424301,
      "val_conf_over_90": 0.007421088113915175,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 42.71701908111572,
      "val_boundary_f1": 0.3072463768115942,
      "val_boundary_precision": 0.2602291325695581,
      "val_boundary_recall": 0.375,
      "val_complete_segments": 0.1661745046819278,
      "val_avg_segment_overlap": 0.6090093211856451,
      "val_verse_to_chorus_acc": 0.2831858407079646,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.42125567536763825,
      "val_pk_metric": 0.3107132040907675
    }
  ]
}