{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.16160864979184558,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1801791433282895,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009364363515835176,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "composite",
      "weight_decay": 0.018187351635761986,
      "gradient_clip_norm": 0.34503498859907583,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11774253101620555,
        "ece_after": 0.014343031072780494,
        "improvement": 0.10339949994342505,
        "params": {
          "temperature": 0.49937573337143754
        }
      },
      "platt": {
        "ece_before": 0.11774253101620555,
        "ece_after": 0.021707157093907144,
        "improvement": 0.09603537392229841,
        "params": {
          "A": 1.8796588792435904,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.556341215968132,
      "train_chorus_rate": 0.5079426742624491,
      "train_max_prob": 0.5848144203424454,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5935966521501541,
      "val_macro_f1": 0.42930810126717966,
      "val_verse_f1": 0.8210281054317752,
      "val_chorus_f1": 0.037588097102584185,
      "val_chorus_rate": 0.013994654756970704,
      "val_max_prob": 0.5988423824310303,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00092621558726206,
      "epoch_time": 65.0683331489563,
      "val_boundary_f1": 0.008620689655172414,
      "val_boundary_precision": 0.05,
      "val_boundary_recall": 0.0047169811320754715,
      "val_complete_segments": 0.0532656463462402,
      "val_avg_segment_overlap": 0.1707137165513971,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.28973713046164334,
      "val_pk_metric": 0.2816820950740775
    },
    {
      "epoch": 2,
      "train_loss": 0.5400208786129952,
      "train_chorus_rate": 0.4804810389410704,
      "train_max_prob": 0.599302613735199,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5728919208049774,
      "val_macro_f1": 0.6197220437017995,
      "val_verse_f1": 0.8206940874035991,
      "val_chorus_f1": 0.41874999999999996,
      "val_chorus_rate": 0.1724262870848179,
      "val_max_prob": 0.5851114243268967,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008959999907432035,
      "epoch_time": 60.51942706108093,
      "val_boundary_f1": 0.30751445086705204,
      "val_boundary_precision": 0.30158730158730157,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.1564494391376682,
      "val_avg_segment_overlap": 0.4180735726209454,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.25757575757575757,
      "val_window_diff": 0.38966903831573774,
      "val_pk_metric": 0.31578992332924793
    },
    {
      "epoch": 3,
      "train_loss": 0.5165755495429039,
      "train_chorus_rate": 0.37424031868577,
      "train_max_prob": 0.6236525923013687,
      "train_conf_over_90": 0.0037156200967729093,
      "train_conf_over_95": 0.0003696151019539684,
      "val_loss": 0.5459616780281067,
      "val_macro_f1": 0.7038680167247734,
      "val_verse_f1": 0.8250261415127222,
      "val_chorus_f1": 0.5827098919368245,
      "val_chorus_rate": 0.2927344925701618,
      "val_max_prob": 0.6807876378297806,
      "val_conf_over_90": 0.0009348820603918284,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008471101285853408,
      "epoch_time": 52.94481897354126,
      "val_boundary_f1": 0.3629268292682927,
      "val_boundary_precision": 0.30948419301164726,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.2384258937016095,
      "val_avg_segment_overlap": 0.5665935114462063,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.3756790515524344,
      "val_pk_metric": 0.29365367536388154
    },
    {
      "epoch": 4,
      "train_loss": 0.512309941649437,
      "train_chorus_rate": 0.40268524289131163,
      "train_max_prob": 0.6644418776035309,
      "train_conf_over_90": 0.01069959411979653,
      "train_conf_over_95": 9.299741650465876e-05,
      "val_loss": 0.5102773830294609,
      "val_macro_f1": 0.7191961691516672,
      "val_verse_f1": 0.7994652406417112,
      "val_chorus_f1": 0.6389270976616231,
      "val_chorus_rate": 0.41529739648103714,
      "val_max_prob": 0.6600092947483063,
      "val_conf_over_90": 0.0041355398134328425,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007816827223643574,
      "epoch_time": 53.799784898757935,
      "val_boundary_f1": 0.36363636363636365,
      "val_boundary_precision": 0.3059581320450886,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.2275812189253335,
      "val_avg_segment_overlap": 0.6228434032785227,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.40440807330548734,
      "val_pk_metric": 0.30966784816111725
    },
    {
      "epoch": 5,
      "train_loss": 0.49172143787145617,
      "train_chorus_rate": 0.3477861098945141,
      "train_max_prob": 0.6838533461093903,
      "train_conf_over_90": 0.024246344208950176,
      "train_conf_over_95": 0.0018208933906862512,
      "val_loss": 0.5094950720667839,
      "val_macro_f1": 0.7321487910855333,
      "val_verse_f1": 0.8076628352490421,
      "val_chorus_f1": 0.6566347469220245,
      "val_chorus_rate": 0.4190778508782387,
      "val_max_prob": 0.6131422817707062,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007025772636876382,
      "epoch_time": 47.051488161087036,
      "val_boundary_f1": 0.36250000000000004,
      "val_boundary_precision": 0.2916666666666667,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2505423864252072,
      "val_avg_segment_overlap": 0.642483116503952,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4260624354929459,
      "val_pk_metric": 0.31275802487094306
    },
    {
      "epoch": 6,
      "train_loss": 0.48268246054649355,
      "train_chorus_rate": 0.34833901524543764,
      "train_max_prob": 0.6637313336133956,
      "train_conf_over_90": 0.027277896617306396,
      "train_conf_over_95": 0.0020122737274505197,
      "val_loss": 0.5077395886182785,
      "val_macro_f1": 0.7267030555788137,
      "val_verse_f1": 0.8097928436911488,
      "val_chorus_f1": 0.6436132674664785,
      "val_chorus_rate": 0.3974810764193535,
      "val_max_prob": 0.7093147784471512,
      "val_conf_over_90": 0.032353777438402176,
      "val_conf_over_95": 0.005296463845297694,
      "learning_rate": 0.0006132510406894614,
      "epoch_time": 59.862300157547,
      "val_boundary_f1": 0.36947791164658633,
      "val_boundary_precision": 0.32167832167832167,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.2435352410431944,
      "val_avg_segment_overlap": 0.6172272907543254,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3899934955610912,
      "val_pk_metric": 0.28958652359686976
    },
    {
      "epoch": 7,
      "train_loss": 0.4895544171333313,
      "train_chorus_rate": 0.3604144647717476,
      "train_max_prob": 0.7033186733722687,
      "train_conf_over_90": 0.04213290720363148,
      "train_conf_over_95": 0.0044323986483505,
      "val_loss": 0.5191555172204971,
      "val_macro_f1": 0.7484251003951896,
      "val_verse_f1": 0.8548748921484037,
      "val_chorus_f1": 0.6419753086419754,
      "val_chorus_rate": 0.27840936556458473,
      "val_max_prob": 0.708031564950943,
      "val_conf_over_90": 0.007758533523883671,
      "val_conf_over_95": 0.0004625346919056028,
      "learning_rate": 0.0005176080379496217,
      "epoch_time": 56.700353145599365,
      "val_boundary_f1": 0.4166666666666667,
      "val_boundary_precision": 0.3595890410958904,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2937091670522211,
      "val_avg_segment_overlap": 0.6386448902397599,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3350969868753496,
      "val_pk_metric": 0.25112648102446405
    },
    {
      "epoch": 8,
      "train_loss": 0.46898989379405975,
      "train_chorus_rate": 0.35179233402013776,
      "train_max_prob": 0.6823142856359482,
      "train_conf_over_90": 0.024894312582910062,
      "train_conf_over_95": 0.0023726599116344004,
      "val_loss": 0.49071289598941803,
      "val_macro_f1": 0.7618078119107334,
      "val_verse_f1": 0.847971145175834,
      "val_chorus_f1": 0.6756444786456328,
      "val_chorus_rate": 0.33947061002254486,
      "val_max_prob": 0.666730210185051,
      "val_conf_over_90": 0.0071101554785855114,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004198283136338962,
      "epoch_time": 64.7152349948883,
      "val_boundary_f1": 0.42005676442762535,
      "val_boundary_precision": 0.35071090047393366,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.33117997750818534,
      "val_avg_segment_overlap": 0.6686094783154155,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.3583897212329459,
      "val_pk_metric": 0.2507070729746678
    },
    {
      "epoch": 9,
      "train_loss": 0.4804894715547562,
      "train_chorus_rate": 0.3658756949007511,
      "train_max_prob": 0.685704055428505,
      "train_conf_over_90": 0.029042516928166152,
      "train_conf_over_95": 0.0026256642799125985,
      "val_loss": 0.5000177621841431,
      "val_macro_f1": 0.7619548696363849,
      "val_verse_f1": 0.8572430726061032,
      "val_chorus_f1": 0.6666666666666666,
      "val_chorus_rate": 0.30087512731552124,
      "val_max_prob": 0.6719874441623688,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003241853108940563,
      "epoch_time": 49.19426107406616,
      "val_boundary_f1": 0.4284377923292797,
      "val_boundary_precision": 0.3550387596899225,
      "val_boundary_recall": 0.5400943396226415,
      "val_complete_segments": 0.3329503890346944,
      "val_avg_segment_overlap": 0.6676891858129661,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3518025072319884,
      "val_pk_metric": 0.2448849428646139
    },
    {
      "epoch": 10,
      "train_loss": 0.4693176493048668,
      "train_chorus_rate": 0.3520618908107281,
      "train_max_prob": 0.6941514134407043,
      "train_conf_over_90": 0.021914248040411623,
      "train_conf_over_95": 0.00043989309633616356,
      "val_loss": 0.4888514578342438,
      "val_macro_f1": 0.7676727987140561,
      "val_verse_f1": 0.8547954991962851,
      "val_chorus_f1": 0.6805500982318271,
      "val_chorus_rate": 0.3263498395681381,
      "val_max_prob": 0.6827120035886765,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023485908789587954,
      "epoch_time": 46.89891576766968,
      "val_boundary_f1": 0.45197740112994345,
      "val_boundary_precision": 0.3761755485893417,
      "val_boundary_recall": 0.5660377358490566,
      "val_complete_segments": 0.3598054348849683,
      "val_avg_segment_overlap": 0.6867521909959847,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.33559653203209816,
      "val_pk_metric": 0.23840965851891624
    },
    {
      "epoch": 11,
      "train_loss": 0.46386453658342364,
      "train_chorus_rate": 0.33944680988788606,
      "train_max_prob": 0.6918001055717469,
      "train_conf_over_90": 0.009161002826294862,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4846881255507469,
      "val_macro_f1": 0.7616442070702052,
      "val_verse_f1": 0.8431838975297347,
      "val_chorus_f1": 0.6801045166106756,
      "val_chorus_rate": 0.3591766282916069,
      "val_max_prob": 0.7055232673883438,
      "val_conf_over_90": 0.009039415686856955,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015575362921916035,
      "epoch_time": 59.76321792602539,
      "val_boundary_f1": 0.4383301707779885,
      "val_boundary_precision": 0.36666666666666664,
      "val_boundary_recall": 0.5448113207547169,
      "val_complete_segments": 0.33710238415964816,
      "val_avg_segment_overlap": 0.6848680730099804,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.3564688192439194,
      "val_pk_metric": 0.25518238343240357
    },
    {
      "epoch": 12,
      "train_loss": 0.4656474471092224,
      "train_chorus_rate": 0.3842616781592369,
      "train_max_prob": 0.7018323361873626,
      "train_conf_over_90": 0.015642152493819596,
      "train_conf_over_95": 3.739715903066099e-05,
      "val_loss": 0.4798858240246773,
      "val_macro_f1": 0.755672130527445,
      "val_verse_f1": 0.8307345481871125,
      "val_chorus_f1": 0.6806097128677774,
      "val_chorus_rate": 0.39403779804706573,
      "val_max_prob": 0.6931576877832413,
      "val_conf_over_90": 0.012055083934683353,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.032622299817684e-05,
      "epoch_time": 52.80990123748779,
      "val_boundary_f1": 0.41722488038277517,
      "val_boundary_precision": 0.35104669887278583,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3294075699696061,
      "val_avg_segment_overlap": 0.6785141341452816,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.37721617616762354,
      "val_pk_metric": 0.27265369249822474
    },
    {
      "epoch": 13,
      "train_loss": 0.46040057092905046,
      "train_chorus_rate": 0.3742197766900063,
      "train_max_prob": 0.7018395155668259,
      "train_conf_over_90": 0.025347988796420397,
      "train_conf_over_95": 0.00011350714776199311,
      "val_loss": 0.4781588837504387,
      "val_macro_f1": 0.7584948503341544,
      "val_verse_f1": 0.8304956488838442,
      "val_chorus_f1": 0.6864940517844647,
      "val_chorus_rate": 0.4029039964079857,
      "val_max_prob": 0.7142526358366013,
      "val_conf_over_90": 0.040499260649085045,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.143636084031402e-05,
      "epoch_time": 54.660441875457764,
      "val_boundary_f1": 0.41802492809204217,
      "val_boundary_precision": 0.35218093699515346,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3274761638626962,
      "val_avg_segment_overlap": 0.681256910379537,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.36655218677388834,
      "val_pk_metric": 0.2664831027072159
    },
    {
      "epoch": 14,
      "train_loss": 0.4554724797606468,
      "train_chorus_rate": 0.355133655667305,
      "train_max_prob": 0.7133498311042785,
      "train_conf_over_90": 0.03600345207378268,
      "train_conf_over_95": 0.00021766465797554702,
      "val_loss": 0.47836901247501373,
      "val_macro_f1": 0.7597158840154886,
      "val_verse_f1": 0.8355422811274968,
      "val_chorus_f1": 0.6838894869034804,
      "val_chorus_rate": 0.3856651112437248,
      "val_max_prob": 0.7039331495761871,
      "val_conf_over_90": 0.02332541416399181,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1220764321457575e-05,
      "epoch_time": 58.21295428276062,
      "val_boundary_f1": 0.4250000000000001,
      "val_boundary_precision": 0.3587662337662338,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.32980924607382717,
      "val_avg_segment_overlap": 0.6816509684441351,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.37342210343789517,
      "val_pk_metric": 0.26715365970206373
    }
  ]
}