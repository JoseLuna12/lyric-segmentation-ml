{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1898475275424849,
      "layer_dropout": 0.24690134529224103,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 256,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 2991106,
      "lstm_params": 2990080,
      "attention_params": 0,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000910926575990696,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 14,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.015594662510007058,
      "gradient_clip_norm": 0.33715835697441765,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07839537436812238,
        "ece_after": 0.008520264624963811,
        "improvement": 0.06987510974315857,
        "params": {
          "temperature": 0.6128893373720464
        }
      },
      "platt": {
        "ece_before": 0.07839537436812238,
        "ece_after": 0.0916404418925405,
        "improvement": -0.01324506752441812,
        "params": {
          "A": 0.9999996370646613,
          "B": -0.08271976687298598
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5709782153367996,
      "train_chorus_rate": 0.46755634639412164,
      "train_max_prob": 0.550223883986473,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5912344753742218,
      "val_macro_f1": 0.4395239224349818,
      "val_verse_f1": 0.3854308235933678,
      "val_chorus_f1": 0.4936170212765958,
      "val_chorus_rate": 0.7980409264564514,
      "val_max_prob": 0.5546352416276932,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009009845365699611,
      "epoch_time": 145.4398808479309,
      "val_boundary_f1": 0.0784313725490196,
      "val_boundary_precision": 0.16058394160583941,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.028467004726283624,
      "val_avg_segment_overlap": 0.19471047911736405,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4172380180547997,
      "val_pk_metric": 0.413918126960231
    },
    {
      "epoch": 2,
      "train_loss": 0.5550281167030334,
      "train_chorus_rate": 0.5413173589855432,
      "train_max_prob": 0.5749424755573272,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5894865691661835,
      "val_macro_f1": 0.5750943670150988,
      "val_verse_f1": 0.766260162601626,
      "val_chorus_f1": 0.3839285714285715,
      "val_chorus_rate": 0.2506563551723957,
      "val_max_prob": 0.546497642993927,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008715929331376405,
      "epoch_time": 166.75579071044922,
      "val_boundary_f1": 0.09763313609467457,
      "val_boundary_precision": 0.13095238095238096,
      "val_boundary_recall": 0.07783018867924528,
      "val_complete_segments": 0.016767081427738903,
      "val_avg_segment_overlap": 0.2747128961633932,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.38207519524228095,
      "val_pk_metric": 0.36969279981251596
    },
    {
      "epoch": 3,
      "train_loss": 0.5473595052957535,
      "train_chorus_rate": 0.5172212932258844,
      "train_max_prob": 0.5924360960721969,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5962518751621246,
      "val_macro_f1": 0.5281782570313223,
      "val_verse_f1": 0.8001246300046736,
      "val_chorus_f1": 0.25623188405797104,
      "val_chorus_rate": 0.12435074895620346,
      "val_max_prob": 0.5841398984193802,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000824036319800288,
      "epoch_time": 178.88719415664673,
      "val_boundary_f1": 0.10749185667752444,
      "val_boundary_precision": 0.1736842105263158,
      "val_boundary_recall": 0.07783018867924528,
      "val_complete_segments": 0.03476061844301505,
      "val_avg_segment_overlap": 0.24008562329554792,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.3542551275646375,
      "val_pk_metric": 0.34788633010861436
    },
    {
      "epoch": 4,
      "train_loss": 0.5477732360363007,
      "train_chorus_rate": 0.48465698435902593,
      "train_max_prob": 0.5890076637268067,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.567064642906189,
      "val_macro_f1": 0.5975501144913555,
      "val_verse_f1": 0.6578385305425032,
      "val_chorus_f1": 0.537261698440208,
      "val_chorus_rate": 0.5526840463280678,
      "val_max_prob": 0.5667330622673035,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000760393148762695,
      "epoch_time": 138.38192200660706,
      "val_boundary_f1": 0.14795244385733156,
      "val_boundary_precision": 0.16816816816816818,
      "val_boundary_recall": 0.1320754716981132,
      "val_complete_segments": 0.054566739137258756,
      "val_avg_segment_overlap": 0.3336838239551321,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.11616161616161616,
      "val_window_diff": 0.4334428922214652,
      "val_pk_metric": 0.3807774856149454
    },
    {
      "epoch": 5,
      "train_loss": 0.5430233970284462,
      "train_chorus_rate": 0.42205503582954407,
      "train_max_prob": 0.6167035698890686,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5489895641803741,
      "val_macro_f1": 0.6000893213514844,
      "val_verse_f1": 0.6252310536044363,
      "val_chorus_f1": 0.5749475890985325,
      "val_chorus_rate": 0.6388330012559891,
      "val_max_prob": 0.5881066620349884,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000683444931993022,
      "epoch_time": 144.0821349620819,
      "val_boundary_f1": 0.1712403951701427,
      "val_boundary_precision": 0.1601642710472279,
      "val_boundary_recall": 0.18396226415094338,
      "val_complete_segments": 0.05596394758642903,
      "val_avg_segment_overlap": 0.41830529347095213,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.17676767676767677,
      "val_window_diff": 0.4866925361836021,
      "val_pk_metric": 0.40444699454034705
    },
    {
      "epoch": 6,
      "train_loss": 0.5072294801473618,
      "train_chorus_rate": 0.41923908665776255,
      "train_max_prob": 0.6564210236072541,
      "train_conf_over_90": 0.010029851028230041,
      "train_conf_over_95": 3.0940593569539486e-05,
      "val_loss": 0.5184884145855904,
      "val_macro_f1": 0.6743542046408686,
      "val_verse_f1": 0.7336933942667222,
      "val_chorus_f1": 0.615015015015015,
      "val_chorus_rate": 0.5188738107681274,
      "val_max_prob": 0.6559414863586426,
      "val_conf_over_90": 0.002246150193968788,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005965546758026141,
      "epoch_time": 129.54752779006958,
      "val_boundary_f1": 0.28378378378378377,
      "val_boundary_precision": 0.24019607843137256,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.1400389955930783,
      "val_avg_segment_overlap": 0.5723649773617181,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.4688239986939766,
      "val_pk_metric": 0.35964680272411725
    },
    {
      "epoch": 7,
      "train_loss": 0.49601338505744935,
      "train_chorus_rate": 0.401470934599638,
      "train_max_prob": 0.6668855220079422,
      "train_conf_over_90": 0.007225331477820873,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5173459872603416,
      "val_macro_f1": 0.6906911153397286,
      "val_verse_f1": 0.7494841106066858,
      "val_chorus_f1": 0.6318981200727714,
      "val_chorus_rate": 0.5115735083818436,
      "val_max_prob": 0.6767721921205521,
      "val_conf_over_90": 0.012579047353938222,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005035199013327007,
      "epoch_time": 171.7041847705841,
      "val_boundary_f1": 0.28960155490767736,
      "val_boundary_precision": 0.2462809917355372,
      "val_boundary_recall": 0.35141509433962265,
      "val_complete_segments": 0.13020141979579944,
      "val_avg_segment_overlap": 0.5849827541066056,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4646363089289167,
      "val_pk_metric": 0.3585817819492678
    },
    {
      "epoch": 8,
      "train_loss": 0.4767379999160767,
      "train_chorus_rate": 0.3916382104158401,
      "train_max_prob": 0.6861664324998855,
      "train_conf_over_90": 0.015538379925419576,
      "train_conf_over_95": 7.855459698475897e-05,
      "val_loss": 0.5171010568737984,
      "val_macro_f1": 0.7035511403795317,
      "val_verse_f1": 0.7854531460457957,
      "val_chorus_f1": 0.6216491347132677,
      "val_chorus_rate": 0.42490576207637787,
      "val_max_prob": 0.694410502910614,
      "val_conf_over_90": 0.015282178530469537,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00040840667465799553,
      "epoch_time": 143.90696692466736,
      "val_boundary_f1": 0.32979749276759884,
      "val_boundary_precision": 0.27895595432300163,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.1824692648261047,
      "val_avg_segment_overlap": 0.6061310091288049,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.45508290349013447,
      "val_pk_metric": 0.3439473549266573
    },
    {
      "epoch": 9,
      "train_loss": 0.46726884245872496,
      "train_chorus_rate": 0.38193765580654143,
      "train_max_prob": 0.7049803763628006,
      "train_conf_over_90": 0.032662203954532745,
      "train_conf_over_95": 0.0012884301773738115,
      "val_loss": 0.519730806350708,
      "val_macro_f1": 0.7161724915418225,
      "val_verse_f1": 0.8152193701074095,
      "val_chorus_f1": 0.6171256129762355,
      "val_chorus_rate": 0.3520846664905548,
      "val_max_prob": 0.6992897242307663,
      "val_conf_over_90": 0.01174533343873918,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00031537190018808206,
      "epoch_time": 116.32130217552185,
      "val_boundary_f1": 0.33849129593810445,
      "val_boundary_precision": 0.28688524590163933,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.1999578790273382,
      "val_avg_segment_overlap": 0.6193095195777173,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.403416201562351,
      "val_pk_metric": 0.31267241709044913
    },
    {
      "epoch": 10,
      "train_loss": 0.46545728743076326,
      "train_chorus_rate": 0.3884411111474037,
      "train_max_prob": 0.7021836191415787,
      "train_conf_over_90": 0.025870222621597348,
      "train_conf_over_95": 0.0009457526815822348,
      "val_loss": 0.5123974829912186,
      "val_macro_f1": 0.7174384042684803,
      "val_verse_f1": 0.8009855951478393,
      "val_chorus_f1": 0.6338912133891212,
      "val_chorus_rate": 0.4050671458244324,
      "val_max_prob": 0.6816441267728806,
      "val_conf_over_90": 0.009970676386728883,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022848164399767411,
      "epoch_time": 138.38854002952576,
      "val_boundary_f1": 0.3333333333333333,
      "val_boundary_precision": 0.28175895765472314,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.21088278666486512,
      "val_avg_segment_overlap": 0.6165824667327682,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.45565892941601116,
      "val_pk_metric": 0.343760273590942
    },
    {
      "epoch": 11,
      "train_loss": 0.46234932243824006,
      "train_chorus_rate": 0.38200885578989985,
      "train_max_prob": 0.6999162048101425,
      "train_conf_over_90": 0.019934408320114016,
      "train_conf_over_95": 0.0006147233041701838,
      "val_loss": 0.5061316192150116,
      "val_macro_f1": 0.734553913820208,
      "val_verse_f1": 0.8203414996288048,
      "val_chorus_f1": 0.648766328011611,
      "val_chorus_rate": 0.3782512694597244,
      "val_max_prob": 0.6837706714868546,
      "val_conf_over_90": 0.00981885869987309,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001515334272280011,
      "epoch_time": 158.77988004684448,
      "val_boundary_f1": 0.35483870967741943,
      "val_boundary_precision": 0.2968253968253968,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22690286484029853,
      "val_avg_segment_overlap": 0.6305710255533571,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.44462789374317124,
      "val_pk_metric": 0.3167818956120999
    },
    {
      "epoch": 12,
      "train_loss": 0.4574797451496124,
      "train_chorus_rate": 0.3793427929282188,
      "train_max_prob": 0.7080207616090775,
      "train_conf_over_90": 0.023737837525550275,
      "train_conf_over_95": 0.001431983185466379,
      "val_loss": 0.5016417875885963,
      "val_macro_f1": 0.7161948932003814,
      "val_verse_f1": 0.787843137254902,
      "val_chorus_f1": 0.6445466491458608,
      "val_chorus_rate": 0.44902344048023224,
      "val_max_prob": 0.7040116339921951,
      "val_conf_over_90": 0.02655032090842724,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 8.7890256190408e-05,
      "epoch_time": 179.96390676498413,
      "val_boundary_f1": 0.34619188921859545,
      "val_boundary_precision": 0.2981260647359455,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.18243349014823032,
      "val_avg_segment_overlap": 0.6161295872029923,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4476723757830252,
      "val_pk_metric": 0.333083088364433
    },
    {
      "epoch": 13,
      "train_loss": 0.44889035224914553,
      "train_chorus_rate": 0.3662794753909111,
      "train_max_prob": 0.7100602239370346,
      "train_conf_over_90": 0.025472460594028235,
      "train_conf_over_95": 0.002195959762320854,
      "val_loss": 0.5020525753498077,
      "val_macro_f1": 0.7210345843061661,
      "val_verse_f1": 0.7955030044582283,
      "val_chorus_f1": 0.6465661641541038,
      "val_chorus_rate": 0.4344499260187149,
      "val_max_prob": 0.7089730352163315,
      "val_conf_over_90": 0.030520901549607515,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 4.033364285305534e-05,
      "epoch_time": 125.57309889793396,
      "val_boundary_f1": 0.33595284872298625,
      "val_boundary_precision": 0.2878787878787879,
      "val_boundary_recall": 0.4033018867924528,
      "val_complete_segments": 0.1994195016862037,
      "val_avg_segment_overlap": 0.6202698164010397,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4466504674752959,
      "val_pk_metric": 0.3326465495761022
    },
    {
      "epoch": 14,
      "train_loss": 0.45078134834766387,
      "train_chorus_rate": 0.38310293555259706,
      "train_max_prob": 0.7171815693378448,
      "train_conf_over_90": 0.037038832902908325,
      "train_conf_over_95": 0.0029467931162798777,
      "val_loss": 0.5026690736413002,
      "val_macro_f1": 0.7191296748395333,
      "val_verse_f1": 0.7946584091348946,
      "val_chorus_f1": 0.643600940544172,
      "val_chorus_rate": 0.43263570964336395,
      "val_max_prob": 0.7072005718946457,
      "val_conf_over_90": 0.03005803655833006,
      "val_conf_over_95": 0.00047234738303814083,
      "learning_rate": 1.0942039420734895e-05,
      "epoch_time": 145.97379088401794,
      "val_boundary_f1": 0.33791748526522597,
      "val_boundary_precision": 0.2895622895622896,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.19378767686031736,
      "val_avg_segment_overlap": 0.613977476105172,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.44618727997113294,
      "val_pk_metric": 0.33098968081983404
    }
  ]
}