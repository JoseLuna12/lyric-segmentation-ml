{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.1549297799679336,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.20632001503235217,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007995831278831913,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 10,
      "validation_strategy": "composite",
      "weight_decay": 0.015167024431070649,
      "gradient_clip_norm": 0.3075451784219631,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08374689965854694,
        "ece_after": 0.014154914246912322,
        "improvement": 0.06959198541163461,
        "params": {
          "temperature": 0.6355019374772108
        }
      },
      "platt": {
        "ece_before": 0.08374689965854694,
        "ece_after": 0.028482214626371287,
        "improvement": 0.05526468503217565,
        "params": {
          "A": 1.4181397591060492,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5715845465660095,
      "train_chorus_rate": 0.42840890075312926,
      "train_max_prob": 0.6076847553253174,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5940624624490738,
      "val_macro_f1": 0.4739684334516182,
      "val_verse_f1": 0.8192735359525574,
      "val_chorus_f1": 0.12866333095067908,
      "val_chorus_rate": 0.0440571578219533,
      "val_max_prob": 0.5767495185136795,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007908576492043165,
      "epoch_time": 65.98005890846252,
      "val_boundary_f1": 0.08679245283018869,
      "val_boundary_precision": 0.2169811320754717,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.05108284507807308,
      "val_avg_segment_overlap": 0.20774246817677974,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.32103348748931887,
      "val_pk_metric": 0.3026805938065813
    },
    {
      "epoch": 2,
      "train_loss": 0.5510760456323623,
      "train_chorus_rate": 0.5296674743294716,
      "train_max_prob": 0.6077307134866714,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5813367664813995,
      "val_macro_f1": 0.39055701210976596,
      "val_verse_f1": 0.2937226277372263,
      "val_chorus_f1": 0.4873913964823056,
      "val_chorus_rate": 0.8593984246253967,
      "val_max_prob": 0.6187150776386261,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007650625584554505,
      "epoch_time": 60.526593923568726,
      "val_boundary_f1": 0.04285714285714286,
      "val_boundary_precision": 0.08823529411764706,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.02051467085931561,
      "val_avg_segment_overlap": 0.17605675324630962,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.40473119683530173,
      "val_pk_metric": 0.3978457324460807
    },
    {
      "epoch": 3,
      "train_loss": 0.5385964408516883,
      "train_chorus_rate": 0.4366721956059337,
      "train_max_prob": 0.6091649860143662,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6047754883766174,
      "val_macro_f1": 0.6416864734243868,
      "val_verse_f1": 0.819435325016415,
      "val_chorus_f1": 0.46393762183235865,
      "val_chorus_rate": 0.20509428158402443,
      "val_max_prob": 0.6799290031194687,
      "val_conf_over_90": 0.005665024742484093,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007233252248808976,
      "epoch_time": 54.63742208480835,
      "val_boundary_f1": 0.31922611850060456,
      "val_boundary_precision": 0.32754342431761785,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.16690002947956287,
      "val_avg_segment_overlap": 0.43326271104363445,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.36411467612840454,
      "val_pk_metric": 0.297221232062639
    },
    {
      "epoch": 4,
      "train_loss": 0.5168427973985672,
      "train_chorus_rate": 0.42953365445137026,
      "train_max_prob": 0.6715817511081695,
      "train_conf_over_90": 0.010666461603250355,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5336717814207077,
      "val_macro_f1": 0.714380549179607,
      "val_verse_f1": 0.823592112275715,
      "val_chorus_f1": 0.605168986083499,
      "val_chorus_rate": 0.31945254653692245,
      "val_max_prob": 0.6871333420276642,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006674697702358124,
      "epoch_time": 54.805609941482544,
      "val_boundary_f1": 0.378698224852071,
      "val_boundary_precision": 0.3254237288135593,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24827803868100792,
      "val_avg_segment_overlap": 0.5807470502387467,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.36316943173694605,
      "val_pk_metric": 0.2700655868663353
    },
    {
      "epoch": 5,
      "train_loss": 0.48684864342212675,
      "train_chorus_rate": 0.37264704033732415,
      "train_max_prob": 0.6846171826124191,
      "train_conf_over_90": 0.009659398312214762,
      "train_conf_over_95": 0.00012676366313826292,
      "val_loss": 0.5047361254692078,
      "val_macro_f1": 0.6624547509998575,
      "val_verse_f1": 0.7143465304384846,
      "val_chorus_f1": 0.6105629715612304,
      "val_chorus_rate": 0.5468899458646774,
      "val_max_prob": 0.6525350362062454,
      "val_conf_over_90": 0.005180877051316202,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005999373459123935,
      "epoch_time": 47.701329946517944,
      "val_boundary_f1": 0.2509578544061303,
      "val_boundary_precision": 0.21129032258064517,
      "val_boundary_recall": 0.3089622641509434,
      "val_complete_segments": 0.14787909216594264,
      "val_avg_segment_overlap": 0.5620981730745425,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.48166626623639397,
      "val_pk_metric": 0.36803520753534374
    },
    {
      "epoch": 6,
      "train_loss": 0.4775402009487152,
      "train_chorus_rate": 0.34838973060250283,
      "train_max_prob": 0.6767927706241608,
      "train_conf_over_90": 0.010042613639961928,
      "train_conf_over_95": 0.00010495074384380132,
      "val_loss": 0.5173819065093994,
      "val_macro_f1": 0.7151367924016628,
      "val_verse_f1": 0.7913195117225345,
      "val_chorus_f1": 0.6389540730807912,
      "val_chorus_rate": 0.4337010830640793,
      "val_max_prob": 0.7322497069835663,
      "val_conf_over_90": 0.06843846198171377,
      "val_conf_over_95": 0.0031758068944327533,
      "learning_rate": 0.0005236794429100997,
      "epoch_time": 60.932854652404785,
      "val_boundary_f1": 0.37252861602497395,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.23036905068983543,
      "val_avg_segment_overlap": 0.6056499341898925,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.37578951433693275,
      "val_pk_metric": 0.29654030094188255
    },
    {
      "epoch": 7,
      "train_loss": 0.48071262538433074,
      "train_chorus_rate": 0.35584047734737395,
      "train_max_prob": 0.7110257923603058,
      "train_conf_over_90": 0.02966368129127659,
      "train_conf_over_95": 0.0010117561585502699,
      "val_loss": 0.5146244987845421,
      "val_macro_f1": 0.7434787263078351,
      "val_verse_f1": 0.845910845910846,
      "val_chorus_f1": 0.6410466067048242,
      "val_chorus_rate": 0.30222805589437485,
      "val_max_prob": 0.7208205610513687,
      "val_conf_over_90": 0.009281133592594415,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004420288975161487,
      "epoch_time": 58.03258490562439,
      "val_boundary_f1": 0.41906653426017876,
      "val_boundary_precision": 0.36192109777015435,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3012401205932489,
      "val_avg_segment_overlap": 0.635724838895837,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.33480111977430277,
      "val_pk_metric": 0.25121730586089863
    },
    {
      "epoch": 8,
      "train_loss": 0.46445564925670624,
      "train_chorus_rate": 0.36357370018959045,
      "train_max_prob": 0.6902415215969085,
      "train_conf_over_90": 0.0147216085344553,
      "train_conf_over_95": 2.9256875859573483e-05,
      "val_loss": 0.5057308748364449,
      "val_macro_f1": 0.7565878754348144,
      "val_verse_f1": 0.863768115942029,
      "val_chorus_f1": 0.6494076349275999,
      "val_chorus_rate": 0.26111314073204994,
      "val_max_prob": 0.6829123646020889,
      "val_conf_over_90": 0.001166149420896545,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003585542303670428,
      "epoch_time": 64.95906591415405,
      "val_boundary_f1": 0.40845070422535207,
      "val_boundary_precision": 0.356140350877193,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.29796485244523424,
      "val_avg_segment_overlap": 0.6338530746635213,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.3259441013659829,
      "val_pk_metric": 0.24259365371045655
    },
    {
      "epoch": 9,
      "train_loss": 0.47972248047590255,
      "train_chorus_rate": 0.3614442080259323,
      "train_max_prob": 0.690170156955719,
      "train_conf_over_90": 0.01846630370710045,
      "train_conf_over_95": 3.417634870857e-05,
      "val_loss": 0.5062359869480133,
      "val_macro_f1": 0.7543639338309209,
      "val_verse_f1": 0.86288536876171,
      "val_chorus_f1": 0.6458424989001319,
      "val_chorus_rate": 0.25928910821676254,
      "val_max_prob": 0.6792977750301361,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002769036849730917,
      "epoch_time": 49.69265794754028,
      "val_boundary_f1": 0.4234841193455246,
      "val_boundary_precision": 0.35772357723577236,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.31120209741630733,
      "val_avg_segment_overlap": 0.64973062876223,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3316657207006023,
      "val_pk_metric": 0.23973091817571762
    },
    {
      "epoch": 10,
      "train_loss": 0.4647110655903816,
      "train_chorus_rate": 0.33626741990447045,
      "train_max_prob": 0.7037973195314408,
      "train_conf_over_90": 0.014673281117575243,
      "train_conf_over_95": 3.576538001652807e-05,
      "val_loss": 0.47998813539743423,
      "val_macro_f1": 0.7529859802232507,
      "val_verse_f1": 0.830026207412954,
      "val_chorus_f1": 0.6759457530335474,
      "val_chorus_rate": 0.38900770992040634,
      "val_max_prob": 0.6934568285942078,
      "val_conf_over_90": 0.0064068506471812725,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002006457819707979,
      "epoch_time": 47.14681792259216,
      "val_boundary_f1": 0.4202626641651032,
      "val_boundary_precision": 0.34890965732087226,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3319681634368803,
      "val_avg_segment_overlap": 0.680788872318303,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.3787210288229733,
      "val_pk_metric": 0.2671753237247941
    }
  ]
}