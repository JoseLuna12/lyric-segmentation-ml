{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.167216422638474,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.21647275612733344,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00035528467830571523,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.013403809248506373,
      "gradient_clip_norm": 0.3970807739147053,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06885371303043104,
        "ece_after": 0.02235096258299759,
        "improvement": 0.046502750447433454,
        "params": {
          "temperature": 0.6930786389733736
        }
      },
      "platt": {
        "ece_before": 0.06885371303043104,
        "ece_after": 0.021396534645487145,
        "improvement": 0.0474571783849439,
        "params": {
          "A": 1.4085030139422192,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5530885621905327,
      "train_chorus_rate": 0.4176975697278976,
      "train_max_prob": 0.562816721200943,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5786372870206833,
      "val_macro_f1": 0.5849791484749265,
      "val_verse_f1": 0.7833167165171153,
      "val_chorus_f1": 0.38664158043273755,
      "val_chorus_rate": 0.22304848209023476,
      "val_max_prob": 0.6051378101110458,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003514136931835994,
      "epoch_time": 52.477147817611694,
      "val_boundary_f1": 0.1940085592011412,
      "val_boundary_precision": 0.24548736462093862,
      "val_boundary_recall": 0.16037735849056603,
      "val_complete_segments": 0.07826133018338746,
      "val_avg_segment_overlap": 0.29598933414959355,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.32416283607252167,
      "val_pk_metric": 0.3022507857518355
    },
    {
      "epoch": 2,
      "train_loss": 0.5514687746763229,
      "train_chorus_rate": 0.43499721502885225,
      "train_max_prob": 0.6174238115549088,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6312509626150131,
      "val_macro_f1": 0.4295368294902239,
      "val_verse_f1": 0.8240418118466899,
      "val_chorus_f1": 0.03503184713375796,
      "val_chorus_rate": 0.00843824545154348,
      "val_max_prob": 0.6945909708738327,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00033996991844213574,
      "epoch_time": 49.33963489532471,
      "val_boundary_f1": 0.004464285714285714,
      "val_boundary_precision": 0.041666666666666664,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.05708388095715773,
      "val_avg_segment_overlap": 0.17378866942582322,
      "val_verse_to_chorus_acc": 0.0,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.2747220237895879,
      "val_pk_metric": 0.2755063531536668
    },
    {
      "epoch": 3,
      "train_loss": 0.512213283777237,
      "train_chorus_rate": 0.34741122454870493,
      "train_max_prob": 0.6292834728956223,
      "train_conf_over_90": 0.00149732593272347,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5331805944442749,
      "val_macro_f1": 0.676796886040194,
      "val_verse_f1": 0.7791868705706826,
      "val_chorus_f1": 0.5744069015097053,
      "val_chorus_rate": 0.38445867598056793,
      "val_max_prob": 0.6393297761678696,
      "val_conf_over_90": 0.01188961649313569,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003214535019508501,
      "epoch_time": 62.22845506668091,
      "val_boundary_f1": 0.2648648648648648,
      "val_boundary_precision": 0.21428571428571427,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.13063695986548585,
      "val_avg_segment_overlap": 0.5210864213827762,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.3923700903110975,
      "val_pk_metric": 0.31574840874316235
    },
    {
      "epoch": 4,
      "train_loss": 0.4888631537556648,
      "train_chorus_rate": 0.371843533962965,
      "train_max_prob": 0.6729057848453521,
      "train_conf_over_90": 0.030724000826012343,
      "train_conf_over_95": 0.0017254999082069844,
      "val_loss": 0.5039522126317024,
      "val_macro_f1": 0.7055274313843662,
      "val_verse_f1": 0.7955614068083505,
      "val_chorus_f1": 0.615493455960382,
      "val_chorus_rate": 0.3954831287264824,
      "val_max_prob": 0.665661409497261,
      "val_conf_over_90": 0.017069217516109347,
      "val_conf_over_95": 0.0005073207139503211,
      "learning_rate": 0.00029667369996203577,
      "epoch_time": 60.172313928604126,
      "val_boundary_f1": 0.2993421052631579,
      "val_boundary_precision": 0.2297979797979798,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.17071526154240896,
      "val_avg_segment_overlap": 0.5684198629371118,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4470135788009892,
      "val_pk_metric": 0.32609044643822593
    },
    {
      "epoch": 5,
      "train_loss": 0.4791674390435219,
      "train_chorus_rate": 0.38038635328412057,
      "train_max_prob": 0.6897835999727249,
      "train_conf_over_90": 0.033436771761626,
      "train_conf_over_95": 0.0017446344689233228,
      "val_loss": 0.5116758272051811,
      "val_macro_f1": 0.6637118497805796,
      "val_verse_f1": 0.735478648046954,
      "val_chorus_f1": 0.5919450515142054,
      "val_chorus_rate": 0.48832160234451294,
      "val_max_prob": 0.6699198484420776,
      "val_conf_over_90": 0.022470582858659327,
      "val_conf_over_95": 0.0021458175615407526,
      "learning_rate": 0.00026671350872928647,
      "epoch_time": 48.56138205528259,
      "val_boundary_f1": 0.239202657807309,
      "val_boundary_precision": 0.18461538461538463,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.11680572217422694,
      "val_avg_segment_overlap": 0.5360753708602858,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.5004940411075897,
      "val_pk_metric": 0.3681631028524851
    },
    {
      "epoch": 6,
      "train_loss": 0.4792018041014671,
      "train_chorus_rate": 0.3957667492330074,
      "train_max_prob": 0.6837503850460053,
      "train_conf_over_90": 0.02575114506762475,
      "train_conf_over_95": 0.0007804338441928848,
      "val_loss": 0.4880238398909569,
      "val_macro_f1": 0.7261504106467643,
      "val_verse_f1": 0.8077941732879304,
      "val_chorus_f1": 0.6445066480055983,
      "val_chorus_rate": 0.4037391021847725,
      "val_max_prob": 0.684663936495781,
      "val_conf_over_90": 0.02760616596788168,
      "val_conf_over_95": 0.00227589815040119,
      "learning_rate": 0.0002328823323744213,
      "epoch_time": 51.077378034591675,
      "val_boundary_f1": 0.3131313131313132,
      "val_boundary_precision": 0.24345549738219896,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.18906743245290436,
      "val_avg_segment_overlap": 0.6158835079421006,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.45199686282434814,
      "val_pk_metric": 0.3299542987576675
    },
    {
      "epoch": 7,
      "train_loss": 0.44507830739021303,
      "train_chorus_rate": 0.346164733171463,
      "train_max_prob": 0.7084480404853821,
      "train_conf_over_90": 0.05646189553663135,
      "train_conf_over_95": 0.004024794494034723,
      "val_loss": 0.49717745184898376,
      "val_macro_f1": 0.7329166293836217,
      "val_verse_f1": 0.8316299085529855,
      "val_chorus_f1": 0.6342033502142579,
      "val_chorus_rate": 0.33249683678150177,
      "val_max_prob": 0.7010551691055298,
      "val_conf_over_90": 0.04260806925594807,
      "val_conf_over_95": 0.0032555662328377366,
      "learning_rate": 0.00019665875564414337,
      "epoch_time": 66.84813904762268,
      "val_boundary_f1": 0.3378016085790885,
      "val_boundary_precision": 0.2719424460431655,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.22175175478462858,
      "val_avg_segment_overlap": 0.6237503487356545,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3974338092765735,
      "val_pk_metric": 0.28739125449169034
    },
    {
      "epoch": 8,
      "train_loss": 0.4478145569562912,
      "train_chorus_rate": 0.33414774760603905,
      "train_max_prob": 0.6978077441453934,
      "train_conf_over_90": 0.031474355712998656,
      "train_conf_over_95": 0.0029475741961505265,
      "val_loss": 0.5065150409936905,
      "val_macro_f1": 0.7231327863358321,
      "val_verse_f1": 0.820838627700127,
      "val_chorus_f1": 0.6254269449715371,
      "val_chorus_rate": 0.34869617968797684,
      "val_max_prob": 0.7264185547828674,
      "val_conf_over_90": 0.07641523331403732,
      "val_conf_over_95": 0.00623049185378477,
      "learning_rate": 0.000159625922661572,
      "epoch_time": 57.135947942733765,
      "val_boundary_f1": 0.3108715184186882,
      "val_boundary_precision": 0.251088534107402,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.1918039138214112,
      "val_avg_segment_overlap": 0.6062206732221825,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4328121952121845,
      "val_pk_metric": 0.3132047095636723
    },
    {
      "epoch": 9,
      "train_loss": 0.4557446166872978,
      "train_chorus_rate": 0.35140751004219056,
      "train_max_prob": 0.7173159748315812,
      "train_conf_over_90": 0.05787901137955487,
      "train_conf_over_95": 0.00782773334067315,
      "val_loss": 0.4829754903912544,
      "val_macro_f1": 0.7417234917531708,
      "val_verse_f1": 0.8385137549124688,
      "val_chorus_f1": 0.6449332285938727,
      "val_chorus_rate": 0.3268892839550972,
      "val_max_prob": 0.7007428109645844,
      "val_conf_over_90": 0.029391601216048002,
      "val_conf_over_95": 0.0007735613908153027,
      "learning_rate": 0.00012340234593129405,
      "epoch_time": 53.49691700935364,
      "val_boundary_f1": 0.3691215616681455,
      "val_boundary_precision": 0.2958748221906117,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.24895371435668362,
      "val_avg_segment_overlap": 0.6342225312397325,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3671672854784783,
      "val_pk_metric": 0.2703579543713566
    },
    {
      "epoch": 10,
      "train_loss": 0.4479470133781433,
      "train_chorus_rate": 0.3554780215024948,
      "train_max_prob": 0.7109546482563018,
      "train_conf_over_90": 0.05119615690782666,
      "train_conf_over_95": 0.004999769933056087,
      "val_loss": 0.4847042039036751,
      "val_macro_f1": 0.7517067361683012,
      "val_verse_f1": 0.8556094182825484,
      "val_chorus_f1": 0.6478040540540541,
      "val_chorus_rate": 0.28351372480392456,
      "val_max_prob": 0.7120105028152466,
      "val_conf_over_90": 0.028822345659136772,
      "val_conf_over_95": 0.0013312033843249083,
      "learning_rate": 8.957116957642888e-05,
      "epoch_time": 54.21386480331421,
      "val_boundary_f1": 0.3728191000918274,
      "val_boundary_precision": 0.30526315789473685,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2516219559962932,
      "val_avg_segment_overlap": 0.635630731224359,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3553335322625997,
      "val_pk_metric": 0.25667442060480516
    },
    {
      "epoch": 11,
      "train_loss": 0.43170838207006457,
      "train_chorus_rate": 0.3055469125509262,
      "train_max_prob": 0.7183674544095993,
      "train_conf_over_90": 0.04896235568448901,
      "train_conf_over_95": 0.0057458431896520775,
      "val_loss": 0.4739062786102295,
      "val_macro_f1": 0.7384349827310238,
      "val_verse_f1": 0.8232894492861116,
      "val_chorus_f1": 0.653580516175936,
      "val_chorus_rate": 0.37746093422174454,
      "val_max_prob": 0.7166813910007477,
      "val_conf_over_90": 0.06676603294909,
      "val_conf_over_95": 0.007606171362567693,
      "learning_rate": 5.961097834367956e-05,
      "epoch_time": 55.77233409881592,
      "val_boundary_f1": 0.3286467486818981,
      "val_boundary_precision": 0.2619047619047619,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.22052430972102235,
      "val_avg_segment_overlap": 0.6303736357727123,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40005336051264007,
      "val_pk_metric": 0.29986499954494966
    },
    {
      "epoch": 12,
      "train_loss": 0.42659690231084824,
      "train_chorus_rate": 0.3396336428821087,
      "train_max_prob": 0.731703695654869,
      "train_conf_over_90": 0.08561943229287863,
      "train_conf_over_95": 0.018956224177964033,
      "val_loss": 0.4721367433667183,
      "val_macro_f1": 0.7556235651098112,
      "val_verse_f1": 0.8433038134827401,
      "val_chorus_f1": 0.6679433167368823,
      "val_chorus_rate": 0.3429393693804741,
      "val_max_prob": 0.7177085429430008,
      "val_conf_over_90": 0.0505571449175477,
      "val_conf_over_95": 0.004300593689549714,
      "learning_rate": 3.48311763548652e-05,
      "epoch_time": 48.469322204589844,
      "val_boundary_f1": 0.3667262969588551,
      "val_boundary_precision": 0.2953890489913545,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.26277869105281615,
      "val_avg_segment_overlap": 0.6490861266431055,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3640321885135553,
      "val_pk_metric": 0.27523929565832383
    },
    {
      "epoch": 13,
      "train_loss": 0.4346094936132431,
      "train_chorus_rate": 0.3600185364484787,
      "train_max_prob": 0.7223317444324493,
      "train_conf_over_90": 0.06790779577568173,
      "train_conf_over_95": 0.013088153256103397,
      "val_loss": 0.4697640612721443,
      "val_macro_f1": 0.7546238707840448,
      "val_verse_f1": 0.8418191701395181,
      "val_chorus_f1": 0.6674285714285715,
      "val_chorus_rate": 0.3464513495564461,
      "val_max_prob": 0.71479532122612,
      "val_conf_over_90": 0.04506798880174756,
      "val_conf_over_95": 0.003350673578097485,
      "learning_rate": 1.6314759863579478e-05,
      "epoch_time": 54.0429801940918,
      "val_boundary_f1": 0.3616636528028933,
      "val_boundary_precision": 0.2932551319648094,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.26375733406486324,
      "val_avg_segment_overlap": 0.6454559197053735,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3667986805077239,
      "val_pk_metric": 0.27825716138583
    },
    {
      "epoch": 14,
      "train_loss": 0.42285437434911727,
      "train_chorus_rate": 0.3235641434788704,
      "train_max_prob": 0.725209328532219,
      "train_conf_over_90": 0.06327803088352084,
      "train_conf_over_95": 0.007921622780850157,
      "val_loss": 0.4710824638605118,
      "val_macro_f1": 0.7565870320942603,
      "val_verse_f1": 0.8454758050008995,
      "val_chorus_f1": 0.6676982591876209,
      "val_chorus_rate": 0.336703360080719,
      "val_max_prob": 0.7202331572771072,
      "val_conf_over_90": 0.0520192664116621,
      "val_conf_over_95": 0.004064100998220965,
      "learning_rate": 4.870985122115851e-06,
      "epoch_time": 54.822674036026,
      "val_boundary_f1": 0.37522768670309653,
      "val_boundary_precision": 0.3056379821958457,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2702931646993153,
      "val_avg_segment_overlap": 0.6488049467365783,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3627455163033132,
      "val_pk_metric": 0.2713181553868262
    },
    {
      "epoch": 15,
      "train_loss": 0.4173487275838852,
      "train_chorus_rate": 0.32300922498106954,
      "train_max_prob": 0.733184763789177,
      "train_conf_over_90": 0.07907238472253084,
      "train_conf_over_95": 0.015271214867243543,
      "val_loss": 0.4702594578266144,
      "val_macro_f1": 0.7541744102382703,
      "val_verse_f1": 0.8389335281227174,
      "val_chorus_f1": 0.6694152923538231,
      "val_chorus_rate": 0.3570806682109833,
      "val_max_prob": 0.7202952951192856,
      "val_conf_over_90": 0.05924544669687748,
      "val_conf_over_95": 0.005315235175658017,
      "learning_rate": 1e-06,
      "epoch_time": 59.836264848709106,
      "val_boundary_f1": 0.3576036866359447,
      "val_boundary_precision": 0.2934947049924357,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2514378110878641,
      "val_avg_segment_overlap": 0.6466447524899008,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.36702266530067407,
      "val_pk_metric": 0.28358487687604694
    }
  ]
}