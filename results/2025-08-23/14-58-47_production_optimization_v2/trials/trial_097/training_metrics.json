{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.16935005135608316,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.20339674526239543,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008336219614600974,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "composite",
      "weight_decay": 0.020289351130826635,
      "gradient_clip_norm": 0.34061215466524103,
      "max_epochs": 8,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07632073929829776,
        "ece_after": 0.027210664757928126,
        "improvement": 0.049110074540369635,
        "params": {
          "temperature": 0.6609159631217666
        }
      },
      "platt": {
        "ece_before": 0.07632073929829776,
        "ece_after": 0.028550480812612355,
        "improvement": 0.047770258485685405,
        "params": {
          "A": 1.4818096763715194,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5605572551488877,
      "train_chorus_rate": 0.4841552774858428,
      "train_max_prob": 0.5851218700408936,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5789905786514282,
      "val_macro_f1": 0.5536467323140175,
      "val_verse_f1": 0.6867196367763905,
      "val_chorus_f1": 0.4205738278516445,
      "val_chorus_rate": 0.40192463248968124,
      "val_max_prob": 0.5559588819742203,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008019321749862414,
      "epoch_time": 63.43206977844238,
      "val_boundary_f1": 0.14285714285714285,
      "val_boundary_precision": 0.20909090909090908,
      "val_boundary_recall": 0.10849056603773585,
      "val_complete_segments": 0.020046938697521943,
      "val_avg_segment_overlap": 0.2533518646621935,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.45064953910864547,
      "val_pk_metric": 0.4617037589865047
    },
    {
      "epoch": 2,
      "train_loss": 0.5534789770841598,
      "train_chorus_rate": 0.4410399027168751,
      "train_max_prob": 0.5867616921663285,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6094141155481339,
      "val_macro_f1": 0.4506990842868705,
      "val_verse_f1": 0.82031708749266,
      "val_chorus_f1": 0.08108108108108107,
      "val_chorus_rate": 0.027467841049656272,
      "val_max_prob": 0.6240269690752029,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007116872982866882,
      "epoch_time": 60.883501052856445,
      "val_boundary_f1": 0.024793388429752067,
      "val_boundary_precision": 0.1,
      "val_boundary_recall": 0.014150943396226415,
      "val_complete_segments": 0.051454052143341644,
      "val_avg_segment_overlap": 0.1771152752905702,
      "val_verse_to_chorus_acc": 0.017699115044247787,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.2950630691987855,
      "val_pk_metric": 0.28642304219643466
    },
    {
      "epoch": 3,
      "train_loss": 0.537909871339798,
      "train_chorus_rate": 0.45346295312047,
      "train_max_prob": 0.5913656026124954,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5616661757230759,
      "val_macro_f1": 0.6795109817213134,
      "val_verse_f1": 0.7965461413923367,
      "val_chorus_f1": 0.5624758220502902,
      "val_chorus_rate": 0.3368629738688469,
      "val_max_prob": 0.6284810602664948,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005766262957671006,
      "epoch_time": 56.58270525932312,
      "val_boundary_f1": 0.3162393162393162,
      "val_boundary_precision": 0.2890625,
      "val_boundary_recall": 0.3490566037735849,
      "val_complete_segments": 0.170013705949549,
      "val_avg_segment_overlap": 0.5099053258920515,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.37088331599288765,
      "val_pk_metric": 0.3091557563938978
    },
    {
      "epoch": 4,
      "train_loss": 0.5107769295573235,
      "train_chorus_rate": 0.4140638932585716,
      "train_max_prob": 0.6496912688016891,
      "train_conf_over_90": 0.0076259682624368,
      "train_conf_over_95": 6.816632812842727e-05,
      "val_loss": 0.5300399363040924,
      "val_macro_f1": 0.7300472680346894,
      "val_verse_f1": 0.832472850275948,
      "val_chorus_f1": 0.627621685793431,
      "val_chorus_rate": 0.32255059480667114,
      "val_max_prob": 0.6749672889709473,
      "val_conf_over_90": 0.0010299893765477464,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041731098073004877,
      "epoch_time": 54.477038860321045,
      "val_boundary_f1": 0.3737089201877934,
      "val_boundary_precision": 0.31045241809672386,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.246086656266932,
      "val_avg_segment_overlap": 0.603997881598151,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.3680515406625928,
      "val_pk_metric": 0.2746114796621877
    },
    {
      "epoch": 5,
      "train_loss": 0.4973657771945,
      "train_chorus_rate": 0.42072995007038116,
      "train_max_prob": 0.6692243576049804,
      "train_conf_over_90": 0.01405860527884215,
      "train_conf_over_95": 0.0005913017696002499,
      "val_loss": 0.5514064431190491,
      "val_macro_f1": 0.7199179575382617,
      "val_verse_f1": 0.859064807219032,
      "val_chorus_f1": 0.5807711078574914,
      "val_chorus_rate": 0.20434429496526718,
      "val_max_prob": 0.6766987591981888,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000257995665692997,
      "epoch_time": 47.95065188407898,
      "val_boundary_f1": 0.3697813121272366,
      "val_boundary_precision": 0.31958762886597936,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.2500724705920888,
      "val_avg_segment_overlap": 0.5869469782024495,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.33924335622274226,
      "val_pk_metric": 0.25600675570578013
    },
    {
      "epoch": 6,
      "train_loss": 0.48907933831214906,
      "train_chorus_rate": 0.3248432524502277,
      "train_max_prob": 0.6585633963346481,
      "train_conf_over_90": 0.002929694333579391,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5159239172935486,
      "val_macro_f1": 0.7148299774505066,
      "val_verse_f1": 0.7964872088583429,
      "val_chorus_f1": 0.6331727460426703,
      "val_chorus_rate": 0.41500983387231827,
      "val_max_prob": 0.6818866580724716,
      "val_conf_over_90": 0.010592401726171374,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0001229346631734092,
      "epoch_time": 58.49119997024536,
      "val_boundary_f1": 0.3516483516483516,
      "val_boundary_precision": 0.3050259965337955,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.21844861070735938,
      "val_avg_segment_overlap": 0.6087728584229867,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4042122845025638,
      "val_pk_metric": 0.3107307363831292
    },
    {
      "epoch": 7,
      "train_loss": 0.48201037049293516,
      "train_chorus_rate": 0.3860402062535286,
      "train_max_prob": 0.6827843934297562,
      "train_conf_over_90": 0.017000669008120896,
      "train_conf_over_95": 0.0006692543567623944,
      "val_loss": 0.5057715401053429,
      "val_macro_f1": 0.7184395913378336,
      "val_verse_f1": 0.7944304776638947,
      "val_chorus_f1": 0.6424487050117726,
      "val_chorus_rate": 0.4313027188181877,
      "val_max_prob": 0.6693962663412094,
      "val_conf_over_90": 0.013029310503043234,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 3.268978647385601e-05,
      "epoch_time": 55.697718143463135,
      "val_boundary_f1": 0.3710144927536232,
      "val_boundary_precision": 0.3142389525368249,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24836657972925208,
      "val_avg_segment_overlap": 0.6245612929876388,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4044323654658721,
      "val_pk_metric": 0.30656376643506067
    },
    {
      "epoch": 8,
      "train_loss": 0.47426402419805525,
      "train_chorus_rate": 0.36799529790878294,
      "train_max_prob": 0.6789264261722565,
      "train_conf_over_90": 0.018646330991759896,
      "train_conf_over_95": 0.001379279384855181,
      "val_loss": 0.5038126707077026,
      "val_macro_f1": 0.7273074772117173,
      "val_verse_f1": 0.8063963449457453,
      "val_chorus_f1": 0.6482186094776893,
      "val_chorus_rate": 0.4110334441065788,
      "val_max_prob": 0.6740964204072952,
      "val_conf_over_90": 0.013501657987944782,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1e-06,
      "epoch_time": 62.9068078994751,
      "val_boundary_f1": 0.3783783783783784,
      "val_boundary_precision": 0.3202614379084967,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.25967299863111104,
      "val_avg_segment_overlap": 0.6303231372507958,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.39490021296091055,
      "val_pk_metric": 0.29484051186512694
    }
  ]
}