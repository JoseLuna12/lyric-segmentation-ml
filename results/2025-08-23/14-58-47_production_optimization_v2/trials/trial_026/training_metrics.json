{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.15112828191092909,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.17400744113983008,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1236483,
      "lstm_params": 675840,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0008206459820989492,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 8,
      "validation_strategy": "composite",
      "weight_decay": 0.010792255634511446,
      "gradient_clip_norm": 0.30152212648500853,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12408900581490548,
        "ece_after": 0.02544529002694107,
        "improvement": 0.09864371578796441,
        "params": {
          "temperature": 0.5077695417026152
        }
      },
      "platt": {
        "ece_before": 0.12408900581490548,
        "ece_after": 0.030028038458763267,
        "improvement": 0.09406096735614221,
        "params": {
          "A": 1.8598149452080652,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5819797128438949,
      "train_chorus_rate": 0.4174962721997872,
      "train_max_prob": 0.5885897547006607,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5948641300201416,
      "val_macro_f1": 0.5328086252487942,
      "val_verse_f1": 0.8209023241683123,
      "val_chorus_f1": 0.24471492632927608,
      "val_chorus_rate": 0.083455347456038,
      "val_max_prob": 0.5892356932163239,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008116903664700701,
      "epoch_time": 77.3199110031128,
      "val_boundary_f1": 0.16358024691358025,
      "val_boundary_precision": 0.23660714285714285,
      "val_boundary_recall": 0.125,
      "val_complete_segments": 0.07314341875582597,
      "val_avg_segment_overlap": 0.2625880114542011,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.32616852971906785,
      "val_pk_metric": 0.2943443105133968
    },
    {
      "epoch": 2,
      "train_loss": 0.5524277433753013,
      "train_chorus_rate": 0.389623327832669,
      "train_max_prob": 0.6107580453157425,
      "train_conf_over_90": 0.0005792554758954794,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5518583208322525,
      "val_macro_f1": 0.612628349466124,
      "val_verse_f1": 0.6776025236593061,
      "val_chorus_f1": 0.5476541752729418,
      "val_chorus_rate": 0.5333277955651283,
      "val_max_prob": 0.6298768073320389,
      "val_conf_over_90": 0.0016832828405313194,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007852149229602264,
      "epoch_time": 55.02306294441223,
      "val_boundary_f1": 0.21026072329688814,
      "val_boundary_precision": 0.16339869281045752,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.08187593744327573,
      "val_avg_segment_overlap": 0.45913641749093126,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.5434638137420198,
      "val_pk_metric": 0.41727365273154904
    },
    {
      "epoch": 3,
      "train_loss": 0.5105863034725189,
      "train_chorus_rate": 0.3965611010789871,
      "train_max_prob": 0.6759531408548355,
      "train_conf_over_90": 0.021798381785629317,
      "train_conf_over_95": 0.0011286861699772999,
      "val_loss": 0.5294749364256859,
      "val_macro_f1": 0.7235126698790534,
      "val_verse_f1": 0.8337137840210712,
      "val_chorus_f1": 0.6133115557370356,
      "val_chorus_rate": 0.30326205492019653,
      "val_max_prob": 0.6721043884754181,
      "val_conf_over_90": 0.008451171510387212,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007423767554940716,
      "epoch_time": 131.9600911140442,
      "val_boundary_f1": 0.35022222222222227,
      "val_boundary_precision": 0.2810271041369472,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.23637249201936372,
      "val_avg_segment_overlap": 0.6132652628310504,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.39290975893946817,
      "val_pk_metric": 0.28081563116483876
    },
    {
      "epoch": 4,
      "train_loss": 0.4865983366966248,
      "train_chorus_rate": 0.3890337698161602,
      "train_max_prob": 0.6867381513118744,
      "train_conf_over_90": 0.03275580196641385,
      "train_conf_over_95": 0.0037106341798789797,
      "val_loss": 0.5042897909879684,
      "val_macro_f1": 0.6750258124856992,
      "val_verse_f1": 0.7344820427652066,
      "val_chorus_f1": 0.6155695822061917,
      "val_chorus_rate": 0.5178762152791023,
      "val_max_prob": 0.67021144926548,
      "val_conf_over_90": 0.011932469962630421,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006850480975502105,
      "epoch_time": 112.67237401008606,
      "val_boundary_f1": 0.24456521739130435,
      "val_boundary_precision": 0.19852941176470587,
      "val_boundary_recall": 0.31839622641509435,
      "val_complete_segments": 0.11359651008378474,
      "val_avg_segment_overlap": 0.5348934656844729,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.3686868686868687,
      "val_window_diff": 0.49121768224446793,
      "val_pk_metric": 0.3692025568583244
    },
    {
      "epoch": 5,
      "train_loss": 0.4773815333843231,
      "train_chorus_rate": 0.3697733648121357,
      "train_max_prob": 0.7010159730911255,
      "train_conf_over_90": 0.0332162442849949,
      "train_conf_over_95": 0.003673953641555272,
      "val_loss": 0.4992864951491356,
      "val_macro_f1": 0.6958760018869807,
      "val_verse_f1": 0.7641395908543922,
      "val_chorus_f1": 0.6276124129195694,
      "val_chorus_rate": 0.4771460145711899,
      "val_max_prob": 0.6900097727775574,
      "val_conf_over_90": 0.026851188158616424,
      "val_conf_over_95": 0.000979668096988462,
      "learning_rate": 0.000615734486574212,
      "epoch_time": 53.74341583251953,
      "val_boundary_f1": 0.2645985401459854,
      "val_boundary_precision": 0.21577380952380953,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.11056487482786527,
      "val_avg_segment_overlap": 0.5625829735203508,
      "val_verse_to_chorus_acc": 0.2345132743362832,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.47162191667713915,
      "val_pk_metric": 0.3627113480231171
    },
    {
      "epoch": 6,
      "train_loss": 0.482334640622139,
      "train_chorus_rate": 0.38268723860383036,
      "train_max_prob": 0.7055883854627609,
      "train_conf_over_90": 0.034892313479213045,
      "train_conf_over_95": 0.004908893068204634,
      "val_loss": 0.496378056704998,
      "val_macro_f1": 0.7660534236872014,
      "val_verse_f1": 0.8581497797356827,
      "val_chorus_f1": 0.6739570676387201,
      "val_chorus_rate": 0.3075164780020714,
      "val_max_prob": 0.678271621465683,
      "val_conf_over_90": 0.005255101132206619,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005374652599693344,
      "epoch_time": 73.73479104042053,
      "val_boundary_f1": 0.3943661971830986,
      "val_boundary_precision": 0.32761310452418096,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2781171055163632,
      "val_avg_segment_overlap": 0.657708489719055,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.35619506449953514,
      "val_pk_metric": 0.25798418523659683
    },
    {
      "epoch": 7,
      "train_loss": 0.4503932654857635,
      "train_chorus_rate": 0.3357068248093128,
      "train_max_prob": 0.7178496658802033,
      "train_conf_over_90": 0.04740086372476071,
      "train_conf_over_95": 0.002327429095748812,
      "val_loss": 0.49994753301143646,
      "val_macro_f1": 0.7659332963795836,
      "val_verse_f1": 0.8618707542240028,
      "val_chorus_f1": 0.6699958385351644,
      "val_chorus_rate": 0.2912708669900894,
      "val_max_prob": 0.7619699388742447,
      "val_conf_over_90": 0.061060573905706406,
      "val_conf_over_95": 0.0019243628485128284,
      "learning_rate": 0.0004536611585156296,
      "epoch_time": 127.29526996612549,
      "val_boundary_f1": 0.3816046966731898,
      "val_boundary_precision": 0.32608695652173914,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.2799860381514676,
      "val_avg_segment_overlap": 0.648829488774773,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3314960729717111,
      "val_pk_metric": 0.24711272541132703
    },
    {
      "epoch": 8,
      "train_loss": 0.4560843944549561,
      "train_chorus_rate": 0.32832348719239235,
      "train_max_prob": 0.7152795672416687,
      "train_conf_over_90": 0.03471424837771338,
      "train_conf_over_95": 0.007158216321840882,
      "val_loss": 0.5031335651874542,
      "val_macro_f1": 0.7660335857485291,
      "val_verse_f1": 0.856586402266289,
      "val_chorus_f1": 0.6754807692307692,
      "val_chorus_rate": 0.3136823922395706,
      "val_max_prob": 0.7672724723815918,
      "val_conf_over_90": 0.10509016178548336,
      "val_conf_over_95": 0.026051594642922282,
      "learning_rate": 0.0003679848235833199,
      "epoch_time": 97.62589311599731,
      "val_boundary_f1": 0.3562841530054645,
      "val_boundary_precision": 0.3319755600814664,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.19514569864516843,
      "val_avg_segment_overlap": 0.618786526725025,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3146607826740876,
      "val_pk_metric": 0.24901933715781435
    }
  ]
}