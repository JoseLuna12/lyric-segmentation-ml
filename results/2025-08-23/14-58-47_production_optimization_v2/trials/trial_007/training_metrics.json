{
  "metadata": {
    "model_info": {
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.30969587060787984,
      "layer_dropout": 0.30817962705810464,
      "attention_enabled": false,
      "attention_heads": 1,
      "attention_dropout": 0.0,
      "attention_dim": 128,
      "positional_encoding": false,
      "max_seq_length": 1000,
      "total_params": 578050,
      "lstm_params": 577536,
      "attention_params": 0,
      "classifier_params": 514
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0002987563071416756,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 12,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.008178911788825332,
      "gradient_clip_norm": 0.8609145271092145,
      "max_epochs": 12,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.055791451048640216,
        "ece_after": 0.019344127951061788,
        "improvement": 0.03644732309757843,
        "params": {
          "temperature": 0.5537417164466287
        }
      },
      "platt": {
        "ece_before": 0.055791451048640216,
        "ece_after": 0.06676328975582874,
        "improvement": -0.01097183870718852,
        "params": {
          "A": 0.9999993308056329,
          "B": -0.03276107205322831
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5291215896606445,
      "train_chorus_rate": 0.2553194832056761,
      "train_max_prob": 0.535006183385849,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5545980632305145,
      "val_macro_f1": 0.5239019339251237,
      "val_verse_f1": 0.5937031484257871,
      "val_chorus_f1": 0.45410071942446045,
      "val_chorus_rate": 0.5534392893314362,
      "val_max_prob": 0.5355335474014282,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002936834070751401,
      "epoch_time": 68.93168592453003,
      "val_boundary_f1": 0.057971014492753624,
      "val_boundary_precision": 0.125,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.018438697318007662,
      "val_avg_segment_overlap": 0.22042922566125372,
      "val_verse_to_chorus_acc": 0.061946902654867256,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.44842417005643276,
      "val_pk_metric": 0.46478293852645663
    },
    {
      "epoch": 2,
      "train_loss": 0.5312155902385711,
      "train_chorus_rate": 0.48255327343940735,
      "train_max_prob": 0.5582383811473847,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5541014075279236,
      "val_macro_f1": 0.5005801321180428,
      "val_verse_f1": 0.5399499203277942,
      "val_chorus_f1": 0.4612103439082912,
      "val_chorus_rate": 0.6211616694927216,
      "val_max_prob": 0.5537412166595459,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002788104166317043,
      "epoch_time": 47.381789207458496,
      "val_boundary_f1": 0.04744525547445255,
      "val_boundary_precision": 0.10483870967741936,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.013050766283524903,
      "val_avg_segment_overlap": 0.1951824593584695,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.436300247274353,
      "val_pk_metric": 0.4391072773672352
    },
    {
      "epoch": 3,
      "train_loss": 0.5217470228672028,
      "train_chorus_rate": 0.45410321950912474,
      "train_max_prob": 0.5714091002941132,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5513266623020172,
      "val_macro_f1": 0.5679205531009655,
      "val_verse_f1": 0.6706349206349207,
      "val_chorus_f1": 0.4652061855670103,
      "val_chorus_rate": 0.46231013536453247,
      "val_max_prob": 0.5583212077617645,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002551509055313094,
      "epoch_time": 43.500519037246704,
      "val_boundary_f1": 0.062385321100917435,
      "val_boundary_precision": 0.14049586776859505,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.02173132183908046,
      "val_avg_segment_overlap": 0.22822089158437886,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3846547167053718,
      "val_pk_metric": 0.3999677132837283
    },
    {
      "epoch": 4,
      "train_loss": 0.5350261509418488,
      "train_chorus_rate": 0.5836268723011017,
      "train_max_prob": 0.5611722052097321,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5545229911804199,
      "val_macro_f1": 0.5747559997662273,
      "val_verse_f1": 0.7850805126519882,
      "val_chorus_f1": 0.36443148688046645,
      "val_chorus_rate": 0.20559560507535934,
      "val_max_prob": 0.567793995141983,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022431723035625667,
      "epoch_time": 48.81631422042847,
      "val_boundary_f1": 0.058608058608058615,
      "val_boundary_precision": 0.13114754098360656,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.019815613026819924,
      "val_avg_segment_overlap": 0.2366284344876451,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.3473107906466031,
      "val_pk_metric": 0.35882849349207385
    },
    {
      "epoch": 5,
      "train_loss": 0.5139802008867264,
      "train_chorus_rate": 0.35841784775257113,
      "train_max_prob": 0.5756787180900573,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5469354093074799,
      "val_macro_f1": 0.5356980293509175,
      "val_verse_f1": 0.5830176064185425,
      "val_chorus_f1": 0.4883784522832924,
      "val_chorus_rate": 0.5982456207275391,
      "val_max_prob": 0.5671597123146057,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018841065511466845,
      "epoch_time": 77.85169005393982,
      "val_boundary_f1": 0.03163444639718805,
      "val_boundary_precision": 0.06206896551724138,
      "val_boundary_recall": 0.02122641509433962,
      "val_complete_segments": 0.012691570881226053,
      "val_avg_segment_overlap": 0.23013377223154108,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.417661086952141,
      "val_pk_metric": 0.42233516482277256
    },
    {
      "epoch": 6,
      "train_loss": 0.5172073781490326,
      "train_chorus_rate": 0.5015156149864197,
      "train_max_prob": 0.5853682160377502,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5414769053459167,
      "val_macro_f1": 0.5175915359470804,
      "val_verse_f1": 0.5403377110694184,
      "val_chorus_f1": 0.4948453608247423,
      "val_chorus_rate": 0.6533046662807465,
      "val_max_prob": 0.5690885484218597,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014987815357083779,
      "epoch_time": 41.9425048828125,
      "val_boundary_f1": 0.05944055944055943,
      "val_boundary_precision": 0.11486486486486487,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.019995210727969347,
      "val_avg_segment_overlap": 0.23082738576443906,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.39716630380308493,
      "val_pk_metric": 0.4083271995296515
    },
    {
      "epoch": 7,
      "train_loss": 0.5053360402584076,
      "train_chorus_rate": 0.42626276314258577,
      "train_max_prob": 0.5900033175945282,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5467899143695831,
      "val_macro_f1": 0.5978138414499323,
      "val_verse_f1": 0.7051754215933321,
      "val_chorus_f1": 0.4904522613065326,
      "val_chorus_rate": 0.43311718106269836,
      "val_max_prob": 0.5762381553649902,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011134565202700713,
      "epoch_time": 89.09439706802368,
      "val_boundary_f1": 0.10999999999999999,
      "val_boundary_precision": 0.1875,
      "val_boundary_recall": 0.07783018867924528,
      "val_complete_segments": 0.05268199233716475,
      "val_avg_segment_overlap": 0.27526107962094687,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.361840192983225,
      "val_pk_metric": 0.3588135778929536
    },
    {
      "epoch": 8,
      "train_loss": 0.5005683392286301,
      "train_chorus_rate": 0.4890233725309372,
      "train_max_prob": 0.5973376512527466,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5449557900428772,
      "val_macro_f1": 0.5998018506513813,
      "val_verse_f1": 0.7190160832544938,
      "val_chorus_f1": 0.48058761804826866,
      "val_chorus_rate": 0.4022108316421509,
      "val_max_prob": 0.5794909596443176,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.543907678541893e-05,
      "epoch_time": 78.7850968837738,
      "val_boundary_f1": 0.12251655629139072,
      "val_boundary_precision": 0.20555555555555555,
      "val_boundary_recall": 0.08726415094339622,
      "val_complete_segments": 0.0440014367816092,
      "val_avg_segment_overlap": 0.277615092032328,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.3609469089390147,
      "val_pk_metric": 0.3489251382461039
    },
    {
      "epoch": 9,
      "train_loss": 0.5022740960121155,
      "train_chorus_rate": 0.36645393669605253,
      "train_max_prob": 0.6046150147914886,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5402982234954834,
      "val_macro_f1": 0.5654404291132245,
      "val_verse_f1": 0.6215745976511527,
      "val_chorus_f1": 0.509306260575296,
      "val_chorus_rate": 0.5711756646633148,
      "val_max_prob": 0.5770138204097748,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.460540161036619e-05,
      "epoch_time": 104.64947199821472,
      "val_boundary_f1": 0.07516339869281045,
      "val_boundary_precision": 0.12234042553191489,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.03095067049808429,
      "val_avg_segment_overlap": 0.2655868585527994,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.3946346529052991,
      "val_pk_metric": 0.37631449772366654
    },
    {
      "epoch": 10,
      "train_loss": 0.4992493033409119,
      "train_chorus_rate": 0.5437810450792313,
      "train_max_prob": 0.602078092098236,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5421033799648285,
      "val_macro_f1": 0.6006988734751056,
      "val_verse_f1": 0.7064077669902914,
      "val_chorus_f1": 0.49498997995991983,
      "val_chorus_rate": 0.4354761391878128,
      "val_max_prob": 0.5781683921813965,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.0945890509971322e-05,
      "epoch_time": 119.29076099395752,
      "val_boundary_f1": 0.1098546042003231,
      "val_boundary_precision": 0.17435897435897435,
      "val_boundary_recall": 0.08018867924528301,
      "val_complete_segments": 0.0497485632183908,
      "val_avg_segment_overlap": 0.28830205754925614,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.03535353535353535,
      "val_window_diff": 0.3644067673160484,
      "val_pk_metric": 0.34307997014279934
    },
    {
      "epoch": 11,
      "train_loss": 0.509711754322052,
      "train_chorus_rate": 0.41806272566318514,
      "train_max_prob": 0.5988297164440155,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5430458784103394,
      "val_macro_f1": 0.6037147810838256,
      "val_verse_f1": 0.720303605313093,
      "val_chorus_f1": 0.4871259568545581,
      "val_chorus_rate": 0.40594686567783356,
      "val_max_prob": 0.5809173583984375,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.072900066535509e-06,
      "epoch_time": 128.75632905960083,
      "val_boundary_f1": 0.12238325281803542,
      "val_boundary_precision": 0.19289340101522842,
      "val_boundary_recall": 0.08962264150943396,
      "val_complete_segments": 0.051125478927203066,
      "val_avg_segment_overlap": 0.29248516667681324,
      "val_verse_to_chorus_acc": 0.08849557522123894,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3622370906062895,
      "val_pk_metric": 0.34174326124348203
    },
    {
      "epoch": 12,
      "train_loss": 0.4928404867649078,
      "train_chorus_rate": 0.39073253571987154,
      "train_max_prob": 0.6022985517978668,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5421158373355865,
      "val_macro_f1": 0.6010671008123272,
      "val_verse_f1": 0.7105973025048169,
      "val_chorus_f1": 0.4915368991198375,
      "val_chorus_rate": 0.4256253242492676,
      "val_max_prob": 0.5799558460712433,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 176.25549793243408,
      "val_boundary_f1": 0.10679611650485436,
      "val_boundary_precision": 0.17010309278350516,
      "val_boundary_recall": 0.07783018867924528,
      "val_complete_segments": 0.040529214559386975,
      "val_avg_segment_overlap": 0.2913620511366769,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.3673791118123749,
      "val_pk_metric": 0.34848823843742915
    }
  ]
}