{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.1628768870881864,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.19621941237000612,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009365400266168018,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.02232429711995684,
      "gradient_clip_norm": 0.3610494757139939,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08922051044074863,
        "ece_after": 0.025950411096771483,
        "improvement": 0.06327009934397715,
        "params": {
          "temperature": 0.6224202870916442
        }
      },
      "platt": {
        "ece_before": 0.08922051044074863,
        "ece_after": 0.030326410498623776,
        "improvement": 0.058894099942124856,
        "params": {
          "A": 1.5052923727833032,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5728663533926011,
      "train_chorus_rate": 0.40300521430617664,
      "train_max_prob": 0.6073326855897904,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5703013837337494,
      "val_macro_f1": 0.4551012818651223,
      "val_verse_f1": 0.41883714811891604,
      "val_chorus_f1": 0.4913654156113285,
      "val_chorus_rate": 0.76755690574646,
      "val_max_prob": 0.5467980951070786,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009263181295212336,
      "epoch_time": 65.7092957496643,
      "val_boundary_f1": 0.07704654895666131,
      "val_boundary_precision": 0.12060301507537688,
      "val_boundary_recall": 0.05660377358490566,
      "val_complete_segments": 0.029203430820610034,
      "val_avg_segment_overlap": 0.21271905999600252,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4312982580324396,
      "val_pk_metric": 0.42455801503544643
    },
    {
      "epoch": 2,
      "train_loss": 0.5420055598020553,
      "train_chorus_rate": 0.4430367909371853,
      "train_max_prob": 0.6033429026603698,
      "train_conf_over_90": 0.00013924215454608202,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5625929087400436,
      "val_macro_f1": 0.6744697934430023,
      "val_verse_f1": 0.8274018379281537,
      "val_chorus_f1": 0.5215377489578509,
      "val_chorus_rate": 0.2313910573720932,
      "val_max_prob": 0.5822040885686874,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008960991841877094,
      "epoch_time": 60.56063389778137,
      "val_boundary_f1": 0.3421550094517959,
      "val_boundary_precision": 0.2854889589905363,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.20996787955960808,
      "val_avg_segment_overlap": 0.5290599366077559,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.35728358955143846,
      "val_pk_metric": 0.2841992869086746
    },
    {
      "epoch": 3,
      "train_loss": 0.5149050891399384,
      "train_chorus_rate": 0.43782280534505846,
      "train_max_prob": 0.6248591929674149,
      "train_conf_over_90": 0.001251455961028114,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5198584571480751,
      "val_macro_f1": 0.6475916454591941,
      "val_verse_f1": 0.7026338147833475,
      "val_chorus_f1": 0.5925494761350407,
      "val_chorus_rate": 0.544607475399971,
      "val_max_prob": 0.6536015868186951,
      "val_conf_over_90": 0.0034015390556305647,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008472039035338925,
      "epoch_time": 53.339807987213135,
      "val_boundary_f1": 0.26276150627615064,
      "val_boundary_precision": 0.20363164721141375,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.131913076915728,
      "val_avg_segment_overlap": 0.5367411169891007,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.5035756538348968,
      "val_pk_metric": 0.3668951804460275
    },
    {
      "epoch": 4,
      "train_loss": 0.4924715667963028,
      "train_chorus_rate": 0.4080790027976036,
      "train_max_prob": 0.6701314628124238,
      "train_conf_over_90": 0.014416454083402641,
      "train_conf_over_95": 0.0005746402777731419,
      "val_loss": 0.5189288929104805,
      "val_macro_f1": 0.749448211851616,
      "val_verse_f1": 0.8579263067694944,
      "val_chorus_f1": 0.6409701169337376,
      "val_chorus_rate": 0.2683528773486614,
      "val_max_prob": 0.6856568306684494,
      "val_conf_over_90": 0.001753229516907595,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007817692459499424,
      "epoch_time": 54.126113176345825,
      "val_boundary_f1": 0.39848197343453506,
      "val_boundary_precision": 0.3333333333333333,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.29495809057049777,
      "val_avg_segment_overlap": 0.6328414931325341,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3465060631277964,
      "val_pk_metric": 0.25184485215345603
    },
    {
      "epoch": 5,
      "train_loss": 0.47320829927921293,
      "train_chorus_rate": 0.37595183998346327,
      "train_max_prob": 0.6863272041082382,
      "train_conf_over_90": 0.02062500083993655,
      "train_conf_over_95": 0.0016726916073821485,
      "val_loss": 0.510438546538353,
      "val_macro_f1": 0.7638734094127134,
      "val_verse_f1": 0.8684255319148935,
      "val_chorus_f1": 0.6593212869105334,
      "val_chorus_rate": 0.2579214684665203,
      "val_max_prob": 0.6760191768407822,
      "val_conf_over_90": 0.00026624067686498165,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007026550199626014,
      "epoch_time": 47.049479246139526,
      "val_boundary_f1": 0.41330645161290325,
      "val_boundary_precision": 0.3609154929577465,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.28703163662071407,
      "val_avg_segment_overlap": 0.6479180926251336,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3057489887313287,
      "val_pk_metric": 0.23431570752479708
    },
    {
      "epoch": 6,
      "train_loss": 0.47217798978090286,
      "train_chorus_rate": 0.33285261169075964,
      "train_max_prob": 0.6862224221229554,
      "train_conf_over_90": 0.01668357393646147,
      "train_conf_over_95": 0.0011707374593243002,
      "val_loss": 0.5123315304517746,
      "val_macro_f1": 0.7405809307850124,
      "val_verse_f1": 0.8251851851851851,
      "val_chorus_f1": 0.6559766763848397,
      "val_chorus_rate": 0.37473220378160477,
      "val_max_prob": 0.7606384456157684,
      "val_conf_over_90": 0.11419677175581455,
      "val_conf_over_95": 0.0087327784858644,
      "learning_rate": 0.0006133188968796922,
      "epoch_time": 60.381210803985596,
      "val_boundary_f1": 0.3849056603773585,
      "val_boundary_precision": 0.32075471698113206,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.26877573490776036,
      "val_avg_segment_overlap": 0.640691912958837,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.372568571662791,
      "val_pk_metric": 0.27468522930841066
    },
    {
      "epoch": 7,
      "train_loss": 0.4650695398449898,
      "train_chorus_rate": 0.33722951635718346,
      "train_max_prob": 0.7000866651535034,
      "train_conf_over_90": 0.03320174274267629,
      "train_conf_over_95": 0.0012101688218535856,
      "val_loss": 0.48598723113536835,
      "val_macro_f1": 0.751000376564498,
      "val_verse_f1": 0.8279872444194334,
      "val_chorus_f1": 0.6740135087095627,
      "val_chorus_rate": 0.39174026995897293,
      "val_max_prob": 0.6595877557992935,
      "val_conf_over_90": 0.0024525667540729046,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000517665293962218,
      "epoch_time": 57.28104496002197,
      "val_boundary_f1": 0.3739130434782609,
      "val_boundary_precision": 0.29614325068870523,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.26563158939882164,
      "val_avg_segment_overlap": 0.65834502881266,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4199346350820505,
      "val_pk_metric": 0.29936161895621893
    },
    {
      "epoch": 8,
      "train_loss": 0.45675562471151354,
      "train_chorus_rate": 0.35413874238729476,
      "train_max_prob": 0.6909686654806138,
      "train_conf_over_90": 0.022643225599313154,
      "train_conf_over_95": 0.0011064545105909929,
      "val_loss": 0.47883032262325287,
      "val_macro_f1": 0.7856612251349093,
      "val_verse_f1": 0.8673541963015647,
      "val_chorus_f1": 0.7039682539682539,
      "val_chorus_rate": 0.3194628059864044,
      "val_max_prob": 0.675480842590332,
      "val_conf_over_90": 0.0017587647307664156,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004198747326545841,
      "epoch_time": 64.8635368347168,
      "val_boundary_f1": 0.40576923076923077,
      "val_boundary_precision": 0.3425324675324675,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3082174110938692,
      "val_avg_segment_overlap": 0.6716858582862035,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3182401258469221,
      "val_pk_metric": 0.2300898826294545
    },
    {
      "epoch": 9,
      "train_loss": 0.459123095870018,
      "train_chorus_rate": 0.33754630759358406,
      "train_max_prob": 0.7058679014444351,
      "train_conf_over_90": 0.032753963369759734,
      "train_conf_over_95": 0.0013513481186237185,
      "val_loss": 0.48963508754968643,
      "val_macro_f1": 0.7830414595735748,
      "val_verse_f1": 0.872872525182355,
      "val_chorus_f1": 0.6932103939647946,
      "val_chorus_rate": 0.2868545949459076,
      "val_max_prob": 0.6857513338327408,
      "val_conf_over_90": 0.006481694406829774,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003242211297371098,
      "epoch_time": 49.9038610458374,
      "val_boundary_f1": 0.41558441558441567,
      "val_boundary_precision": 0.36048526863084923,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.3255248658748129,
      "val_avg_segment_overlap": 0.6735682670678005,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.2934769930405433,
      "val_pk_metric": 0.2186503068527391
    },
    {
      "epoch": 10,
      "train_loss": 0.45225966572761533,
      "train_chorus_rate": 0.33436101824045183,
      "train_max_prob": 0.7095070451498031,
      "train_conf_over_90": 0.03638698874274269,
      "train_conf_over_95": 0.00026985857693944125,
      "val_loss": 0.47685054689645767,
      "val_macro_f1": 0.7720671751211627,
      "val_verse_f1": 0.8484179543782191,
      "val_chorus_f1": 0.6957163958641063,
      "val_chorus_rate": 0.36555273085832596,
      "val_max_prob": 0.7203139811754227,
      "val_conf_over_90": 0.042161060962826014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023488500665420057,
      "epoch_time": 47.377800941467285,
      "val_boundary_f1": 0.39264990328820115,
      "val_boundary_precision": 0.33278688524590166,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2883913985186519,
      "val_avg_segment_overlap": 0.6619736696363705,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3431453171191852,
      "val_pk_metric": 0.2523947809016481
    },
    {
      "epoch": 11,
      "train_loss": 0.442587748169899,
      "train_chorus_rate": 0.3176333777606487,
      "train_max_prob": 0.7167309641838073,
      "train_conf_over_90": 0.024174560711253436,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4877229258418083,
      "val_macro_f1": 0.7680305981081376,
      "val_verse_f1": 0.8542785535266738,
      "val_chorus_f1": 0.6817826426896013,
      "val_chorus_rate": 0.3286173865199089,
      "val_max_prob": 0.7316051870584488,
      "val_conf_over_90": 0.06006176769733429,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001557707806668596,
      "epoch_time": 60.04338216781616,
      "val_boundary_f1": 0.3883089770354906,
      "val_boundary_precision": 0.34831460674157305,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.27274025843750127,
      "val_avg_segment_overlap": 0.6454036339186175,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.3082463590655773,
      "val_pk_metric": 0.22862855561460022
    },
    {
      "epoch": 12,
      "train_loss": 0.44639251083135606,
      "train_chorus_rate": 0.3526775799691677,
      "train_max_prob": 0.715429937839508,
      "train_conf_over_90": 0.04778680698946118,
      "train_conf_over_95": 0.00022567727719433606,
      "val_loss": 0.48105742037296295,
      "val_macro_f1": 0.7802001155871702,
      "val_verse_f1": 0.8642984014209593,
      "val_chorus_f1": 0.6961018297533811,
      "val_chorus_rate": 0.317813016474247,
      "val_max_prob": 0.7233865708112717,
      "val_conf_over_90": 0.049041364807635546,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.033612308290929e-05,
      "epoch_time": 52.65893602371216,
      "val_boundary_f1": 0.4258872651356993,
      "val_boundary_precision": 0.38202247191011235,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.30885231353152875,
      "val_avg_segment_overlap": 0.662748153599106,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.29084555479002583,
      "val_pk_metric": 0.21994146878160376
    },
    {
      "epoch": 13,
      "train_loss": 0.4383873164653778,
      "train_chorus_rate": 0.3446889132261276,
      "train_max_prob": 0.7199002295732498,
      "train_conf_over_90": 0.06150306928902864,
      "train_conf_over_95": 0.001559223112417385,
      "val_loss": 0.48136913776397705,
      "val_macro_f1": 0.7731866318250584,
      "val_verse_f1": 0.8527272727272728,
      "val_chorus_f1": 0.6936459909228442,
      "val_chorus_rate": 0.34956179559230804,
      "val_max_prob": 0.7389099597930908,
      "val_conf_over_90": 0.09275838546454906,
      "val_conf_over_95": 0.0012262833770364523,
      "learning_rate": 4.1440842429092254e-05,
      "epoch_time": 55.00473380088806,
      "val_boundary_f1": 0.41194029850746267,
      "val_boundary_precision": 0.35628227194492257,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.3014058919546725,
      "val_avg_segment_overlap": 0.6680487726495441,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.33390367308659497,
      "val_pk_metric": 0.2398956626793562
    },
    {
      "epoch": 14,
      "train_loss": 0.43612136840820315,
      "train_chorus_rate": 0.3328047081828117,
      "train_max_prob": 0.7268111497163773,
      "train_conf_over_90": 0.06696353405714035,
      "train_conf_over_95": 0.0019642156781628727,
      "val_loss": 0.4788886159658432,
      "val_macro_f1": 0.776481530717509,
      "val_verse_f1": 0.8566781131393458,
      "val_chorus_f1": 0.6962849482956722,
      "val_chorus_rate": 0.3415415585041046,
      "val_max_prob": 0.7163912802934647,
      "val_conf_over_90": 0.05501949228346348,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1221897095568207e-05,
      "epoch_time": 49.44459009170532,
      "val_boundary_f1": 0.3983903420523139,
      "val_boundary_precision": 0.3473684210526316,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.2901979941614088,
      "val_avg_segment_overlap": 0.6646588148599211,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.327770057300542,
      "val_pk_metric": 0.23846831441100902
    },
    {
      "epoch": 15,
      "train_loss": 0.42548171281814573,
      "train_chorus_rate": 0.31303051486611366,
      "train_max_prob": 0.7248670905828476,
      "train_conf_over_90": 0.05624475441873074,
      "train_conf_over_95": 0.0013705121440580116,
      "val_loss": 0.4773528352379799,
      "val_macro_f1": 0.775097207493814,
      "val_verse_f1": 0.855072463768116,
      "val_chorus_f1": 0.6951219512195121,
      "val_chorus_rate": 0.34471769630908966,
      "val_max_prob": 0.7220126092433929,
      "val_conf_over_90": 0.06620880402624607,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 1e-06,
      "epoch_time": 56.657776832580566,
      "val_boundary_f1": 0.39597989949748746,
      "val_boundary_precision": 0.3450087565674256,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2940421086895106,
      "val_avg_segment_overlap": 0.664092841562937,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.323933203227724,
      "val_pk_metric": 0.23590420896427283
    }
  ]
}