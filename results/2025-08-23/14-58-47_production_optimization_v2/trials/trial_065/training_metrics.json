{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1681565302793211,
      "layer_dropout": 0.20973657635259219,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.21052500671727642,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009093152440432785,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.014399440917590656,
      "gradient_clip_norm": 0.6714878890701641,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10883231591323504,
        "ece_after": 0.02180734901800606,
        "improvement": 0.08702496689522898,
        "params": {
          "temperature": 0.5486526307590051
        }
      },
      "platt": {
        "ece_before": 0.10883231591323504,
        "ece_after": 0.02274560647301215,
        "improvement": 0.0860867094402229,
        "params": {
          "A": 1.7828480898213,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.56610709130764,
      "train_chorus_rate": 0.3741226568177808,
      "train_max_prob": 0.6037621170282363,
      "train_conf_over_90": 0.017558425664901733,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5816883742809296,
      "val_macro_f1": 0.3180357852694694,
      "val_verse_f1": 0.1564209848728677,
      "val_chorus_f1": 0.4796505856660711,
      "val_chorus_rate": 0.9371864497661591,
      "val_max_prob": 0.64801986515522,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008993908103570763,
      "epoch_time": 76.4986879825592,
      "val_boundary_f1": 0.003642987249544627,
      "val_boundary_precision": 0.008,
      "val_boundary_recall": 0.0023584905660377358,
      "val_complete_segments": 0.0017857142857142857,
      "val_avg_segment_overlap": 0.1197883378523616,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4029852638865382,
      "val_pk_metric": 0.3830188465432452
    },
    {
      "epoch": 2,
      "train_loss": 0.5350282177329063,
      "train_chorus_rate": 0.4382208691909909,
      "train_max_prob": 0.5796150624752044,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5483101457357407,
      "val_macro_f1": 0.5205580793901962,
      "val_verse_f1": 0.5967365967365967,
      "val_chorus_f1": 0.44437956204379564,
      "val_chorus_rate": 0.5417259186506271,
      "val_max_prob": 0.5617599040269852,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000870051254673273,
      "epoch_time": 62.539592027664185,
      "val_boundary_f1": 0.04718693284936479,
      "val_boundary_precision": 0.10236220472440945,
      "val_boundary_recall": 0.030660377358490566,
      "val_complete_segments": 0.01439122996652159,
      "val_avg_segment_overlap": 0.2130674998750494,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4358090451750466,
      "val_pk_metric": 0.44548341507494105
    },
    {
      "epoch": 3,
      "train_loss": 0.536169071495533,
      "train_chorus_rate": 0.45735839661210775,
      "train_max_prob": 0.5885338604450225,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5481768846511841,
      "val_macro_f1": 0.45692695492893054,
      "val_verse_f1": 0.823287872122012,
      "val_chorus_f1": 0.09056603773584905,
      "val_chorus_rate": 0.02570747071877122,
      "val_max_prob": 0.5523530840873718,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008225788563620593,
      "epoch_time": 45.31574583053589,
      "val_boundary_f1": 0.04979253112033195,
      "val_boundary_precision": 0.20689655172413793,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.0625186635658534,
      "val_avg_segment_overlap": 0.18723162833827442,
      "val_verse_to_chorus_acc": 0.035398230088495575,
      "val_chorus_to_verse_acc": 0.015151515151515152,
      "val_window_diff": 0.2807398078455158,
      "val_pk_metric": 0.2769912886968918
    },
    {
      "epoch": 4,
      "train_loss": 0.5179407998919487,
      "train_chorus_rate": 0.4406692856922746,
      "train_max_prob": 0.5651505798101425,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5374247133731842,
      "val_macro_f1": 0.5484675518628919,
      "val_verse_f1": 0.5939312806782687,
      "val_chorus_f1": 0.503003823047515,
      "val_chorus_rate": 0.6023943573236465,
      "val_max_prob": 0.5862858593463898,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007590483870274758,
      "epoch_time": 52.0471727848053,
      "val_boundary_f1": 0.09491525423728814,
      "val_boundary_precision": 0.1686746987951807,
      "val_boundary_recall": 0.0660377358490566,
      "val_complete_segments": 0.04195922744438121,
      "val_avg_segment_overlap": 0.24331603359723852,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.045454545454545456,
      "val_window_diff": 0.3917854151227669,
      "val_pk_metric": 0.3900051042310396
    },
    {
      "epoch": 5,
      "train_loss": 0.5063224375247956,
      "train_chorus_rate": 0.4204678650945425,
      "train_max_prob": 0.6112618535757065,
      "train_conf_over_90": 2.750275016296655e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5073676258325577,
      "val_macro_f1": 0.647656167946125,
      "val_verse_f1": 0.7347903130537508,
      "val_chorus_f1": 0.5605220228384992,
      "val_chorus_rate": 0.4549790620803833,
      "val_max_prob": 0.6189931333065033,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006822364330324589,
      "epoch_time": 52.063159704208374,
      "val_boundary_f1": 0.19811320754716982,
      "val_boundary_precision": 0.19811320754716982,
      "val_boundary_recall": 0.19811320754716982,
      "val_complete_segments": 0.071942843085473,
      "val_avg_segment_overlap": 0.447724479753576,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.4344417951316013,
      "val_pk_metric": 0.383279789080796
    },
    {
      "epoch": 6,
      "train_loss": 0.4713496699929237,
      "train_chorus_rate": 0.39143764451146124,
      "train_max_prob": 0.6642117321491241,
      "train_conf_over_90": 0.018174992079730147,
      "train_conf_over_95": 0.0003334191715111956,
      "val_loss": 0.49011872708797455,
      "val_macro_f1": 0.5900227250286094,
      "val_verse_f1": 0.620831429876656,
      "val_chorus_f1": 0.559214020180563,
      "val_chorus_rate": 0.6266067177057266,
      "val_max_prob": 0.6630435138940811,
      "val_conf_over_90": 0.013247013499494642,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005955000453512397,
      "epoch_time": 45.33286786079407,
      "val_boundary_f1": 0.12660944206008584,
      "val_boundary_precision": 0.11614173228346457,
      "val_boundary_recall": 0.1391509433962264,
      "val_complete_segments": 0.038037473164726616,
      "val_avg_segment_overlap": 0.4055022001339109,
      "val_verse_to_chorus_acc": 0.11061946902654868,
      "val_chorus_to_verse_acc": 0.13636363636363635,
      "val_window_diff": 0.5220324326042513,
      "val_pk_metric": 0.41750157300740753
    },
    {
      "epoch": 7,
      "train_loss": 0.45715408623218534,
      "train_chorus_rate": 0.3704808734357357,
      "train_max_prob": 0.6849464684724808,
      "train_conf_over_90": 0.027263568082707933,
      "train_conf_over_95": 0.0009692843013908714,
      "val_loss": 0.47571971267461777,
      "val_macro_f1": 0.7321137166865015,
      "val_verse_f1": 0.8336894586894587,
      "val_chorus_f1": 0.6305379746835443,
      "val_chorus_rate": 0.32137105613946915,
      "val_max_prob": 0.6721878200769424,
      "val_conf_over_90": 0.011363505967892706,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005026300203328531,
      "epoch_time": 87.86393594741821,
      "val_boundary_f1": 0.3575525812619502,
      "val_boundary_precision": 0.30064308681672025,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2286766883532525,
      "val_avg_segment_overlap": 0.6217695294395272,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.39416568739030755,
      "val_pk_metric": 0.2944704889588952
    },
    {
      "epoch": 8,
      "train_loss": 0.4394672870635986,
      "train_chorus_rate": 0.3404255799949169,
      "train_max_prob": 0.6971671402454376,
      "train_conf_over_90": 0.03873953225556761,
      "train_conf_over_95": 0.0015925360989058391,
      "val_loss": 0.4582865834236145,
      "val_macro_f1": 0.75532004538274,
      "val_verse_f1": 0.850680332214172,
      "val_chorus_f1": 0.659959758551308,
      "val_chorus_rate": 0.31111470237374306,
      "val_max_prob": 0.7316956669092178,
      "val_conf_over_90": 0.07211833260953426,
      "val_conf_over_95": 0.000979668096988462,
      "learning_rate": 0.00040768522371042564,
      "epoch_time": 63.42376685142517,
      "val_boundary_f1": 0.36382754994742367,
      "val_boundary_precision": 0.32827324478178366,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.2274512393017165,
      "val_avg_segment_overlap": 0.6234713773037072,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.347810423371735,
      "val_pk_metric": 0.2524192650902802
    },
    {
      "epoch": 9,
      "train_loss": 0.4196792125701904,
      "train_chorus_rate": 0.30584707111120224,
      "train_max_prob": 0.7183295905590057,
      "train_conf_over_90": 0.04885644755559042,
      "train_conf_over_95": 0.004294831270817668,
      "val_loss": 0.4610968977212906,
      "val_macro_f1": 0.7054053607982713,
      "val_verse_f1": 0.7863610094394144,
      "val_chorus_f1": 0.6244497121571283,
      "val_chorus_rate": 0.4257429763674736,
      "val_max_prob": 0.6795252412557602,
      "val_conf_over_90": 0.013155639811884612,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000314815198692039,
      "epoch_time": 111.22899413108826,
      "val_boundary_f1": 0.2554814108674928,
      "val_boundary_precision": 0.2144,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.1308864954941307,
      "val_avg_segment_overlap": 0.5912094932518281,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.4527433553192786,
      "val_pk_metric": 0.3487479406293654
    },
    {
      "epoch": 10,
      "train_loss": 0.42238938212394717,
      "train_chorus_rate": 0.3359245821833611,
      "train_max_prob": 0.7186656862497329,
      "train_conf_over_90": 0.03908447287976742,
      "train_conf_over_95": 0.0028645057696849107,
      "val_loss": 0.4515329524874687,
      "val_macro_f1": 0.7223216351588867,
      "val_verse_f1": 0.8039476181438603,
      "val_chorus_f1": 0.6406956521739131,
      "val_chorus_rate": 0.4062431529164314,
      "val_max_prob": 0.7123474329710007,
      "val_conf_over_90": 0.0375131918117404,
      "val_conf_over_95": 0.0009545074863126501,
      "learning_rate": 0.00022807881101081975,
      "epoch_time": 88.06842803955078,
      "val_boundary_f1": 0.3422756706753006,
      "val_boundary_precision": 0.2815829528158295,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2165537981550707,
      "val_avg_segment_overlap": 0.6283888625601274,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.42569372697803776,
      "val_pk_metric": 0.30114816992770255
    },
    {
      "epoch": 11,
      "train_loss": 0.42222338616847993,
      "train_chorus_rate": 0.3320551060140133,
      "train_max_prob": 0.7215833336114883,
      "train_conf_over_90": 0.05546359205618501,
      "train_conf_over_95": 0.004082876280881465,
      "val_loss": 0.4601353630423546,
      "val_macro_f1": 0.769753017949531,
      "val_verse_f1": 0.8707970643454516,
      "val_chorus_f1": 0.6687089715536104,
      "val_chorus_rate": 0.2615763433277607,
      "val_max_prob": 0.7052335292100906,
      "val_conf_over_90": 0.013759268214926124,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015126685701580278,
      "epoch_time": 91.79684925079346,
      "val_boundary_f1": 0.4249726177437021,
      "val_boundary_precision": 0.3967280163599182,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2745247955878921,
      "val_avg_segment_overlap": 0.6398830543454075,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.28543518985088234,
      "val_pk_metric": 0.2190472067854653
    },
    {
      "epoch": 12,
      "train_loss": 0.4201623037457466,
      "train_chorus_rate": 0.32730265483260157,
      "train_max_prob": 0.7178630650043487,
      "train_conf_over_90": 0.04165634489618242,
      "train_conf_over_95": 0.0033875379216624425,
      "val_loss": 0.44964299350976944,
      "val_macro_f1": 0.7470563857805292,
      "val_verse_f1": 0.8365681117358968,
      "val_chorus_f1": 0.6575446598251615,
      "val_chorus_rate": 0.3467213585972786,
      "val_max_prob": 0.722710907459259,
      "val_conf_over_90": 0.03752236673608422,
      "val_conf_over_95": 0.0007232401403598487,
      "learning_rate": 8.773638768121925e-05,
      "epoch_time": 81.74889278411865,
      "val_boundary_f1": 0.3726829268292683,
      "val_boundary_precision": 0.3178036605657238,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.24607967875465225,
      "val_avg_segment_overlap": 0.6494951833601634,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.3777593506312367,
      "val_pk_metric": 0.2656554397620863
    },
    {
      "epoch": 13,
      "train_loss": 0.4113046869635582,
      "train_chorus_rate": 0.3226682223379612,
      "train_max_prob": 0.729096457362175,
      "train_conf_over_90": 0.06243237880989909,
      "train_conf_over_95": 0.005395274667534977,
      "val_loss": 0.44480811059474945,
      "val_macro_f1": 0.7424511274950529,
      "val_verse_f1": 0.8272676888970996,
      "val_chorus_f1": 0.6576345660930062,
      "val_chorus_rate": 0.371279314160347,
      "val_max_prob": 0.7302366495132446,
      "val_conf_over_90": 0.06214215140789747,
      "val_conf_over_95": 0.00241633559926413,
      "learning_rate": 4.026398937000542e-05,
      "epoch_time": 81.86854195594788,
      "val_boundary_f1": 0.38395415472779365,
      "val_boundary_precision": 0.32263242375601925,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.24896644106612292,
      "val_avg_segment_overlap": 0.6505290455333068,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.3927462707045359,
      "val_pk_metric": 0.28764164504264456
    },
    {
      "epoch": 14,
      "train_loss": 0.40411800891160965,
      "train_chorus_rate": 0.3267441004514694,
      "train_max_prob": 0.7392378449440002,
      "train_conf_over_90": 0.08300724513828754,
      "train_conf_over_95": 0.009926668234402313,
      "val_loss": 0.446569062769413,
      "val_macro_f1": 0.7567571960300473,
      "val_verse_f1": 0.848690073070754,
      "val_chorus_f1": 0.6648243189893407,
      "val_chorus_rate": 0.3225990980863571,
      "val_max_prob": 0.7259976863861084,
      "val_conf_over_90": 0.03951636562123895,
      "val_conf_over_95": 0.00047234738303814083,
      "learning_rate": 1.0924433686202224e-05,
      "epoch_time": 87.17916679382324,
      "val_boundary_f1": 0.396484375,
      "val_boundary_precision": 0.3383333333333333,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.26272635118075205,
      "val_avg_segment_overlap": 0.6643407703391981,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.36131894452158525,
      "val_pk_metric": 0.25916586691181537
    },
    {
      "epoch": 15,
      "train_loss": 0.4086649209260941,
      "train_chorus_rate": 0.3242854192852974,
      "train_max_prob": 0.7319747328758239,
      "train_conf_over_90": 0.06489795092493296,
      "train_conf_over_95": 0.0051654110342497,
      "val_loss": 0.44560206681489944,
      "val_macro_f1": 0.7539647331382671,
      "val_verse_f1": 0.8448986910525373,
      "val_chorus_f1": 0.6630307752239969,
      "val_chorus_rate": 0.3309005871415138,
      "val_max_prob": 0.7241374999284744,
      "val_conf_over_90": 0.038255090825259686,
      "val_conf_over_95": 0.00047234738303814083,
      "learning_rate": 1e-06,
      "epoch_time": 86.45257329940796,
      "val_boundary_f1": 0.39337877312560854,
      "val_boundary_precision": 0.33499170812603646,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26691379684486793,
      "val_avg_segment_overlap": 0.6592547025551133,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.36466922433259763,
      "val_pk_metric": 0.2629515165135633
    }
  ]
}