{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.27849421393583873,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.29471009103158474,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1867010,
      "lstm_params": 1339392,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007508366990586275,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 10,
      "validation_strategy": "composite",
      "weight_decay": 0.02334230379147727,
      "gradient_clip_norm": 0.3519584334224244,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10269793576774991,
        "ece_after": 0.022345644273668922,
        "improvement": 0.08035229149408099,
        "params": {
          "temperature": 0.5396214312772467
        }
      },
      "platt": {
        "ece_before": 0.10269793576774991,
        "ece_after": 0.03148794040991421,
        "improvement": 0.0712099953578357,
        "params": {
          "A": 1.6050358420137936,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5803359776735306,
      "train_chorus_rate": 0.501976868417114,
      "train_max_prob": 0.6046778589487076,
      "train_conf_over_90": 3.320053219795227e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5598631203174591,
      "val_macro_f1": 0.5515726318902334,
      "val_verse_f1": 0.5750291715285881,
      "val_chorus_f1": 0.5281160922518786,
      "val_chorus_rate": 0.6485812664031982,
      "val_max_prob": 0.5450561046600342,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007426438335924903,
      "epoch_time": 107.89349508285522,
      "val_boundary_f1": 0.13301088270858527,
      "val_boundary_precision": 0.13647642679900746,
      "val_boundary_recall": 0.12971698113207547,
      "val_complete_segments": 0.03899523481973111,
      "val_avg_segment_overlap": 0.33576888792879556,
      "val_verse_to_chorus_acc": 0.11504424778761062,
      "val_chorus_to_verse_acc": 0.10606060606060606,
      "val_window_diff": 0.4738016912420314,
      "val_pk_metric": 0.45152410189476677
    },
    {
      "epoch": 2,
      "train_loss": 0.5315618649125099,
      "train_chorus_rate": 0.4354299310594797,
      "train_max_prob": 0.582837775349617,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5470973700284958,
      "val_macro_f1": 0.6876642737037405,
      "val_verse_f1": 0.7980402830702231,
      "val_chorus_f1": 0.5772882643372579,
      "val_chorus_rate": 0.34761814773082733,
      "val_max_prob": 0.5801851749420166,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007184233047286792,
      "epoch_time": 98.21277117729187,
      "val_boundary_f1": 0.3163950143815915,
      "val_boundary_precision": 0.2665589660743134,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.19334666055238697,
      "val_avg_segment_overlap": 0.543647102466952,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.423409185241901,
      "val_pk_metric": 0.32810877923088716
    },
    {
      "epoch": 3,
      "train_loss": 0.5227852210402488,
      "train_chorus_rate": 0.5138400949537754,
      "train_max_prob": 0.6477950900793076,
      "train_conf_over_90": 0.006036939108162187,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5161336585879326,
      "val_macro_f1": 0.6907330086265204,
      "val_verse_f1": 0.7543788187372708,
      "val_chorus_f1": 0.62708719851577,
      "val_chorus_rate": 0.4948910176753998,
      "val_max_prob": 0.6362003087997437,
      "val_conf_over_90": 0.0004625346919056028,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006792336658015351,
      "epoch_time": 101.2265088558197,
      "val_boundary_f1": 0.29720279720279724,
      "val_boundary_precision": 0.2361111111111111,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.15531592606088895,
      "val_avg_segment_overlap": 0.5809548402247087,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.46839320417751557,
      "val_pk_metric": 0.3621471829094697
    },
    {
      "epoch": 4,
      "train_loss": 0.49691698253154754,
      "train_chorus_rate": 0.4063765212893486,
      "train_max_prob": 0.6543578207492828,
      "train_conf_over_90": 0.003445455979090184,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5269350856542587,
      "val_macro_f1": 0.5801543927981803,
      "val_verse_f1": 0.5880935165100024,
      "val_chorus_f1": 0.572215269086358,
      "val_chorus_rate": 0.6819352060556412,
      "val_max_prob": 0.6634415835142136,
      "val_conf_over_90": 0.0096942950040102,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006267876920849258,
      "epoch_time": 232.2000629901886,
      "val_boundary_f1": 0.1724890829694323,
      "val_boundary_precision": 0.16056910569105692,
      "val_boundary_recall": 0.18632075471698112,
      "val_complete_segments": 0.05392284611531696,
      "val_avg_segment_overlap": 0.43607614452812443,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.47038653914924866,
      "val_pk_metric": 0.37773031003542135
    },
    {
      "epoch": 5,
      "train_loss": 0.4897220075130463,
      "train_chorus_rate": 0.39561875984072686,
      "train_max_prob": 0.659117066860199,
      "train_conf_over_90": 0.004831391668994911,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5278433561325073,
      "val_macro_f1": 0.7515214349590124,
      "val_verse_f1": 0.8588578288458241,
      "val_chorus_f1": 0.6441850410722006,
      "val_chorus_rate": 0.2695329114794731,
      "val_max_prob": 0.6965391784906387,
      "val_conf_over_90": 0.0014072294579818845,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005633775242939706,
      "epoch_time": 87.79989099502563,
      "val_boundary_f1": 0.41291585127201563,
      "val_boundary_precision": 0.3528428093645485,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.31854858191019375,
      "val_avg_segment_overlap": 0.6349699848043231,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.3520943469007869,
      "val_pk_metric": 0.2500037711275091
    },
    {
      "epoch": 6,
      "train_loss": 0.4806489869952202,
      "train_chorus_rate": 0.3552610531449318,
      "train_max_prob": 0.6691628605127334,
      "train_conf_over_90": 0.005875722932978533,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4943871721625328,
      "val_macro_f1": 0.7199913118321479,
      "val_verse_f1": 0.7821543408360129,
      "val_chorus_f1": 0.6578282828282829,
      "val_chorus_rate": 0.47878118604421616,
      "val_max_prob": 0.6861609071493149,
      "val_conf_over_90": 0.011969883344136178,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004917744910368783,
      "epoch_time": 90.20715594291687,
      "val_boundary_f1": 0.37044145873320533,
      "val_boundary_precision": 0.3122977346278317,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2504249799716396,
      "val_avg_segment_overlap": 0.6146259590598838,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.42160061827942275,
      "val_pk_metric": 0.31563929047689515
    },
    {
      "epoch": 7,
      "train_loss": 0.47560581266880037,
      "train_chorus_rate": 0.39803401529788973,
      "train_max_prob": 0.6765112966299057,
      "train_conf_over_90": 0.005534837342565879,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4935329258441925,
      "val_macro_f1": 0.7458318063128931,
      "val_verse_f1": 0.8224193244008302,
      "val_chorus_f1": 0.6692442882249561,
      "val_chorus_rate": 0.3997127115726471,
      "val_max_prob": 0.684143140912056,
      "val_conf_over_90": 0.013466994743794203,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00041510798845645797,
      "epoch_time": 98.09577512741089,
      "val_boundary_f1": 0.40774907749077494,
      "val_boundary_precision": 0.33484848484848484,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.316240390140178,
      "val_avg_segment_overlap": 0.6620073934274939,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4029011503036979,
      "val_pk_metric": 0.291329111351855
    },
    {
      "epoch": 8,
      "train_loss": 0.47555932849645616,
      "train_chorus_rate": 0.355505596101284,
      "train_max_prob": 0.6830235004425049,
      "train_conf_over_90": 0.010547888194560073,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4930027946829796,
      "val_macro_f1": 0.7311938838686985,
      "val_verse_f1": 0.7994516255385822,
      "val_chorus_f1": 0.6629361421988149,
      "val_chorus_rate": 0.44739075750112534,
      "val_max_prob": 0.690916046500206,
      "val_conf_over_90": 0.004040742409415543,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003367287106021697,
      "epoch_time": 86.64503502845764,
      "val_boundary_f1": 0.4011799410029499,
      "val_boundary_precision": 0.3440134907251265,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2864279367990927,
      "val_avg_segment_overlap": 0.6447944714758931,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.40246439648017795,
      "val_pk_metric": 0.29294997069428863
    },
    {
      "epoch": 9,
      "train_loss": 0.47819333970546724,
      "train_chorus_rate": 0.38951480090618135,
      "train_max_prob": 0.6756473898887634,
      "train_conf_over_90": 0.006742295643198304,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49591852724552155,
      "val_macro_f1": 0.7323992321590319,
      "val_verse_f1": 0.8005480524564493,
      "val_chorus_f1": 0.6642504118616145,
      "val_chorus_rate": 0.4463324472308159,
      "val_max_prob": 0.7074072510004044,
      "val_conf_over_90": 0.0566999027505517,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002600622080217493,
      "epoch_time": 88.68461108207703,
      "val_boundary_f1": 0.38777459407831905,
      "val_boundary_precision": 0.3258426966292135,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.282409657422913,
      "val_avg_segment_overlap": 0.6537504022970889,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4115688707343561,
      "val_pk_metric": 0.30062754570869465
    },
    {
      "epoch": 10,
      "train_loss": 0.45515117794275284,
      "train_chorus_rate": 0.3560872547328472,
      "train_max_prob": 0.6989282548427582,
      "train_conf_over_90": 0.025288823549635707,
      "train_conf_over_95": 0.00010713797237258405,
      "val_loss": 0.5017961338162422,
      "val_macro_f1": 0.7279150063302604,
      "val_verse_f1": 0.7996112730806608,
      "val_chorus_f1": 0.65621873957986,
      "val_chorus_rate": 0.43751851469278336,
      "val_max_prob": 0.710529699921608,
      "val_conf_over_90": 0.06094114016741514,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018845917476465696,
      "epoch_time": 98.04226517677307,
      "val_boundary_f1": 0.3804971319311663,
      "val_boundary_precision": 0.319935691318328,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.27626492573470307,
      "val_avg_segment_overlap": 0.6397636084519134,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4382233812631657,
      "val_pk_metric": 0.32842503790680366
    }
  ]
}