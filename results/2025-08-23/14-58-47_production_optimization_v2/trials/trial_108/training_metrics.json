{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2693664447156089,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.264388399111532,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009433388164864008,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.018209751373407586,
      "gradient_clip_norm": 0.36561638664216023,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.1423367563861995,
        "ece_after": 0.022376862455210676,
        "improvement": 0.11995989393098883,
        "params": {
          "temperature": 0.44394637455959596
        }
      },
      "platt": {
        "ece_before": 0.1423367563861995,
        "ece_after": 0.033435574800420115,
        "improvement": 0.10890118158577938,
        "params": {
          "A": 2.116597307516561,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5712954699993134,
      "train_chorus_rate": 0.4944220499601215,
      "train_max_prob": 0.5906972080469132,
      "train_conf_over_90": 4.0650405571796e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.561947837471962,
      "val_macro_f1": 0.47759458972526625,
      "val_verse_f1": 0.45167958656330753,
      "val_chorus_f1": 0.503509592887225,
      "val_chorus_rate": 0.7501471042633057,
      "val_max_prob": 0.579824835062027,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009330426344554539,
      "epoch_time": 99.84536099433899,
      "val_boundary_f1": 0.054313099041533544,
      "val_boundary_precision": 0.08415841584158416,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.018136823386028053,
      "val_avg_segment_overlap": 0.23691456111466744,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.44877890854525987,
      "val_pk_metric": 0.4511554940286757
    },
    {
      "epoch": 2,
      "train_loss": 0.536966547369957,
      "train_chorus_rate": 0.524007860943675,
      "train_max_prob": 0.6083554834127426,
      "train_conf_over_90": 0.00022920577321201564,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5391867458820343,
      "val_macro_f1": 0.716269330637822,
      "val_verse_f1": 0.8140978816654492,
      "val_chorus_f1": 0.618440779610195,
      "val_chorus_rate": 0.35681604593992233,
      "val_max_prob": 0.6004891246557236,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009026040809239284,
      "epoch_time": 105.77706909179688,
      "val_boundary_f1": 0.3695450324976787,
      "val_boundary_precision": 0.30474732006125577,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.24266909122423436,
      "val_avg_segment_overlap": 0.5907836474344295,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.380810738159872,
      "val_pk_metric": 0.28055436184871124
    },
    {
      "epoch": 3,
      "train_loss": 0.5140945628285408,
      "train_chorus_rate": 0.3879309292882681,
      "train_max_prob": 0.6369288563728333,
      "train_conf_over_90": 0.00029007038683630525,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5273811370134354,
      "val_macro_f1": 0.6114872179834934,
      "val_verse_f1": 0.6391563502980284,
      "val_chorus_f1": 0.5838180856689582,
      "val_chorus_rate": 0.6297340393066406,
      "val_max_prob": 0.6449388414621353,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008533534667415371,
      "epoch_time": 122.88459014892578,
      "val_boundary_f1": 0.1675178753830439,
      "val_boundary_precision": 0.14774774774774774,
      "val_boundary_recall": 0.19339622641509435,
      "val_complete_segments": 0.07096061748765885,
      "val_avg_segment_overlap": 0.4534453784142642,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.18181818181818182,
      "val_window_diff": 0.49784136233091947,
      "val_pk_metric": 0.3999163140789477
    },
    {
      "epoch": 4,
      "train_loss": 0.5024377390742302,
      "train_chorus_rate": 0.42541962340474127,
      "train_max_prob": 0.6630717217922211,
      "train_conf_over_90": 0.0032846149522811176,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5088529735803604,
      "val_macro_f1": 0.7230203579459609,
      "val_verse_f1": 0.7953261927945472,
      "val_chorus_f1": 0.6507145230973745,
      "val_chorus_rate": 0.43983008712530136,
      "val_max_prob": 0.6512395739555359,
      "val_conf_over_90": 0.004728155035991222,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007874432800787176,
      "epoch_time": 96.38683795928955,
      "val_boundary_f1": 0.33425160697887973,
      "val_boundary_precision": 0.2736842105263158,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.2092045840720284,
      "val_avg_segment_overlap": 0.6182499068069656,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4537663322279347,
      "val_pk_metric": 0.3415231490437243
    },
    {
      "epoch": 5,
      "train_loss": 0.48526691198349,
      "train_chorus_rate": 0.3861169837415218,
      "train_max_prob": 0.6643457531929016,
      "train_conf_over_90": 0.013276365597266703,
      "train_conf_over_95": 0.0005222055420745164,
      "val_loss": 0.5273049622774124,
      "val_macro_f1": 0.7557734462959367,
      "val_verse_f1": 0.8568947551233067,
      "val_chorus_f1": 0.6546521374685668,
      "val_chorus_rate": 0.2874864339828491,
      "val_max_prob": 0.6998564600944519,
      "val_conf_over_90": 0.002673711540410295,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007077541123648007,
      "epoch_time": 101.0113480091095,
      "val_boundary_f1": 0.42296072507552873,
      "val_boundary_precision": 0.36906854130052724,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.29880220509859956,
      "val_avg_segment_overlap": 0.628232079721003,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.32957178088591343,
      "val_pk_metric": 0.23760273317927808
    },
    {
      "epoch": 6,
      "train_loss": 0.49176466315984724,
      "train_chorus_rate": 0.3788608342409134,
      "train_max_prob": 0.6689551770687103,
      "train_conf_over_90": 0.004634247001376934,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5026521384716034,
      "val_macro_f1": 0.6765891320977465,
      "val_verse_f1": 0.7236870310825295,
      "val_chorus_f1": 0.6294912331129635,
      "val_chorus_rate": 0.55473692715168,
      "val_max_prob": 0.6417321711778641,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006177687626199369,
      "epoch_time": 92.11947274208069,
      "val_boundary_f1": 0.30883720930232555,
      "val_boundary_precision": 0.25499231950844853,
      "val_boundary_recall": 0.3915094339622642,
      "val_complete_segments": 0.19007055646769327,
      "val_avg_segment_overlap": 0.5755086672337371,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.47760650327805787,
      "val_pk_metric": 0.3458813681456829
    },
    {
      "epoch": 7,
      "train_loss": 0.4824654832482338,
      "train_chorus_rate": 0.4065875239670277,
      "train_max_prob": 0.6812007248401641,
      "train_conf_over_90": 0.010709775576833636,
      "train_conf_over_95": 7.296685653273016e-05,
      "val_loss": 0.49393023550510406,
      "val_macro_f1": 0.7468540365486931,
      "val_verse_f1": 0.8194656488549619,
      "val_chorus_f1": 0.6742424242424243,
      "val_chorus_rate": 0.4139155223965645,
      "val_max_prob": 0.6914189159870148,
      "val_conf_over_90": 0.019727270817384124,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000521420022425592,
      "epoch_time": 95.09427285194397,
      "val_boundary_f1": 0.3815028901734104,
      "val_boundary_precision": 0.32247557003257327,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.26611689329080634,
      "val_avg_segment_overlap": 0.6516616183532797,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40788763278393547,
      "val_pk_metric": 0.3000143937675044
    },
    {
      "epoch": 8,
      "train_loss": 0.48655697107315066,
      "train_chorus_rate": 0.3710491076111794,
      "train_max_prob": 0.6598027557134628,
      "train_conf_over_90": 0.0038880328182131054,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4915667027235031,
      "val_macro_f1": 0.7615517818770784,
      "val_verse_f1": 0.8391997035939237,
      "val_chorus_f1": 0.6839038601602331,
      "val_chorus_rate": 0.37512896955013275,
      "val_max_prob": 0.6639984995126724,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042291879406080923,
      "epoch_time": 94.11237287521362,
      "val_boundary_f1": 0.41965973534971646,
      "val_boundary_precision": 0.3501577287066246,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.3381861334141292,
      "val_avg_segment_overlap": 0.679772905466884,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3930414001318892,
      "val_pk_metric": 0.27424793840474615
    },
    {
      "epoch": 9,
      "train_loss": 0.4739413887262344,
      "train_chorus_rate": 0.3941917806863785,
      "train_max_prob": 0.6863653421401977,
      "train_conf_over_90": 0.013234642654424533,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49270741641521454,
      "val_macro_f1": 0.7629606266603541,
      "val_verse_f1": 0.8452142206016409,
      "val_chorus_f1": 0.6807070327190673,
      "val_chorus_rate": 0.3542051464319229,
      "val_max_prob": 0.6737924963235855,
      "val_conf_over_90": 0.0011563367443159223,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003265700538664642,
      "epoch_time": 89.02396488189697,
      "val_boundary_f1": 0.43125618199802185,
      "val_boundary_precision": 0.37137989778534924,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3323546732613541,
      "val_avg_segment_overlap": 0.6651652397007874,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.3624952306402826,
      "val_pk_metric": 0.261524564326865
    },
    {
      "epoch": 10,
      "train_loss": 0.4698596358299255,
      "train_chorus_rate": 0.3383308663964272,
      "train_max_prob": 0.6893803149461746,
      "train_conf_over_90": 0.013773000362562016,
      "train_conf_over_95": 2.7533038519322872e-05,
      "val_loss": 0.4870573356747627,
      "val_macro_f1": 0.7516692254312158,
      "val_verse_f1": 0.8224727689661762,
      "val_chorus_f1": 0.6808656818962556,
      "val_chorus_rate": 0.4158122166991234,
      "val_max_prob": 0.6981742531061172,
      "val_conf_over_90": 0.01484789967071265,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023658470412160038,
      "epoch_time": 99.33018589019775,
      "val_boundary_f1": 0.3988212180746562,
      "val_boundary_precision": 0.34175084175084175,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.29303799519865265,
      "val_avg_segment_overlap": 0.6517446952125577,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3930444206082615,
      "val_pk_metric": 0.28405819687067124
    },
    {
      "epoch": 11,
      "train_loss": 0.4622628852725029,
      "train_chorus_rate": 0.33443892896175387,
      "train_max_prob": 0.6923204600811005,
      "train_conf_over_90": 0.014792785851750524,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4911988079547882,
      "val_macro_f1": 0.7664725051821396,
      "val_verse_f1": 0.8465898701773633,
      "val_chorus_f1": 0.6863551401869159,
      "val_chorus_rate": 0.35775963217020035,
      "val_max_prob": 0.6841452419757843,
      "val_conf_over_90": 0.02882232703268528,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015689553640768348,
      "epoch_time": 115.89311003684998,
      "val_boundary_f1": 0.4189723320158103,
      "val_boundary_precision": 0.36054421768707484,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.30857604498908847,
      "val_avg_segment_overlap": 0.6759383622005358,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.38337950803076504,
      "val_pk_metric": 0.2643918105539847
    },
    {
      "epoch": 12,
      "train_loss": 0.45856530517339705,
      "train_chorus_rate": 0.371253128349781,
      "train_max_prob": 0.7018859475851059,
      "train_conf_over_90": 0.028841436468064786,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48798126727342606,
      "val_macro_f1": 0.7536247114083273,
      "val_verse_f1": 0.8279245283018867,
      "val_chorus_f1": 0.679324894514768,
      "val_chorus_rate": 0.39917704463005066,
      "val_max_prob": 0.6956444084644318,
      "val_conf_over_90": 0.038682004902511835,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.098534974486389e-05,
      "epoch_time": 95.98639583587646,
      "val_boundary_f1": 0.4110671936758893,
      "val_boundary_precision": 0.35374149659863946,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.3071890042595239,
      "val_avg_segment_overlap": 0.6618723946417131,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.39538001492937086,
      "val_pk_metric": 0.2792000803130045
    },
    {
      "epoch": 13,
      "train_loss": 0.4686549350619316,
      "train_chorus_rate": 0.35129946544766427,
      "train_max_prob": 0.6877829730510712,
      "train_conf_over_90": 0.021625444805249572,
      "train_conf_over_95": 3.148614487145096e-05,
      "val_loss": 0.4881836101412773,
      "val_macro_f1": 0.7813895338453295,
      "val_verse_f1": 0.8633684586533309,
      "val_chorus_f1": 0.6994106090373281,
      "val_chorus_rate": 0.32560376077890396,
      "val_max_prob": 0.673139676451683,
      "val_conf_over_90": 0.001166149420896545,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.1734735562472406e-05,
      "epoch_time": 93.73693585395813,
      "val_boundary_f1": 0.4573170731707317,
      "val_boundary_precision": 0.4017857142857143,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.34529952805403497,
      "val_avg_segment_overlap": 0.6852875777370433,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.33923860603184447,
      "val_pk_metric": 0.23795250408033689
    },
    {
      "epoch": 14,
      "train_loss": 0.4568196877837181,
      "train_chorus_rate": 0.3126602195203304,
      "train_max_prob": 0.6862388461828232,
      "train_conf_over_90": 0.01383753565896768,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48522286117076874,
      "val_macro_f1": 0.754043432927902,
      "val_verse_f1": 0.8259217027746104,
      "val_chorus_f1": 0.6821651630811937,
      "val_chorus_rate": 0.4082327112555504,
      "val_max_prob": 0.6974250227212906,
      "val_conf_over_90": 0.0269589526578784,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1296182030946924e-05,
      "epoch_time": 110.27376794815063,
      "val_boundary_f1": 0.4130434782608695,
      "val_boundary_precision": 0.3554421768707483,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.31266855213037614,
      "val_avg_segment_overlap": 0.6622866516932783,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.38955493985169226,
      "val_pk_metric": 0.2740657113013901
    },
    {
      "epoch": 15,
      "train_loss": 0.45212383270263673,
      "train_chorus_rate": 0.3367311030626297,
      "train_max_prob": 0.6956582397222519,
      "train_conf_over_90": 0.01955274771898985,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48514336347579956,
      "val_macro_f1": 0.7725344725858263,
      "val_verse_f1": 0.8502928257686676,
      "val_chorus_f1": 0.694776119402985,
      "val_chorus_rate": 0.3588533326983452,
      "val_max_prob": 0.6994747519493103,
      "val_conf_over_90": 0.02222524327225983,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 107.33526182174683,
      "val_boundary_f1": 0.44623115577889444,
      "val_boundary_precision": 0.38879159369527144,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.3443098984456354,
      "val_avg_segment_overlap": 0.6819542534342091,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.3487856331857333,
      "val_pk_metric": 0.24411988538217239
    }
  ]
}