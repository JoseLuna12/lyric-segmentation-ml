{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.17830716028305496,
      "layer_dropout": 0.2295553920344599,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1328868333036712,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2764291,
      "lstm_params": 2203648,
      "attention_params": 559617,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000882134730535545,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "boundary_f1",
      "weight_decay": 0.01644752307695163,
      "gradient_clip_norm": 0.4288044986041489,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.13863122057762503,
        "ece_after": 0.020468718220419395,
        "improvement": 0.11816250235720563,
        "params": {
          "temperature": 0.44587585992874396
        }
      },
      "platt": {
        "ece_before": 0.13863122057762503,
        "ece_after": 0.0765545886368555,
        "improvement": 0.062076631940769525,
        "params": {
          "A": 1.4999993941024998,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6061424791812897,
      "train_chorus_rate": 0.5685811843635747,
      "train_max_prob": 0.5806357443332673,
      "train_conf_over_90": 0.012269372493028641,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6028936505317688,
      "val_macro_f1": 0.36177969296739665,
      "val_verse_f1": 0.23482526057633357,
      "val_chorus_f1": 0.48873412535845967,
      "val_chorus_rate": 0.8990464359521866,
      "val_max_prob": 0.617738351225853,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008725072765660583,
      "epoch_time": 68.70610308647156,
      "val_boundary_f1": 0.014571948998178508,
      "val_boundary_precision": 0.032,
      "val_boundary_recall": 0.009433962264150943,
      "val_complete_segments": 0.003818234610917538,
      "val_avg_segment_overlap": 0.150503135425353,
      "val_verse_to_chorus_acc": 0.008849557522123894,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.42059857828196767,
      "val_pk_metric": 0.41831712946869365
    },
    {
      "epoch": 2,
      "train_loss": 0.5765446871519089,
      "train_chorus_rate": 0.5096969954669476,
      "train_max_prob": 0.5820269614458085,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6083894073963165,
      "val_macro_f1": 0.5635520347661711,
      "val_verse_f1": 0.7624831309041834,
      "val_chorus_f1": 0.36462093862815886,
      "val_chorus_rate": 0.24477799609303474,
      "val_max_prob": 0.5740877836942673,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008440456805937145,
      "epoch_time": 57.66246008872986,
      "val_boundary_f1": 0.09677419354838711,
      "val_boundary_precision": 0.20149253731343283,
      "val_boundary_recall": 0.06367924528301887,
      "val_complete_segments": 0.04303439555295335,
      "val_avg_segment_overlap": 0.23359352068040717,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.35432086205119095,
      "val_pk_metric": 0.3603966397329876
    },
    {
      "epoch": 3,
      "train_loss": 0.5701187551021576,
      "train_chorus_rate": 0.557275313232094,
      "train_max_prob": 0.5787927895784378,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.588733360171318,
      "val_macro_f1": 0.44702286473767805,
      "val_verse_f1": 0.40886309680823,
      "val_chorus_f1": 0.48518263266712613,
      "val_chorus_rate": 0.7701831758022308,
      "val_max_prob": 0.5772818773984909,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007979938509363953,
      "epoch_time": 40.73898482322693,
      "val_boundary_f1": 0.07985480943738656,
      "val_boundary_precision": 0.1732283464566929,
      "val_boundary_recall": 0.05188679245283019,
      "val_complete_segments": 0.03059605014801197,
      "val_avg_segment_overlap": 0.19150458096882056,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.4218771659664106,
      "val_pk_metric": 0.42083326832986423
    },
    {
      "epoch": 4,
      "train_loss": 0.5650955975055695,
      "train_chorus_rate": 0.5507179588079453,
      "train_max_prob": 0.5753828138113022,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5874295681715012,
      "val_macro_f1": 0.6302179834382237,
      "val_verse_f1": 0.7846873376060973,
      "val_chorus_f1": 0.47574862927035,
      "val_chorus_rate": 0.2833953872323036,
      "val_max_prob": 0.5634882301092148,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007363644735313216,
      "epoch_time": 48.64539194107056,
      "val_boundary_f1": 0.22538552787663108,
      "val_boundary_precision": 0.22673031026252982,
      "val_boundary_recall": 0.2240566037735849,
      "val_complete_segments": 0.08988462026638061,
      "val_avg_segment_overlap": 0.3994177686498067,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.21212121212121213,
      "val_window_diff": 0.40901861121303473,
      "val_pk_metric": 0.34423676593188623
    },
    {
      "epoch": 5,
      "train_loss": 0.5469817727804184,
      "train_chorus_rate": 0.5164143212139607,
      "train_max_prob": 0.5981479436159134,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5466185361146927,
      "val_macro_f1": 0.6798750243362761,
      "val_verse_f1": 0.7651735505138646,
      "val_chorus_f1": 0.5945764981586876,
      "val_chorus_rate": 0.4350108578801155,
      "val_max_prob": 0.6227903068065643,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006618510479016586,
      "epoch_time": 48.638548135757446,
      "val_boundary_f1": 0.2713257965056526,
      "val_boundary_precision": 0.24043715846994534,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.09723391964908401,
      "val_avg_segment_overlap": 0.5380531706258358,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.44403989986046766,
      "val_pk_metric": 0.3668486164089676
    },
    {
      "epoch": 6,
      "train_loss": 0.5292445316910743,
      "train_chorus_rate": 0.39972284287214277,
      "train_max_prob": 0.6490099787712097,
      "train_conf_over_90": 0.005210087483283133,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5511895716190338,
      "val_macro_f1": 0.5304514133141887,
      "val_verse_f1": 0.5309126594700687,
      "val_chorus_f1": 0.5299901671583087,
      "val_chorus_rate": 0.6996256709098816,
      "val_max_prob": 0.6723151654005051,
      "val_conf_over_90": 0.015911240712739527,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005777101683025091,
      "epoch_time": 41.94501209259033,
      "val_boundary_f1": 0.13364055299539168,
      "val_boundary_precision": 0.13063063063063063,
      "val_boundary_recall": 0.13679245283018868,
      "val_complete_segments": 0.04734624224284882,
      "val_avg_segment_overlap": 0.364108136894834,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.12121212121212122,
      "val_window_diff": 0.5205542530988703,
      "val_pk_metric": 0.43269841505074935
    },
    {
      "epoch": 7,
      "train_loss": 0.5214117422699929,
      "train_chorus_rate": 0.4182891920208931,
      "train_max_prob": 0.6456385463476181,
      "train_conf_over_90": 0.01072837994142901,
      "train_conf_over_95": 0.0007104846998117864,
      "val_loss": 0.5302871689200401,
      "val_macro_f1": 0.7216703285799675,
      "val_verse_f1": 0.8160645516229599,
      "val_chorus_f1": 0.6272761055369752,
      "val_chorus_rate": 0.3615332096815109,
      "val_max_prob": 0.6489182710647583,
      "val_conf_over_90": 0.001492524053901434,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048761919492509176,
      "epoch_time": 84.56539487838745,
      "val_boundary_f1": 0.3162544169611307,
      "val_boundary_precision": 0.2528248587570621,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.17930350438303777,
      "val_avg_segment_overlap": 0.6253099802818225,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.45717811524847446,
      "val_pk_metric": 0.3152755118086016
    },
    {
      "epoch": 8,
      "train_loss": 0.5013639405369759,
      "train_chorus_rate": 0.39245942085981367,
      "train_max_prob": 0.6570389658212662,
      "train_conf_over_90": 0.010744404207798652,
      "train_conf_over_95": 0.0001462740619899705,
      "val_loss": 0.5273500606417656,
      "val_macro_f1": 0.7493122940725494,
      "val_verse_f1": 0.84787590340208,
      "val_chorus_f1": 0.650748684743019,
      "val_chorus_rate": 0.30775367841124535,
      "val_max_prob": 0.6872982680797577,
      "val_conf_over_90": 0.007894459064118564,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003955155356104534,
      "epoch_time": 58.029074907302856,
      "val_boundary_f1": 0.3721374045801527,
      "val_boundary_precision": 0.3125,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.23952294970322544,
      "val_avg_segment_overlap": 0.6388282751318899,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3686566077490818,
      "val_pk_metric": 0.2586559144001944
    },
    {
      "epoch": 9,
      "train_loss": 0.4829056471586227,
      "train_chorus_rate": 0.32989804446697235,
      "train_max_prob": 0.681440320611,
      "train_conf_over_90": 0.0167515471635852,
      "train_conf_over_95": 0.0006554797670105472,
      "val_loss": 0.5188915506005287,
      "val_macro_f1": 0.703897904554702,
      "val_verse_f1": 0.785122374253228,
      "val_chorus_f1": 0.622673434856176,
      "val_chorus_rate": 0.4268660619854927,
      "val_max_prob": 0.674954429268837,
      "val_conf_over_90": 0.018397307256236672,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.0003054245622330359,
      "epoch_time": 103.49512195587158,
      "val_boundary_f1": 0.2636103151862464,
      "val_boundary_precision": 0.22150882825040127,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.13282249072280886,
      "val_avg_segment_overlap": 0.585970133838061,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.45734532974044184,
      "val_pk_metric": 0.3505534432719706
    },
    {
      "epoch": 10,
      "train_loss": 0.4872359365224838,
      "train_chorus_rate": 0.354679012298584,
      "train_max_prob": 0.6791429132223129,
      "train_conf_over_90": 0.019229380987235346,
      "train_conf_over_95": 0.002087867874070071,
      "val_loss": 0.5154962837696075,
      "val_macro_f1": 0.7021351946784475,
      "val_verse_f1": 0.7804783200466653,
      "val_chorus_f1": 0.6237920693102299,
      "val_chorus_rate": 0.43746064603328705,
      "val_max_prob": 0.6750533431768417,
      "val_conf_over_90": 0.02056371606886387,
      "val_conf_over_95": 0.0002312673459528014,
      "learning_rate": 0.00022128368263388634,
      "epoch_time": 81.95921587944031,
      "val_boundary_f1": 0.3071364046973803,
      "val_boundary_precision": 0.24890190336749635,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.1597501777644938,
      "val_avg_segment_overlap": 0.6108944456370509,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4823420667162893,
      "val_pk_metric": 0.33994721905826336
    },
    {
      "epoch": 11,
      "train_loss": 0.49013429433107375,
      "train_chorus_rate": 0.35908634290099145,
      "train_max_prob": 0.6761456817388535,
      "train_conf_over_90": 0.018309401339502075,
      "train_conf_over_95": 0.00046701519167982044,
      "val_loss": 0.5243430137634277,
      "val_macro_f1": 0.7573156922343405,
      "val_verse_f1": 0.8571428571428571,
      "val_chorus_f1": 0.657488527325824,
      "val_chorus_rate": 0.28969570994377136,
      "val_max_prob": 0.659782275557518,
      "val_conf_over_90": 0.0002312673459528014,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014677025700422344,
      "epoch_time": 85.95134592056274,
      "val_boundary_f1": 0.404,
      "val_boundary_precision": 0.3506944444444444,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.26850045584138904,
      "val_avg_segment_overlap": 0.6552070368310866,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3383495835973836,
      "val_pk_metric": 0.24350330684086202
    },
    {
      "epoch": 12,
      "train_loss": 0.487055678665638,
      "train_chorus_rate": 0.3409091025590897,
      "train_max_prob": 0.6768329352140426,
      "train_conf_over_90": 0.014354061291669495,
      "train_conf_over_95": 0.00015408818144351243,
      "val_loss": 0.5107562690973282,
      "val_macro_f1": 0.7341212867898328,
      "val_verse_f1": 0.8232481147691741,
      "val_chorus_f1": 0.6449944588104913,
      "val_chorus_rate": 0.36601482331752777,
      "val_max_prob": 0.6842081248760223,
      "val_conf_over_90": 0.018673050915822387,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.514087959914961e-05,
      "epoch_time": 78.25067806243896,
      "val_boundary_f1": 0.33115060804490176,
      "val_boundary_precision": 0.2744186046511628,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.1892365987408405,
      "val_avg_segment_overlap": 0.6386193908855053,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4278834487319161,
      "val_pk_metric": 0.2993760950328381
    },
    {
      "epoch": 13,
      "train_loss": 0.481684735417366,
      "train_chorus_rate": 0.3390537962317467,
      "train_max_prob": 0.6810953199863434,
      "train_conf_over_90": 0.018850432778708636,
      "train_conf_over_95": 0.00023329784744419158,
      "val_loss": 0.5072775036096573,
      "val_macro_f1": 0.7280574881093398,
      "val_verse_f1": 0.8111361926260345,
      "val_chorus_f1": 0.6449787835926449,
      "val_chorus_rate": 0.3954484611749649,
      "val_max_prob": 0.6938641518354416,
      "val_conf_over_90": 0.023416572250425816,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.908904994183032e-05,
      "epoch_time": 77.42305207252502,
      "val_boundary_f1": 0.3498596819457437,
      "val_boundary_precision": 0.289922480620155,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.2208487555120641,
      "val_avg_segment_overlap": 0.6363668322411822,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4311352246062383,
      "val_pk_metric": 0.30599905643437675
    },
    {
      "epoch": 14,
      "train_loss": 0.47487984597682953,
      "train_chorus_rate": 0.3400826469063759,
      "train_max_prob": 0.6954436898231506,
      "train_conf_over_90": 0.025277332426048814,
      "train_conf_over_95": 0.0002460857562255114,
      "val_loss": 0.5081406831741333,
      "val_macro_f1": 0.7447058907475941,
      "val_verse_f1": 0.8365540906628138,
      "val_chorus_f1": 0.6528576908323743,
      "val_chorus_rate": 0.3413238078355789,
      "val_max_prob": 0.6849338561296463,
      "val_conf_over_90": 0.01359248801600188,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0627453969486633e-05,
      "epoch_time": 81.52308177947998,
      "val_boundary_f1": 0.3761638733705772,
      "val_boundary_precision": 0.31076923076923074,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24579267951484282,
      "val_avg_segment_overlap": 0.6557208949845482,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.38935949618617793,
      "val_pk_metric": 0.2688550085996972
    },
    {
      "epoch": 15,
      "train_loss": 0.4812590152025223,
      "train_chorus_rate": 0.33998618125915525,
      "train_max_prob": 0.6860649943351745,
      "train_conf_over_90": 0.01940131888259202,
      "train_conf_over_95": 0.00033412578341085464,
      "val_loss": 0.5073961317539215,
      "val_macro_f1": 0.7427585879074081,
      "val_verse_f1": 0.8321487151448879,
      "val_chorus_f1": 0.6533684606699284,
      "val_chorus_rate": 0.35356979072093964,
      "val_max_prob": 0.6829774975776672,
      "val_conf_over_90": 0.01359248801600188,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 80.97779989242554,
      "val_boundary_f1": 0.3616236162361624,
      "val_boundary_precision": 0.296969696969697,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.23788352433633453,
      "val_avg_segment_overlap": 0.654145922756295,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3991941791758531,
      "val_pk_metric": 0.28083825835705917
    }
  ]
}