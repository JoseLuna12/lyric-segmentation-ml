{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.23153357221996998,
      "layer_dropout": 0.0,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.21944134950692712,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007954854400134199,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.017373287404568418,
      "gradient_clip_norm": 0.304493877160622,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11110057807683008,
        "ece_after": 0.01673155225271793,
        "improvement": 0.09436902582411215,
        "params": {
          "temperature": 0.5121512390689039
        }
      },
      "platt": {
        "ece_before": 0.11110057807683008,
        "ece_after": 0.023051309327948074,
        "improvement": 0.088049268748882,
        "params": {
          "A": 1.7626027476788968,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5823985874652863,
      "train_chorus_rate": 0.5391735807410442,
      "train_max_prob": 0.6137559592723847,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5778045654296875,
      "val_macro_f1": 0.4253003568352406,
      "val_verse_f1": 0.3445714285714286,
      "val_chorus_f1": 0.5060292850990525,
      "val_chorus_rate": 0.8407783955335617,
      "val_max_prob": 0.5620261281728745,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007868047334902442,
      "epoch_time": 144.1068058013916,
      "val_boundary_f1": 0.06701940035273368,
      "val_boundary_precision": 0.13286713286713286,
      "val_boundary_recall": 0.04481132075471698,
      "val_complete_segments": 0.02920542683268028,
      "val_avg_segment_overlap": 0.19636947990543688,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.010101010101010102,
      "val_window_diff": 0.41586242348240277,
      "val_pk_metric": 0.4123462597892559
    },
    {
      "epoch": 2,
      "train_loss": 0.5491037502884865,
      "train_chorus_rate": 0.449490564968437,
      "train_max_prob": 0.6049998283386231,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5573550462722778,
      "val_macro_f1": 0.5103777947399816,
      "val_verse_f1": 0.4922213720989544,
      "val_chorus_f1": 0.5285342173810088,
      "val_chorus_rate": 0.7378562539815903,
      "val_max_prob": 0.5933063477277756,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007611420024504313,
      "epoch_time": 148.15542912483215,
      "val_boundary_f1": 0.12269938650306748,
      "val_boundary_precision": 0.1278772378516624,
      "val_boundary_recall": 0.1179245283018868,
      "val_complete_segments": 0.034859139551610394,
      "val_avg_segment_overlap": 0.29554960039239764,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.10101010101010101,
      "val_window_diff": 0.47077947074748644,
      "val_pk_metric": 0.41990174150994003
    },
    {
      "epoch": 3,
      "train_loss": 0.508508087694645,
      "train_chorus_rate": 0.40360661298036576,
      "train_max_prob": 0.6377275258302688,
      "train_conf_over_90": 0.008160745716304518,
      "train_conf_over_95": 3.728560695890337e-05,
      "val_loss": 0.5283185914158821,
      "val_macro_f1": 0.7268706177811387,
      "val_verse_f1": 0.8192328867682144,
      "val_chorus_f1": 0.634508348794063,
      "val_chorus_rate": 0.36309488117694855,
      "val_max_prob": 0.664556473493576,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007196188313838672,
      "epoch_time": 156.12320613861084,
      "val_boundary_f1": 0.37642919964819704,
      "val_boundary_precision": 0.30014025245441794,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.2853989328671195,
      "val_avg_segment_overlap": 0.6196602598484923,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.42720778628164996,
      "val_pk_metric": 0.30101418883624464
    },
    {
      "epoch": 4,
      "train_loss": 0.4962890163064003,
      "train_chorus_rate": 0.4221062481403351,
      "train_max_prob": 0.6775875240564346,
      "train_conf_over_90": 0.011419510046835057,
      "train_conf_over_95": 0.0003944865224184468,
      "val_loss": 0.5082897171378136,
      "val_macro_f1": 0.7331582147326507,
      "val_verse_f1": 0.8114676286310993,
      "val_chorus_f1": 0.6548488008342023,
      "val_chorus_rate": 0.40764694660902023,
      "val_max_prob": 0.6604771465063095,
      "val_conf_over_90": 0.007824530941434205,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006640499821164419,
      "epoch_time": 124.99370074272156,
      "val_boundary_f1": 0.348607367475292,
      "val_boundary_precision": 0.28156748911465895,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.2459578537786385,
      "val_avg_segment_overlap": 0.6332892731335241,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.43794574957288573,
      "val_pk_metric": 0.3171333869491235
    },
    {
      "epoch": 5,
      "train_loss": 0.48812186866998675,
      "train_chorus_rate": 0.37767872884869574,
      "train_max_prob": 0.6786117374897003,
      "train_conf_over_90": 0.014601197669981048,
      "train_conf_over_95": 0.00015776116051711143,
      "val_loss": 0.5156851783394814,
      "val_macro_f1": 0.7420802504511586,
      "val_verse_f1": 0.832909553214675,
      "val_chorus_f1": 0.6512509476876421,
      "val_chorus_rate": 0.34931476414203644,
      "val_max_prob": 0.7199023514986038,
      "val_conf_over_90": 0.01917549269273877,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005968640800100649,
      "epoch_time": 130.09125685691833,
      "val_boundary_f1": 0.39203980099502483,
      "val_boundary_precision": 0.33907056798623064,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2869016569970971,
      "val_avg_segment_overlap": 0.6219524186873681,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.3716110552895788,
      "val_pk_metric": 0.2704856862196316
    },
    {
      "epoch": 6,
      "train_loss": 0.488880655169487,
      "train_chorus_rate": 0.3748911641538143,
      "train_max_prob": 0.6915122181177139,
      "train_conf_over_90": 0.012940148418419995,
      "train_conf_over_95": 3.6179448943585155e-05,
      "val_loss": 0.4949125498533249,
      "val_macro_f1": 0.7112645993508345,
      "val_verse_f1": 0.7700469291981229,
      "val_chorus_f1": 0.6524822695035462,
      "val_chorus_rate": 0.4970180615782738,
      "val_max_prob": 0.6862316131591797,
      "val_conf_over_90": 0.014310830971226096,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005209974713805122,
      "epoch_time": 137.62965297698975,
      "val_boundary_f1": 0.30492424242424243,
      "val_boundary_precision": 0.254746835443038,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.18709126108383795,
      "val_avg_segment_overlap": 0.6034938269178481,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4550091273575939,
      "val_pk_metric": 0.3333455424126247
    },
    {
      "epoch": 7,
      "train_loss": 0.4756653130054474,
      "train_chorus_rate": 0.38601952642202375,
      "train_max_prob": 0.6937264293432236,
      "train_conf_over_90": 0.015189894821378402,
      "train_conf_over_95": 3.636363544501364e-05,
      "val_loss": 0.4892137125134468,
      "val_macro_f1": 0.7457772441131935,
      "val_verse_f1": 0.8191347436630455,
      "val_chorus_f1": 0.6724197445633414,
      "val_chorus_rate": 0.41238779574632645,
      "val_max_prob": 0.6990700662136078,
      "val_conf_over_90": 0.034396044444292784,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004397658910732741,
      "epoch_time": 149.59909200668335,
      "val_boundary_f1": 0.3799621928166351,
      "val_boundary_precision": 0.31703470031545744,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.27847560293212464,
      "val_avg_segment_overlap": 0.6567561957998055,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4051950727045813,
      "val_pk_metric": 0.2909079928590578
    },
    {
      "epoch": 8,
      "train_loss": 0.4829122394323349,
      "train_chorus_rate": 0.37611128464341165,
      "train_max_prob": 0.6793396800756455,
      "train_conf_over_90": 0.007932225195690989,
      "train_conf_over_95": 3.017501439899206e-05,
      "val_loss": 0.49449195712804794,
      "val_macro_f1": 0.7643777329160009,
      "val_verse_f1": 0.85290967511603,
      "val_chorus_f1": 0.6758457907159716,
      "val_chorus_rate": 0.32558806240558624,
      "val_max_prob": 0.6868248879909515,
      "val_conf_over_90": 0.003422112320549786,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003567195489401459,
      "epoch_time": 129.55920886993408,
      "val_boundary_f1": 0.4297994269340974,
      "val_boundary_precision": 0.3611556982343499,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.3428516154391022,
      "val_avg_segment_overlap": 0.6782096217101059,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.36141084983728805,
      "val_pk_metric": 0.2595502713559853
    },
    {
      "epoch": 9,
      "train_loss": 0.4694571256637573,
      "train_chorus_rate": 0.38113090246915815,
      "train_max_prob": 0.7038892060518265,
      "train_conf_over_90": 0.01988215618766844,
      "train_conf_over_95": 3.5385703085921705e-05,
      "val_loss": 0.48745712637901306,
      "val_macro_f1": 0.7514987014326666,
      "val_verse_f1": 0.8275991727768378,
      "val_chorus_f1": 0.6753982300884955,
      "val_chorus_rate": 0.3948701545596123,
      "val_max_prob": 0.6808414459228516,
      "val_conf_over_90": 0.008421095495577902,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002754879686329077,
      "epoch_time": 122.65895390510559,
      "val_boundary_f1": 0.3935361216730037,
      "val_boundary_precision": 0.32961783439490444,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28241665199512495,
      "val_avg_segment_overlap": 0.6580239646860205,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40433529800536566,
      "val_pk_metric": 0.2885662183494284
    },
    {
      "epoch": 10,
      "train_loss": 0.4656537279486656,
      "train_chorus_rate": 0.33150473088026045,
      "train_max_prob": 0.7055094540119171,
      "train_conf_over_90": 0.023128316458314657,
      "train_conf_over_95": 5.5066077038645744e-05,
      "val_loss": 0.4856473132967949,
      "val_macro_f1": 0.7588214928056054,
      "val_verse_f1": 0.8338640194793033,
      "val_chorus_f1": 0.6837789661319074,
      "val_chorus_rate": 0.3898444250226021,
      "val_max_prob": 0.7237959504127502,
      "val_conf_over_90": 0.041613670997321606,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019962136000335504,
      "epoch_time": 128.4123890399933,
      "val_boundary_f1": 0.40119760479041916,
      "val_boundary_precision": 0.3477508650519031,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.28951474387582554,
      "val_avg_segment_overlap": 0.6601777897425594,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.38215030183151094,
      "val_pk_metric": 0.28304028738916565
    },
    {
      "epoch": 11,
      "train_loss": 0.456667560338974,
      "train_chorus_rate": 0.33516601771116256,
      "train_max_prob": 0.7124533653259277,
      "train_conf_over_90": 0.02417576527222991,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4877776876091957,
      "val_macro_f1": 0.7607740592953139,
      "val_verse_f1": 0.84408014571949,
      "val_chorus_f1": 0.6774679728711379,
      "val_chorus_rate": 0.35277413576841354,
      "val_max_prob": 0.6982852518558502,
      "val_conf_over_90": 0.03667629603296518,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001324354578969781,
      "epoch_time": 146.28770685195923,
      "val_boundary_f1": 0.40701071080817913,
      "val_boundary_precision": 0.3466003316749585,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.293986766269375,
      "val_avg_segment_overlap": 0.6695301293433222,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.379916612581659,
      "val_pk_metric": 0.2615224504803658
    },
    {
      "epoch": 12,
      "train_loss": 0.4534550368785858,
      "train_chorus_rate": 0.36454817205667495,
      "train_max_prob": 0.7218129336833954,
      "train_conf_over_90": 0.0525656133890152,
      "train_conf_over_95": 0.0007077369140461087,
      "val_loss": 0.48556675761938095,
      "val_macro_f1": 0.7460122409868453,
      "val_verse_f1": 0.8189276855561916,
      "val_chorus_f1": 0.6730967964174991,
      "val_chorus_rate": 0.4137197881937027,
      "val_max_prob": 0.714071974158287,
      "val_conf_over_90": 0.06233288161456585,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.686660862955269e-05,
      "epoch_time": 119.49839067459106,
      "val_boundary_f1": 0.39071566731141194,
      "val_boundary_precision": 0.33114754098360655,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.28840670127785717,
      "val_avg_segment_overlap": 0.6594916968369331,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4120372831529995,
      "val_pk_metric": 0.2926481865170075
    },
    {
      "epoch": 13,
      "train_loss": 0.46436861008405683,
      "train_chorus_rate": 0.3544527038931847,
      "train_max_prob": 0.703908821940422,
      "train_conf_over_90": 0.038203514739871026,
      "train_conf_over_95": 0.00014118881954345853,
      "val_loss": 0.4911273568868637,
      "val_macro_f1": 0.7694682183833892,
      "val_verse_f1": 0.8584086478823321,
      "val_chorus_f1": 0.6805277888844462,
      "val_chorus_rate": 0.31519148498773575,
      "val_max_prob": 0.6888240426778793,
      "val_conf_over_90": 0.013903186772949994,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.53434375629885e-05,
      "epoch_time": 132.2262580394745,
      "val_boundary_f1": 0.4147557328015952,
      "val_boundary_precision": 0.3592400690846287,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.310076176009368,
      "val_avg_segment_overlap": 0.6743908062389067,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3540003853298838,
      "val_pk_metric": 0.24644899565480508
    },
    {
      "epoch": 14,
      "train_loss": 0.45275411754846573,
      "train_chorus_rate": 0.3075337506830692,
      "train_max_prob": 0.7028491824865342,
      "train_conf_over_90": 0.02718884712085128,
      "train_conf_over_95": 3.657644556369633e-05,
      "val_loss": 0.48136841505765915,
      "val_macro_f1": 0.7525062595858725,
      "val_verse_f1": 0.8251376495158534,
      "val_chorus_f1": 0.6798748696558915,
      "val_chorus_rate": 0.40723446011543274,
      "val_max_prob": 0.707173615694046,
      "val_conf_over_90": 0.049709978979080915,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.680706523175661e-06,
      "epoch_time": 149.5344750881195,
      "val_boundary_f1": 0.4153846153846154,
      "val_boundary_precision": 0.35064935064935066,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.3102758113362567,
      "val_avg_segment_overlap": 0.6652728431934174,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.387864768165897,
      "val_pk_metric": 0.2845431222850914
    },
    {
      "epoch": 15,
      "train_loss": 0.4464827075600624,
      "train_chorus_rate": 0.3448689192533493,
      "train_max_prob": 0.7084607928991318,
      "train_conf_over_90": 0.03413247521966696,
      "train_conf_over_95": 3.776435041800141e-05,
      "val_loss": 0.482353150844574,
      "val_macro_f1": 0.761499678674994,
      "val_verse_f1": 0.84109740379304,
      "val_chorus_f1": 0.681901953556948,
      "val_chorus_rate": 0.3671107515692711,
      "val_max_prob": 0.7087571173906326,
      "val_conf_over_90": 0.041782019194215536,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 145.73799395561218,
      "val_boundary_f1": 0.42645607107601186,
      "val_boundary_precision": 0.366723259762309,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.32444311263240216,
      "val_avg_segment_overlap": 0.6792249154731567,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.3662550360021109,
      "val_pk_metric": 0.2724813926259343
    }
  ]
}