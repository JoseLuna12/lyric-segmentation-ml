{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.1818126876317751,
      "layer_dropout": 0.2064825154701128,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.19518632032511046,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 2706690,
      "lstm_params": 2179072,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007725900993139319,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.015129805651861302,
      "gradient_clip_norm": 0.3328566133883913,
      "max_epochs": 15,
      "patience": 4
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08464912278303229,
        "ece_after": 0.03603860036212006,
        "improvement": 0.048610522420912225,
        "params": {
          "temperature": 0.6552426683717543
        }
      },
      "platt": {
        "ece_before": 0.08464912278303229,
        "ece_after": 0.03781987300731814,
        "improvement": 0.04682924977571414,
        "params": {
          "A": 1.4943636230032435,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.565417030453682,
      "train_chorus_rate": 0.42355988584458826,
      "train_max_prob": 0.5690704792737961,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5801776498556137,
      "val_macro_f1": 0.527563762216585,
      "val_verse_f1": 0.7702790395846851,
      "val_chorus_f1": 0.28484848484848485,
      "val_chorus_rate": 0.18620886281132698,
      "val_max_prob": 0.5540791451931,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007641595518539067,
      "epoch_time": 100.1321189403534,
      "val_boundary_f1": 0.06896551724137931,
      "val_boundary_precision": 0.1836734693877551,
      "val_boundary_recall": 0.04245283018867924,
      "val_complete_segments": 0.01882548167012642,
      "val_avg_segment_overlap": 0.21198497741395406,
      "val_verse_to_chorus_acc": 0.048672566371681415,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.37006567541808094,
      "val_pk_metric": 0.38567638438946594
    },
    {
      "epoch": 2,
      "train_loss": 0.5499412074685097,
      "train_chorus_rate": 0.41612547151744367,
      "train_max_prob": 0.5694746911525727,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5836871415376663,
      "val_macro_f1": 0.5466468867614888,
      "val_verse_f1": 0.731239092495637,
      "val_chorus_f1": 0.36205468102734056,
      "val_chorus_rate": 0.29284122958779335,
      "val_max_prob": 0.5641807615756989,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007392363648520889,
      "epoch_time": 47.2060489654541,
      "val_boundary_f1": 0.04580152671755725,
      "val_boundary_precision": 0.12,
      "val_boundary_recall": 0.02830188679245283,
      "val_complete_segments": 0.05348657246854489,
      "val_avg_segment_overlap": 0.22323966651851732,
      "val_verse_to_chorus_acc": 0.01327433628318584,
      "val_chorus_to_verse_acc": 0.025252525252525252,
      "val_window_diff": 0.31614692461715144,
      "val_pk_metric": 0.31853341535653434
    },
    {
      "epoch": 3,
      "train_loss": 0.5569755151867867,
      "train_chorus_rate": 0.43217584848753177,
      "train_max_prob": 0.57643723487854,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5731476098299026,
      "val_macro_f1": 0.5455896687944738,
      "val_verse_f1": 0.678944370609455,
      "val_chorus_f1": 0.4122349669794925,
      "val_chorus_rate": 0.4073755145072937,
      "val_max_prob": 0.5434340983629227,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006989098011751782,
      "epoch_time": 105.91066908836365,
      "val_boundary_f1": 0.07079646017699115,
      "val_boundary_precision": 0.14184397163120568,
      "val_boundary_recall": 0.04716981132075472,
      "val_complete_segments": 0.0537074985908496,
      "val_avg_segment_overlap": 0.2388786394138444,
      "val_verse_to_chorus_acc": 0.05309734513274336,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.31261281144799696,
      "val_pk_metric": 0.321321479665092
    },
    {
      "epoch": 4,
      "train_loss": 0.5441649079322814,
      "train_chorus_rate": 0.4031751859060023,
      "train_max_prob": 0.5581716656684875,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.57393479347229,
      "val_macro_f1": 0.5313756113559334,
      "val_verse_f1": 0.6027280477408355,
      "val_chorus_f1": 0.4600231749710313,
      "val_chorus_rate": 0.5488388687372208,
      "val_max_prob": 0.5634990185499191,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006449423251641775,
      "epoch_time": 51.39614486694336,
      "val_boundary_f1": 0.05839416058394161,
      "val_boundary_precision": 0.12903225806451613,
      "val_boundary_recall": 0.03773584905660377,
      "val_complete_segments": 0.05507724054913875,
      "val_avg_segment_overlap": 0.2228314655400693,
      "val_verse_to_chorus_acc": 0.03982300884955752,
      "val_chorus_to_verse_acc": 0.005050505050505051,
      "val_window_diff": 0.3145789607418995,
      "val_pk_metric": 0.3183671993083485
    },
    {
      "epoch": 5,
      "train_loss": 0.5424442186951637,
      "train_chorus_rate": 0.46512354831211267,
      "train_max_prob": 0.5677061885595321,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.571425050497055,
      "val_macro_f1": 0.5434511349371771,
      "val_verse_f1": 0.6275404396515969,
      "val_chorus_f1": 0.4593618302227574,
      "val_chorus_rate": 0.5169309005141258,
      "val_max_prob": 0.5390623658895493,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000579692574485449,
      "epoch_time": 117.71160387992859,
      "val_boundary_f1": 0.0749185667752443,
      "val_boundary_precision": 0.12105263157894737,
      "val_boundary_recall": 0.054245283018867926,
      "val_complete_segments": 0.06413021300348978,
      "val_avg_segment_overlap": 0.24858224751973163,
      "val_verse_to_chorus_acc": 0.05752212389380531,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.3145523588821107,
      "val_pk_metric": 0.31648444687273036
    },
    {
      "epoch": 6,
      "train_loss": 0.5444080084562302,
      "train_chorus_rate": 0.5413972213864326,
      "train_max_prob": 0.5699687778949738,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5790820866823196,
      "val_macro_f1": 0.3815760987693906,
      "val_verse_f1": 0.2899971173248775,
      "val_chorus_f1": 0.4731550802139037,
      "val_chorus_rate": 0.8481563776731491,
      "val_max_prob": 0.6035085618495941,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005060122763466953,
      "epoch_time": 103.67751979827881,
      "val_boundary_f1": 0.02397260273972603,
      "val_boundary_precision": 0.04375,
      "val_boundary_recall": 0.01650943396226415,
      "val_complete_segments": 0.01446187514586242,
      "val_avg_segment_overlap": 0.14756372386708777,
      "val_verse_to_chorus_acc": 0.030973451327433628,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.47161238056078514,
      "val_pk_metric": 0.4405598485479213
    },
    {
      "epoch": 7,
      "train_loss": 0.5427261769771576,
      "train_chorus_rate": 0.5111481633211952,
      "train_max_prob": 0.5826707512140274,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5641259551048279,
      "val_macro_f1": 0.5636199780873534,
      "val_verse_f1": 0.6273837583029783,
      "val_chorus_f1": 0.4998561978717285,
      "val_chorus_rate": 0.554055280983448,
      "val_max_prob": 0.5659068375825882,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042712161333387683,
      "epoch_time": 77.13921403884888,
      "val_boundary_f1": 0.09465648854961832,
      "val_boundary_precision": 0.1341991341991342,
      "val_boundary_recall": 0.07311320754716981,
      "val_complete_segments": 0.06413021300348978,
      "val_avg_segment_overlap": 0.29304487357956277,
      "val_verse_to_chorus_acc": 0.0752212389380531,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.32903323228873843,
      "val_pk_metric": 0.32153231168382856
    },
    {
      "epoch": 8,
      "train_loss": 0.5272200301289558,
      "train_chorus_rate": 0.5400418132543564,
      "train_max_prob": 0.6107181340456009,
      "train_conf_over_90": 0.00012877648405265063,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5557891875505447,
      "val_macro_f1": 0.6676863668508589,
      "val_verse_f1": 0.7892844300611291,
      "val_chorus_f1": 0.5460883036405887,
      "val_chorus_rate": 0.3347320705652237,
      "val_max_prob": 0.6068234592676163,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034646848598005546,
      "epoch_time": 77.1501739025116,
      "val_boundary_f1": 0.2651356993736952,
      "val_boundary_precision": 0.23782771535580524,
      "val_boundary_recall": 0.29952830188679247,
      "val_complete_segments": 0.1507419705722993,
      "val_avg_segment_overlap": 0.4877309102396698,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.2727272727272727,
      "val_window_diff": 0.329154018130303,
      "val_pk_metric": 0.2908774439673467
    },
    {
      "epoch": 9,
      "train_loss": 0.49720783829689025,
      "train_chorus_rate": 0.4118647985160351,
      "train_max_prob": 0.6513140648603439,
      "train_conf_over_90": 0.008391865060548297,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5447978377342224,
      "val_macro_f1": 0.7069985372066914,
      "val_verse_f1": 0.832272492688801,
      "val_chorus_f1": 0.5817245817245817,
      "val_chorus_rate": 0.27362189441919327,
      "val_max_prob": 0.6757891923189163,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002675778229672369,
      "epoch_time": 78.62999391555786,
      "val_boundary_f1": 0.34017595307917886,
      "val_boundary_precision": 0.2904841402337229,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.2046120503172465,
      "val_avg_segment_overlap": 0.5697729173294726,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.33050663041639605,
      "val_pk_metric": 0.26516721768133883
    },
    {
      "epoch": 10,
      "train_loss": 0.5009611457586288,
      "train_chorus_rate": 0.389311183989048,
      "train_max_prob": 0.6531965255737304,
      "train_conf_over_90": 0.0009215726109687239,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5086554363369942,
      "val_macro_f1": 0.6887224293290339,
      "val_verse_f1": 0.76814713363334,
      "val_chorus_f1": 0.609297725024728,
      "val_chorus_rate": 0.44624488800764084,
      "val_max_prob": 0.6515078246593475,
      "val_conf_over_90": 0.00024108003708533943,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019389752482848314,
      "epoch_time": 56.70728874206543,
      "val_boundary_f1": 0.2851782363977486,
      "val_boundary_precision": 0.2367601246105919,
      "val_boundary_recall": 0.3584905660377358,
      "val_complete_segments": 0.15622092134552368,
      "val_avg_segment_overlap": 0.5708203485770856,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.4340696143007611,
      "val_pk_metric": 0.3430006492802561
    },
    {
      "epoch": 11,
      "train_loss": 0.4918570652604103,
      "train_chorus_rate": 0.42244977205991746,
      "train_max_prob": 0.6625534445047379,
      "train_conf_over_90": 0.0019310407544253394,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5124867856502533,
      "val_macro_f1": 0.7142668403745226,
      "val_verse_f1": 0.813206858810653,
      "val_chorus_f1": 0.6153268219383922,
      "val_chorus_rate": 0.3545902594923973,
      "val_max_prob": 0.6499998420476913,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012864777414975468,
      "epoch_time": 66.7085030078888,
      "val_boundary_f1": 0.31870229007633594,
      "val_boundary_precision": 0.2676282051282051,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.18828482512204675,
      "val_avg_segment_overlap": 0.6034640150549981,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.37687201284820926,
      "val_pk_metric": 0.29141661690557885
    },
    {
      "epoch": 12,
      "train_loss": 0.49145528823137286,
      "train_chorus_rate": 0.37486496940255165,
      "train_max_prob": 0.6698782473802567,
      "train_conf_over_90": 0.001784325612243265,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5086745545268059,
      "val_macro_f1": 0.667459009730702,
      "val_verse_f1": 0.7398144413069787,
      "val_chorus_f1": 0.5951035781544255,
      "val_chorus_rate": 0.4835885316133499,
      "val_max_prob": 0.6512056440114975,
      "val_conf_over_90": 0.0009643201483413577,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.468029813875382e-05,
      "epoch_time": 101.30495476722717,
      "val_boundary_f1": 0.25769230769230766,
      "val_boundary_precision": 0.21753246753246752,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.14050572121887073,
      "val_avg_segment_overlap": 0.5493781944236958,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.4568342076559684,
      "val_pk_metric": 0.3597310831061331
    },
    {
      "epoch": 13,
      "train_loss": 0.4842124775052071,
      "train_chorus_rate": 0.36399301141500473,
      "train_max_prob": 0.6613663107156753,
      "train_conf_over_90": 0.0020869369502179323,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5053387135267258,
      "val_macro_f1": 0.7108949875211491,
      "val_verse_f1": 0.8013468013468014,
      "val_chorus_f1": 0.6204431736954968,
      "val_chorus_rate": 0.3881165236234665,
      "val_max_prob": 0.6503059715032578,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.435373446184303e-05,
      "epoch_time": 53.31618785858154,
      "val_boundary_f1": 0.2935779816513761,
      "val_boundary_precision": 0.24024024024024024,
      "val_boundary_recall": 0.37735849056603776,
      "val_complete_segments": 0.17467918797452203,
      "val_avg_segment_overlap": 0.60564669874724,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.4208271526789892,
      "val_pk_metric": 0.3163423958802244
    },
    {
      "epoch": 14,
      "train_loss": 0.4759188130497932,
      "train_chorus_rate": 0.3480341978371143,
      "train_max_prob": 0.6632780432701111,
      "train_conf_over_90": 0.002092379386886023,
      "train_conf_over_95": 0.0,
      "val_loss": 0.504845529794693,
      "val_macro_f1": 0.7171773544230806,
      "val_verse_f1": 0.811706239646604,
      "val_chorus_f1": 0.6226484691995573,
      "val_chorus_rate": 0.36707568168640137,
      "val_max_prob": 0.6652831435203552,
      "val_conf_over_90": 0.001260946854017675,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.430547460025285e-06,
      "epoch_time": 123.50559902191162,
      "val_boundary_f1": 0.3006660323501427,
      "val_boundary_precision": 0.25199362041467305,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.19024869627997942,
      "val_avg_segment_overlap": 0.6035638322283337,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.39135450118204795,
      "val_pk_metric": 0.29378196682572705
    },
    {
      "epoch": 15,
      "train_loss": 0.47833708077669146,
      "train_chorus_rate": 0.36326789408922194,
      "train_max_prob": 0.6735704869031907,
      "train_conf_over_90": 0.0060671872895909475,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5037265941500664,
      "val_macro_f1": 0.7149324562745769,
      "val_verse_f1": 0.8072713782229642,
      "val_chorus_f1": 0.6225935343261896,
      "val_chorus_rate": 0.3773067370057106,
      "val_max_prob": 0.6690886616706848,
      "val_conf_over_90": 0.002757748414296657,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 71.07264018058777,
      "val_boundary_f1": 0.2981956315289649,
      "val_boundary_precision": 0.24960254372019078,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.18424965641296498,
      "val_avg_segment_overlap": 0.6020358706126853,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.40133858309030324,
      "val_pk_metric": 0.29938422150704214
    }
  ]
}