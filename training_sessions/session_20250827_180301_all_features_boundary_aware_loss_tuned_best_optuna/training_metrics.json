{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2693664447156089,
      "layer_dropout": 0.3,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.264388399111532,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009433388164864008,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.018209751373407586,
      "gradient_clip_norm": 0.36561638664216023,
      "max_epochs": 15,
      "patience": 8
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09236188707159641,
        "ece_after": 0.02613586300072829,
        "improvement": 0.06622602407086813,
        "params": {
          "temperature": 0.6041869166440234
        }
      },
      "platt": {
        "ece_before": 0.09236188707159641,
        "ece_after": 0.02867141380642627,
        "improvement": 0.06369047326517015,
        "params": {
          "A": 1.6225070441576832,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5712954670190811,
      "train_chorus_rate": 0.4944220499601215,
      "train_max_prob": 0.5906972080469132,
      "train_conf_over_90": 4.0650405571796e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.561947837471962,
      "val_macro_f1": 0.47759458972526625,
      "val_verse_f1": 0.45167958656330753,
      "val_chorus_f1": 0.503509592887225,
      "val_chorus_rate": 0.7501471042633057,
      "val_max_prob": 0.579824835062027,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009421910714888119,
      "epoch_time": 106.39840579032898,
      "val_boundary_f1": 0.054313099041533544,
      "val_boundary_precision": 0.08415841584158416,
      "val_boundary_recall": 0.04009433962264151,
      "val_complete_segments": 0.018136823386028053,
      "val_avg_segment_overlap": 0.23691456111466744,
      "val_verse_to_chorus_acc": 0.04424778761061947,
      "val_chorus_to_verse_acc": 0.020202020202020204,
      "val_window_diff": 0.44877890854525987,
      "val_pk_metric": 0.4511554940286757
    },
    {
      "epoch": 2,
      "train_loss": 0.5354575350880623,
      "train_chorus_rate": 0.5256291836500168,
      "train_max_prob": 0.6061097472906113,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5463615357875824,
      "val_macro_f1": 0.698490973980778,
      "val_verse_f1": 0.8148148148148148,
      "val_chorus_f1": 0.5821671331467412,
      "val_chorus_rate": 0.31559517979621887,
      "val_max_prob": 0.6183553040027618,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009387534281943029,
      "epoch_time": 109.1651201248169,
      "val_boundary_f1": 0.34920634920634924,
      "val_boundary_precision": 0.3013698630136986,
      "val_boundary_recall": 0.41509433962264153,
      "val_complete_segments": 0.22366744869395982,
      "val_avg_segment_overlap": 0.5585518597702437,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.36559873715383395,
      "val_pk_metric": 0.28052136455080073
    },
    {
      "epoch": 3,
      "train_loss": 0.5120940178632736,
      "train_chorus_rate": 0.44054590463638305,
      "train_max_prob": 0.6388382494449616,
      "train_conf_over_90": 0.001822108868509531,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5362496227025986,
      "val_macro_f1": 0.7304995004995005,
      "val_verse_f1": 0.827922077922078,
      "val_chorus_f1": 0.6330769230769231,
      "val_chorus_rate": 0.3400028422474861,
      "val_max_prob": 0.6852152645587921,
      "val_conf_over_90": 0.0022059514885768294,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009330426344554538,
      "epoch_time": 127.29616689682007,
      "val_boundary_f1": 0.3751127141568981,
      "val_boundary_precision": 0.30364963503649633,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2726487148411857,
      "val_avg_segment_overlap": 0.6231817657498462,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.41408793048602877,
      "val_pk_metric": 0.2981435404957101
    },
    {
      "epoch": 4,
      "train_loss": 0.4982531502842903,
      "train_chorus_rate": 0.43584829568862915,
      "train_max_prob": 0.659615358710289,
      "train_conf_over_90": 0.005557074307580479,
      "train_conf_over_95": 0.00031059009197633716,
      "val_loss": 0.5079497843980789,
      "val_macro_f1": 0.7404504141590467,
      "val_verse_f1": 0.8241411327762304,
      "val_chorus_f1": 0.656759695541863,
      "val_chorus_rate": 0.37861140072345734,
      "val_max_prob": 0.6567169427871704,
      "val_conf_over_90": 0.0029795129084959626,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009250865126853132,
      "epoch_time": 100.08467388153076,
      "val_boundary_f1": 0.3878326996197719,
      "val_boundary_precision": 0.3248407643312102,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2659640192381444,
      "val_avg_segment_overlap": 0.6362097039196404,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40365882397297537,
      "val_pk_metric": 0.2999370731190071
    },
    {
      "epoch": 5,
      "train_loss": 0.4873400926589966,
      "train_chorus_rate": 0.3935593873262405,
      "train_max_prob": 0.6675720453262329,
      "train_conf_over_90": 0.010997556991060264,
      "train_conf_over_95": 0.00015103444166015835,
      "val_loss": 0.5427867397665977,
      "val_macro_f1": 0.740641269253925,
      "val_verse_f1": 0.8579641528576258,
      "val_chorus_f1": 0.6233183856502242,
      "val_chorus_rate": 0.24940630048513412,
      "val_max_prob": 0.7127047032117844,
      "val_conf_over_90": 0.00265867353300564,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000914923824309399,
      "epoch_time": 105.62858700752258,
      "val_boundary_f1": 0.3739495798319328,
      "val_boundary_precision": 0.3371212121212121,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.24406629967340468,
      "val_avg_segment_overlap": 0.5989664968505944,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.3434343434343434,
      "val_window_diff": 0.3330403408684811,
      "val_pk_metric": 0.24734939164668202
    },
    {
      "epoch": 6,
      "train_loss": 0.4930602103471756,
      "train_chorus_rate": 0.37319671735167503,
      "train_max_prob": 0.665228009223938,
      "train_conf_over_90": 0.0020698070118669422,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5048682615160942,
      "val_macro_f1": 0.6769007711043841,
      "val_verse_f1": 0.7245880590627007,
      "val_chorus_f1": 0.6292134831460674,
      "val_chorus_rate": 0.5526105910539627,
      "val_max_prob": 0.650091290473938,
      "val_conf_over_90": 0.0029246043413877487,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009026040809239283,
      "epoch_time": 95.08901190757751,
      "val_boundary_f1": 0.32830188679245287,
      "val_boundary_precision": 0.27358490566037735,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.20909108434294013,
      "val_avg_segment_overlap": 0.5868454216546478,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4724459147078903,
      "val_pk_metric": 0.3514399414318143
    },
    {
      "epoch": 7,
      "train_loss": 0.48294941186904905,
      "train_chorus_rate": 0.4050129041075706,
      "train_max_prob": 0.6870682239532471,
      "train_conf_over_90": 0.01545408682723064,
      "train_conf_over_95": 0.00010429108515381813,
      "val_loss": 0.49730105698108673,
      "val_macro_f1": 0.7350253437178246,
      "val_verse_f1": 0.8025053826580544,
      "val_chorus_f1": 0.6675453047775948,
      "val_chorus_rate": 0.4466407224535942,
      "val_max_prob": 0.6406430751085281,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008881873030802992,
      "epoch_time": 100.71126580238342,
      "val_boundary_f1": 0.3695014662756599,
      "val_boundary_precision": 0.31552587646076796,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.2511096462315975,
      "val_avg_segment_overlap": 0.6396939343261179,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4204821226930289,
      "val_pk_metric": 0.307190133568587
    },
    {
      "epoch": 8,
      "train_loss": 0.4877387464046478,
      "train_chorus_rate": 0.3675573870539665,
      "train_max_prob": 0.6640023201704025,
      "train_conf_over_90": 0.00448715717648156,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4923947900533676,
      "val_macro_f1": 0.7545979704296626,
      "val_verse_f1": 0.831557300429987,
      "val_chorus_f1": 0.6776386404293381,
      "val_chorus_rate": 0.3872225135564804,
      "val_max_prob": 0.7043893933296204,
      "val_conf_over_90": 0.01776760700158775,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008717437278709961,
      "epoch_time": 98.95371699333191,
      "val_boundary_f1": 0.38936372269705605,
      "val_boundary_precision": 0.32591414944356123,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.29793639647828407,
      "val_avg_segment_overlap": 0.671516235261046,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.39887360761116786,
      "val_pk_metric": 0.29018578406137696
    },
    {
      "epoch": 9,
      "train_loss": 0.4717123121023178,
      "train_chorus_rate": 0.3754737302660942,
      "train_max_prob": 0.6874277144670486,
      "train_conf_over_90": 0.010792438569478691,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4920520484447479,
      "val_macro_f1": 0.7417323689319091,
      "val_verse_f1": 0.810548768663952,
      "val_chorus_f1": 0.6729159691998662,
      "val_chorus_rate": 0.4347226172685623,
      "val_max_prob": 0.6777227818965912,
      "val_conf_over_90": 0.00640280736843124,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008533534667415369,
      "epoch_time": 95.70790505409241,
      "val_boundary_f1": 0.41,
      "val_boundary_precision": 0.3559027777777778,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.29722385428907167,
      "val_avg_segment_overlap": 0.6411552716008154,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3965553187140757,
      "val_pk_metric": 0.29887867136533636
    },
    {
      "epoch": 10,
      "train_loss": 0.4758267909288406,
      "train_chorus_rate": 0.3533659495413303,
      "train_max_prob": 0.6876030087471008,
      "train_conf_over_90": 0.013931369400233961,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4954554960131645,
      "val_macro_f1": 0.7198438225631676,
      "val_verse_f1": 0.7801131770412287,
      "val_chorus_f1": 0.6595744680851063,
      "val_chorus_rate": 0.4854263961315155,
      "val_max_prob": 0.6967436522245407,
      "val_conf_over_90": 0.0035334217245690525,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000833106115195561,
      "epoch_time": 105.56438398361206,
      "val_boundary_f1": 0.3608445297504798,
      "val_boundary_precision": 0.3042071197411003,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.22257871793926937,
      "val_avg_segment_overlap": 0.627219410719775,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.42756597680917396,
      "val_pk_metric": 0.32041823046252554
    },
    {
      "epoch": 11,
      "train_loss": 0.4675948902964592,
      "train_chorus_rate": 0.3526520639657974,
      "train_max_prob": 0.6855789154767991,
      "train_conf_over_90": 0.014770666387630627,
      "train_conf_over_95": 0.00012562813935801387,
      "val_loss": 0.49802594631910324,
      "val_macro_f1": 0.7809774569808752,
      "val_verse_f1": 0.8701570680628272,
      "val_chorus_f1": 0.691797845898923,
      "val_chorus_rate": 0.2938936948776245,
      "val_max_prob": 0.7255170494318008,
      "val_conf_over_90": 0.05814454331994057,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008111003162945444,
      "epoch_time": 118.22047591209412,
      "val_boundary_f1": 0.48608137044967875,
      "val_boundary_precision": 0.44509803921568625,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.3587933373458294,
      "val_avg_segment_overlap": 0.6814559036321942,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.31640058410823413,
      "val_pk_metric": 0.22299614523302036
    },
    {
      "epoch": 12,
      "train_loss": 0.4594013303518295,
      "train_chorus_rate": 0.3647465847432613,
      "train_max_prob": 0.7055772304534912,
      "train_conf_over_90": 0.03560186592512764,
      "train_conf_over_95": 3.441156295593828e-05,
      "val_loss": 0.4902806803584099,
      "val_macro_f1": 0.746793193662681,
      "val_verse_f1": 0.8089134293038848,
      "val_chorus_f1": 0.6846729580214774,
      "val_chorus_rate": 0.4552112743258476,
      "val_max_prob": 0.7302922308444977,
      "val_conf_over_90": 0.1251822765916586,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007874432800787174,
      "epoch_time": 99.75764989852905,
      "val_boundary_f1": 0.4364364364364365,
      "val_boundary_precision": 0.3791304347826087,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.33058844141823995,
      "val_avg_segment_overlap": 0.6660007821840204,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.38775434630414884,
      "val_pk_metric": 0.2862703472624472
    },
    {
      "epoch": 13,
      "train_loss": 0.4689794838428497,
      "train_chorus_rate": 0.3439514458179474,
      "train_max_prob": 0.6912266552448273,
      "train_conf_over_90": 0.032131148898042736,
      "train_conf_over_95": 0.00026628723426256327,
      "val_loss": 0.4902629554271698,
      "val_macro_f1": 0.7796043299738709,
      "val_verse_f1": 0.8677192982456141,
      "val_chorus_f1": 0.6914893617021276,
      "val_chorus_rate": 0.30126694589853287,
      "val_max_prob": 0.683589294552803,
      "val_conf_over_90": 0.0031663223926443607,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007622502612505263,
      "epoch_time": 95.16312909126282,
      "val_boundary_f1": 0.4623773173391494,
      "val_boundary_precision": 0.4300202839756592,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.3482849991333554,
      "val_avg_segment_overlap": 0.6566395273571393,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.30866673184994525,
      "val_pk_metric": 0.21544615192878994
    },
    {
      "epoch": 14,
      "train_loss": 0.45645003467798234,
      "train_chorus_rate": 0.31538448184728624,
      "train_max_prob": 0.6945415258407592,
      "train_conf_over_90": 0.015462491050129756,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4882361516356468,
      "val_macro_f1": 0.7595722788236876,
      "val_verse_f1": 0.8238713427630304,
      "val_chorus_f1": 0.6952732148843447,
      "val_chorus_rate": 0.4328700080513954,
      "val_max_prob": 0.7362169921398163,
      "val_conf_over_90": 0.05789080914109945,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007356439976653091,
      "epoch_time": 113.65542197227478,
      "val_boundary_f1": 0.48520710059171596,
      "val_boundary_precision": 0.41694915254237286,
      "val_boundary_recall": 0.5801886792452831,
      "val_complete_segments": 0.386330456346363,
      "val_avg_segment_overlap": 0.6794951605548044,
      "val_verse_to_chorus_acc": 0.5619469026548672,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.378108077867707,
      "val_pk_metric": 0.2627809601420477
    },
    {
      "epoch": 15,
      "train_loss": 0.4500552177429199,
      "train_chorus_rate": 0.3167974442243576,
      "train_max_prob": 0.6989787071943283,
      "train_conf_over_90": 0.01679896767018363,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4890219196677208,
      "val_macro_f1": 0.7604953503381406,
      "val_verse_f1": 0.8325467245610723,
      "val_chorus_f1": 0.688443976115209,
      "val_chorus_rate": 0.39999549835920334,
      "val_max_prob": 0.7192317247390747,
      "val_conf_over_90": 0.07831299863755703,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007077541123648005,
      "epoch_time": 110.1649739742279,
      "val_boundary_f1": 0.4503582395087001,
      "val_boundary_precision": 0.39783001808318263,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.3216727672984301,
      "val_avg_segment_overlap": 0.6582876983897679,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.36549930683791665,
      "val_pk_metric": 0.26592814400137516
    }
  ]
}