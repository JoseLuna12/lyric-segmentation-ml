{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2693664447156089,
      "layer_dropout": 0.3,
      "attention_enabled": true,
      "attention_heads": 4,
      "attention_dropout": 0.264388399111532,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1252610,
      "lstm_params": 724992,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009433388164864008,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.018209751373407586,
      "gradient_clip_norm": 0.36561638664216023,
      "max_epochs": 15,
      "patience": 8
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.04796730402000758,
        "ece_after": 0.02751916838711041,
        "improvement": 0.02044813563289717,
        "params": {
          "temperature": 0.7653771036277025
        }
      },
      "platt": {
        "ece_before": 0.04796730402000758,
        "ece_after": 0.03223272080739964,
        "improvement": 0.01573458321260794,
        "params": {
          "A": 1.1157174723446335,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5160534620285034,
      "train_chorus_rate": 0.2680384825216606,
      "train_max_prob": 0.623162916302681,
      "train_conf_over_90": 0.00044715446420013906,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5040415078401566,
      "val_macro_f1": 0.5236447360170792,
      "val_verse_f1": 0.5555811277330265,
      "val_chorus_f1": 0.4917083443011318,
      "val_chorus_rate": 0.6332966536283493,
      "val_max_prob": 0.5335017591714859,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009421910714888119,
      "epoch_time": 98.6981348991394,
      "val_boundary_f1": 0.11011904761904763,
      "val_boundary_precision": 0.14919354838709678,
      "val_boundary_recall": 0.08726415094339622,
      "val_complete_segments": 0.029207422844750523,
      "val_avg_segment_overlap": 0.26501310239680975,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.04040404040404041,
      "val_window_diff": 0.4432837175023948,
      "val_pk_metric": 0.44615642675696204
    },
    {
      "epoch": 2,
      "train_loss": 0.4876860216259956,
      "train_chorus_rate": 0.2261321332771331,
      "train_max_prob": 0.6168310910463333,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49413592368364334,
      "val_macro_f1": 0.5575528196410712,
      "val_verse_f1": 0.5915621436716076,
      "val_chorus_f1": 0.5235434956105347,
      "val_chorus_rate": 0.6240147948265076,
      "val_max_prob": 0.6133017539978027,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009387534281943029,
      "epoch_time": 105.0034110546112,
      "val_boundary_f1": 0.12610340479192936,
      "val_boundary_precision": 0.13550135501355012,
      "val_boundary_recall": 0.1179245283018868,
      "val_complete_segments": 0.03701606090259325,
      "val_avg_segment_overlap": 0.32371095025949576,
      "val_verse_to_chorus_acc": 0.10619469026548672,
      "val_chorus_to_verse_acc": 0.09090909090909091,
      "val_window_diff": 0.46035824201337217,
      "val_pk_metric": 0.43496396425590056
    },
    {
      "epoch": 3,
      "train_loss": 0.4529530882835388,
      "train_chorus_rate": 0.2562911616172642,
      "train_max_prob": 0.659155136346817,
      "train_conf_over_90": 0.018024844815954566,
      "train_conf_over_95": 0.0008955263998359442,
      "val_loss": 0.45738304406404495,
      "val_macro_f1": 0.7095716660359452,
      "val_verse_f1": 0.8172697957721247,
      "val_chorus_f1": 0.6018735362997657,
      "val_chorus_rate": 0.33067529648542404,
      "val_max_prob": 0.6557592749595642,
      "val_conf_over_90": 0.016385227907449007,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009330426344554538,
      "epoch_time": 117.46307396888733,
      "val_boundary_f1": 0.3688212927756654,
      "val_boundary_precision": 0.3089171974522293,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.23888231512833846,
      "val_avg_segment_overlap": 0.5937585573951806,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.38739719400772854,
      "val_pk_metric": 0.28757886694056367
    },
    {
      "epoch": 4,
      "train_loss": 0.4399927005171776,
      "train_chorus_rate": 0.28793021515011785,
      "train_max_prob": 0.690499547123909,
      "train_conf_over_90": 0.016137603227980434,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4406385272741318,
      "val_macro_f1": 0.7407088341722963,
      "val_verse_f1": 0.846220980973992,
      "val_chorus_f1": 0.6351966873706005,
      "val_chorus_rate": 0.2946334034204483,
      "val_max_prob": 0.7070497572422028,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009250865126853132,
      "epoch_time": 90.61113405227661,
      "val_boundary_f1": 0.40634291377601583,
      "val_boundary_precision": 0.3504273504273504,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.28911450080591117,
      "val_avg_segment_overlap": 0.6256776535634628,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.37072759814219924,
      "val_pk_metric": 0.26466416683090205
    },
    {
      "epoch": 5,
      "train_loss": 0.4253570392727852,
      "train_chorus_rate": 0.3116044484078884,
      "train_max_prob": 0.6904655426740647,
      "train_conf_over_90": 0.003861021070042625,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4741407632827759,
      "val_macro_f1": 0.6890320990715573,
      "val_verse_f1": 0.8555893171277785,
      "val_chorus_f1": 0.5224748810153359,
      "val_chorus_rate": 0.16553329303860664,
      "val_max_prob": 0.7517630755901337,
      "val_conf_over_90": 0.0024074708635453135,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000914923824309399,
      "epoch_time": 94.7296371459961,
      "val_boundary_f1": 0.3279445727482679,
      "val_boundary_precision": 0.3212669683257919,
      "val_boundary_recall": 0.33490566037735847,
      "val_complete_segments": 0.18763721303488007,
      "val_avg_segment_overlap": 0.5088038834261397,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.3221579319456661,
      "val_pk_metric": 0.26205342392940434
    },
    {
      "epoch": 6,
      "train_loss": 0.4352568581700325,
      "train_chorus_rate": 0.29415836166590453,
      "train_max_prob": 0.7110220849514007,
      "train_conf_over_90": 0.00840783016756177,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42656370997428894,
      "val_macro_f1": 0.7500514606988831,
      "val_verse_f1": 0.8310146540530513,
      "val_chorus_f1": 0.6690882673447149,
      "val_chorus_rate": 0.37731461971998215,
      "val_max_prob": 0.6818983554840088,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009026040809239283,
      "epoch_time": 85.5361578464508,
      "val_boundary_f1": 0.3897131552917903,
      "val_boundary_precision": 0.33560477001703576,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2444518200218094,
      "val_avg_segment_overlap": 0.6376393715589376,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.3700163705709951,
      "val_pk_metric": 0.279575826921957
    },
    {
      "epoch": 7,
      "train_loss": 0.42099167257547376,
      "train_chorus_rate": 0.32918836995959283,
      "train_max_prob": 0.7148068308830261,
      "train_conf_over_90": 0.0064539608458289875,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42494672536849976,
      "val_macro_f1": 0.7643104930061988,
      "val_verse_f1": 0.8589451550727177,
      "val_chorus_f1": 0.6696758309396799,
      "val_chorus_rate": 0.30003491789102554,
      "val_max_prob": 0.7122552543878555,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008881873030802992,
      "epoch_time": 89.5511269569397,
      "val_boundary_f1": 0.43184079601990044,
      "val_boundary_precision": 0.37349397590361444,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3376855267629393,
      "val_avg_segment_overlap": 0.6509990306226409,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.35085478899633127,
      "val_pk_metric": 0.24990523628459443
    },
    {
      "epoch": 8,
      "train_loss": 0.4179202452301979,
      "train_chorus_rate": 0.2754188321530819,
      "train_max_prob": 0.7018315136432648,
      "train_conf_over_90": 0.002686903430731036,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42121851444244385,
      "val_macro_f1": 0.7738884486172966,
      "val_verse_f1": 0.8656768558951965,
      "val_chorus_f1": 0.6821000413393965,
      "val_chorus_rate": 0.29524026811122894,
      "val_max_prob": 0.7296176701784134,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008717437278709961,
      "epoch_time": 88.31944298744202,
      "val_boundary_f1": 0.4455852156057495,
      "val_boundary_precision": 0.39454545454545453,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3355843572704654,
      "val_avg_segment_overlap": 0.6695676597130013,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3442556601313956,
      "val_pk_metric": 0.23645138940354357
    },
    {
      "epoch": 9,
      "train_loss": 0.4094171762466431,
      "train_chorus_rate": 0.29664954394102094,
      "train_max_prob": 0.7264206200838089,
      "train_conf_over_90": 0.01187747000658419,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42538560926914215,
      "val_macro_f1": 0.7743170818921543,
      "val_verse_f1": 0.8777366116537555,
      "val_chorus_f1": 0.6708975521305531,
      "val_chorus_rate": 0.2428419105708599,
      "val_max_prob": 0.6885634958744049,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008533534667415369,
      "epoch_time": 87.32202911376953,
      "val_boundary_f1": 0.4529147982062781,
      "val_boundary_precision": 0.43162393162393164,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.310930008557262,
      "val_avg_segment_overlap": 0.6409209452506532,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.30850162810698734,
      "val_pk_metric": 0.21731769525867778
    },
    {
      "epoch": 10,
      "train_loss": 0.40687555223703387,
      "train_chorus_rate": 0.270036693662405,
      "train_max_prob": 0.729103547334671,
      "train_conf_over_90": 0.018459102720953524,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4251933619379997,
      "val_macro_f1": 0.7798099342733348,
      "val_verse_f1": 0.867626404494382,
      "val_chorus_f1": 0.6919934640522876,
      "val_chorus_rate": 0.3020124211907387,
      "val_max_prob": 0.776556059718132,
      "val_conf_over_90": 0.025743973441421986,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000833106115195561,
      "epoch_time": 93.10472297668457,
      "val_boundary_f1": 0.4527472527472528,
      "val_boundary_precision": 0.42386831275720166,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.3285897850585019,
      "val_avg_segment_overlap": 0.6619990654122341,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.31643541223678345,
      "val_pk_metric": 0.23200556740211412
    },
    {
      "epoch": 11,
      "train_loss": 0.39558503925800326,
      "train_chorus_rate": 0.26742552742362025,
      "train_max_prob": 0.7394292652606964,
      "train_conf_over_90": 0.006062203110195697,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4212530478835106,
      "val_macro_f1": 0.7770527901677757,
      "val_verse_f1": 0.8748933265062298,
      "val_chorus_f1": 0.6792122538293216,
      "val_chorus_rate": 0.2619961351156235,
      "val_max_prob": 0.7486867010593414,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008111003162945444,
      "epoch_time": 107.83797693252563,
      "val_boundary_f1": 0.44594594594594594,
      "val_boundary_precision": 0.4267241379310345,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.3187924024615435,
      "val_avg_segment_overlap": 0.6497699815234111,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.29824653367097076,
      "val_pk_metric": 0.21912560275569837
    },
    {
      "epoch": 12,
      "train_loss": 0.39785303324460985,
      "train_chorus_rate": 0.308904755115509,
      "train_max_prob": 0.7406787037849426,
      "train_conf_over_90": 0.004505565462750383,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4148459807038307,
      "val_macro_f1": 0.7708757213955503,
      "val_verse_f1": 0.8477381390216993,
      "val_chorus_f1": 0.6940133037694013,
      "val_chorus_rate": 0.36527783423662186,
      "val_max_prob": 0.7268530428409576,
      "val_conf_over_90": 0.001387604046612978,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007874432800787174,
      "epoch_time": 88.82548904418945,
      "val_boundary_f1": 0.4446680080482897,
      "val_boundary_precision": 0.387719298245614,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.32699312894169735,
      "val_avg_segment_overlap": 0.672588506160284,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.3767209076988757,
      "val_pk_metric": 0.2561580584700168
    },
    {
      "epoch": 13,
      "train_loss": 0.3973777934908867,
      "train_chorus_rate": 0.27732118517160415,
      "train_max_prob": 0.7346453875303268,
      "train_conf_over_90": 0.0015753017942188308,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42777343839406967,
      "val_macro_f1": 0.7733099564584898,
      "val_verse_f1": 0.8824796950107742,
      "val_chorus_f1": 0.6641402179062055,
      "val_chorus_rate": 0.2194560132920742,
      "val_max_prob": 0.75174480676651,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007622502612505263,
      "epoch_time": 88.08302521705627,
      "val_boundary_f1": 0.461340206185567,
      "val_boundary_precision": 0.5085227272727273,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.30991059230719886,
      "val_avg_segment_overlap": 0.6011501117887321,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.23808394962580065,
      "val_pk_metric": 0.2036605152616942
    },
    {
      "epoch": 14,
      "train_loss": 0.3845035806298256,
      "train_chorus_rate": 0.2504359923303127,
      "train_max_prob": 0.7453868597745895,
      "train_conf_over_90": 0.00460246175643988,
      "train_conf_over_95": 0.0,
      "val_loss": 0.42070433497428894,
      "val_macro_f1": 0.7827186255732592,
      "val_verse_f1": 0.8639857015192135,
      "val_chorus_f1": 0.7014515496273048,
      "val_chorus_rate": 0.32636650651693344,
      "val_max_prob": 0.7771242260932922,
      "val_conf_over_90": 0.008975642209406942,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007356439976653091,
      "epoch_time": 102.66693305969238,
      "val_boundary_f1": 0.4653679653679654,
      "val_boundary_precision": 0.43,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.3409719691665609,
      "val_avg_segment_overlap": 0.6698923092421666,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.3059978733511944,
      "val_pk_metric": 0.22843541827666927
    },
    {
      "epoch": 15,
      "train_loss": 0.37678530663251875,
      "train_chorus_rate": 0.2562672317028046,
      "train_max_prob": 0.7578863114118576,
      "train_conf_over_90": 0.0084696777863428,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4095858410000801,
      "val_macro_f1": 0.7785523566890397,
      "val_verse_f1": 0.8525676421866372,
      "val_chorus_f1": 0.7045370711914422,
      "val_chorus_rate": 0.36602669954299927,
      "val_max_prob": 0.7437202334403992,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007077541123648005,
      "epoch_time": 99.01683115959167,
      "val_boundary_f1": 0.45270988310308186,
      "val_boundary_precision": 0.4119922630560928,
      "val_boundary_recall": 0.5023584905660378,
      "val_complete_segments": 0.34338900330416766,
      "val_avg_segment_overlap": 0.6687270369718217,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3304331390833945,
      "val_pk_metric": 0.24333273351219542
    }
  ]
}