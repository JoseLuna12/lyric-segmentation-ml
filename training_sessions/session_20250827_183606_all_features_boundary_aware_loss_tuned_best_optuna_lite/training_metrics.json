{
  "metadata": {
    "model_info": {
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.16160864979184558,
      "layer_dropout": 0.3,
      "attention_enabled": true,
      "attention_heads": 8,
      "attention_dropout": 0.1801791433282895,
      "attention_dim": 256,
      "positional_encoding": true,
      "max_seq_length": 1000,
      "total_params": 1228034,
      "lstm_params": 700416,
      "attention_params": 526592,
      "classifier_params": 1026
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0009364363515835176,
      "scheduler": "cosine",
      "label_smoothing": 0.0,
      "weighted_sampling": true,
      "total_epochs": 15,
      "validation_strategy": "composite",
      "weight_decay": 0.018187351635761986,
      "gradient_clip_norm": 0.34503498859907583,
      "max_epochs": 15,
      "patience": 8
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.14471728527417121,
        "ece_after": 0.02009426815570688,
        "improvement": 0.12462301711846434,
        "params": {
          "temperature": 0.41567668975963307
        }
      },
      "platt": {
        "ece_before": 0.14471728527417121,
        "ece_after": 0.07907357473797319,
        "improvement": 0.06564371053619802,
        "params": {
          "A": 1.499999945048427,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5563412085175514,
      "train_chorus_rate": 0.5079426742624491,
      "train_max_prob": 0.584814390540123,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5935966670513153,
      "val_macro_f1": 0.42930810126717966,
      "val_verse_f1": 0.8210281054317752,
      "val_chorus_f1": 0.037588097102584185,
      "val_chorus_rate": 0.013994654756970704,
      "val_max_prob": 0.5988423824310303,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009352970136147222,
      "epoch_time": 66.31977319717407,
      "val_boundary_f1": 0.008620689655172414,
      "val_boundary_precision": 0.05,
      "val_boundary_recall": 0.0047169811320754715,
      "val_complete_segments": 0.0532656463462402,
      "val_avg_segment_overlap": 0.1707137165513971,
      "val_verse_to_chorus_acc": 0.004424778761061947,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.28973713046164334,
      "val_pk_metric": 0.2816820950740775
    },
    {
      "epoch": 2,
      "train_loss": 0.5412174448370933,
      "train_chorus_rate": 0.49588662418536844,
      "train_max_prob": 0.6006902992725373,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5746778696775436,
      "val_macro_f1": 0.6036261147966121,
      "val_verse_f1": 0.8200158856235108,
      "val_chorus_f1": 0.38723634396971335,
      "val_chorus_rate": 0.15480855107307434,
      "val_max_prob": 0.5832047164440155,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000931884550448394,
      "epoch_time": 61.769227027893066,
      "val_boundary_f1": 0.27923627684964203,
      "val_boundary_precision": 0.2826086956521739,
      "val_boundary_recall": 0.2759433962264151,
      "val_complete_segments": 0.14677845357855962,
      "val_avg_segment_overlap": 0.38939611926540874,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.20707070707070707,
      "val_window_diff": 0.3971441782452034,
      "val_pk_metric": 0.3149442723714214
    },
    {
      "epoch": 3,
      "train_loss": 0.520397900044918,
      "train_chorus_rate": 0.37977503687143327,
      "train_max_prob": 0.6170780122280121,
      "train_conf_over_90": 0.0010157780925510451,
      "train_conf_over_95": 0.0,
      "val_loss": 0.522772952914238,
      "val_macro_f1": 0.6868655000869575,
      "val_verse_f1": 0.7586895725129844,
      "val_chorus_f1": 0.6150414276609305,
      "val_chorus_rate": 0.47222737967967987,
      "val_max_prob": 0.6256670504808426,
      "val_conf_over_90": 0.0011759620974771678,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00092621558726206,
      "epoch_time": 53.91236972808838,
      "val_boundary_f1": 0.3070866141732283,
      "val_boundary_precision": 0.2635135135135135,
      "val_boundary_recall": 0.36792452830188677,
      "val_complete_segments": 0.1537023806111823,
      "val_avg_segment_overlap": 0.5591051702270491,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.40517815066749524,
      "val_pk_metric": 0.3068256418084264
    },
    {
      "epoch": 4,
      "train_loss": 0.4936794310808182,
      "train_chorus_rate": 0.4066280983388424,
      "train_max_prob": 0.6675625950098037,
      "train_conf_over_90": 0.02319103041663766,
      "train_conf_over_95": 0.0014081062632612883,
      "val_loss": 0.5312539488077164,
      "val_macro_f1": 0.6005624200643691,
      "val_verse_f1": 0.6238106289162219,
      "val_chorus_f1": 0.5773142112125164,
      "val_chorus_rate": 0.6421339958906174,
      "val_max_prob": 0.7085175514221191,
      "val_conf_over_90": 0.08235935773700476,
      "val_conf_over_95": 0.018636181019246578,
      "learning_rate": 0.0009183177426745216,
      "epoch_time": 54.79577922821045,
      "val_boundary_f1": 0.21298174442190673,
      "val_boundary_precision": 0.18683274021352314,
      "val_boundary_recall": 0.24764150943396226,
      "val_complete_segments": 0.1124368100110412,
      "val_avg_segment_overlap": 0.4899089665449971,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.2222222222222222,
      "val_window_diff": 0.5025853342310823,
      "val_pk_metric": 0.4017970643606533
    },
    {
      "epoch": 5,
      "train_loss": 0.5114345327019691,
      "train_chorus_rate": 0.42728569991886617,
      "train_max_prob": 0.6758564203977585,
      "train_conf_over_90": 0.023691990846418775,
      "train_conf_over_95": 0.0019699151569511743,
      "val_loss": 0.5257350355386734,
      "val_macro_f1": 0.741840669245388,
      "val_verse_f1": 0.8602693602693603,
      "val_chorus_f1": 0.6234119782214157,
      "val_chorus_rate": 0.24229376763105392,
      "val_max_prob": 0.6841547042131424,
      "val_conf_over_90": 0.0011913100606761873,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0009082294941907209,
      "epoch_time": 48.760685205459595,
      "val_boundary_f1": 0.39763779527559057,
      "val_boundary_precision": 0.34121621621621623,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.273454199541156,
      "val_avg_segment_overlap": 0.627590002781942,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3364861525223152,
      "val_pk_metric": 0.2520286310383351
    },
    {
      "epoch": 6,
      "train_loss": 0.4930383950471878,
      "train_chorus_rate": 0.32622692808508874,
      "train_max_prob": 0.6703013896942138,
      "train_conf_over_90": 0.01568802262772806,
      "train_conf_over_95": 0.0013892218674300238,
      "val_loss": 0.5183519944548607,
      "val_macro_f1": 0.704515102203223,
      "val_verse_f1": 0.7733067729083667,
      "val_chorus_f1": 0.6357234314980794,
      "val_chorus_rate": 0.46866244077682495,
      "val_max_prob": 0.7188512682914734,
      "val_conf_over_90": 0.08008473552763462,
      "val_conf_over_95": 0.01886808662675321,
      "learning_rate": 0.0008959999907432035,
      "epoch_time": 61.545721769332886,
      "val_boundary_f1": 0.31633714880332986,
      "val_boundary_precision": 0.28305400372439476,
      "val_boundary_recall": 0.3584905660377358,
      "val_complete_segments": 0.1771382748450617,
      "val_avg_segment_overlap": 0.5854080291476222,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.41547628557137617,
      "val_pk_metric": 0.33671984176360625
    },
    {
      "epoch": 7,
      "train_loss": 0.4899737015366554,
      "train_chorus_rate": 0.3550480280071497,
      "train_max_prob": 0.7028042763471604,
      "train_conf_over_90": 0.03368795085698366,
      "train_conf_over_95": 0.004910287543316372,
      "val_loss": 0.504493847489357,
      "val_macro_f1": 0.745270669880236,
      "val_verse_f1": 0.8355394378966456,
      "val_chorus_f1": 0.6550019018638265,
      "val_chorus_rate": 0.34686071425676346,
      "val_max_prob": 0.6488531231880188,
      "val_conf_over_90": 0.000693802023306489,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008816888132434607,
      "epoch_time": 58.913631200790405,
      "val_boundary_f1": 0.40074906367041196,
      "val_boundary_precision": 0.33229813664596275,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.30362097061460797,
      "val_avg_segment_overlap": 0.6531245162872452,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3827484570098535,
      "val_pk_metric": 0.26787065358810846
    },
    {
      "epoch": 8,
      "train_loss": 0.4706407621502876,
      "train_chorus_rate": 0.3622221015393734,
      "train_max_prob": 0.6772811383008956,
      "train_conf_over_90": 0.01927497732685879,
      "train_conf_over_95": 0.001251704918104224,
      "val_loss": 0.48916903883218765,
      "val_macro_f1": 0.764206038239741,
      "val_verse_f1": 0.8496755587599134,
      "val_chorus_f1": 0.6787365177195686,
      "val_chorus_rate": 0.3385917991399765,
      "val_max_prob": 0.6943401992321014,
      "val_conf_over_90": 0.01154723740182817,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008653656843097163,
      "epoch_time": 65.57463598251343,
      "val_boundary_f1": 0.42125984251968507,
      "val_boundary_precision": 0.3614864864864865,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.319362647756073,
      "val_avg_segment_overlap": 0.668511362503437,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3365072886426258,
      "val_pk_metric": 0.23991906259720297
    },
    {
      "epoch": 9,
      "train_loss": 0.4886967077851295,
      "train_chorus_rate": 0.36033537313342096,
      "train_max_prob": 0.6834753185510636,
      "train_conf_over_90": 0.01672980231815018,
      "train_conf_over_95": 0.00043314947979524734,
      "val_loss": 0.49965424835681915,
      "val_macro_f1": 0.7672929700473095,
      "val_verse_f1": 0.8572440665958201,
      "val_chorus_f1": 0.6773418734987989,
      "val_chorus_rate": 0.3142743408679962,
      "val_max_prob": 0.6464382261037827,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008471101285853408,
      "epoch_time": 50.40130805969238,
      "val_boundary_f1": 0.42937853107344626,
      "val_boundary_precision": 0.3573667711598746,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.3406031675517359,
      "val_avg_segment_overlap": 0.6842470925316686,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.33154374501827955,
      "val_pk_metric": 0.23420622710208328
    },
    {
      "epoch": 10,
      "train_loss": 0.473723004758358,
      "train_chorus_rate": 0.36981995925307276,
      "train_max_prob": 0.6898671209812164,
      "train_conf_over_90": 0.008335008405265399,
      "train_conf_over_95": 0.0,
      "val_loss": 0.482023149728775,
      "val_macro_f1": 0.7388721596193444,
      "val_verse_f1": 0.809284332688588,
      "val_chorus_f1": 0.6684599865501009,
      "val_chorus_rate": 0.4315098077058792,
      "val_max_prob": 0.7173686027526855,
      "val_conf_over_90": 0.05236851889640093,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008270110853027809,
      "epoch_time": 48.49297213554382,
      "val_boundary_f1": 0.4080076263107721,
      "val_boundary_precision": 0.3424,
      "val_boundary_recall": 0.5047169811320755,
      "val_complete_segments": 0.31223468393404763,
      "val_avg_segment_overlap": 0.6729050936403046,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4014626570398905,
      "val_pk_metric": 0.30735660735419085
    },
    {
      "epoch": 11,
      "train_loss": 0.46560750901699066,
      "train_chorus_rate": 0.3300324320793152,
      "train_max_prob": 0.7015601754188537,
      "train_conf_over_90": 0.013395504135405644,
      "train_conf_over_95": 5.157297709956765e-05,
      "val_loss": 0.48148149251937866,
      "val_macro_f1": 0.7513639998581835,
      "val_verse_f1": 0.8223156285823462,
      "val_chorus_f1": 0.6804123711340208,
      "val_chorus_rate": 0.4158501774072647,
      "val_max_prob": 0.6919403523206711,
      "val_conf_over_90": 0.0035628597252070904,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0008051664749805607,
      "epoch_time": 60.90720319747925,
      "val_boundary_f1": 0.3904761904761905,
      "val_boundary_precision": 0.3274760383386581,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.2791725694032163,
      "val_avg_segment_overlap": 0.6762598564746614,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.3756027399637723,
      "val_pk_metric": 0.2813963037074356
    },
    {
      "epoch": 12,
      "train_loss": 0.46667671352624895,
      "train_chorus_rate": 0.38243151679635046,
      "train_max_prob": 0.700975415110588,
      "train_conf_over_90": 0.013339310247101822,
      "train_conf_over_95": 0.0,
      "val_loss": 0.504652850329876,
      "val_macro_f1": 0.7604273313032901,
      "val_verse_f1": 0.8685056693179894,
      "val_chorus_f1": 0.6523489932885906,
      "val_chorus_rate": 0.25029782950878143,
      "val_max_prob": 0.7077518254518509,
      "val_conf_over_90": 0.004679945472162217,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007816827223643574,
      "epoch_time": 53.59113669395447,
      "val_boundary_f1": 0.4336569579288026,
      "val_boundary_precision": 0.3996023856858847,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.3072969253907748,
      "val_avg_segment_overlap": 0.6148823344729979,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.30058225420317575,
      "val_pk_metric": 0.22597321612210391
    },
    {
      "epoch": 13,
      "train_loss": 0.4698165953159332,
      "train_chorus_rate": 0.35297428667545316,
      "train_max_prob": 0.7067909836769104,
      "train_conf_over_90": 0.027638605152606032,
      "train_conf_over_95": 8.305647643283009e-05,
      "val_loss": 0.4835100620985031,
      "val_macro_f1": 0.7268455700525367,
      "val_verse_f1": 0.7882919005613472,
      "val_chorus_f1": 0.6653992395437263,
      "val_chorus_rate": 0.47527866065502167,
      "val_max_prob": 0.73131263256073,
      "val_conf_over_90": 0.08077304065227509,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007566742379363385,
      "epoch_time": 56.28232979774475,
      "val_boundary_f1": 0.3956262425447316,
      "val_boundary_precision": 0.34192439862542956,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.2772694486639343,
      "val_avg_segment_overlap": 0.6464871500210606,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.38645134809486614,
      "val_pk_metric": 0.29915043033731936
    },
    {
      "epoch": 14,
      "train_loss": 0.4509709194302559,
      "train_chorus_rate": 0.35655307322740554,
      "train_max_prob": 0.7107347071170806,
      "train_conf_over_90": 0.024166768370196223,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4681822955608368,
      "val_macro_f1": 0.7924940559211124,
      "val_verse_f1": 0.8690348044492286,
      "val_chorus_f1": 0.7159533073929961,
      "val_chorus_rate": 0.3327166363596916,
      "val_max_prob": 0.7125039249658585,
      "val_conf_over_90": 0.047608526423573494,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007302628605187935,
      "epoch_time": 50.86589980125427,
      "val_boundary_f1": 0.5019455252918289,
      "val_boundary_precision": 0.4271523178807947,
      "val_boundary_recall": 0.6084905660377359,
      "val_complete_segments": 0.4241145383377621,
      "val_avg_segment_overlap": 0.7206704948440273,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5606060606060606,
      "val_window_diff": 0.306810192907129,
      "val_pk_metric": 0.20970573921256777
    },
    {
      "epoch": 15,
      "train_loss": 0.44590231478214265,
      "train_chorus_rate": 0.31747027635574343,
      "train_max_prob": 0.7133578807115555,
      "train_conf_over_90": 0.045510335214203224,
      "train_conf_over_95": 0.000860787121928297,
      "val_loss": 0.4865206182003021,
      "val_macro_f1": 0.7894103825999319,
      "val_verse_f1": 0.8844136063631748,
      "val_chorus_f1": 0.6944071588366891,
      "val_chorus_rate": 0.24941806867718697,
      "val_max_prob": 0.6880740374326706,
      "val_conf_over_90": 0.0011563367443159223,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007025772636876382,
      "epoch_time": 57.63356304168701,
      "val_boundary_f1": 0.5339265850945495,
      "val_boundary_precision": 0.5052631578947369,
      "val_boundary_recall": 0.5660377358490566,
      "val_complete_segments": 0.40111759616001397,
      "val_avg_segment_overlap": 0.669757712059561,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.25520395680158364,
      "val_pk_metric": 0.1890872443814259
    }
  ]
}