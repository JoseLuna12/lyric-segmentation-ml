{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.33307814266019814,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 135682,
      "cnn_params": 65920,
      "attention_params": 66304
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00038340353418185813,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 6,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.12905173937557723,
        "ece_after": 0.01405011692719284,
        "improvement": 0.1150016224483844,
        "params": {
          "temperature": 0.3979282859190425
        }
      },
      "platt": {
        "ece_before": 0.12905173937557723,
        "ece_after": 0.03532699577524994,
        "improvement": 0.09372474360032729,
        "params": {
          "A": 2.039202811633149,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5801959484815598,
      "train_chorus_rate": 0.4793831924907863,
      "train_max_prob": 0.560065507888794,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.590275228023529,
      "val_macro_f1": 0.5316388120106199,
      "val_verse_f1": 0.5821325648414986,
      "val_chorus_f1": 0.4811450591797412,
      "val_chorus_rate": 0.5676145851612091,
      "val_max_prob": 0.5256690829992294,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.9391318557573337e-05,
      "epoch_time": 126.1688380241394,
      "val_boundary_f1": 0.15500289184499713,
      "val_boundary_precision": 0.10268199233716475,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.01883634922781944,
      "val_avg_segment_overlap": 0.36832792345999377,
      "val_verse_to_chorus_acc": 0.07079646017699115,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.6316005909762183,
      "val_pk_metric": 0.4860258764338333,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 9.715890988707542,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5660783387720585,
      "train_chorus_rate": 0.34510507993400097,
      "train_max_prob": 0.5563698150217533,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5825456231832504,
      "val_macro_f1": 0.6097629608442344,
      "val_verse_f1": 0.7562935190144617,
      "val_chorus_f1": 0.46323240267400706,
      "val_chorus_rate": 0.3116123154759407,
      "val_max_prob": 0.5469559580087662,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.1378138703706706e-05,
      "epoch_time": 107.0158121585846,
      "val_boundary_f1": 0.17743324720068906,
      "val_boundary_precision": 0.13975576662143827,
      "val_boundary_recall": 0.2429245283018868,
      "val_complete_segments": 0.055327520759076806,
      "val_avg_segment_overlap": 0.43813982558651265,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.5184764215679515,
      "val_pk_metric": 0.40566222308070177,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.2534063681960106,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5474247951060534,
      "train_chorus_rate": 0.3859101110137999,
      "train_max_prob": 0.5750572346150875,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5892573595046997,
      "val_macro_f1": 0.5889855358543192,
      "val_verse_f1": 0.8036780125826745,
      "val_chorus_f1": 0.374293059125964,
      "val_chorus_rate": 0.16884125769138336,
      "val_max_prob": 0.6103508472442627,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.076834333356034e-05,
      "epoch_time": 100.61667609214783,
      "val_boundary_f1": 0.21680876979293542,
      "val_boundary_precision": 0.22418136020151133,
      "val_boundary_recall": 0.2099056603773585,
      "val_complete_segments": 0.1358542807295527,
      "val_avg_segment_overlap": 0.38781669743200187,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.19696969696969696,
      "val_window_diff": 0.4058321660198375,
      "val_pk_metric": 0.31407037750107475,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.3115717321634293,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.549100860953331,
      "train_chorus_rate": 0.438002061098814,
      "train_max_prob": 0.5936255604028702,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5685839653015137,
      "val_macro_f1": 0.6411994741003716,
      "val_verse_f1": 0.7884380985547623,
      "val_chorus_f1": 0.4939608496459808,
      "val_chorus_rate": 0.28882337361574173,
      "val_max_prob": 0.602734237909317,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.670740724805122e-05,
      "epoch_time": 89.38006711006165,
      "val_boundary_f1": 0.2660377358490566,
      "val_boundary_precision": 0.22169811320754718,
      "val_boundary_recall": 0.33254716981132076,
      "val_complete_segments": 0.10598235921977464,
      "val_avg_segment_overlap": 0.4962932521153375,
      "val_verse_to_chorus_acc": 0.22566371681415928,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.48668240657749817,
      "val_pk_metric": 0.3448291724028948,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.337995760142803,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5307263769209385,
      "train_chorus_rate": 0.41678466461598873,
      "train_max_prob": 0.6063165403902531,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5433141142129898,
      "val_macro_f1": 0.6635368676123854,
      "val_verse_f1": 0.7379851196460888,
      "val_chorus_f1": 0.5890886155786819,
      "val_chorus_rate": 0.4814126417040825,
      "val_max_prob": 0.6178074330091476,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010805219739733885,
      "epoch_time": 94.51386976242065,
      "val_boundary_f1": 0.2546093064091308,
      "val_boundary_precision": 0.20279720279720279,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.1112429801891251,
      "val_avg_segment_overlap": 0.526163131011302,
      "val_verse_to_chorus_acc": 0.23008849557522124,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4834684501206027,
      "val_pk_metric": 0.3530505235427389,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.313742071390152,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.5135056264698505,
      "train_chorus_rate": 0.36516972444951534,
      "train_max_prob": 0.6371319964528084,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5410135239362717,
      "val_macro_f1": 0.7059762911242438,
      "val_verse_f1": 0.8158741508759385,
      "val_chorus_f1": 0.596078431372549,
      "val_chorus_rate": 0.32401346415281296,
      "val_max_prob": 0.6174627393484116,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001434213506883645,
      "epoch_time": 122.3201150894165,
      "val_boundary_f1": 0.35004397537379073,
      "val_boundary_precision": 0.2791023842917251,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.22680054239266528,
      "val_avg_segment_overlap": 0.5950839141078306,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.45003776536545975,
      "val_pk_metric": 0.3247327092307917,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.832546070218086,
      "cnn_effective_layers": 1
    }
  ]
}