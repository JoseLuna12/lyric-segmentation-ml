{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.3143491041062528,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 168576,
      "cnn_params": 97278,
      "attention_params": 66304
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0001964313365651723,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 10,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0773740272625022,
        "ece_after": 0.014677086050946036,
        "improvement": 0.06269694121155617,
        "params": {
          "temperature": 0.6005157860609981
        }
      },
      "platt": {
        "ece_before": 0.0773740272625022,
        "ece_after": 0.017927913701487403,
        "improvement": 0.0594461135610148,
        "params": {
          "A": 1.6292585764714638,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5860920064151287,
      "train_chorus_rate": 0.4567264672368765,
      "train_max_prob": 0.5505722127854824,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5858024805784225,
      "val_macro_f1": 0.6516739855030171,
      "val_verse_f1": 0.7684384771013427,
      "val_chorus_f1": 0.5349094939046917,
      "val_chorus_rate": 0.3647765591740608,
      "val_max_prob": 0.5277895927429199,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.779959173491953e-06,
      "epoch_time": 89.60774493217468,
      "val_boundary_f1": 0.2707182320441989,
      "val_boundary_precision": 0.19140625,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.12524098974642353,
      "val_avg_segment_overlap": 0.5245708634170202,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.5823494691373869,
      "val_pk_metric": 0.3649705859050262,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 10.434489443898201,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5824422799050808,
      "train_chorus_rate": 0.3909567967057228,
      "train_max_prob": 0.5592828392982483,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.572888046503067,
      "val_macro_f1": 0.6555834905541439,
      "val_verse_f1": 0.7365281368065222,
      "val_chorus_f1": 0.5746388443017656,
      "val_chorus_rate": 0.4678885415196419,
      "val_max_prob": 0.5424245744943619,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1530016860970051e-05,
      "epoch_time": 77.72918033599854,
      "val_boundary_f1": 0.2789943227899432,
      "val_boundary_precision": 0.2126081582200247,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.13089734143795664,
      "val_avg_segment_overlap": 0.5218167405654681,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.5235393154010272,
      "val_pk_metric": 0.3967750421636874,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3.4868790805339813,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5549788288772106,
      "train_chorus_rate": 0.41980475187301636,
      "train_max_prob": 0.5731704905629158,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5579792410135269,
      "val_macro_f1": 0.6868549127855448,
      "val_verse_f1": 0.7921337989340195,
      "val_chorus_f1": 0.58157602663707,
      "val_chorus_rate": 0.3637112155556679,
      "val_max_prob": 0.5741761028766632,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.605360165384475e-05,
      "epoch_time": 137.63865303993225,
      "val_boundary_f1": 0.3345388788426763,
      "val_boundary_precision": 0.27126099706744866,
      "val_boundary_recall": 0.4363207547169811,
      "val_complete_segments": 0.2001504267206975,
      "val_avg_segment_overlap": 0.5723884684299787,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4808062210004528,
      "val_pk_metric": 0.3101819415376111,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.508466474711895,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.5373165383934975,
      "train_chorus_rate": 0.31896366737782955,
      "train_max_prob": 0.612098753452301,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5455921590328217,
      "val_macro_f1": 0.6762340103008555,
      "val_verse_f1": 0.7728390391526386,
      "val_chorus_f1": 0.5796289814490724,
      "val_chorus_rate": 0.4040074944496155,
      "val_max_prob": 0.6069818586111069,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.226217672980432e-05,
      "epoch_time": 75.32544779777527,
      "val_boundary_f1": 0.30517711171662126,
      "val_boundary_precision": 0.2481536189069424,
      "val_boundary_recall": 0.39622641509433965,
      "val_complete_segments": 0.12962024927856572,
      "val_avg_segment_overlap": 0.5357600235409007,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4802890727178696,
      "val_pk_metric": 0.3207458693639933,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.364871770143509,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.526785708963871,
      "train_chorus_rate": 0.36768843699246645,
      "train_max_prob": 0.6423072665929794,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5361091867089272,
      "val_macro_f1": 0.6848637093142012,
      "val_verse_f1": 0.7829181494661921,
      "val_chorus_f1": 0.5868092691622103,
      "val_chorus_rate": 0.3943052440881729,
      "val_max_prob": 0.6532475799322128,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.0034226182001125e-05,
      "epoch_time": 94.8316798210144,
      "val_boundary_f1": 0.31164069660861593,
      "val_boundary_precision": 0.25487256371814093,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.13793209308037085,
      "val_avg_segment_overlap": 0.5518855102745145,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4771174254577347,
      "val_pk_metric": 0.2999722288669119,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.7197002321481705,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.5205654315650463,
      "train_chorus_rate": 0.396757610142231,
      "train_max_prob": 0.6610147282481194,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.525041326880455,
      "val_macro_f1": 0.7043577757666198,
      "val_verse_f1": 0.7882150373062942,
      "val_chorus_f1": 0.6205005142269455,
      "val_chorus_rate": 0.42739761620759964,
      "val_max_prob": 0.660404846072197,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.92176333611727e-05,
      "epoch_time": 80.53339695930481,
      "val_boundary_f1": 0.3342415985467757,
      "val_boundary_precision": 0.2717872968980798,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.1619236200650826,
      "val_avg_segment_overlap": 0.5722221528094489,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4748626089295056,
      "val_pk_metric": 0.33396522355854025,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3.338824175298214,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.5039667133241892,
      "train_chorus_rate": 0.38171385787427425,
      "train_max_prob": 0.6750513166189194,
      "train_conf_over_90": 0.00036917358011123724,
      "train_conf_over_95": 0.0,
      "val_loss": 0.514788419008255,
      "val_macro_f1": 0.725688622754491,
      "val_verse_f1": 0.811377245508982,
      "val_chorus_f1": 0.64,
      "val_chorus_rate": 0.3997539132833481,
      "val_max_prob": 0.6839015483856201,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.9632658143751874e-05,
      "epoch_time": 87.60750842094421,
      "val_boundary_f1": 0.3533507397737163,
      "val_boundary_precision": 0.28,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.19259225148891754,
      "val_avg_segment_overlap": 0.6009709473455336,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.482332949860857,
      "val_pk_metric": 0.3208297816534903,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.8889688327908516,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.5051055736839771,
      "train_chorus_rate": 0.3917266968637705,
      "train_max_prob": 0.6863348744809628,
      "train_conf_over_90": 0.002519460209441604,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5029060170054436,
      "val_macro_f1": 0.7386386392565478,
      "val_verse_f1": 0.8176503865736375,
      "val_chorus_f1": 0.659626891939458,
      "val_chorus_rate": 0.41640686243772507,
      "val_max_prob": 0.6900889873504639,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.107545485407035e-05,
      "epoch_time": 84.80698204040527,
      "val_boundary_f1": 0.3762200532386868,
      "val_boundary_precision": 0.3015647226173542,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.21491066494750416,
      "val_avg_segment_overlap": 0.6206618798912524,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.47653474884748515,
      "val_pk_metric": 0.3319715587422031,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 4.247420929372311,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.4964905008673668,
      "train_chorus_rate": 0.4134515393525362,
      "train_max_prob": 0.6878405027091503,
      "train_conf_over_90": 0.003960022451792611,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5032915845513344,
      "val_macro_f1": 0.6785385027755115,
      "val_verse_f1": 0.7263787943565625,
      "val_chorus_f1": 0.6306982111944605,
      "val_chorus_rate": 0.5760693252086639,
      "val_max_prob": 0.6813207119703293,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.332206198693307e-05,
      "epoch_time": 84.3909740447998,
      "val_boundary_f1": 0.28169014084507044,
      "val_boundary_precision": 0.23400936037441497,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.1188447841837048,
      "val_avg_segment_overlap": 0.5434426852101295,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.49383125349593465,
      "val_pk_metric": 0.36636678012747603,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 4.046286955475807,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.4800486546009779,
      "train_chorus_rate": 0.4016667902469635,
      "train_max_prob": 0.7041920907795429,
      "train_conf_over_90": 0.007463259855285287,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4839719384908676,
      "val_macro_f1": 0.7563442249634718,
      "val_verse_f1": 0.8273107645492582,
      "val_chorus_f1": 0.6853776853776854,
      "val_chorus_rate": 0.4151460528373718,
      "val_max_prob": 0.6941526085138321,
      "val_conf_over_90": 0.009398446884006262,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.613278564263666e-05,
      "epoch_time": 108.12746596336365,
      "val_boundary_f1": 0.3982222222222222,
      "val_boundary_precision": 0.3195435092724679,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.23024498065942162,
      "val_avg_segment_overlap": 0.6354668957935496,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.5036935310422362,
      "val_pk_metric": 0.3294034364539724,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3.5319902449846268,
      "cnn_effective_layers": 1
    }
  ]
}