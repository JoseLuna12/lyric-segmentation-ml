{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.3842810256530799,
      "layer_dropout": 0.17675161631734992,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 136834,
      "cnn_params": 131840,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007771901374109088,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08004158470333207,
        "ece_after": 0.016799796277507113,
        "improvement": 0.06324178842582495,
        "params": {
          "temperature": 0.6100556433539771
        }
      },
      "platt": {
        "ece_before": 0.08004158470333207,
        "ece_after": 0.022717171851801738,
        "improvement": 0.05732441285153034,
        "params": {
          "A": 1.5062458230097469,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5663107832272848,
      "train_chorus_rate": 0.20681173540651798,
      "train_max_prob": 0.5408650835355123,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5963066816329956,
      "val_macro_f1": 0.5765525963123794,
      "val_verse_f1": 0.8009630818619583,
      "val_chorus_f1": 0.35214211076280044,
      "val_chorus_rate": 0.1722821705043316,
      "val_max_prob": 0.5486801117658615,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.570605533590387e-05,
      "epoch_time": 173.91194319725037,
      "val_boundary_f1": 0.15566037735849056,
      "val_boundary_precision": 0.15566037735849056,
      "val_boundary_recall": 0.15566037735849056,
      "val_complete_segments": 0.043841086928537276,
      "val_avg_segment_overlap": 0.3300330435630571,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.40248733244312007,
      "val_pk_metric": 0.3596808639649544,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 5.970657524135378,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5596368941995833,
      "train_chorus_rate": 0.4164878659778171,
      "train_max_prob": 0.5524242089854347,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5718444436788559,
      "val_macro_f1": 0.6569524641390716,
      "val_verse_f1": 0.772284506524536,
      "val_chorus_f1": 0.5416204217536071,
      "val_chorus_rate": 0.3661889061331749,
      "val_max_prob": 0.5811116844415665,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.9447050175117956e-05,
      "epoch_time": 125.3263168334961,
      "val_boundary_f1": 0.266137040714995,
      "val_boundary_precision": 0.22984562607204118,
      "val_boundary_recall": 0.3160377358490566,
      "val_complete_segments": 0.11401095111993821,
      "val_avg_segment_overlap": 0.5080795779897678,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.4303264916899531,
      "val_pk_metric": 0.3614563950402676,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.353759980863995,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.523332354095247,
      "train_chorus_rate": 0.34739964703718823,
      "train_max_prob": 0.596699164973365,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5531313717365265,
      "val_macro_f1": 0.6761408953018033,
      "val_verse_f1": 0.7845446182152713,
      "val_chorus_f1": 0.5677371723883352,
      "val_chorus_rate": 0.36725300550460815,
      "val_max_prob": 0.6307357251644135,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.197035744445357e-05,
      "epoch_time": 120.71799087524414,
      "val_boundary_f1": 0.2732673267326733,
      "val_boundary_precision": 0.2354948805460751,
      "val_boundary_recall": 0.32547169811320753,
      "val_complete_segments": 0.14739077614108645,
      "val_avg_segment_overlap": 0.5486959603520529,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4117152297492459,
      "val_pk_metric": 0.33070617581085376,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.7484860486454434,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5180820491578844,
      "train_chorus_rate": 0.38733650081687504,
      "train_max_prob": 0.6334322988986969,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5415690541267395,
      "val_macro_f1": 0.682250652466587,
      "val_verse_f1": 0.7836932241250931,
      "val_chorus_f1": 0.5808080808080808,
      "val_chorus_rate": 0.3808581531047821,
      "val_max_prob": 0.6488323211669922,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010271829097938047,
      "epoch_time": 136.20096683502197,
      "val_boundary_f1": 0.277992277992278,
      "val_boundary_precision": 0.23529411764705882,
      "val_boundary_recall": 0.33962264150943394,
      "val_complete_segments": 0.12561117317665232,
      "val_avg_segment_overlap": 0.5605436482844104,
      "val_verse_to_chorus_acc": 0.21238938053097345,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4098890194065209,
      "val_pk_metric": 0.33460259423876615,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.566359712017907,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5113953600327173,
      "train_chorus_rate": 0.4211561481157939,
      "train_max_prob": 0.6463642054133945,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5223733931779861,
      "val_macro_f1": 0.6829743450003805,
      "val_verse_f1": 0.7507082152974505,
      "val_chorus_f1": 0.6152404747033103,
      "val_chorus_rate": 0.4869846701622009,
      "val_max_prob": 0.6704664826393127,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001409295195546374,
      "epoch_time": 124.39188718795776,
      "val_boundary_f1": 0.25190839694656486,
      "val_boundary_precision": 0.21153846153846154,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.11133575388944059,
      "val_avg_segment_overlap": 0.5610283956273315,
      "val_verse_to_chorus_acc": 0.18141592920353983,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4290255232775107,
      "val_pk_metric": 0.34165226681730554,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.8178354038132563,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.5024023354053497,
      "train_chorus_rate": 0.41477706531683606,
      "train_max_prob": 0.669484429889255,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5110170692205429,
      "val_macro_f1": 0.7173481288832315,
      "val_verse_f1": 0.800227876946449,
      "val_chorus_f1": 0.6344683808200139,
      "val_chorus_rate": 0.40804123878479004,
      "val_max_prob": 0.6901199966669083,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018565791775217231,
      "epoch_time": 120.13083910942078,
      "val_boundary_f1": 0.3628158844765343,
      "val_boundary_precision": 0.29385964912280704,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2647571168487256,
      "val_avg_segment_overlap": 0.631913824581205,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.40570375122105473,
      "val_pk_metric": 0.2910704554944953,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.009607507122888,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.489160998000039,
      "train_chorus_rate": 0.42979206144809723,
      "train_max_prob": 0.6788472500112321,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49570197612047195,
      "val_macro_f1": 0.7037501614989106,
      "val_verse_f1": 0.7618069815195071,
      "val_chorus_f1": 0.6456933414783139,
      "val_chorus_rate": 0.5031985342502594,
      "val_max_prob": 0.6705872714519501,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002357959924077685,
      "epoch_time": 130.3519048690796,
      "val_boundary_f1": 0.37068239258635216,
      "val_boundary_precision": 0.28833551769331583,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.2768147849314061,
      "val_avg_segment_overlap": 0.6298515534635397,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.5707070707070707,
      "val_window_diff": 0.4330990498107024,
      "val_pk_metric": 0.3002402688093994,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.763790918721093,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.48257142305374146,
      "train_chorus_rate": 0.37174154983626473,
      "train_max_prob": 0.6848993466960059,
      "train_conf_over_90": 0.00010879389204395314,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4908219575881958,
      "val_macro_f1": 0.691777969831026,
      "val_verse_f1": 0.7425679949399114,
      "val_chorus_f1": 0.6409879447221405,
      "val_chorus_rate": 0.5336611717939377,
      "val_max_prob": 0.7018182426691055,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00029010230458809225,
      "epoch_time": 119.4687716960907,
      "val_boundary_f1": 0.3493212669683257,
      "val_boundary_precision": 0.2834067547723935,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2571935686306962,
      "val_avg_segment_overlap": 0.6139847854005167,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4153853659244926,
      "val_pk_metric": 0.3070999000522173,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.542027281390296,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4924696849452125,
      "train_chorus_rate": 0.382938409017192,
      "train_max_prob": 0.6771856447060903,
      "train_conf_over_90": 0.0007834753519596739,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5076045095920563,
      "val_macro_f1": 0.648443337363118,
      "val_verse_f1": 0.6826320501342884,
      "val_chorus_f1": 0.6142546245919477,
      "val_chorus_rate": 0.601902186870575,
      "val_max_prob": 0.6994654834270477,
      "val_conf_over_90": 0.0020541808917187154,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034723220811896325,
      "epoch_time": 118.45428776741028,
      "val_boundary_f1": 0.3145009416195857,
      "val_boundary_precision": 0.2617554858934169,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.18343643109345692,
      "val_avg_segment_overlap": 0.575085000633527,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.42566766647299004,
      "val_pk_metric": 0.32397646921605705,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.323179145654042,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.4861886650323868,
      "train_chorus_rate": 0.3945423968964153,
      "train_max_prob": 0.692577729622523,
      "train_conf_over_90": 0.0018714278283166802,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5001740083098412,
      "val_macro_f1": 0.6719174445500568,
      "val_verse_f1": 0.7109940750493747,
      "val_chorus_f1": 0.6328408140507388,
      "val_chorus_rate": 0.5804305821657181,
      "val_max_prob": 0.6876115947961807,
      "val_conf_over_90": 0.00022686025477014482,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004057711435664982,
      "epoch_time": 125.17251682281494,
      "val_boundary_f1": 0.3553875236294896,
      "val_boundary_precision": 0.29652996845425866,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.23654965013424545,
      "val_avg_segment_overlap": 0.5870094526095291,
      "val_verse_to_chorus_acc": 0.41150442477876104,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39075457397311864,
      "val_pk_metric": 0.296802797533601,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.2726095649931164,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4823063462972641,
      "train_chorus_rate": 0.4307040257586373,
      "train_max_prob": 0.6997233033180237,
      "train_conf_over_90": 0.003214139019190851,
      "train_conf_over_95": 0.0,
      "val_loss": 0.479211263358593,
      "val_macro_f1": 0.7277570173436787,
      "val_verse_f1": 0.790335463258786,
      "val_chorus_f1": 0.6651785714285715,
      "val_chorus_rate": 0.46971139311790466,
      "val_max_prob": 0.7070504426956177,
      "val_conf_over_90": 0.0004338138969615102,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00046426966329873935,
      "epoch_time": 128.32419610023499,
      "val_boundary_f1": 0.44241316270566733,
      "val_boundary_precision": 0.3611940298507463,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.34816561844863736,
      "val_avg_segment_overlap": 0.6641717892513008,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.37922649308484996,
      "val_pk_metric": 0.27395927417573823,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.2214643359184265,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.48656566275490654,
      "train_chorus_rate": 0.40352807690699893,
      "train_max_prob": 0.6908770634068383,
      "train_conf_over_90": 0.002023906133318734,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48035789281129837,
      "val_macro_f1": 0.7686588152265008,
      "val_verse_f1": 0.8568888888888889,
      "val_chorus_f1": 0.6804287415641128,
      "val_chorus_rate": 0.3197407051920891,
      "val_max_prob": 0.7237945348024368,
      "val_conf_over_90": 0.003162532637361437,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005212793203931269,
      "epoch_time": 109.46513295173645,
      "val_boundary_f1": 0.4519966015293118,
      "val_boundary_precision": 0.35325365205843295,
      "val_boundary_recall": 0.6273584905660378,
      "val_complete_segments": 0.3982212475633528,
      "val_avg_segment_overlap": 0.7207962787706099,
      "val_verse_to_chorus_acc": 0.6283185840707964,
      "val_chorus_to_verse_acc": 0.5707070707070707,
      "val_window_diff": 0.4029465001336482,
      "val_pk_metric": 0.27680716976855274,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.679787506659826,
      "cnn_effective_layers": 2
    }
  ]
}