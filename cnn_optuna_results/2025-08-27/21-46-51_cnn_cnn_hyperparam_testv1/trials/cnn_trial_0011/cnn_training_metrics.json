{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.2571040329333564,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 70914,
      "cnn_params": 65920,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0003537855468923014,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09240374507744793,
        "ece_after": 0.03043185793639165,
        "improvement": 0.06197188714105628,
        "params": {
          "temperature": 0.5950673647331057
        }
      },
      "platt": {
        "ece_before": 0.09240374507744793,
        "ece_after": 0.031180650259282117,
        "improvement": 0.06122309481816582,
        "params": {
          "A": 1.637816383303685,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5629579644454153,
      "train_chorus_rate": 0.2061280584649036,
      "train_max_prob": 0.5404794153414274,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5797087997198105,
      "val_macro_f1": 0.6257447183541913,
      "val_verse_f1": 0.8066225165562914,
      "val_chorus_f1": 0.4448669201520913,
      "val_chorus_rate": 0.2184743508696556,
      "val_max_prob": 0.5249180197715759,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.649332345141026e-05,
      "epoch_time": 334.9937300682068,
      "val_boundary_f1": 0.2696817420435511,
      "val_boundary_precision": 0.20909090909090908,
      "val_boundary_recall": 0.37971698113207547,
      "val_complete_segments": 0.1423312746151092,
      "val_avg_segment_overlap": 0.45579513022979146,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.43625626180893295,
      "val_pk_metric": 0.32313877349099807,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 5.076060659007022,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5504280171896282,
      "train_chorus_rate": 0.37989179868447154,
      "train_max_prob": 0.534515402818981,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5663524717092514,
      "val_macro_f1": 0.6596249825171343,
      "val_verse_f1": 0.7770677378126711,
      "val_chorus_f1": 0.5421822272215974,
      "val_chorus_rate": 0.35625964403152466,
      "val_max_prob": 0.5447886735200882,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.3454435105179326e-05,
      "epoch_time": 236.7407727241516,
      "val_boundary_f1": 0.3009900990099009,
      "val_boundary_precision": 0.2593856655290102,
      "val_boundary_recall": 0.3584905660377358,
      "val_complete_segments": 0.14337894248608535,
      "val_avg_segment_overlap": 0.5039366770018354,
      "val_verse_to_chorus_acc": 0.26991150442477874,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4188778058022688,
      "val_pk_metric": 0.32945168250044155,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.6776614879306995,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5291471010760257,
      "train_chorus_rate": 0.3634275268567236,
      "train_max_prob": 0.5677751679169504,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5455421954393387,
      "val_macro_f1": 0.6401094121050801,
      "val_verse_f1": 0.713819812474521,
      "val_chorus_f1": 0.5663990117356392,
      "val_chorus_rate": 0.49683183431625366,
      "val_max_prob": 0.5817072838544846,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.48427591883541e-05,
      "epoch_time": 150.35669016838074,
      "val_boundary_f1": 0.19484240687679083,
      "val_boundary_precision": 0.1637239165329053,
      "val_boundary_recall": 0.24056603773584906,
      "val_complete_segments": 0.06806932102984735,
      "val_avg_segment_overlap": 0.4737518652978112,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.4651230191930834,
      "val_pk_metric": 0.37646956831302925,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.5880225426272343,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.5009271910316065,
      "train_chorus_rate": 0.31138628407528524,
      "train_max_prob": 0.6168908414087797,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5339429080486298,
      "val_macro_f1": 0.6529698608995484,
      "val_verse_f1": 0.733506079330277,
      "val_chorus_f1": 0.5724336424688199,
      "val_chorus_rate": 0.4695003479719162,
      "val_max_prob": 0.6152828484773636,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.034418905321342e-05,
      "epoch_time": 161.21241807937622,
      "val_boundary_f1": 0.19723502304147467,
      "val_boundary_precision": 0.16187594553706505,
      "val_boundary_recall": 0.25235849056603776,
      "val_complete_segments": 0.07067486085343228,
      "val_avg_segment_overlap": 0.5114099318811933,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.3282828282828283,
      "val_window_diff": 0.4499601826960882,
      "val_pk_metric": 0.371441801940949,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.411900884226749,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5054011721360055,
      "train_chorus_rate": 0.4340038032908189,
      "train_max_prob": 0.6402451019538077,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5251438021659851,
      "val_macro_f1": 0.6740020768593278,
      "val_verse_f1": 0.7591041869522882,
      "val_chorus_f1": 0.5888999667663675,
      "val_chorus_rate": 0.44002199172973633,
      "val_max_prob": 0.6464596837759018,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.953117257407348e-05,
      "epoch_time": 178.36974596977234,
      "val_boundary_f1": 0.2514506769825918,
      "val_boundary_precision": 0.21311475409836064,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.11291764313380855,
      "val_avg_segment_overlap": 0.5416721990337677,
      "val_verse_to_chorus_acc": 0.1902654867256637,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.41415045217260277,
      "val_pk_metric": 0.3439418582171143,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.6212894163633647,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.4925654608952372,
      "train_chorus_rate": 0.38671609288767766,
      "train_max_prob": 0.6477896571159363,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5132874324917793,
      "val_macro_f1": 0.6771014405882236,
      "val_verse_f1": 0.7367330016583749,
      "val_chorus_f1": 0.6174698795180724,
      "val_chorus_rate": 0.5168790966272354,
      "val_max_prob": 0.6423758566379547,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.187450466073804e-05,
      "epoch_time": 203.195739030838,
      "val_boundary_f1": 0.2395644283121597,
      "val_boundary_precision": 0.19469026548672566,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.08175389773134134,
      "val_avg_segment_overlap": 0.5369686384104693,
      "val_verse_to_chorus_acc": 0.1504424778761062,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4537320952491656,
      "val_pk_metric": 0.3518901746181351,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.1999098313482186,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.474914119431847,
      "train_chorus_rate": 0.39780915410895096,
      "train_max_prob": 0.670485982769414,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5035856664180756,
      "val_macro_f1": 0.6984534525330175,
      "val_verse_f1": 0.7622136630853436,
      "val_chorus_f1": 0.6346932419806913,
      "val_chorus_rate": 0.4889741688966751,
      "val_max_prob": 0.6552744507789612,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011675792350950297,
      "epoch_time": 197.77507877349854,
      "val_boundary_f1": 0.3113879003558719,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.41273584905660377,
      "val_complete_segments": 0.18819044364157145,
      "val_avg_segment_overlap": 0.5849491704095566,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.4318758482747421,
      "val_pk_metric": 0.32599979561954057,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.1894057989120483,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.4838527393968482,
      "train_chorus_rate": 0.4079642774243104,
      "train_max_prob": 0.677533673612695,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4964744374155998,
      "val_macro_f1": 0.6981316300790623,
      "val_verse_f1": 0.7572895277207392,
      "val_chorus_f1": 0.6389737324373854,
      "val_chorus_rate": 0.5044030994176865,
      "val_max_prob": 0.6744373440742493,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014349510800574727,
      "epoch_time": 342.91071105003357,
      "val_boundary_f1": 0.3231046931407942,
      "val_boundary_precision": 0.26169590643274854,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.18757018357582267,
      "val_avg_segment_overlap": 0.5778172626655476,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.42228953117196383,
      "val_pk_metric": 0.3103088563695752,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.985539750048989,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.4857354462146759,
      "train_chorus_rate": 0.4281133813293357,
      "train_max_prob": 0.6704364607208654,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49482061713933945,
      "val_macro_f1": 0.7072669131728233,
      "val_verse_f1": 0.7647783251231528,
      "val_chorus_f1": 0.6497555012224939,
      "val_chorus_rate": 0.5043415650725365,
      "val_max_prob": 0.6654663234949112,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017134860746486792,
      "epoch_time": 308.3523907661438,
      "val_boundary_f1": 0.3636363636363636,
      "val_boundary_precision": 0.28888888888888886,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.25854530807538323,
      "val_avg_segment_overlap": 0.5986245893562816,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4219202515010597,
      "val_pk_metric": 0.301985153126201,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.389727874806053,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.4746144115924835,
      "train_chorus_rate": 0.40295823781113876,
      "train_max_prob": 0.6893237609612314,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49484532326459885,
      "val_macro_f1": 0.7000963694194366,
      "val_verse_f1": 0.7551867219917012,
      "val_chorus_f1": 0.6450060168471721,
      "val_chorus_rate": 0.5167752653360367,
      "val_max_prob": 0.7010440826416016,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001995501816015944,
      "epoch_time": 197.04406595230103,
      "val_boundary_f1": 0.37249283667621774,
      "val_boundary_precision": 0.3130016051364366,
      "val_boundary_recall": 0.45990566037735847,
      "val_complete_segments": 0.27151950493115906,
      "val_avg_segment_overlap": 0.5817441175315999,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.3949637845367768,
      "val_pk_metric": 0.2920098598523189,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.4187979823664616,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 11,
      "train_loss": 0.4820653482487327,
      "train_chorus_rate": 0.39305068474066884,
      "train_max_prob": 0.6822457313537598,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49556921422481537,
      "val_macro_f1": 0.726445294700989,
      "val_verse_f1": 0.7924826904055391,
      "val_chorus_f1": 0.6604078989964389,
      "val_chorus_rate": 0.4591972306370735,
      "val_max_prob": 0.6516669392585754,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002273219897215583,
      "epoch_time": 145.49925804138184,
      "val_boundary_f1": 0.4199288256227758,
      "val_boundary_precision": 0.33714285714285713,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.34147788301923643,
      "val_avg_segment_overlap": 0.6244097929358549,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.5505050505050505,
      "val_window_diff": 0.3831487291418152,
      "val_pk_metric": 0.2786188966424492,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.1231958364185535,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 12,
      "train_loss": 0.4795646636109603,
      "train_chorus_rate": 0.4163147916919307,
      "train_max_prob": 0.6855053117400721,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5151231586933136,
      "val_macro_f1": 0.6033157740029085,
      "val_verse_f1": 0.6212406015037594,
      "val_chorus_f1": 0.5853909465020577,
      "val_chorus_rate": 0.6561176031827927,
      "val_max_prob": 0.6630957275629044,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025389804470619785,
      "epoch_time": 259.89069390296936,
      "val_boundary_f1": 0.25768087215064417,
      "val_boundary_precision": 0.2222222222222222,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.14001765778081568,
      "val_avg_segment_overlap": 0.4533101146563668,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4250179214387838,
      "val_pk_metric": 0.3486287256920381,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.965207940653751,
      "cnn_effective_layers": 1
    }
  ]
}