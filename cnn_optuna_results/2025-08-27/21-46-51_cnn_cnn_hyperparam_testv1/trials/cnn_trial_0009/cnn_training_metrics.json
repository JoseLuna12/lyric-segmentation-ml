{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.2983530767462085,
      "layer_dropout": 0.22148116687819522,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 8,
      "total_params": 275711,
      "cnn_params": 194556,
      "attention_params": 74625
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00013796609641485185,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.03781896153344153,
        "ece_after": 0.02221974273795932,
        "improvement": 0.015599218795482213,
        "params": {
          "temperature": 0.7942793715751919
        }
      },
      "platt": {
        "ece_before": 0.03781896153344153,
        "ece_after": 0.021561749645441136,
        "improvement": 0.016257211888000396,
        "params": {
          "A": 1.1243732822466952,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5689402893185616,
      "train_chorus_rate": 0.5033074794337153,
      "train_max_prob": 0.5928510203957558,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5807331800460815,
      "val_macro_f1": 0.6494482909469002,
      "val_verse_f1": 0.7376888365705316,
      "val_chorus_f1": 0.5612077453232688,
      "val_chorus_rate": 0.4496592879295349,
      "val_max_prob": 0.6314174234867096,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013646957750245713,
      "epoch_time": 159.74599289894104,
      "val_boundary_f1": 0.2780082987551867,
      "val_boundary_precision": 0.19667318982387474,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.19441526610644255,
      "val_avg_segment_overlap": 0.5367907243745467,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.5145381012669744,
      "val_pk_metric": 0.37444058076090714,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2683.715069591999,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5619655698537827,
      "train_chorus_rate": 0.39192936569452286,
      "train_max_prob": 0.6224223598837852,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5671302676200867,
      "val_macro_f1": 0.6027554748090409,
      "val_verse_f1": 0.6464601769911504,
      "val_chorus_f1": 0.5590507726269315,
      "val_chorus_rate": 0.5919469892978668,
      "val_max_prob": 0.6324232816696167,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001320454258228391,
      "epoch_time": 122.25625109672546,
      "val_boundary_f1": 0.2197802197802198,
      "val_boundary_precision": 0.1712779973649539,
      "val_boundary_recall": 0.30660377358490565,
      "val_complete_segments": 0.09289653361344538,
      "val_avg_segment_overlap": 0.4883652523932862,
      "val_verse_to_chorus_acc": 0.22566371681415928,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.5110035452602821,
      "val_pk_metric": 0.4011564071658411,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3478.4712528437376,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5376526191830635,
      "train_chorus_rate": 0.5468772538006306,
      "train_max_prob": 0.6245015636086464,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5631891191005707,
      "val_macro_f1": 0.6780914288845143,
      "val_verse_f1": 0.7664739884393064,
      "val_chorus_f1": 0.5897088693297224,
      "val_chorus_rate": 0.42563100159168243,
      "val_max_prob": 0.661956250667572,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012488699803383225,
      "epoch_time": 134.94234490394592,
      "val_boundary_f1": 0.2508532423208191,
      "val_boundary_precision": 0.196524064171123,
      "val_boundary_recall": 0.3466981132075472,
      "val_complete_segments": 0.13913690476190477,
      "val_avg_segment_overlap": 0.5747887157517343,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.4923584553314615,
      "val_pk_metric": 0.3568907307367337,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 4805.313105553389,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5482857450842857,
      "train_chorus_rate": 0.4872303865849972,
      "train_max_prob": 0.6471069008111954,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5531857013702393,
      "val_macro_f1": 0.6405637292276778,
      "val_verse_f1": 0.6997047659215521,
      "val_chorus_f1": 0.5814226925338035,
      "val_chorus_rate": 0.5377266705036163,
      "val_max_prob": 0.6797172129154205,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011530715177976372,
      "epoch_time": 109.8711531162262,
      "val_boundary_f1": 0.253781512605042,
      "val_boundary_precision": 0.19712793733681463,
      "val_boundary_recall": 0.3561320754716981,
      "val_complete_segments": 0.12412464985994398,
      "val_avg_segment_overlap": 0.535723838448824,
      "val_verse_to_chorus_acc": 0.252212389380531,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.4980299285492056,
      "val_pk_metric": 0.37449700464488883,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1793326362967491,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5296552702784538,
      "train_chorus_rate": 0.41067617386579514,
      "train_max_prob": 0.6528567299246788,
      "train_conf_over_90": 6.506199497380294e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5464956760406494,
      "val_macro_f1": 0.7146458821871116,
      "val_verse_f1": 0.803223388305847,
      "val_chorus_f1": 0.6260683760683761,
      "val_chorus_rate": 0.38755418360233307,
      "val_max_prob": 0.6776877343654633,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010372457231113887,
      "epoch_time": 123.11830401420593,
      "val_boundary_f1": 0.3005008347245409,
      "val_boundary_precision": 0.23255813953488372,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.20903361344537816,
      "val_avg_segment_overlap": 0.6148005393904626,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.49391992763332115,
      "val_pk_metric": 0.33422558454488216,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.0716517716646194,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.530182309448719,
      "train_chorus_rate": 0.4539559595286846,
      "train_max_prob": 0.6481795236468315,
      "train_conf_over_90": 0.0004048095906910021,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5382998883724213,
      "val_macro_f1": 0.6768116514410881,
      "val_verse_f1": 0.7469733656174334,
      "val_chorus_f1": 0.6066499372647428,
      "val_chorus_rate": 0.4835698902606964,
      "val_max_prob": 0.6975490152835846,
      "val_conf_over_90": 0.0018068498466163874,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.064547393011931e-05,
      "epoch_time": 116.61977887153625,
      "val_boundary_f1": 0.2951653944020356,
      "val_boundary_precision": 0.2304635761589404,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.17397584033613445,
      "val_avg_segment_overlap": 0.5857004049291648,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.47191409343703183,
      "val_pk_metric": 0.35512804471128834,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 348.1406740248203,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.5197423212230206,
      "train_chorus_rate": 0.4077267162501812,
      "train_max_prob": 0.6697379350662231,
      "train_conf_over_90": 0.0007043869591143448,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5343059301376343,
      "val_macro_f1": 0.7134380247493974,
      "val_verse_f1": 0.7947197245073655,
      "val_chorus_f1": 0.6321563249914295,
      "val_chorus_rate": 0.41541336476802826,
      "val_max_prob": 0.7004701495170593,
      "val_conf_over_90": 0.001617742469534278,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.664147599643278e-05,
      "epoch_time": 111.8602831363678,
      "val_boundary_f1": 0.3284356093344858,
      "val_boundary_precision": 0.2592087312414734,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.23266806722689076,
      "val_avg_segment_overlap": 0.6224373572710462,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.47167679875070406,
      "val_pk_metric": 0.3234690208209121,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.433496966958046,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.5181320048868656,
      "train_chorus_rate": 0.42498045042157173,
      "train_max_prob": 0.6617260500788689,
      "train_conf_over_90": 0.0010127062669198494,
      "train_conf_over_95": 3.415300670894794e-05,
      "val_loss": 0.5285204350948334,
      "val_macro_f1": 0.6839561379817423,
      "val_verse_f1": 0.7455815865187013,
      "val_chorus_f1": 0.6223306894447833,
      "val_chorus_rate": 0.5059036612510681,
      "val_max_prob": 0.6896372735500336,
      "val_conf_over_90": 0.0042090966599062085,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.232462041841907e-05,
      "epoch_time": 114.13030576705933,
      "val_boundary_f1": 0.2998236331569665,
      "val_boundary_precision": 0.23943661971830985,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.1829919467787115,
      "val_avg_segment_overlap": 0.593202966706674,
      "val_verse_to_chorus_acc": 0.2920353982300885,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4751350757061979,
      "val_pk_metric": 0.34674306744911765,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 14.467234201729298,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.5141007229685783,
      "train_chorus_rate": 0.4482196047902107,
      "train_max_prob": 0.6647949889302254,
      "train_conf_over_90": 0.001396010622556787,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5248106420040131,
      "val_macro_f1": 0.7146538726574685,
      "val_verse_f1": 0.7894941634241246,
      "val_chorus_f1": 0.6398135818908123,
      "val_chorus_rate": 0.4370187520980835,
      "val_max_prob": 0.7117407619953156,
      "val_conf_over_90": 0.007528805872425437,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.8320622484732534e-05,
      "epoch_time": 123.42395520210266,
      "val_boundary_f1": 0.34086956521739126,
      "val_boundary_precision": 0.2699724517906336,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.22443977591036413,
      "val_avg_segment_overlap": 0.6186716549586927,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.46086240361558034,
      "val_pk_metric": 0.322969967403405,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.144496113061905,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.5113180689513683,
      "train_chorus_rate": 0.4137929491698742,
      "train_max_prob": 0.6762673109769821,
      "train_conf_over_90": 0.0019227464363211766,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5218206346035004,
      "val_macro_f1": 0.7027547450667221,
      "val_verse_f1": 0.7696933253156946,
      "val_chorus_f1": 0.6358161648177496,
      "val_chorus_rate": 0.4737866371870041,
      "val_max_prob": 0.7106935083866119,
      "val_conf_over_90": 0.01540775178000331,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.524152410371297e-05,
      "epoch_time": 120.58697319030762,
      "val_boundary_f1": 0.31853785900783294,
      "val_boundary_precision": 0.2524137931034483,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.2036064425770308,
      "val_avg_segment_overlap": 0.6127231109640313,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4726072619324343,
      "val_pk_metric": 0.3422167857178039,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 269.9519412368536,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.5088510103523731,
      "train_chorus_rate": 0.4136187508702278,
      "train_max_prob": 0.6736716255545616,
      "train_conf_over_90": 0.0024712146987440065,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5184784829616547,
      "val_macro_f1": 0.7208482021572824,
      "val_verse_f1": 0.7966003476917133,
      "val_chorus_f1": 0.6450960566228514,
      "val_chorus_rate": 0.42744526267051697,
      "val_max_prob": 0.7102212905883789,
      "val_conf_over_90": 0.012655364815145731,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.3658944635088114e-05,
      "epoch_time": 116.68945002555847,
      "val_boundary_f1": 0.32871972318339104,
      "val_boundary_precision": 0.25956284153005466,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.21161589635854341,
      "val_avg_segment_overlap": 0.6273799087963067,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.47409808617309396,
      "val_pk_metric": 0.31648820366738595,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.0014441385865211,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.49926259741187096,
      "train_chorus_rate": 0.40945643559098244,
      "train_max_prob": 0.6796086132526398,
      "train_conf_over_90": 0.0023753297427902,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5159485638141632,
      "val_macro_f1": 0.72249417293753,
      "val_verse_f1": 0.7930291756412766,
      "val_chorus_f1": 0.6519591702337834,
      "val_chorus_rate": 0.4442255049943924,
      "val_max_prob": 0.710701197385788,
      "val_conf_over_90": 0.012844472657889128,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.4079098381019574e-05,
      "epoch_time": 110.55685210227966,
      "val_boundary_f1": 0.319721980886186,
      "val_boundary_precision": 0.2530949105914718,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.20200892857142855,
      "val_avg_segment_overlap": 0.6260993617109809,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.46686393528357883,
      "val_pk_metric": 0.323368232940877,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.146379679441452,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.5059648342430592,
      "train_chorus_rate": 0.399698119610548,
      "train_max_prob": 0.6777192652225494,
      "train_conf_over_90": 0.0027140272868564352,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5152336657047272,
      "val_macro_f1": 0.7273083347284895,
      "val_verse_f1": 0.7997671711292199,
      "val_chorus_f1": 0.6548494983277592,
      "val_chorus_rate": 0.433566078543663,
      "val_max_prob": 0.7109720706939697,
      "val_conf_over_90": 0.01195508474484086,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.920670592012702e-06,
      "epoch_time": 123.38979816436768,
      "val_boundary_f1": 0.3324584426946632,
      "val_boundary_precision": 0.26425591098748263,
      "val_boundary_recall": 0.4481132075471698,
      "val_complete_segments": 0.22724089635854341,
      "val_avg_segment_overlap": 0.6381225427617447,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.45963857199871017,
      "val_pk_metric": 0.3147937376220694,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2549.653025060892,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.5074228309094906,
      "train_chorus_rate": 0.39823422208428383,
      "train_max_prob": 0.6799217313528061,
      "train_conf_over_90": 0.0021110313973622397,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5150871276855469,
      "val_macro_f1": 0.7216662458753811,
      "val_verse_f1": 0.7920015683199373,
      "val_chorus_f1": 0.6513309234308249,
      "val_chorus_rate": 0.44680942595005035,
      "val_max_prob": 0.7123201489448547,
      "val_conf_over_90": 0.013761934358626604,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.4965189123947035e-06,
      "epoch_time": 113.80029201507568,
      "val_boundary_f1": 0.329246935201401,
      "val_boundary_precision": 0.2618384401114206,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21962535014005602,
      "val_avg_segment_overlap": 0.6288184224079655,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4622100990203608,
      "val_pk_metric": 0.3217943944731767,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.2805665284395218,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.4969453997910023,
      "train_chorus_rate": 0.4008980505168438,
      "train_max_prob": 0.6823384687304497,
      "train_conf_over_90": 0.0029225294128991663,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5150306969881058,
      "val_macro_f1": 0.7191665584045858,
      "val_verse_f1": 0.7879266127441309,
      "val_chorus_f1": 0.6504065040650406,
      "val_chorus_rate": 0.4547932595014572,
      "val_max_prob": 0.7122558355331421,
      "val_conf_over_90": 0.013761934358626604,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 129.33558917045593,
      "val_boundary_f1": 0.32635253054101226,
      "val_boundary_precision": 0.2590027700831025,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.20621060924369747,
      "val_avg_segment_overlap": 0.6266936625851582,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.46254217950939824,
      "val_pk_metric": 0.32285366902255747,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1849.8549392223358,
      "cnn_effective_layers": 2
    }
  ]
}