{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.3490296065076597,
      "layer_dropout": 0.14199008454189144,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 135298,
      "cnn_params": 131840,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0007169033074379604,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "boundary_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05055987836394185,
        "ece_after": 0.011199254359618152,
        "improvement": 0.0393606240043237,
        "params": {
          "temperature": 0.7682789586153351
        }
      },
      "platt": {
        "ece_before": 0.05055987836394185,
        "ece_after": 0.03284111706821762,
        "improvement": 0.01771876129572423,
        "params": {
          "A": 1.1130225143399033,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5369764531359953,
      "train_chorus_rate": 0.4383822642540669,
      "train_max_prob": 0.6430959561291862,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5183219835162163,
      "val_macro_f1": 0.6936001676331067,
      "val_verse_f1": 0.74822842851188,
      "val_chorus_f1": 0.6389719067543335,
      "val_chorus_rate": 0.5203693807125092,
      "val_max_prob": 0.7039184868335724,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006896558602185136,
      "epoch_time": 40.50462627410889,
      "val_boundary_f1": 0.34522661523625847,
      "val_boundary_precision": 0.29200652528548127,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.21802260084529804,
      "val_avg_segment_overlap": 0.609884419887736,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.46132137877166446,
      "val_pk_metric": 0.35381825733389033,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.942934560425141,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5080949015477124,
      "train_chorus_rate": 0.4110666653689216,
      "train_max_prob": 0.6720170974731445,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5011486038565636,
      "val_macro_f1": 0.7531571393783645,
      "val_verse_f1": 0.8178988326848249,
      "val_chorus_f1": 0.6884154460719041,
      "val_chorus_rate": 0.4326772689819336,
      "val_max_prob": 0.7238887399435043,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006120616954006099,
      "epoch_time": 29.494248867034912,
      "val_boundary_f1": 0.42181818181818176,
      "val_boundary_precision": 0.3431952662721893,
      "val_boundary_recall": 0.5471698113207547,
      "val_complete_segments": 0.3249512477469078,
      "val_avg_segment_overlap": 0.6962057243655723,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.42261690636819327,
      "val_pk_metric": 0.3094679305203235,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.6190316764747396,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4904775426668279,
      "train_chorus_rate": 0.3904871484812568,
      "train_max_prob": 0.6968386173248291,
      "train_conf_over_90": 0.0015218991234980743,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5007170364260674,
      "val_macro_f1": 0.7487670968175555,
      "val_verse_f1": 0.8203363914373089,
      "val_chorus_f1": 0.6771978021978021,
      "val_chorus_rate": 0.4093092381954193,
      "val_max_prob": 0.7172375470399857,
      "val_conf_over_90": 0.00035688793286681175,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004959338211849196,
      "epoch_time": 24.03880286216736,
      "val_boundary_f1": 0.3919781221513217,
      "val_boundary_precision": 0.31946508172362553,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2591557119771272,
      "val_avg_segment_overlap": 0.684680998697843,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.4416363048196678,
      "val_pk_metric": 0.3010562121292558,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.7881670103353613,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.49125969760558186,
      "train_chorus_rate": 0.37774114573703094,
      "train_max_prob": 0.6928532789735233,
      "train_conf_over_90": 0.002190174166839022,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49238699674606323,
      "val_macro_f1": 0.7514420067183887,
      "val_verse_f1": 0.8187089292616931,
      "val_chorus_f1": 0.6841750841750841,
      "val_chorus_rate": 0.42840462923049927,
      "val_max_prob": 0.720372200012207,
      "val_conf_over_90": 0.003930665785446763,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003589516537189802,
      "epoch_time": 27.150105237960815,
      "val_boundary_f1": 0.3841911764705882,
      "val_boundary_precision": 0.3147590361445783,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.26171025234632356,
      "val_avg_segment_overlap": 0.6800203475660981,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4246097846624233,
      "val_pk_metric": 0.304215220723245,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.6273796453195459,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48136768446249123,
      "train_chorus_rate": 0.381633402670131,
      "train_max_prob": 0.6997096889159259,
      "train_conf_over_90": 0.005765544651213157,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49284428358078003,
      "val_macro_f1": 0.74731590508341,
      "val_verse_f1": 0.810300766660114,
      "val_chorus_f1": 0.6843310435067059,
      "val_chorus_rate": 0.4477696046233177,
      "val_max_prob": 0.7322299182415009,
      "val_conf_over_90": 0.012199711694847792,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002219694862530408,
      "epoch_time": 27.78021502494812,
      "val_boundary_f1": 0.400360685302074,
      "val_boundary_precision": 0.32408759124087594,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.29010523494312884,
      "val_avg_segment_overlap": 0.6815085517035058,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.43896487054332745,
      "val_pk_metric": 0.30588615172600797,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.835066416684319,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.46795450063312755,
      "train_chorus_rate": 0.34515657845665426,
      "train_max_prob": 0.7104148268699646,
      "train_conf_over_90": 0.005654936967938042,
      "train_conf_over_95": 0.0,
      "val_loss": 0.496782585978508,
      "val_macro_f1": 0.7246149459963003,
      "val_verse_f1": 0.7829787234042553,
      "val_chorus_f1": 0.6662511685883453,
      "val_chorus_rate": 0.4851732477545738,
      "val_max_prob": 0.7091446220874786,
      "val_conf_over_90": 0.01326077722478658,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010584161203735044,
      "epoch_time": 27.035095930099487,
      "val_boundary_f1": 0.35197066911090746,
      "val_boundary_precision": 0.28785607196401797,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.21658081608552426,
      "val_avg_segment_overlap": 0.6476018826089075,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.44574568201673836,
      "val_pk_metric": 0.33350882163844314,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8059512271600611,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.4750728922731736,
      "train_chorus_rate": 0.3685708834844477,
      "train_max_prob": 0.6956890996764687,
      "train_conf_over_90": 0.0063389465315541365,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48913324624300003,
      "val_macro_f1": 0.7673226992517855,
      "val_verse_f1": 0.8355488036460311,
      "val_chorus_f1": 0.6990965948575399,
      "val_chorus_rate": 0.4070058688521385,
      "val_max_prob": 0.7085687965154648,
      "val_conf_over_90": 0.0060407103155739605,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.8247447219446777e-05,
      "epoch_time": 32.27996587753296,
      "val_boundary_f1": 0.4175627240143369,
      "val_boundary_precision": 0.33670520231213874,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.29601940766983653,
      "val_avg_segment_overlap": 0.6964985364564232,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4237295496569485,
      "val_pk_metric": 0.2966132020400672,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.7439365246716667,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.48011509460561413,
      "train_chorus_rate": 0.3692694166127373,
      "train_max_prob": 0.6991943366387311,
      "train_conf_over_90": 0.005834389717646819,
      "train_conf_over_95": 0.0,
      "val_loss": 0.488152913749218,
      "val_macro_f1": 0.759734662791967,
      "val_verse_f1": 0.8241673121611153,
      "val_chorus_f1": 0.6953020134228187,
      "val_chorus_rate": 0.4306730180978775,
      "val_max_prob": 0.7134467661380768,
      "val_conf_over_90": 0.010748064029030502,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 22.143909215927124,
      "val_boundary_f1": 0.4010791366906475,
      "val_boundary_precision": 0.3241279069767442,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.2810990816707067,
      "val_avg_segment_overlap": 0.6860373844716139,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4409408621419212,
      "val_pk_metric": 0.3094993435324839,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8196518561419319,
      "cnn_effective_layers": 2
    }
  ]
}