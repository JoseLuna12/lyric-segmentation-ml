{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.2981170097457604,
      "layer_dropout": 0.12797777655997813,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 198014,
      "cnn_params": 194556,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00021931399753552855,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06384541174810385,
        "ece_after": 0.018996676550867026,
        "improvement": 0.044848735197236825,
        "params": {
          "temperature": 0.6972821838909142
        }
      },
      "platt": {
        "ece_before": 0.06384541174810385,
        "ece_after": 0.024658210634131327,
        "improvement": 0.03918720111397252,
        "params": {
          "A": 1.3800403525992044,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5165372658520937,
      "train_chorus_rate": 0.4388900510966778,
      "train_max_prob": 0.6445513777434826,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48542338609695435,
      "val_macro_f1": 0.7503669023314608,
      "val_verse_f1": 0.8174956454422295,
      "val_chorus_f1": 0.683238159220692,
      "val_chorus_rate": 0.432584784924984,
      "val_max_prob": 0.6744422316551208,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002155945629977518,
      "epoch_time": 27.531670093536377,
      "val_boundary_f1": 0.37748917748917754,
      "val_boundary_precision": 0.2982216142270862,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.21994075029164364,
      "val_avg_segment_overlap": 0.6141857086084594,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.5407272548648162,
      "val_pk_metric": 0.3724930294121961,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.31548704020679,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49217066913843155,
      "train_chorus_rate": 0.3987515177577734,
      "train_max_prob": 0.6866367533802986,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4768349528312683,
      "val_macro_f1": 0.751666363682614,
      "val_verse_f1": 0.8171039844509232,
      "val_chorus_f1": 0.6862287429143048,
      "val_chorus_rate": 0.4313551262021065,
      "val_max_prob": 0.7220799624919891,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020468973270151484,
      "epoch_time": 19.697625875473022,
      "val_boundary_f1": 0.4311270125223613,
      "val_boundary_precision": 0.3472622478386167,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.2953106772272364,
      "val_avg_segment_overlap": 0.6472081951639018,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.5144312969157534,
      "val_pk_metric": 0.32962290963765073,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.0701911896467209,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4897986203432083,
      "train_chorus_rate": 0.4322304017841816,
      "train_max_prob": 0.6984428241848946,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4739810451865196,
      "val_macro_f1": 0.7806974884244434,
      "val_verse_f1": 0.8510875627440044,
      "val_chorus_f1": 0.7103074141048824,
      "val_chorus_rate": 0.3723129406571388,
      "val_max_prob": 0.7066541016101837,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000187342652810422,
      "epoch_time": 20.231353044509888,
      "val_boundary_f1": 0.44247787610619466,
      "val_boundary_precision": 0.35410764872521244,
      "val_boundary_recall": 0.589622641509434,
      "val_complete_segments": 0.2856066187757107,
      "val_avg_segment_overlap": 0.6374367465573368,
      "val_verse_to_chorus_acc": 0.5707964601769911,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.49924703908271856,
      "val_pk_metric": 0.31173285756488495,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.3049182146787643,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.46944938972592354,
      "train_chorus_rate": 0.405618516728282,
      "train_max_prob": 0.7052132040262222,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47240714728832245,
      "val_macro_f1": 0.7769256649593234,
      "val_verse_f1": 0.8464994384125796,
      "val_chorus_f1": 0.7073518915060671,
      "val_chorus_rate": 0.3902285322546959,
      "val_max_prob": 0.7329349517822266,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016473549815164643,
      "epoch_time": 22.795822143554688,
      "val_boundary_f1": 0.46321525885558584,
      "val_boundary_precision": 0.3766617429837518,
      "val_boundary_recall": 0.6014150943396226,
      "val_complete_segments": 0.3287499232516731,
      "val_avg_segment_overlap": 0.6516571693415651,
      "val_verse_to_chorus_acc": 0.588495575221239,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.49495070209800146,
      "val_pk_metric": 0.3075847217400115,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.096114881336689,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4794057961553335,
      "train_chorus_rate": 0.3933971356600523,
      "train_max_prob": 0.7113646939396858,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4731125459074974,
      "val_macro_f1": 0.7533417644350189,
      "val_verse_f1": 0.8186407766990292,
      "val_chorus_f1": 0.6880427521710086,
      "val_chorus_rate": 0.4465101584792137,
      "val_max_prob": 0.715294674038887,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013840890895509407,
      "epoch_time": 20.63300085067749,
      "val_boundary_f1": 0.4307417336907954,
      "val_boundary_precision": 0.34676258992805753,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.28680696260821514,
      "val_avg_segment_overlap": 0.6406969202331714,
      "val_verse_to_chorus_acc": 0.5309734513274337,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.5283735028458729,
      "val_pk_metric": 0.36001684615200114,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1735831387341022,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.480299673974514,
      "train_chorus_rate": 0.4014097545295954,
      "train_max_prob": 0.693417377769947,
      "train_conf_over_90": 3.248440771130845e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4848061874508858,
      "val_macro_f1": 0.733756260044065,
      "val_verse_f1": 0.7932557205941388,
      "val_chorus_f1": 0.6742567994939911,
      "val_chorus_rate": 0.4944278597831726,
      "val_max_prob": 0.7144273370504379,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011015699876776429,
      "epoch_time": 18.160399198532104,
      "val_boundary_f1": 0.3572093023255814,
      "val_boundary_precision": 0.29493087557603687,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.23256891999754403,
      "val_avg_segment_overlap": 0.6117375885537142,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.5232768033920002,
      "val_pk_metric": 0.38018362177890047,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.0828032717108727,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.45914516411721706,
      "train_chorus_rate": 0.3602412361651659,
      "train_max_prob": 0.7213228419423103,
      "train_conf_over_90": 0.00010133199975825846,
      "train_conf_over_95": 0.0,
      "val_loss": 0.474654883146286,
      "val_macro_f1": 0.7572261362927863,
      "val_verse_f1": 0.822093023255814,
      "val_chorus_f1": 0.6923592493297587,
      "val_chorus_rate": 0.43732907623052597,
      "val_max_prob": 0.7338611781597137,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.190508858043451e-05,
      "epoch_time": 19.30160093307495,
      "val_boundary_f1": 0.4183123877917415,
      "val_boundary_precision": 0.33768115942028987,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.28118898508012524,
      "val_avg_segment_overlap": 0.6423246901471222,
      "val_verse_to_chorus_acc": 0.5265486725663717,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.5295810917511743,
      "val_pk_metric": 0.34275564172520967,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.305240124464035,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4636130928993225,
      "train_chorus_rate": 0.3737416286021471,
      "train_max_prob": 0.7048487737774849,
      "train_conf_over_90": 0.00025844111587502994,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47522474080324173,
      "val_macro_f1": 0.7773660590044753,
      "val_verse_f1": 0.845763667105016,
      "val_chorus_f1": 0.7089684509039347,
      "val_chorus_rate": 0.40068095177412033,
      "val_max_prob": 0.706778809428215,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.557849938388217e-05,
      "epoch_time": 20.798300743103027,
      "val_boundary_f1": 0.43906976744186044,
      "val_boundary_precision": 0.36251920122887865,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.2825290108675631,
      "val_avg_segment_overlap": 0.6360724655497421,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.49841324285220356,
      "val_pk_metric": 0.3304889287778217,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1088117770850658,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4751500003039837,
      "train_chorus_rate": 0.343791838735342,
      "train_max_prob": 0.701013345271349,
      "train_conf_over_90": 0.00017892899631988257,
      "train_conf_over_95": 0.0,
      "val_loss": 0.474664531648159,
      "val_macro_f1": 0.7623908109286249,
      "val_verse_f1": 0.8274532485058801,
      "val_chorus_f1": 0.6973283733513698,
      "val_chorus_rate": 0.4374207779765129,
      "val_max_prob": 0.7090925723314285,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.2971344725106553e-05,
      "epoch_time": 22.573838233947754,
      "val_boundary_f1": 0.41681574239713776,
      "val_boundary_precision": 0.3357348703170029,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.29409805366243014,
      "val_avg_segment_overlap": 0.6360423823344314,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.5038007373334394,
      "val_pk_metric": 0.32139191835210285,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1124245040118694,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.46114190109074116,
      "train_chorus_rate": 0.3736776355654001,
      "train_max_prob": 0.7079743891954422,
      "train_conf_over_90": 0.0002927605964941904,
      "train_conf_over_95": 0.0,
      "val_loss": 0.472979374229908,
      "val_macro_f1": 0.7591517014611748,
      "val_verse_f1": 0.8229126213592233,
      "val_chorus_f1": 0.6953907815631263,
      "val_chorus_rate": 0.4482862949371338,
      "val_max_prob": 0.7235637754201889,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.5624264834013743e-05,
      "epoch_time": 19.647019863128662,
      "val_boundary_f1": 0.42973708068902994,
      "val_boundary_precision": 0.3490427098674521,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.29394455700865724,
      "val_avg_segment_overlap": 0.6425193215521561,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.5101676190223936,
      "val_pk_metric": 0.3383200836203729,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.023198887705803,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4672305155545473,
      "train_chorus_rate": 0.3703790381550789,
      "train_max_prob": 0.7122282236814499,
      "train_conf_over_90": 0.0005947313875367399,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4753710627555847,
      "val_macro_f1": 0.756099650678706,
      "val_verse_f1": 0.8190513371071637,
      "val_chorus_f1": 0.6931479642502483,
      "val_chorus_rate": 0.4587787538766861,
      "val_max_prob": 0.7206986099481583,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.719434537776769e-06,
      "epoch_time": 17.916280031204224,
      "val_boundary_f1": 0.41160471441523117,
      "val_boundary_precision": 0.33431516936671574,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.2786102412967397,
      "val_avg_segment_overlap": 0.6362208104622089,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.5042785478778424,
      "val_pk_metric": 0.339453361154732,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.9312212523072958,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.4585206266492605,
      "train_chorus_rate": 0.381144005805254,
      "train_max_prob": 0.7116990201175213,
      "train_conf_over_90": 0.0004394481184135657,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47554564476013184,
      "val_macro_f1": 0.7553435421254159,
      "val_verse_f1": 0.8184303006638033,
      "val_chorus_f1": 0.6922567835870285,
      "val_chorus_rate": 0.4589686617255211,
      "val_max_prob": 0.7215378135442734,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 17.5271098613739,
      "val_boundary_f1": 0.4120328167730173,
      "val_boundary_precision": 0.33580980683506684,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.2786102412967397,
      "val_avg_segment_overlap": 0.6352889560261985,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.5041169140015859,
      "val_pk_metric": 0.3400489985599625,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1063299514353275,
      "cnn_effective_layers": 2
    }
  ]
}