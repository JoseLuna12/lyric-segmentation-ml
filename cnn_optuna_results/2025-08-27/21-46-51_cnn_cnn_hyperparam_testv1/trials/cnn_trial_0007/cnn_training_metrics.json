{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.2543174014470008,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 70914,
      "cnn_params": 65920,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00032657992815532513,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08079654603376839,
        "ece_after": 0.015358476586683796,
        "improvement": 0.06543806944708459,
        "params": {
          "temperature": 0.6117681067663197
        }
      },
      "platt": {
        "ece_before": 0.08079654603376839,
        "ece_after": 0.02106641061706487,
        "improvement": 0.05973013541670352,
        "params": {
          "A": 1.4999939941410358,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5729716137835854,
      "train_chorus_rate": 0.1357005652726481,
      "train_max_prob": 0.5473587199261314,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5863466709852219,
      "val_macro_f1": 0.643355755163193,
      "val_verse_f1": 0.7784111150694691,
      "val_chorus_f1": 0.508300395256917,
      "val_chorus_rate": 0.32275082916021347,
      "val_max_prob": 0.5278153270483017,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.7926745862012646e-05,
      "epoch_time": 112.05998802185059,
      "val_boundary_f1": 0.23539373412362408,
      "val_boundary_precision": 0.18361955085865259,
      "val_boundary_recall": 0.3278301886792453,
      "val_complete_segments": 0.11014049495732023,
      "val_avg_segment_overlap": 0.4934369082244727,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.37373737373737376,
      "val_window_diff": 0.4493255028974452,
      "val_pk_metric": 0.3322427639316522,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 5.404458183991282,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5516347947873568,
      "train_chorus_rate": 0.4667873225714031,
      "train_max_prob": 0.5454038569801732,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5652877390384674,
      "val_macro_f1": 0.6611507370423204,
      "val_verse_f1": 0.7666666666666666,
      "val_chorus_f1": 0.5556348074179743,
      "val_chorus_rate": 0.39101388305425644,
      "val_max_prob": 0.5683762282133102,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.22156013965139e-05,
      "epoch_time": 135.2529101371765,
      "val_boundary_f1": 0.2708757637474542,
      "val_boundary_precision": 0.23835125448028674,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.1094462647211423,
      "val_avg_segment_overlap": 0.5180371684895675,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.41727943904695375,
      "val_pk_metric": 0.32871898572023833,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.1564337768052755,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5216456463462428,
      "train_chorus_rate": 0.3810535575214185,
      "train_max_prob": 0.6001174826371042,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5397295951843262,
      "val_macro_f1": 0.6783072277416458,
      "val_verse_f1": 0.7611794571372779,
      "val_chorus_f1": 0.5954349983460138,
      "val_chorus_rate": 0.4439372792840004,
      "val_max_prob": 0.6277124136686325,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.504311828603999e-05,
      "epoch_time": 117.79758906364441,
      "val_boundary_f1": 0.2155688622754491,
      "val_boundary_precision": 0.18685121107266436,
      "val_boundary_recall": 0.25471698113207547,
      "val_complete_segments": 0.08339067797212488,
      "val_avg_segment_overlap": 0.5414927811296399,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.41260790573883044,
      "val_pk_metric": 0.33557837439696414,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.6991107087386281,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.4924378348024268,
      "train_chorus_rate": 0.3677986248543388,
      "train_max_prob": 0.6568502156358016,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5255408883094788,
      "val_macro_f1": 0.6852246017586678,
      "val_verse_f1": 0.7586618876941457,
      "val_chorus_f1": 0.6117873158231901,
      "val_chorus_rate": 0.467841237783432,
      "val_max_prob": 0.6743799299001694,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.499281402842818e-05,
      "epoch_time": 115.29253482818604,
      "val_boundary_f1": 0.24321608040201007,
      "val_boundary_precision": 0.2119089316987741,
      "val_boundary_recall": 0.28537735849056606,
      "val_complete_segments": 0.09114163924406002,
      "val_avg_segment_overlap": 0.5591074992826053,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4021802146512962,
      "val_pk_metric": 0.3217414172138695,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.847650741275988,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.49399111615984065,
      "train_chorus_rate": 0.42069669146286814,
      "train_max_prob": 0.6794593459681461,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5205589681863785,
      "val_macro_f1": 0.6463902317840756,
      "val_verse_f1": 0.685815289438798,
      "val_chorus_f1": 0.6069651741293532,
      "val_chorus_rate": 0.588395431637764,
      "val_max_prob": 0.663506269454956,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012020626397900511,
      "epoch_time": 109.83557987213135,
      "val_boundary_f1": 0.20121951219512196,
      "val_boundary_precision": 0.1767857142857143,
      "val_boundary_recall": 0.23349056603773585,
      "val_complete_segments": 0.06483072611271817,
      "val_avg_segment_overlap": 0.5015975201419729,
      "val_verse_to_chorus_acc": 0.09734513274336283,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.4126980446172872,
      "val_pk_metric": 0.3331070733318606,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.6088073535969385,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.4843440636208183,
      "train_chorus_rate": 0.3910625569130245,
      "train_max_prob": 0.6833634439267611,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5047588869929314,
      "val_macro_f1": 0.7262568431264409,
      "val_verse_f1": 0.797112758486149,
      "val_chorus_f1": 0.6554009277667329,
      "val_chorus_rate": 0.44094371795654297,
      "val_max_prob": 0.6906158030033112,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001584984194556401,
      "epoch_time": 98.46865916252136,
      "val_boundary_f1": 0.3634686346863468,
      "val_boundary_precision": 0.29848484848484846,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.2738020200333099,
      "val_avg_segment_overlap": 0.6253983756687698,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.5505050505050505,
      "val_window_diff": 0.39138522857756897,
      "val_pk_metric": 0.2944408127879122,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.543417453765869,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.4771688643254732,
      "train_chorus_rate": 0.40929827721495377,
      "train_max_prob": 0.6936735040263126,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5247737765312195,
      "val_macro_f1": 0.7334814923704522,
      "val_verse_f1": 0.8352585747289853,
      "val_chorus_f1": 0.631704410011919,
      "val_chorus_rate": 0.3208377808332443,
      "val_max_prob": 0.6644595265388489,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019749319336724718,
      "epoch_time": 105.30983686447144,
      "val_boundary_f1": 0.4056999161777033,
      "val_boundary_precision": 0.31469440832249673,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.3358206348303826,
      "val_avg_segment_overlap": 0.6452211074807942,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.3905385566691842,
      "val_pk_metric": 0.29361188563333573,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.165862208918521,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.49108381334104034,
      "train_chorus_rate": 0.3862133724124808,
      "train_max_prob": 0.6781297043750161,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.506321407854557,
      "val_macro_f1": 0.7421043053432177,
      "val_verse_f1": 0.822538375140397,
      "val_chorus_f1": 0.6616702355460385,
      "val_chorus_rate": 0.38845670223236084,
      "val_max_prob": 0.6869569271802902,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023477090006913294,
      "epoch_time": 124.41076612472534,
      "val_boundary_f1": 0.43680137575236466,
      "val_boundary_precision": 0.34370771312584575,
      "val_boundary_recall": 0.5990566037735849,
      "val_complete_segments": 0.383105165992651,
      "val_avg_segment_overlap": 0.6612293217424341,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.5959595959595959,
      "val_window_diff": 0.38366257849742125,
      "val_pk_metric": 0.28425892941464076,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.464356635746203,
      "cnn_effective_layers": 1
    }
  ]
}