{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.25953375254290356,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "localized",
      "attention_heads": 4,
      "total_params": 165504,
      "cnn_params": 97278,
      "attention_params": 66304
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00017753837036522268,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "boundary_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05132377295515159,
        "ece_after": 0.024084780109069184,
        "improvement": 0.02723899284608241,
        "params": {
          "temperature": 0.7568275872598862
        }
      },
      "platt": {
        "ece_before": 0.05132377295515159,
        "ece_after": 0.04319718027805769,
        "improvement": 0.008126592677093904,
        "params": {
          "A": 1.1079397824909343,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5952406355312893,
      "train_chorus_rate": 0.24008329111217921,
      "train_max_prob": 0.6087289708001273,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6140421032905579,
      "val_macro_f1": 0.46669227847603917,
      "val_verse_f1": 0.8006644518272426,
      "val_chorus_f1": 0.13272010512483576,
      "val_chorus_rate": 0.07665786147117615,
      "val_max_prob": 0.5404388606548309,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000174530670815988,
      "epoch_time": 76.00176787376404,
      "val_boundary_f1": 0.10218978102189781,
      "val_boundary_precision": 0.13409961685823754,
      "val_boundary_recall": 0.08254716981132075,
      "val_complete_segments": 0.015613696648179406,
      "val_avg_segment_overlap": 0.2269232437759317,
      "val_verse_to_chorus_acc": 0.07964601769911504,
      "val_chorus_to_verse_acc": 0.030303030303030304,
      "val_window_diff": 0.4011254424496594,
      "val_pk_metric": 0.36994280331376206,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1147.289446932929,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5749816298484802,
      "train_chorus_rate": 0.5953572818211147,
      "train_max_prob": 0.5530079262597221,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6105087399482727,
      "val_macro_f1": 0.5555089286510672,
      "val_verse_f1": 0.7948922585794094,
      "val_chorus_f1": 0.3161255987227249,
      "val_chorus_rate": 0.1611892133951187,
      "val_max_prob": 0.5706821382045746,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016571254192210576,
      "epoch_time": 67.2024290561676,
      "val_boundary_f1": 0.17714285714285713,
      "val_boundary_precision": 0.2246376811594203,
      "val_boundary_recall": 0.14622641509433962,
      "val_complete_segments": 0.043740742016604085,
      "val_avg_segment_overlap": 0.28771067389139193,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.08080808080808081,
      "val_window_diff": 0.39313481956133034,
      "val_pk_metric": 0.37098274128003744,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 10.223249222551074,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5745300395148141,
      "train_chorus_rate": 0.5121218476976667,
      "train_max_prob": 0.5761842727661133,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5844972431659698,
      "val_macro_f1": 0.5511485238608445,
      "val_verse_f1": 0.5600770527329642,
      "val_chorus_f1": 0.5422199949887246,
      "val_chorus_rate": 0.6737373471260071,
      "val_max_prob": 0.5822782516479492,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015168492459504695,
      "epoch_time": 61.333240270614624,
      "val_boundary_f1": 0.1702127659574468,
      "val_boundary_precision": 0.17061611374407584,
      "val_boundary_recall": 0.16981132075471697,
      "val_complete_segments": 0.06614936787350581,
      "val_avg_segment_overlap": 0.35368589846505805,
      "val_verse_to_chorus_acc": 0.16371681415929204,
      "val_chorus_to_verse_acc": 0.16666666666666666,
      "val_window_diff": 0.4277433770736748,
      "val_pk_metric": 0.3802823443373159,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.502795317343303,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.5651448369026184,
      "train_chorus_rate": 0.29315643864018576,
      "train_max_prob": 0.6352641497339521,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6170943975448608,
      "val_macro_f1": 0.5882495418638206,
      "val_verse_f1": 0.806865575874238,
      "val_chorus_f1": 0.36963350785340315,
      "val_chorus_rate": 0.17110932618379593,
      "val_max_prob": 0.6470008790493011,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013340377777391703,
      "epoch_time": 68.11671590805054,
      "val_boundary_f1": 0.2802690582959641,
      "val_boundary_precision": 0.2670940170940171,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.12717454958834268,
      "val_avg_segment_overlap": 0.39556092706266466,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.38206143555198796,
      "val_pk_metric": 0.30486109885853196,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 35.43815748180662,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5609158532960075,
      "train_chorus_rate": 0.5004034340381622,
      "train_max_prob": 0.6069181220872062,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5737050473690033,
      "val_macro_f1": 0.5789175773936517,
      "val_verse_f1": 0.6008403361344538,
      "val_chorus_f1": 0.5569948186528497,
      "val_chorus_rate": 0.6414811909198761,
      "val_max_prob": 0.6056838631629944,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001121149314035524,
      "epoch_time": 60.32726287841797,
      "val_boundary_f1": 0.19267822736030826,
      "val_boundary_precision": 0.16286644951140064,
      "val_boundary_recall": 0.2358490566037736,
      "val_complete_segments": 0.0669847393985325,
      "val_avg_segment_overlap": 0.41772174431338993,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.30808080808080807,
      "val_window_diff": 0.4390327992289821,
      "val_pk_metric": 0.3560386226382249,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.4772581117493764,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.5451569557189941,
      "train_chorus_rate": 0.4855209972177233,
      "train_max_prob": 0.6237352575574603,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5654889047145844,
      "val_macro_f1": 0.6598002731976649,
      "val_verse_f1": 0.7385842472582252,
      "val_chorus_f1": 0.5810162991371045,
      "val_chorus_rate": 0.4695785343647003,
      "val_max_prob": 0.6316740214824677,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.926918518261135e-05,
      "epoch_time": 65.05951499938965,
      "val_boundary_f1": 0.27340823970037453,
      "val_boundary_precision": 0.2267080745341615,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.12574494471046196,
      "val_avg_segment_overlap": 0.5295304100005328,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.42505871977254667,
      "val_pk_metric": 0.34409202774783876,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 19.458219519683293,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.541789174079895,
      "train_chorus_rate": 0.4458674490451813,
      "train_max_prob": 0.6255608541624886,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5563092231750488,
      "val_macro_f1": 0.6700781617190287,
      "val_verse_f1": 0.7382987382987384,
      "val_chorus_f1": 0.601857585139319,
      "val_chorus_rate": 0.49297061562538147,
      "val_max_prob": 0.6193509101867676,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.642343896167031e-05,
      "epoch_time": 65.66995191574097,
      "val_boundary_f1": 0.27864798021434456,
      "val_boundary_precision": 0.21419518377693283,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.1464828275173103,
      "val_avg_segment_overlap": 0.5578278968392686,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.448715929083886,
      "val_pk_metric": 0.3476639285238382,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 321.8469601699284,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.5268133197511945,
      "train_chorus_rate": 0.43676922576768057,
      "train_max_prob": 0.6252062150410244,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5521810054779053,
      "val_macro_f1": 0.6982154862548504,
      "val_verse_f1": 0.7880393641180924,
      "val_chorus_f1": 0.6083916083916083,
      "val_chorus_rate": 0.4036005139350891,
      "val_max_prob": 0.655365914106369,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.513459259130569e-05,
      "epoch_time": 65.52602291107178,
      "val_boundary_f1": 0.3129707112970711,
      "val_boundary_precision": 0.24254215304798962,
      "val_boundary_recall": 0.4410377358490566,
      "val_complete_segments": 0.19440042715904784,
      "val_avg_segment_overlap": 0.6030608182159738,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.41817001362747264,
      "val_pk_metric": 0.3247895163444843,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 12.2012597152165,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.5231897958687374,
      "train_chorus_rate": 0.36446186900138855,
      "train_max_prob": 0.6570300800459725,
      "train_conf_over_90": 0.00010452895159167903,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5433783531188965,
      "val_macro_f1": 0.6826153623680613,
      "val_verse_f1": 0.748321464903357,
      "val_chorus_f1": 0.6169092598327657,
      "val_chorus_rate": 0.4913218915462494,
      "val_max_prob": 0.6549789607524872,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.685344577017575e-05,
      "epoch_time": 59.84752702713013,
      "val_boundary_f1": 0.27008547008547007,
      "val_boundary_precision": 0.21179624664879357,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.13889558717144923,
      "val_avg_segment_overlap": 0.5686036147105387,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4398143991256488,
      "val_pk_metric": 0.335973709010153,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.8472135748182024,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.5177024602890015,
      "train_chorus_rate": 0.4177429846354893,
      "train_max_prob": 0.6583554829869952,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5407171845436096,
      "val_macro_f1": 0.6969389173295735,
      "val_verse_f1": 0.7665268623926502,
      "val_chorus_f1": 0.6273509722664967,
      "val_chorus_rate": 0.4697296470403671,
      "val_max_prob": 0.6663714945316315,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.2825828443116962e-05,
      "epoch_time": 64.32317900657654,
      "val_boundary_f1": 0.3019197207678883,
      "val_boundary_precision": 0.23961218836565096,
      "val_boundary_recall": 0.4080188679245283,
      "val_complete_segments": 0.18327362292879534,
      "val_avg_segment_overlap": 0.5878852056592938,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4239702964783353,
      "val_pk_metric": 0.32396845421222176,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 321.96064322335377,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 11,
      "train_loss": 0.5226629972457886,
      "train_chorus_rate": 0.40192329032080515,
      "train_max_prob": 0.6680082253047398,
      "train_conf_over_90": 3.476688704852547e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5396748781204224,
      "val_macro_f1": 0.6996958190429527,
      "val_verse_f1": 0.769904458598726,
      "val_chorus_f1": 0.6294871794871794,
      "val_chorus_rate": 0.4660006910562515,
      "val_max_prob": 0.6657867729663849,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.007699549234707e-06,
      "epoch_time": 65.4942581653595,
      "val_boundary_f1": 0.31560592850915437,
      "val_boundary_precision": 0.2503457814661134,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.2009542181955975,
      "val_avg_segment_overlap": 0.5955299104895071,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.41760064415465026,
      "val_pk_metric": 0.31753614425736576,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.3168110166277205,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 12,
      "train_loss": 0.5158389593873706,
      "train_chorus_rate": 0.41146160449300495,
      "train_max_prob": 0.6642498033387321,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5389254093170166,
      "val_macro_f1": 0.6942160088501009,
      "val_verse_f1": 0.7614254076907591,
      "val_chorus_f1": 0.6270066100094428,
      "val_chorus_rate": 0.4808569401502609,
      "val_max_prob": 0.6636338531970978,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 63.87850880622864,
      "val_boundary_f1": 0.29597197898423816,
      "val_boundary_precision": 0.23537604456824512,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.17504908884219228,
      "val_avg_segment_overlap": 0.5880283559780771,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.41947012920542337,
      "val_pk_metric": 0.3194943589256699,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3149.696363900389,
      "cnn_effective_layers": 1
    }
  ]
}