{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.3930892865503881,
      "layer_dropout": 0.23722965853306727,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 4,
      "total_params": 212995,
      "cnn_params": 131840,
      "attention_params": 74625
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0009773584004575738,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05260400632158476,
        "ece_after": 0.01514671401858096,
        "improvement": 0.0374572923030038,
        "params": {
          "temperature": 0.7418366047918237
        }
      },
      "platt": {
        "ece_before": 0.05260400632158476,
        "ece_after": 0.01532342219048258,
        "improvement": 0.037280584131102176,
        "params": {
          "A": 1.2867018597326936,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5753834247589111,
      "train_chorus_rate": 0.5055430488927024,
      "train_max_prob": 0.5687275103160313,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5743227899074554,
      "val_macro_f1": 0.6770249011678071,
      "val_verse_f1": 0.778628806276854,
      "val_chorus_f1": 0.5754209960587603,
      "val_chorus_rate": 0.38955317437648773,
      "val_max_prob": 0.5967033207416534,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.107887065692487e-05,
      "epoch_time": 116.23835802078247,
      "val_boundary_f1": 0.25709779179810727,
      "val_boundary_precision": 0.19312796208530805,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.12431318681318682,
      "val_avg_segment_overlap": 0.5790422648258005,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.4967546936964486,
      "val_pk_metric": 0.3773975453513649,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 6.325201698711941,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5459284271512713,
      "train_chorus_rate": 0.4229038655757904,
      "train_max_prob": 0.6035796574183873,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5523533523082733,
      "val_macro_f1": 0.6994678951895608,
      "val_verse_f1": 0.7915021620605376,
      "val_chorus_f1": 0.607433628318584,
      "val_chorus_rate": 0.39515264332294464,
      "val_max_prob": 0.6499016284942627,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.701568451173578e-05,
      "epoch_time": 97.66447591781616,
      "val_boundary_f1": 0.3465259454705365,
      "val_boundary_precision": 0.2762973352033661,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.22742553499132445,
      "val_avg_segment_overlap": 0.6271122873573203,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.4622807254454059,
      "val_pk_metric": 0.3340801847900903,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 105.26977034977504,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5373046823910305,
      "train_chorus_rate": 0.44460451177188326,
      "train_max_prob": 0.6338656033788409,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5338055193424225,
      "val_macro_f1": 0.6879662933024712,
      "val_verse_f1": 0.754403725450496,
      "val_chorus_f1": 0.6215288611544463,
      "val_chorus_rate": 0.48571327328681946,
      "val_max_prob": 0.6802552044391632,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.685454945108517e-05,
      "epoch_time": 97.15782713890076,
      "val_boundary_f1": 0.33477883781439727,
      "val_boundary_precision": 0.26474622770919065,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.2525394013880856,
      "val_avg_segment_overlap": 0.6228861045302319,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4510204935414588,
      "val_pk_metric": 0.325366139241261,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 768.3307400005204,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5275941065379551,
      "train_chorus_rate": 0.504055666072028,
      "train_max_prob": 0.6522649782044547,
      "train_conf_over_90": 4.927807770270322e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5264057815074921,
      "val_macro_f1": 0.7108055009823182,
      "val_verse_f1": 0.7831041257367387,
      "val_chorus_f1": 0.6385068762278978,
      "val_chorus_rate": 0.4541683942079544,
      "val_max_prob": 0.7008761167526245,
      "val_conf_over_90": 0.0003293807676527649,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.051222422544887e-05,
      "epoch_time": 94.61153602600098,
      "val_boundary_f1": 0.35393734123624043,
      "val_boundary_precision": 0.2760898282694848,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.3131235540775014,
      "val_avg_segment_overlap": 0.6450292345408652,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.45158572276054704,
      "val_pk_metric": 0.315000148766656,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 768.2351992215429,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5188202049051013,
      "train_chorus_rate": 0.42030938608305796,
      "train_max_prob": 0.6662741388593402,
      "train_conf_over_90": 0.00030211521204494474,
      "train_conf_over_95": 0.0,
      "val_loss": 0.520907461643219,
      "val_macro_f1": 0.732429876348321,
      "val_verse_f1": 0.805630543771693,
      "val_chorus_f1": 0.6592292089249492,
      "val_chorus_rate": 0.4310455918312073,
      "val_max_prob": 0.7198792099952698,
      "val_conf_over_90": 0.0018115942366421223,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.787315872606737e-05,
      "epoch_time": 100.37821078300476,
      "val_boundary_f1": 0.3816013628620102,
      "val_boundary_precision": 0.2986666666666667,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3570073019086177,
      "val_avg_segment_overlap": 0.6722255779075914,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.44606752241275294,
      "val_pk_metric": 0.31034750314236415,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 768.057622730732,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.5136907356125968,
      "train_chorus_rate": 0.4482674641268594,
      "train_max_prob": 0.6777537550245013,
      "train_conf_over_90": 0.0011812038802807884,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5155193656682968,
      "val_macro_f1": 0.7272817523072234,
      "val_verse_f1": 0.7935190673779887,
      "val_chorus_f1": 0.661044437236458,
      "val_chorus_rate": 0.46244168281555176,
      "val_max_prob": 0.7278041839599609,
      "val_conf_over_90": 0.00964805856347084,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010879047159115306,
      "epoch_time": 110.95611906051636,
      "val_boundary_f1": 0.36741767764298094,
      "val_boundary_precision": 0.29041095890410956,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.2865005060728745,
      "val_avg_segment_overlap": 0.6553434336218584,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4552113200276168,
      "val_pk_metric": 0.3210936649299689,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1535.160497375897,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.5156469345092773,
      "train_chorus_rate": 0.411490546805518,
      "train_max_prob": 0.6798326628548759,
      "train_conf_over_90": 0.0017110149492509663,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5083529353141785,
      "val_macro_f1": 0.7353143774196407,
      "val_verse_f1": 0.8073359073359074,
      "val_chorus_f1": 0.6632928475033738,
      "val_chorus_rate": 0.4329875558614731,
      "val_max_prob": 0.7136091589927673,
      "val_conf_over_90": 0.00621245161164552,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013308719288867535,
      "epoch_time": 87.0038070678711,
      "val_boundary_f1": 0.3536480686695279,
      "val_boundary_precision": 0.27800269905533065,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.27506868131868134,
      "val_avg_segment_overlap": 0.664616809871458,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.45298875760806734,
      "val_pk_metric": 0.31710471000051665,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8875143527984619,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.5039343152727399,
      "train_chorus_rate": 0.40797727022852215,
      "train_max_prob": 0.6692579814365932,
      "train_conf_over_90": 0.00166252492428092,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5073189735412598,
      "val_macro_f1": 0.7503511131152949,
      "val_verse_f1": 0.8304202305689847,
      "val_chorus_f1": 0.6702819956616052,
      "val_chorus_rate": 0.38321034610271454,
      "val_max_prob": 0.7242651283740997,
      "val_conf_over_90": 0.00964805856347084,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016055776136206527,
      "epoch_time": 85.04903793334961,
      "val_boundary_f1": 0.41567912488605285,
      "val_boundary_precision": 0.3387815750371471,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.3353455754771544,
      "val_avg_segment_overlap": 0.6902692897903777,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.4265032595183695,
      "val_pk_metric": 0.29242013077781676,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 605.1333338703428,
      "cnn_effective_layers": 2
    }
  ]
}