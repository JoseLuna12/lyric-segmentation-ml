{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.28262909084207094,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 70914,
      "cnn_params": 65920,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0005180984142541071,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 5,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06663942259456414,
        "ece_after": 0.019908034438468603,
        "improvement": 0.04673138815609554,
        "params": {
          "temperature": 0.6682697330214992
        }
      },
      "platt": {
        "ece_before": 0.06663942259456414,
        "ece_after": 0.021769785064259767,
        "improvement": 0.044869637530304374,
        "params": {
          "A": 1.4604796980910681,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5759652786784701,
      "train_chorus_rate": 0.33202890104924637,
      "train_max_prob": 0.5369614991876814,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5929536819458008,
      "val_macro_f1": 0.6546312523683213,
      "val_verse_f1": 0.8032280219780219,
      "val_chorus_f1": 0.5060344827586206,
      "val_chorus_rate": 0.27203844860196114,
      "val_max_prob": 0.5264285951852798,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.7652535999878026e-05,
      "epoch_time": 191.37225818634033,
      "val_boundary_f1": 0.28397212543554007,
      "val_boundary_precision": 0.22513812154696133,
      "val_boundary_recall": 0.38443396226415094,
      "val_complete_segments": 0.17386828083048292,
      "val_avg_segment_overlap": 0.4993685654552205,
      "val_verse_to_chorus_acc": 0.27876106194690264,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4079260614115326,
      "val_pk_metric": 0.3167199830387944,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.133421778678894,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5564278894000583,
      "train_chorus_rate": 0.39600687556796604,
      "train_max_prob": 0.5450327032142215,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5728308260440826,
      "val_macro_f1": 0.6550259861791925,
      "val_verse_f1": 0.7649906890130355,
      "val_chorus_f1": 0.5450612833453496,
      "val_chorus_rate": 0.38174979388713837,
      "val_max_prob": 0.5682525932788849,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.805226309147063e-05,
      "epoch_time": 152.4402301311493,
      "val_boundary_f1": 0.272452068617558,
      "val_boundary_precision": 0.23809523809523808,
      "val_boundary_recall": 0.31839622641509435,
      "val_complete_segments": 0.12297781271837875,
      "val_avg_segment_overlap": 0.4990799569957445,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4155587363757535,
      "val_pk_metric": 0.3352914259326561,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.4824561013115778,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5284419904152552,
      "train_chorus_rate": 0.40144334899054634,
      "train_max_prob": 0.5972751412126753,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5515303909778595,
      "val_macro_f1": 0.6771191141085903,
      "val_verse_f1": 0.7797241893402908,
      "val_chorus_f1": 0.5745140388768898,
      "val_chorus_rate": 0.3822109252214432,
      "val_max_prob": 0.6240583211183548,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.078641667642764e-05,
      "epoch_time": 278.94270277023315,
      "val_boundary_f1": 0.2563619227144204,
      "val_boundary_precision": 0.21350078492935637,
      "val_boundary_recall": 0.32075471698113206,
      "val_complete_segments": 0.12729314934348449,
      "val_avg_segment_overlap": 0.5472525804121888,
      "val_verse_to_chorus_acc": 0.2079646017699115,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4266653128832158,
      "val_pk_metric": 0.3296319723794692,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.5798731578720941,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.4988611290852229,
      "train_chorus_rate": 0.3547692249218623,
      "train_max_prob": 0.6503573821650611,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5392657816410065,
      "val_macro_f1": 0.6773593532431366,
      "val_verse_f1": 0.7635658914728681,
      "val_chorus_f1": 0.5911528150134049,
      "val_chorus_rate": 0.4328749403357506,
      "val_max_prob": 0.6629609018564224,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012403100418547193,
      "epoch_time": 149.5338430404663,
      "val_boundary_f1": 0.2567947516401125,
      "val_boundary_precision": 0.2130637636080871,
      "val_boundary_recall": 0.3231132075471698,
      "val_complete_segments": 0.1126451644047225,
      "val_avg_segment_overlap": 0.5608765866809161,
      "val_verse_to_chorus_acc": 0.17699115044247787,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4219953634019376,
      "val_pk_metric": 0.3391389482268487,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.9565635191069708,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5027167863316007,
      "train_chorus_rate": 0.4492739149265819,
      "train_max_prob": 0.6692330174975925,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.519794687628746,
      "val_macro_f1": 0.7075476032751855,
      "val_verse_f1": 0.7752741774675972,
      "val_chorus_f1": 0.6398210290827739,
      "val_chorus_rate": 0.46661676466464996,
      "val_max_prob": 0.6566858738660812,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017537637705160357,
      "epoch_time": 167.9060308933258,
      "val_boundary_f1": 0.33481745325022266,
      "val_boundary_precision": 0.26895565092989987,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.21819129519290892,
      "val_avg_segment_overlap": 0.5947399956483485,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.41409363290108303,
      "val_pk_metric": 0.30061637297921484,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.7795059416029186,
      "cnn_effective_layers": 1
    }
  ]
}