{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.389890856885326,
      "layer_dropout": 0.17460384611585128,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 135298,
      "cnn_params": 131840,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005475270056465761,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.04808118864747536,
        "ece_after": 0.02464166122592971,
        "improvement": 0.02343952742154565,
        "params": {
          "temperature": 0.726103215754638
        }
      },
      "platt": {
        "ece_before": 0.04808118864747536,
        "ece_after": 0.016996092772319903,
        "improvement": 0.03108509587515546,
        "params": {
          "A": 1.287846879906227,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.566424947977066,
      "train_chorus_rate": 0.4629846751689911,
      "train_max_prob": 0.5312760233879089,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5900264382362366,
      "val_macro_f1": 0.6275082152301237,
      "val_verse_f1": 0.7468848800446346,
      "val_chorus_f1": 0.5081315504156126,
      "val_chorus_rate": 0.379990354180336,
      "val_max_prob": 0.5219493508338928,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.2544133071563852e-05,
      "epoch_time": 83.30632972717285,
      "val_boundary_f1": 0.20176140912730184,
      "val_boundary_precision": 0.15272727272727274,
      "val_boundary_recall": 0.2971698113207547,
      "val_complete_segments": 0.0780650063993174,
      "val_avg_segment_overlap": 0.4508271559719247,
      "val_verse_to_chorus_acc": 0.28761061946902655,
      "val_chorus_to_verse_acc": 0.14646464646464646,
      "val_window_diff": 0.5092131444133904,
      "val_pk_metric": 0.4303437286394287,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 5.050657832622528,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5602026402950286,
      "train_chorus_rate": 0.3870445221662521,
      "train_max_prob": 0.5388526201248169,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5818885862827301,
      "val_macro_f1": 0.6524931704841443,
      "val_verse_f1": 0.8090077886894684,
      "val_chorus_f1": 0.4959785522788204,
      "val_chorus_rate": 0.25031232833862305,
      "val_max_prob": 0.5447388589382172,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.4470144755039946e-05,
      "epoch_time": 79.00558710098267,
      "val_boundary_f1": 0.23864836325237593,
      "val_boundary_precision": 0.21606118546845124,
      "val_boundary_recall": 0.2665094339622642,
      "val_complete_segments": 0.11223469496587031,
      "val_avg_segment_overlap": 0.4598120807577472,
      "val_verse_to_chorus_acc": 0.24778761061946902,
      "val_chorus_to_verse_acc": 0.21717171717171718,
      "val_window_diff": 0.4283391889047804,
      "val_pk_metric": 0.3400540443637846,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2933583438396454,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5434639096260071,
      "train_chorus_rate": 0.31199310421943666,
      "train_max_prob": 0.5545058965682983,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5692872107028961,
      "val_macro_f1": 0.6642991440408841,
      "val_verse_f1": 0.7897747586700035,
      "val_chorus_f1": 0.5388235294117648,
      "val_chorus_rate": 0.32702960073947906,
      "val_max_prob": 0.5617398023605347,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.7669690114905674e-05,
      "epoch_time": 49.397839307785034,
      "val_boundary_f1": 0.2497482376636455,
      "val_boundary_precision": 0.2179261862917399,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.13077938353242322,
      "val_avg_segment_overlap": 0.5001576173030344,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.29797979797979796,
      "val_window_diff": 0.43117105203171807,
      "val_pk_metric": 0.3561803441389677,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2335141360759736,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5397390902042389,
      "train_chorus_rate": 0.3246996760368347,
      "train_max_prob": 0.5732007324695587,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5553891360759735,
      "val_macro_f1": 0.6559328134875292,
      "val_verse_f1": 0.7519201228878649,
      "val_chorus_f1": 0.5599455040871935,
      "val_chorus_rate": 0.42150816321372986,
      "val_max_prob": 0.5807496905326843,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.2127111805135096e-05,
      "epoch_time": 45.09588813781738,
      "val_boundary_f1": 0.16816816816816818,
      "val_boundary_precision": 0.14608695652173914,
      "val_boundary_recall": 0.19811320754716982,
      "val_complete_segments": 0.06050687926621161,
      "val_avg_segment_overlap": 0.4884907009208285,
      "val_verse_to_chorus_acc": 0.11946902654867257,
      "val_chorus_to_verse_acc": 0.2474747474747475,
      "val_window_diff": 0.4602315027949845,
      "val_pk_metric": 0.3812702407173012,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2398887872695923,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.529402881860733,
      "train_chorus_rate": 0.40578505396842957,
      "train_max_prob": 0.5889087438583374,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5490927398204803,
      "val_macro_f1": 0.6714318300109547,
      "val_verse_f1": 0.7806855879100627,
      "val_chorus_f1": 0.5621780721118469,
      "val_chorus_rate": 0.36813922226428986,
      "val_max_prob": 0.6132772266864777,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.782059691609992e-05,
      "epoch_time": 61.85143184661865,
      "val_boundary_f1": 0.19874476987447698,
      "val_boundary_precision": 0.17857142857142858,
      "val_boundary_recall": 0.2240566037735849,
      "val_complete_segments": 0.08661742747440274,
      "val_avg_segment_overlap": 0.5078888073311058,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.30303030303030304,
      "val_window_diff": 0.4383351815822461,
      "val_pk_metric": 0.3559974223591105,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.7344744026660919,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.505267345905304,
      "train_chorus_rate": 0.2755042061209679,
      "train_max_prob": 0.6294636368751526,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5419114530086517,
      "val_macro_f1": 0.6708460839312711,
      "val_verse_f1": 0.7722920968650272,
      "val_chorus_f1": 0.5694000709975151,
      "val_chorus_rate": 0.39240238070487976,
      "val_max_prob": 0.6282419562339783,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.472228371857031e-05,
      "epoch_time": 60.13792085647583,
      "val_boundary_f1": 0.18541666666666667,
      "val_boundary_precision": 0.166044776119403,
      "val_boundary_recall": 0.2099056603773585,
      "val_complete_segments": 0.07734508319112628,
      "val_avg_segment_overlap": 0.5082493543320128,
      "val_verse_to_chorus_acc": 0.12389380530973451,
      "val_chorus_to_verse_acc": 0.29292929292929293,
      "val_window_diff": 0.43764658206560414,
      "val_pk_metric": 0.3535052473882888,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.9021680176258087,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.5085872322320938,
      "train_chorus_rate": 0.3662649065256119,
      "train_max_prob": 0.627452963590622,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5373229086399078,
      "val_macro_f1": 0.6747390603362345,
      "val_verse_f1": 0.776822429906542,
      "val_chorus_f1": 0.572655690765927,
      "val_chorus_rate": 0.38669781386852264,
      "val_max_prob": 0.6411966681480408,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.279839800831582e-05,
      "epoch_time": 54.5337769985199,
      "val_boundary_f1": 0.2103134479271992,
      "val_boundary_precision": 0.184070796460177,
      "val_boundary_recall": 0.24528301886792453,
      "val_complete_segments": 0.08538422568259385,
      "val_avg_segment_overlap": 0.5248425075410302,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.43569983367942056,
      "val_pk_metric": 0.3559592272879366,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.5584754168987274,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.516021004319191,
      "train_chorus_rate": 0.3983500421047211,
      "train_max_prob": 0.6405887961387634,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.529240220785141,
      "val_macro_f1": 0.6680906543782172,
      "val_verse_f1": 0.7470739932553065,
      "val_chorus_f1": 0.589107315501128,
      "val_chorus_rate": 0.46249590814113617,
      "val_max_prob": 0.6489991247653961,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.200941838408879e-05,
      "epoch_time": 53.251952171325684,
      "val_boundary_f1": 0.2072936660268714,
      "val_boundary_precision": 0.17475728155339806,
      "val_boundary_recall": 0.25471698113207547,
      "val_complete_segments": 0.08684406996587031,
      "val_avg_segment_overlap": 0.5284965157548007,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.4514687275718628,
      "val_pk_metric": 0.36792273542303267,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.918136316537857,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.5118856519460678,
      "train_chorus_rate": 0.3947814404964447,
      "train_max_prob": 0.6501405715942383,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5213550627231598,
      "val_macro_f1": 0.6836167909747592,
      "val_verse_f1": 0.7631010794896956,
      "val_chorus_f1": 0.6041325024598229,
      "val_chorus_rate": 0.44923369586467743,
      "val_max_prob": 0.6603100597858429,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.231026965018046e-05,
      "epoch_time": 46.25818991661072,
      "val_boundary_f1": 0.2453016815034619,
      "val_boundary_precision": 0.21124361158432708,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.10318899317406144,
      "val_avg_segment_overlap": 0.5536029733501695,
      "val_verse_to_chorus_acc": 0.15486725663716813,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4272033210745835,
      "val_pk_metric": 0.3322019231337241,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.7290219187736513,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.5014777839183807,
      "train_chorus_rate": 0.4095980882644653,
      "train_max_prob": 0.650553411245346,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5142685174942017,
      "val_macro_f1": 0.698001142917813,
      "val_verse_f1": 0.7795823665893272,
      "val_chorus_f1": 0.6164199192462988,
      "val_chorus_rate": 0.4303814470767975,
      "val_max_prob": 0.6748692691326141,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.36505433971162e-05,
      "epoch_time": 33.90876603126526,
      "val_boundary_f1": 0.28924833491912466,
      "val_boundary_precision": 0.24242424242424243,
      "val_boundary_recall": 0.3584905660377358,
      "val_complete_segments": 0.14735094923208192,
      "val_avg_segment_overlap": 0.5828798454065349,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4194645460257169,
      "val_pk_metric": 0.31849756489722336,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.0769155502319334,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4901595413684845,
      "train_chorus_rate": 0.378009495139122,
      "train_max_prob": 0.6630893409252167,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5085414499044418,
      "val_macro_f1": 0.6895795341843427,
      "val_verse_f1": 0.7475165562913907,
      "val_chorus_f1": 0.6316425120772947,
      "val_chorus_rate": 0.5137181282043457,
      "val_max_prob": 0.6616297662258148,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.597474468104835e-05,
      "epoch_time": 55.12433314323425,
      "val_boundary_f1": 0.26690712353471596,
      "val_boundary_precision": 0.21605839416058395,
      "val_boundary_recall": 0.3490566037735849,
      "val_complete_segments": 0.12541328924914674,
      "val_avg_segment_overlap": 0.561649710358515,
      "val_verse_to_chorus_acc": 0.19469026548672566,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.44170376873686745,
      "val_pk_metric": 0.33680669253673423,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.150896269083023,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.48849803805351255,
      "train_chorus_rate": 0.36018677055835724,
      "train_max_prob": 0.6546083629131317,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5052266418933868,
      "val_macro_f1": 0.6989946777054998,
      "val_verse_f1": 0.7631578947368421,
      "val_chorus_f1": 0.6348314606741574,
      "val_chorus_rate": 0.487060084939003,
      "val_max_prob": 0.6461172997951508,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010922256359469638,
      "epoch_time": 256.5247218608856,
      "val_boundary_f1": 0.32154882154882153,
      "val_boundary_precision": 0.25,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.18885985494880547,
      "val_avg_segment_overlap": 0.6025264969732185,
      "val_verse_to_chorus_acc": 0.30973451327433627,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.44512817913989705,
      "val_pk_metric": 0.3369191410203868,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.9371034026145937,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.4902703702449799,
      "train_chorus_rate": 0.38690656423568726,
      "train_max_prob": 0.6594473719596863,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4979228377342224,
      "val_macro_f1": 0.6927995879746347,
      "val_verse_f1": 0.7503619441571873,
      "val_chorus_f1": 0.6352372317920822,
      "val_chorus_rate": 0.512798935174942,
      "val_max_prob": 0.6779217422008514,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001233291704008668,
      "epoch_time": 45.02945613861084,
      "val_boundary_f1": 0.3237924865831843,
      "val_boundary_precision": 0.260806916426513,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.19132625853242322,
      "val_avg_segment_overlap": 0.591768197003328,
      "val_verse_to_chorus_acc": 0.3407079646017699,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4252883679133145,
      "val_pk_metric": 0.33050120416543094,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.651879978179932,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.4863988429307938,
      "train_chorus_rate": 0.43399841487407687,
      "train_max_prob": 0.6728762686252594,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.492779865860939,
      "val_macro_f1": 0.7181938554926064,
      "val_verse_f1": 0.784493041749503,
      "val_chorus_f1": 0.6518946692357098,
      "val_chorus_rate": 0.46515363454818726,
      "val_max_prob": 0.6976429224014282,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013822553278428632,
      "epoch_time": 64.04636597633362,
      "val_boundary_f1": 0.37226277372262767,
      "val_boundary_precision": 0.30357142857142855,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.25158649744027306,
      "val_avg_segment_overlap": 0.6246148148650532,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.4101983812019082,
      "val_pk_metric": 0.31926621488522866,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.0537387490272523,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.4853832721710205,
      "train_chorus_rate": 0.3902329206466675,
      "train_max_prob": 0.6857778370380402,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4882544279098511,
      "val_macro_f1": 0.7264393509103013,
      "val_verse_f1": 0.7944936086529006,
      "val_chorus_f1": 0.6583850931677019,
      "val_chorus_rate": 0.45157869160175323,
      "val_max_prob": 0.6954054236412048,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00015383875366923629,
      "epoch_time": 91.27294421195984,
      "val_boundary_f1": 0.3982608695652174,
      "val_boundary_precision": 0.3154269972451791,
      "val_boundary_recall": 0.5400943396226415,
      "val_complete_segments": 0.2969616574232082,
      "val_avg_segment_overlap": 0.6518886327310667,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.42322402584648444,
      "val_pk_metric": 0.3165712236598064,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.080710184574127,
      "cnn_effective_layers": 2
    }
  ]
}