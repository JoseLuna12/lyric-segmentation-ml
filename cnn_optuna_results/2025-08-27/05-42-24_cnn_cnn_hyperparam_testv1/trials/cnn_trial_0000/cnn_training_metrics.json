{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.2733991780504304,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 279042,
      "cnn_params": 262912,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00019594972058679176,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "line_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08826745747934393,
        "ece_after": 0.014045792794649143,
        "improvement": 0.0742216646846948,
        "params": {
          "temperature": 0.6167156723829061
        }
      },
      "platt": {
        "ece_before": 0.08826745747934393,
        "ece_after": 0.02724615803577575,
        "improvement": 0.06102129944356818,
        "params": {
          "A": 1.501391470433065,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5518641001299808,
      "train_chorus_rate": 0.2998970770522168,
      "train_max_prob": 0.5539220916597467,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5589248090982437,
      "val_macro_f1": 0.7149586047686964,
      "val_verse_f1": 0.8045590433482811,
      "val_chorus_f1": 0.6253581661891117,
      "val_chorus_rate": 0.3880586698651314,
      "val_max_prob": 0.5635296553373337,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.0756144330526971e-05,
      "epoch_time": 104.86661696434021,
      "val_boundary_f1": 0.29052969502407705,
      "val_boundary_precision": 0.22019464720194648,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.16233546139868327,
      "val_avg_segment_overlap": 0.6067551919184967,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.3484848484848485,
      "val_window_diff": 0.47401710256056284,
      "val_pk_metric": 0.33907614119207585,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 8.448958572588468,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5267968334649739,
      "train_chorus_rate": 0.40449977391644526,
      "train_max_prob": 0.5934800662492451,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5255920439958572,
      "val_macro_f1": 0.7334835487314846,
      "val_verse_f1": 0.8180462341536168,
      "val_chorus_f1": 0.6489208633093525,
      "val_chorus_rate": 0.38456252217292786,
      "val_max_prob": 0.6243400871753693,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.9329534818134932e-05,
      "epoch_time": 88.68744277954102,
      "val_boundary_f1": 0.3630017452006981,
      "val_boundary_precision": 0.2880886426592798,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2387515162391583,
      "val_avg_segment_overlap": 0.6464887910959639,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4396027694721868,
      "val_pk_metric": 0.3170023807585055,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.4572399854660034,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5138045423909238,
      "train_chorus_rate": 0.4634937424408762,
      "train_max_prob": 0.6475610199727511,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5013227760791779,
      "val_macro_f1": 0.7367410110266641,
      "val_verse_f1": 0.8063701689648475,
      "val_chorus_f1": 0.6671118530884809,
      "val_chorus_rate": 0.4369738921523094,
      "val_max_prob": 0.6703009158372879,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.302616823176431e-05,
      "epoch_time": 83.80428385734558,
      "val_boundary_f1": 0.37792642140468224,
      "val_boundary_precision": 0.2927461139896373,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.29935979762945486,
      "val_avg_segment_overlap": 0.6573929706542753,
      "val_verse_to_chorus_acc": 0.5265486725663717,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.44962722298205066,
      "val_pk_metric": 0.3114707332051471,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.151876600165116,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.49821420249186066,
      "train_chorus_rate": 0.3459217077807376,
      "train_max_prob": 0.6706748636145341,
      "train_conf_over_90": 6.457862419713485e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49872248619794846,
      "val_macro_f1": 0.7460045240596085,
      "val_verse_f1": 0.8154291224686595,
      "val_chorus_f1": 0.6765799256505576,
      "val_chorus_rate": 0.429211288690567,
      "val_max_prob": 0.662998229265213,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.099614742040936e-05,
      "epoch_time": 88.00152397155762,
      "val_boundary_f1": 0.38481449525452976,
      "val_boundary_precision": 0.3034013605442177,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.2778755831005669,
      "val_avg_segment_overlap": 0.6662769058612427,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.42990624414082357,
      "val_pk_metric": 0.31656712330648507,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.4614776623876473,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.49666582126366465,
      "train_chorus_rate": 0.42701263804184764,
      "train_max_prob": 0.6768021740411457,
      "train_conf_over_90": 0.0013806301285512745,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49014734476804733,
      "val_macro_f1": 0.7133925332819981,
      "val_verse_f1": 0.7703339479614834,
      "val_chorus_f1": 0.656451118602513,
      "val_chorus_rate": 0.5027681589126587,
      "val_max_prob": 0.6928601115942001,
      "val_conf_over_90": 0.0002198768634116277,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.212440756085121e-05,
      "epoch_time": 80.24971580505371,
      "val_boundary_f1": 0.35229357798165134,
      "val_boundary_precision": 0.2882882882882883,
      "val_boundary_recall": 0.4528301886792453,
      "val_complete_segments": 0.24809443682376325,
      "val_avg_segment_overlap": 0.6303275025041494,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.44328644947100715,
      "val_pk_metric": 0.343506420028028,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.896798014640808,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.49801264154283625,
      "train_chorus_rate": 0.4155339739824596,
      "train_max_prob": 0.6734126806259155,
      "train_conf_over_90": 0.0007623329875059426,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48543356359004974,
      "val_macro_f1": 0.7515938392410298,
      "val_verse_f1": 0.82339493236807,
      "val_chorus_f1": 0.6797927461139897,
      "val_chorus_rate": 0.41253066807985306,
      "val_max_prob": 0.6883903443813324,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.509990764346481e-05,
      "epoch_time": 82.08982801437378,
      "val_boundary_f1": 0.4104347826086957,
      "val_boundary_precision": 0.325068870523416,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.33305555061988124,
      "val_avg_segment_overlap": 0.6777454929271785,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4186321405636939,
      "val_pk_metric": 0.3041251789943918,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.9267706808290983,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.48064775529660675,
      "train_chorus_rate": 0.4006744591813338,
      "train_max_prob": 0.690380428966723,
      "train_conf_over_90": 0.003403931421129719,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48215366154909134,
      "val_macro_f1": 0.7187876228619436,
      "val_verse_f1": 0.775209654326038,
      "val_chorus_f1": 0.6623655913978495,
      "val_chorus_rate": 0.4995073825120926,
      "val_max_prob": 0.7159363031387329,
      "val_conf_over_90": 0.007595242001116276,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011849698258154972,
      "epoch_time": 81.47826099395752,
      "val_boundary_f1": 0.3483754512635379,
      "val_boundary_precision": 0.2821637426900585,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.24647817622489615,
      "val_avg_segment_overlap": 0.6268558946891157,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.454416627631708,
      "val_pk_metric": 0.33514306020404017,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.87296546132941,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.4651149793675071,
      "train_chorus_rate": 0.384310466678519,
      "train_max_prob": 0.7068751956287184,
      "train_conf_over_90": 0.005812696138347842,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4763404577970505,
      "val_macro_f1": 0.745707521753666,
      "val_verse_f1": 0.8050965558431217,
      "val_chorus_f1": 0.6863184876642102,
      "val_chorus_rate": 0.46712931990623474,
      "val_max_prob": 0.7220154106616974,
      "val_conf_over_90": 0.0056426335067953914,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014086380792078723,
      "epoch_time": 88.47022795677185,
      "val_boundary_f1": 0.4093896713615024,
      "val_boundary_precision": 0.34009360374414976,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.30991558812310915,
      "val_avg_segment_overlap": 0.6574069147561834,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4084067305417942,
      "val_pk_metric": 0.30766699650491935,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.8072502173875507,
      "cnn_effective_layers": 1
    }
  ]
}