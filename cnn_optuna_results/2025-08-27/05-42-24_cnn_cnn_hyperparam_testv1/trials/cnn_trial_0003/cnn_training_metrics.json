{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 3,
      "dropout": 0.3904232161241172,
      "layer_dropout": 0.20440446950124594,
      "kernel_sizes": [
        5,
        7,
        9
      ],
      "dilation_rates": [
        1,
        3,
        9
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 8,
      "total_params": 1876480,
      "cnn_params": 1569789,
      "attention_params": 296705
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0007762566645187931,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "boundary_f1",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.03669689513728286,
        "ece_after": 0.01272488758699833,
        "improvement": 0.02397200755028453,
        "params": {
          "temperature": 0.7853171944723474
        }
      },
      "platt": {
        "ece_before": 0.03669689513728286,
        "ece_after": 0.01505837570473346,
        "improvement": 0.0216385194325494,
        "params": {
          "A": 1.2315451503606045,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.6600013375282288,
      "train_chorus_rate": 0.544980087550357,
      "train_max_prob": 0.6437961608171463,
      "train_conf_over_90": 0.07552638649940491,
      "train_conf_over_95": 0.007262793369591236,
      "val_loss": 0.6337765753269196,
      "val_macro_f1": 0.47290876893177447,
      "val_verse_f1": 0.8081657160012008,
      "val_chorus_f1": 0.13765182186234817,
      "val_chorus_rate": 0.06479985639452934,
      "val_max_prob": 0.6247389018535614,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007630485493901076,
      "epoch_time": 104.52583813667297,
      "val_boundary_f1": 0.025408348457350273,
      "val_boundary_precision": 0.05511811023622047,
      "val_boundary_recall": 0.01650943396226415,
      "val_complete_segments": 0.009966856060606061,
      "val_avg_segment_overlap": 0.2016159663166286,
      "val_verse_to_chorus_acc": 0.022123893805309734,
      "val_chorus_to_verse_acc": 0.0,
      "val_window_diff": 0.33634337806194115,
      "val_pk_metric": 0.348919534412216,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 10.301071997731924,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 2,
      "train_loss": 0.5889268517494202,
      "train_chorus_rate": 0.47743992833420634,
      "train_max_prob": 0.6097973138093948,
      "train_conf_over_90": 0.0002725324302446097,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6543826162815094,
      "val_macro_f1": 0.551840398574067,
      "val_verse_f1": 0.8247863247863249,
      "val_chorus_f1": 0.27889447236180903,
      "val_chorus_rate": 0.09525541961193085,
      "val_max_prob": 0.7367647886276245,
      "val_conf_over_90": 0.006571914767846465,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0007243243152226291,
      "epoch_time": 100.65293288230896,
      "val_boundary_f1": 0.19364599092284415,
      "val_boundary_precision": 0.270042194092827,
      "val_boundary_recall": 0.1509433962264151,
      "val_complete_segments": 0.08667140151515151,
      "val_avg_segment_overlap": 0.3117892918270544,
      "val_verse_to_chorus_acc": 0.21238938053097345,
      "val_chorus_to_verse_acc": 0.050505050505050504,
      "val_window_diff": 0.3400391075721058,
      "val_pk_metric": 0.3040937644232921,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1457.3820385858417,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 3,
      "train_loss": 0.5531631782650948,
      "train_chorus_rate": 0.4278361592441797,
      "train_max_prob": 0.649098701775074,
      "train_conf_over_90": 0.003724374655575957,
      "train_conf_over_95": 3.068237492698245e-05,
      "val_loss": 0.5504849255084991,
      "val_macro_f1": 0.7161709318245514,
      "val_verse_f1": 0.8173094332790151,
      "val_chorus_f1": 0.6150324303700877,
      "val_chorus_rate": 0.3484355956315994,
      "val_max_prob": 0.7522691786289215,
      "val_conf_over_90": 0.1620926484465599,
      "val_conf_over_95": 0.04704310558736324,
      "learning_rate": 0.000662722954580048,
      "epoch_time": 92.6644639968872,
      "val_boundary_f1": 0.3198420533070089,
      "val_boundary_precision": 0.27504244482173174,
      "val_boundary_recall": 0.38207547169811323,
      "val_complete_segments": 0.17161458333333335,
      "val_avg_segment_overlap": 0.6143420065349945,
      "val_verse_to_chorus_acc": 0.26548672566371684,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4226264044992205,
      "val_pk_metric": 0.3323363478760133,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.9269235730171204,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 4,
      "train_loss": 0.5058689750730991,
      "train_chorus_rate": 0.39705998823046684,
      "train_max_prob": 0.6873691082000732,
      "train_conf_over_90": 0.024194105062633753,
      "train_conf_over_95": 0.0007273800274560926,
      "val_loss": 0.5065262317657471,
      "val_macro_f1": 0.7420489441722449,
      "val_verse_f1": 0.8256676557863503,
      "val_chorus_f1": 0.6584302325581396,
      "val_chorus_rate": 0.37991437315940857,
      "val_max_prob": 0.7444990873336792,
      "val_conf_over_90": 0.1282317154109478,
      "val_conf_over_95": 0.014218180906027555,
      "learning_rate": 0.0005824424983890948,
      "epoch_time": 103.07588315010071,
      "val_boundary_f1": 0.3239171374764595,
      "val_boundary_precision": 0.26959247648902823,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.21671401515151517,
      "val_avg_segment_overlap": 0.6504951543872097,
      "val_verse_to_chorus_acc": 0.3053097345132743,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.43383196488810827,
      "val_pk_metric": 0.3242019427040741,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 8821.89870044589,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 5,
      "train_loss": 0.5063990242779255,
      "train_chorus_rate": 0.46804917603731155,
      "train_max_prob": 0.6888454332947731,
      "train_conf_over_90": 0.018488845438696444,
      "train_conf_over_95": 3.187962283845991e-05,
      "val_loss": 0.4870307594537735,
      "val_macro_f1": 0.7694865569043942,
      "val_verse_f1": 0.8475509080902587,
      "val_chorus_f1": 0.6914222057185296,
      "val_chorus_rate": 0.36207185685634613,
      "val_max_prob": 0.7503631711006165,
      "val_conf_over_90": 0.17733407020568848,
      "val_conf_over_95": 0.025851727463304996,
      "learning_rate": 0.0004889539270694562,
      "epoch_time": 78.56384491920471,
      "val_boundary_f1": 0.38348623853211006,
      "val_boundary_precision": 0.3138138138138138,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2479876893939394,
      "val_avg_segment_overlap": 0.6762409538775545,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4133576871822018,
      "val_pk_metric": 0.2836708052600273,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.583570584654808,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 6,
      "train_loss": 0.46877459436655045,
      "train_chorus_rate": 0.36856046319007874,
      "train_max_prob": 0.7300814315676689,
      "train_conf_over_90": 0.08230285393074155,
      "train_conf_over_95": 0.002224352676421404,
      "val_loss": 0.4833967089653015,
      "val_macro_f1": 0.7874134389420915,
      "val_verse_f1": 0.8703180212014134,
      "val_chorus_f1": 0.7045088566827696,
      "val_chorus_rate": 0.30826713144779205,
      "val_max_prob": 0.7273835837841034,
      "val_conf_over_90": 0.08762732893228531,
      "val_conf_over_95": 0.0008846425916999578,
      "learning_rate": 0.00038862833225939656,
      "epoch_time": 96.11963987350464,
      "val_boundary_f1": 0.4231499051233396,
      "val_boundary_precision": 0.353968253968254,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.30648674242424245,
      "val_avg_segment_overlap": 0.6925909797282854,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.37736390400144704,
      "val_pk_metric": 0.2543932536844313,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 8946.885951969773,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 7,
      "train_loss": 0.500928308814764,
      "train_chorus_rate": 0.258206021040678,
      "train_max_prob": 0.6870292350649834,
      "train_conf_over_90": 0.0032681787706678733,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48848819732666016,
      "val_macro_f1": 0.7005639883348707,
      "val_verse_f1": 0.7507886435331229,
      "val_chorus_f1": 0.6503393331366185,
      "val_chorus_rate": 0.5300852358341217,
      "val_max_prob": 0.7195137143135071,
      "val_conf_over_90": 0.03236343618482351,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00028830273744933694,
      "epoch_time": 105.22110104560852,
      "val_boundary_f1": 0.32195121951219513,
      "val_boundary_precision": 0.27454242928452577,
      "val_boundary_recall": 0.3891509433962264,
      "val_complete_segments": 0.2162878787878788,
      "val_avg_segment_overlap": 0.5926271825295675,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.44477104378309085,
      "val_pk_metric": 0.34860237176513453,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 13280.972096651793,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 8,
      "train_loss": 0.49646732583642006,
      "train_chorus_rate": 0.4640101343393326,
      "train_max_prob": 0.6817334294319153,
      "train_conf_over_90": 0.007628333230968565,
      "train_conf_over_95": 3.0069761123741046e-05,
      "val_loss": 0.4694261848926544,
      "val_macro_f1": 0.780151563363342,
      "val_verse_f1": 0.8522285925651932,
      "val_chorus_f1": 0.7080745341614908,
      "val_chorus_rate": 0.37277334928512573,
      "val_max_prob": 0.7665698230266571,
      "val_conf_over_90": 0.17019671201705933,
      "val_conf_over_95": 0.0007077140617184341,
      "learning_rate": 0.00019481416612969834,
      "epoch_time": 92.31655812263489,
      "val_boundary_f1": 0.428193832599119,
      "val_boundary_precision": 0.34177215189873417,
      "val_boundary_recall": 0.5731132075471698,
      "val_complete_segments": 0.35459280303030305,
      "val_avg_segment_overlap": 0.7060395503560478,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.5707070707070707,
      "val_window_diff": 0.4111999809028757,
      "val_pk_metric": 0.2787381756980315,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4349.412430934608,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 9,
      "train_loss": 0.4793800301849842,
      "train_chorus_rate": 0.3784819506108761,
      "train_max_prob": 0.7097877785563469,
      "train_conf_over_90": 0.022158773033879697,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48703326284885406,
      "val_macro_f1": 0.6905136533310476,
      "val_verse_f1": 0.7392319117335031,
      "val_chorus_f1": 0.6417953949285922,
      "val_chorus_rate": 0.5429007411003113,
      "val_max_prob": 0.7277881503105164,
      "val_conf_over_90": 0.14452560991048813,
      "val_conf_over_95": 0.008802691008895636,
      "learning_rate": 0.00011453370993874512,
      "epoch_time": 82.43349480628967,
      "val_boundary_f1": 0.26379310344827583,
      "val_boundary_precision": 0.2078804347826087,
      "val_boundary_recall": 0.3608490566037736,
      "val_complete_segments": 0.15385890151515152,
      "val_avg_segment_overlap": 0.5825989277411129,
      "val_verse_to_chorus_acc": 0.25663716814159293,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.48426577560707823,
      "val_pk_metric": 0.3613088983303638,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0288919135928154,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 10,
      "train_loss": 0.46845266222953796,
      "train_chorus_rate": 0.4322379119694233,
      "train_max_prob": 0.7231630682945251,
      "train_conf_over_90": 0.05295969033613801,
      "train_conf_over_95": 0.00044519255970953964,
      "val_loss": 0.46773311495780945,
      "val_macro_f1": 0.7815512687407893,
      "val_verse_f1": 0.8512381307019177,
      "val_chorus_f1": 0.711864406779661,
      "val_chorus_rate": 0.3829568177461624,
      "val_max_prob": 0.769182562828064,
      "val_conf_over_90": 0.22553729265928268,
      "val_conf_over_95": 0.00514370680321008,
      "learning_rate": 5.293234929616408e-05,
      "epoch_time": 79.9809501171112,
      "val_boundary_f1": 0.4543828264758497,
      "val_boundary_precision": 0.3659942363112392,
      "val_boundary_recall": 0.5990566037735849,
      "val_complete_segments": 0.3749763257575758,
      "val_avg_segment_overlap": 0.7128145731709421,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.6161616161616161,
      "val_window_diff": 0.41444899743372066,
      "val_pk_metric": 0.27958415715944074,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.1635520085692406,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 11,
      "train_loss": 0.4660678170621395,
      "train_chorus_rate": 0.3323187977075577,
      "train_max_prob": 0.7329207807779312,
      "train_conf_over_90": 0.04008600837551057,
      "train_conf_over_95": 0.00019223983690608293,
      "val_loss": 0.46203479170799255,
      "val_macro_f1": 0.765876141804781,
      "val_verse_f1": 0.8299267258002314,
      "val_chorus_f1": 0.7018255578093306,
      "val_chorus_rate": 0.4280281513929367,
      "val_max_prob": 0.7489758729934692,
      "val_conf_over_90": 0.1524527445435524,
      "val_conf_over_95": 0.0019115664181299508,
      "learning_rate": 1.4208115128685468e-05,
      "epoch_time": 85.13677406311035,
      "val_boundary_f1": 0.41361256544502617,
      "val_boundary_precision": 0.32825484764542934,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.3277225378787879,
      "val_avg_segment_overlap": 0.6938431673478589,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.42990884951573033,
      "val_pk_metric": 0.30490554460301966,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8675630539655685,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 12,
      "train_loss": 0.4600710980594158,
      "train_chorus_rate": 0.3589517008513212,
      "train_max_prob": 0.7155645117163658,
      "train_conf_over_90": 0.023874284350313246,
      "train_conf_over_95": 3.486750210868195e-05,
      "val_loss": 0.4622303694486618,
      "val_macro_f1": 0.7604665712918303,
      "val_verse_f1": 0.8215264187866929,
      "val_chorus_f1": 0.6994067237969677,
      "val_chorus_rate": 0.44708360731601715,
      "val_max_prob": 0.7395114898681641,
      "val_conf_over_90": 0.13095493614673615,
      "val_conf_over_95": 0.0013333538081496954,
      "learning_rate": 1e-06,
      "epoch_time": 99.57838106155396,
      "val_boundary_f1": 0.4034934497816594,
      "val_boundary_precision": 0.32038834951456313,
      "val_boundary_recall": 0.5448113207547169,
      "val_complete_segments": 0.30688920454545454,
      "val_avg_segment_overlap": 0.6837243277223881,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4266507186882204,
      "val_pk_metric": 0.3055388014818553,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7481275089085102,
      "cnn_effective_layers": 3
    }
  ]
}