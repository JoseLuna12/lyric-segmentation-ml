{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.26887165208110214,
      "layer_dropout": 0.16405224653738584,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "self",
      "attention_heads": 8,
      "total_params": 330366,
      "cnn_params": 259068,
      "attention_params": 66304
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0003201247488417565,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "line_f1",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.07706463806814201,
        "ece_after": 0.009934400850522742,
        "improvement": 0.06713023721761927,
        "params": {
          "temperature": 0.6424261004964882
        }
      },
      "platt": {
        "ece_before": 0.07706463806814201,
        "ece_after": 0.009896387724838942,
        "improvement": 0.06716825034330307,
        "params": {
          "A": 1.5145459039965576,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5443124870459238,
      "train_chorus_rate": 0.4353489900628726,
      "train_max_prob": 0.6317549016740587,
      "train_conf_over_90": 0.000459605420473963,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5200085937976837,
      "val_macro_f1": 0.7084533452886707,
      "val_verse_f1": 0.7922944878886133,
      "val_chorus_f1": 0.624612202688728,
      "val_chorus_rate": 0.4128245711326599,
      "val_max_prob": 0.6914557218551636,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00031663792812804944,
      "epoch_time": 278.91978693008423,
      "val_boundary_f1": 0.30337078651685395,
      "val_boundary_precision": 0.22992700729927007,
      "val_boundary_recall": 0.44575471698113206,
      "val_complete_segments": 0.2126385336743393,
      "val_avg_segment_overlap": 0.6021029732127114,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.49445365704267774,
      "val_pk_metric": 0.3539684538985005,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 6.564035945468479,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.513316316737069,
      "train_chorus_rate": 0.4681234227286445,
      "train_max_prob": 0.6631301972601149,
      "train_conf_over_90": 0.0009901231290617336,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5018971562385559,
      "val_macro_f1": 0.6983572961931894,
      "val_verse_f1": 0.7710271126063725,
      "val_chorus_f1": 0.6256874797800064,
      "val_chorus_rate": 0.45877449214458466,
      "val_max_prob": 0.6874059736728668,
      "val_conf_over_90": 0.0003937007859349251,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00030632985678373943,
      "epoch_time": 130.5787546634674,
      "val_boundary_f1": 0.314878892733564,
      "val_boundary_precision": 0.24863387978142076,
      "val_boundary_recall": 0.42924528301886794,
      "val_complete_segments": 0.23201193520886615,
      "val_avg_segment_overlap": 0.618437586940326,
      "val_verse_to_chorus_acc": 0.37610619469026546,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4785783219931007,
      "val_pk_metric": 0.3543418423767085,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8720810347133212,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.49988270468182033,
      "train_chorus_rate": 0.43678487671746147,
      "train_max_prob": 0.6774729556507535,
      "train_conf_over_90": 0.0010836466422511472,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5021389722824097,
      "val_macro_f1": 0.6684851851693635,
      "val_verse_f1": 0.7218108737042523,
      "val_chorus_f1": 0.6151594966344747,
      "val_chorus_rate": 0.5431528985500336,
      "val_max_prob": 0.6983365714550018,
      "val_conf_over_90": 0.004449949599802494,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002896510469901871,
      "epoch_time": 102.28707695007324,
      "val_boundary_f1": 0.23148148148148148,
      "val_boundary_precision": 0.19054878048780488,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.11511082693947144,
      "val_avg_segment_overlap": 0.5495694394859887,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.48308226393668807,
      "val_pk_metric": 0.3733759283968511,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0593776106834412,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4948900308873918,
      "train_chorus_rate": 0.44339558482170105,
      "train_max_prob": 0.691835986243354,
      "train_conf_over_90": 0.008561913279764768,
      "train_conf_over_95": 3.0642886283910935e-05,
      "val_loss": 0.5095105320215225,
      "val_macro_f1": 0.664998660578848,
      "val_verse_f1": 0.713949003642597,
      "val_chorus_f1": 0.6160483175150993,
      "val_chorus_rate": 0.5558705627918243,
      "val_max_prob": 0.7385462820529938,
      "val_conf_over_90": 0.06259431317448616,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00026733044276917964,
      "epoch_time": 108.09734916687012,
      "val_boundary_f1": 0.24007744433688283,
      "val_boundary_precision": 0.20361247947454844,
      "val_boundary_recall": 0.29245283018867924,
      "val_complete_segments": 0.1170076726342711,
      "val_avg_segment_overlap": 0.5422407478150525,
      "val_verse_to_chorus_acc": 0.24336283185840707,
      "val_chorus_to_verse_acc": 0.31313131313131315,
      "val_window_diff": 0.47527960723917495,
      "val_pk_metric": 0.3770792223687197,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.7469343543052673,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4855790568722619,
      "train_chorus_rate": 0.3664011326101091,
      "train_max_prob": 0.7027598155869378,
      "train_conf_over_90": 0.010008714135943187,
      "train_conf_over_95": 3.71112611093041e-05,
      "val_loss": 0.4788888990879059,
      "val_macro_f1": 0.7385183977282908,
      "val_verse_f1": 0.813585193665331,
      "val_chorus_f1": 0.6634516017912505,
      "val_chorus_rate": 0.4117935448884964,
      "val_max_prob": 0.7094632685184479,
      "val_conf_over_90": 0.022389547899365425,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002403435616313173,
      "epoch_time": 122.09520411491394,
      "val_boundary_f1": 0.34760273972602734,
      "val_boundary_precision": 0.2728494623655914,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.2720161977834612,
      "val_avg_segment_overlap": 0.6411735868538105,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.45964496984468195,
      "val_pk_metric": 0.31551068051711206,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 139.23004670275583,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4657140009933048,
      "train_chorus_rate": 0.4207318855656518,
      "train_max_prob": 0.7004045380486382,
      "train_conf_over_90": 0.014259818527433608,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47485946118831635,
      "val_macro_f1": 0.757572293704262,
      "val_verse_f1": 0.8296099962135555,
      "val_chorus_f1": 0.6855345911949686,
      "val_chorus_rate": 0.4032045900821686,
      "val_max_prob": 0.7268969416618347,
      "val_conf_over_90": 0.025130034424364567,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000209869859779748,
      "epoch_time": 69.39460015296936,
      "val_boundary_f1": 0.3336439888164026,
      "val_boundary_precision": 0.275808936825886,
      "val_boundary_recall": 0.4221698113207547,
      "val_complete_segments": 0.22811167945439045,
      "val_avg_segment_overlap": 0.6469107329248149,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4515307045473639,
      "val_pk_metric": 0.30830230703437034,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 138.51149949100284,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.47481931580437553,
      "train_chorus_rate": 0.3757313589255015,
      "train_max_prob": 0.6979743970765008,
      "train_conf_over_90": 0.013060521023968855,
      "train_conf_over_95": 6.200844331437515e-05,
      "val_loss": 0.4745946228504181,
      "val_macro_f1": 0.7646128162377712,
      "val_verse_f1": 0.8438074237412715,
      "val_chorus_f1": 0.6854182087342708,
      "val_chorus_rate": 0.3599221855401993,
      "val_max_prob": 0.6989233493804932,
      "val_conf_over_90": 0.011070393258705735,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017724118421443057,
      "epoch_time": 73.6768639087677,
      "val_boundary_f1": 0.38554216867469876,
      "val_boundary_precision": 0.31755725190839695,
      "val_boundary_recall": 0.49056603773584906,
      "val_complete_segments": 0.2978687127024723,
      "val_avg_segment_overlap": 0.6594674547074326,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.39827448099489715,
      "val_pk_metric": 0.270797456563043,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9199425180753072,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.46712157130241394,
      "train_chorus_rate": 0.35979315638542175,
      "train_max_prob": 0.7068888015217252,
      "train_conf_over_90": 0.015901347596405283,
      "train_conf_over_95": 9.345652910673784e-05,
      "val_loss": 0.476571723818779,
      "val_macro_f1": 0.7412120046371626,
      "val_verse_f1": 0.8106119287374127,
      "val_chorus_f1": 0.6718120805369127,
      "val_chorus_rate": 0.431095689535141,
      "val_max_prob": 0.7384838461875916,
      "val_conf_over_90": 0.062237102538347244,
      "val_conf_over_95": 0.0008495919173583388,
      "learning_rate": 0.0001438835646273259,
      "epoch_time": 81.38168931007385,
      "val_boundary_f1": 0.3263825929283772,
      "val_boundary_precision": 0.2650957290132548,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.218307757885763,
      "val_avg_segment_overlap": 0.6263902264755333,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4527842167438464,
      "val_pk_metric": 0.3249430367830558,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 138.59553207622633,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4561082621415456,
      "train_chorus_rate": 0.3860945436689589,
      "train_max_prob": 0.706799156135983,
      "train_conf_over_90": 0.02156350916872422,
      "train_conf_over_95": 0.00039437456548006996,
      "val_loss": 0.4679979234933853,
      "val_macro_f1": 0.7601881241382948,
      "val_verse_f1": 0.831154064809551,
      "val_chorus_f1": 0.6892221834670387,
      "val_chorus_rate": 0.40509548783302307,
      "val_max_prob": 0.7146329581737518,
      "val_conf_over_90": 0.024611953645944595,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011125488906200846,
      "epoch_time": 75.75746989250183,
      "val_boundary_f1": 0.3536345776031435,
      "val_boundary_precision": 0.30303030303030304,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.21786018755328218,
      "val_avg_segment_overlap": 0.6389610922023046,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.4025950350316323,
      "val_pk_metric": 0.29121397802193577,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 23.26653116941452,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.45974189043045044,
      "train_chorus_rate": 0.37833573420842487,
      "train_max_prob": 0.7105219562848409,
      "train_conf_over_90": 0.021622022406922445,
      "train_conf_over_95": 0.00035600199286515516,
      "val_loss": 0.4643546938896179,
      "val_macro_f1": 0.7690463287916323,
      "val_verse_f1": 0.8430059523809523,
      "val_chorus_f1": 0.6950867052023121,
      "val_chorus_rate": 0.3780951350927353,
      "val_max_prob": 0.7244773209095001,
      "val_conf_over_90": 0.04306449368596077,
      "val_conf_over_95": 0.0003937007859349251,
      "learning_rate": 8.078118721043915e-05,
      "epoch_time": 76.62359809875488,
      "val_boundary_f1": 0.36779505946935037,
      "val_boundary_precision": 0.3004484304932735,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2685635123614663,
      "val_avg_segment_overlap": 0.6586471125882909,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.40907799877157625,
      "val_pk_metric": 0.28226632363663545,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9468774563736386,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.46578924854596454,
      "train_chorus_rate": 0.3637193805641598,
      "train_max_prob": 0.7022003531455994,
      "train_conf_over_90": 0.021235808833605714,
      "train_conf_over_95": 0.00036483574270581204,
      "val_loss": 0.46950775384902954,
      "val_macro_f1": 0.7323652536512187,
      "val_verse_f1": 0.7976307996051332,
      "val_chorus_f1": 0.6670997076973043,
      "val_chorus_rate": 0.4566713273525238,
      "val_max_prob": 0.7254444658756256,
      "val_conf_over_90": 0.06675952300429344,
      "val_conf_over_95": 0.0007200715481303632,
      "learning_rate": 5.379430607257686e-05,
      "epoch_time": 82.16201615333557,
      "val_boundary_f1": 0.30924062214089665,
      "val_boundary_precision": 0.2526158445440957,
      "val_boundary_recall": 0.39858490566037735,
      "val_complete_segments": 0.20716112531969308,
      "val_avg_segment_overlap": 0.6169681513803628,
      "val_verse_to_chorus_acc": 0.4026548672566372,
      "val_chorus_to_verse_acc": 0.35858585858585856,
      "val_window_diff": 0.4566600572580097,
      "val_pk_metric": 0.3233322737918416,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.3407222893502977,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.4537639982170529,
      "train_chorus_rate": 0.386861115694046,
      "train_max_prob": 0.7094580994711982,
      "train_conf_over_90": 0.026193350553512573,
      "train_conf_over_95": 0.0008271437804473357,
      "val_loss": 0.46293048560619354,
      "val_macro_f1": 0.7758488975173834,
      "val_verse_f1": 0.8472998137802608,
      "val_chorus_f1": 0.704397981254506,
      "val_chorus_rate": 0.381089523434639,
      "val_max_prob": 0.7210193276405334,
      "val_conf_over_90": 0.03522131498903036,
      "val_conf_over_95": 0.00019685039296746254,
      "learning_rate": 3.147370185156934e-05,
      "epoch_time": 84.18359708786011,
      "val_boundary_f1": 0.40233236151603496,
      "val_boundary_precision": 0.3421487603305785,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.28616794543904517,
      "val_avg_segment_overlap": 0.6663350927142659,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.38362336618082027,
      "val_pk_metric": 0.2758062273487124,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 161.31575469175974,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.46412302056948346,
      "train_chorus_rate": 0.3322659962707096,
      "train_max_prob": 0.6977413098017374,
      "train_conf_over_90": 0.014931272611849837,
      "train_conf_over_95": 0.00023207705170433555,
      "val_loss": 0.4624982178211212,
      "val_macro_f1": 0.7621895375793768,
      "val_verse_f1": 0.8327968187843211,
      "val_chorus_f1": 0.6915822563744324,
      "val_chorus_rate": 0.4023652970790863,
      "val_max_prob": 0.7129729092121124,
      "val_conf_over_90": 0.04679951071739197,
      "val_conf_over_95": 0.0010464423103258014,
      "learning_rate": 1.4794892058016979e-05,
      "epoch_time": 60.39863920211792,
      "val_boundary_f1": 0.3457013574660634,
      "val_boundary_precision": 0.28046989720998533,
      "val_boundary_recall": 0.45047169811320753,
      "val_complete_segments": 0.22811167945439045,
      "val_avg_segment_overlap": 0.6475090671242271,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.419241374908075,
      "val_pk_metric": 0.298051464154808,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 138.71853005886078,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.45280065801408553,
      "train_chorus_rate": 0.3800281584262848,
      "train_max_prob": 0.705384009414249,
      "train_conf_over_90": 0.02513570214311282,
      "train_conf_over_95": 0.0005293129781623267,
      "val_loss": 0.46252284944057465,
      "val_macro_f1": 0.7594021610968872,
      "val_verse_f1": 0.8288871951219512,
      "val_chorus_f1": 0.6899171270718232,
      "val_chorus_rate": 0.4108041524887085,
      "val_max_prob": 0.7297482490539551,
      "val_conf_over_90": 0.06537643074989319,
      "val_conf_over_95": 0.0013728130143135786,
      "learning_rate": 4.486820713707022e-06,
      "epoch_time": 83.16529512405396,
      "val_boundary_f1": 0.35959221501390176,
      "val_boundary_precision": 0.2961832061068702,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.24226342710997442,
      "val_avg_segment_overlap": 0.6545360017141362,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4210949867441651,
      "val_pk_metric": 0.2968486658569376,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0984317792786493,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.4472103946738773,
      "train_chorus_rate": 0.37624548541174996,
      "train_max_prob": 0.7159987555609809,
      "train_conf_over_90": 0.03116301281584634,
      "train_conf_over_95": 0.0008904449706379739,
      "val_loss": 0.4627179652452469,
      "val_macro_f1": 0.7600259462196042,
      "val_verse_f1": 0.8300380228136882,
      "val_chorus_f1": 0.6900138696255201,
      "val_chorus_rate": 0.4074057936668396,
      "val_max_prob": 0.734047919511795,
      "val_conf_over_90": 0.06930829957127571,
      "val_conf_over_95": 0.0015696634072810411,
      "learning_rate": 1e-06,
      "epoch_time": 119.44585967063904,
      "val_boundary_f1": 0.35992578849721707,
      "val_boundary_precision": 0.2966360856269113,
      "val_boundary_recall": 0.45754716981132076,
      "val_complete_segments": 0.24281756180733163,
      "val_avg_segment_overlap": 0.6533160750544187,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.4204481130921233,
      "val_pk_metric": 0.2955443700134481,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 137.4868364267879,
      "cnn_effective_layers": 2
    }
  ]
}