{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 3,
      "dropout": 0.3594409267507096,
      "layer_dropout": 0.19563362070328197,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        3,
        9
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 8,
      "total_params": 371453,
      "cnn_params": 291834,
      "attention_params": 74625
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00019487290213568488,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "line_f1",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.0500260750033064,
        "ece_after": 0.01828513047081549,
        "improvement": 0.031740944532490906,
        "params": {
          "temperature": 0.7194229359775246
        }
      },
      "platt": {
        "ece_before": 0.0500260750033064,
        "ece_after": 0.01876449419555122,
        "improvement": 0.03126158080775518,
        "params": {
          "A": 1.3587763931947898,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5602119565010071,
      "train_chorus_rate": 0.4171425011008978,
      "train_max_prob": 0.6036568954586983,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5537930279970169,
      "val_macro_f1": 0.6671029370335202,
      "val_verse_f1": 0.746730083234245,
      "val_chorus_f1": 0.5874757908327953,
      "val_chorus_rate": 0.4717046841979027,
      "val_max_prob": 0.6932679414749146,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019275460810350248,
      "epoch_time": 44.69289708137512,
      "val_boundary_f1": 0.2585700293829579,
      "val_boundary_precision": 0.22110552763819097,
      "val_boundary_recall": 0.3113207547169811,
      "val_complete_segments": 0.0919291459446184,
      "val_avg_segment_overlap": 0.5186297207033926,
      "val_verse_to_chorus_acc": 0.19911504424778761,
      "val_chorus_to_verse_acc": 0.398989898989899,
      "val_window_diff": 0.4545191921610048,
      "val_pk_metric": 0.33799934237090357,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.926920771598816,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 2,
      "train_loss": 0.5245649013668299,
      "train_chorus_rate": 0.3955781161785126,
      "train_max_prob": 0.6608888171613216,
      "train_conf_over_90": 0.00015800451183167752,
      "train_conf_over_95": 0.0,
      "val_loss": 0.515125572681427,
      "val_macro_f1": 0.7279161840542685,
      "val_verse_f1": 0.803688052247407,
      "val_chorus_f1": 0.65214431586113,
      "val_chorus_rate": 0.440295547246933,
      "val_max_prob": 0.6908624172210693,
      "val_conf_over_90": 0.002704006401472725,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00018649230562086414,
      "epoch_time": 35.6778359413147,
      "val_boundary_f1": 0.3690165361183638,
      "val_boundary_precision": 0.2924137931034483,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.2121784245103457,
      "val_avg_segment_overlap": 0.6136890904270611,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.46587570412740414,
      "val_pk_metric": 0.33025168111732306,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.5543105565011501,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 3,
      "train_loss": 0.5161058474332094,
      "train_chorus_rate": 0.4302645307034254,
      "train_max_prob": 0.6679426245391369,
      "train_conf_over_90": 0.001706983970507281,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5236313492059708,
      "val_macro_f1": 0.7164590460663434,
      "val_verse_f1": 0.7808685211126676,
      "val_chorus_f1": 0.652049571020019,
      "val_chorus_rate": 0.49041853100061417,
      "val_max_prob": 0.7635655105113983,
      "val_conf_over_90": 0.14874577708542347,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001763596873561225,
      "epoch_time": 32.95299482345581,
      "val_boundary_f1": 0.33481745325022266,
      "val_boundary_precision": 0.26895565092989987,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.16769509424694543,
      "val_avg_segment_overlap": 0.6093439021701644,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.4523915616612315,
      "val_pk_metric": 0.32547375449224925,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.96138109639287,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 4,
      "train_loss": 0.4978292379528284,
      "train_chorus_rate": 0.4037485010921955,
      "train_max_prob": 0.6937890127301216,
      "train_conf_over_90": 0.004792433508555405,
      "train_conf_over_95": 0.0,
      "val_loss": 0.515644259750843,
      "val_macro_f1": 0.719679336091821,
      "val_verse_f1": 0.7797775530839232,
      "val_chorus_f1": 0.6595811190997187,
      "val_chorus_rate": 0.5073992237448692,
      "val_max_prob": 0.7689937949180603,
      "val_conf_over_90": 0.20506591722369194,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016279959734914363,
      "epoch_time": 37.204407930374146,
      "val_boundary_f1": 0.36576576576576575,
      "val_boundary_precision": 0.29591836734693877,
      "val_boundary_recall": 0.47877358490566035,
      "val_complete_segments": 0.24566985939706515,
      "val_avg_segment_overlap": 0.6092884661142982,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4743128119823381,
      "val_pk_metric": 0.3194886486981174,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.156502053141594,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 5,
      "train_loss": 0.504943372681737,
      "train_chorus_rate": 0.42428382113575935,
      "train_max_prob": 0.69915921241045,
      "train_conf_over_90": 0.009410566883161664,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49157852679491043,
      "val_macro_f1": 0.7235573659198915,
      "val_verse_f1": 0.7804480651731162,
      "val_chorus_f1": 0.6666666666666667,
      "val_chorus_rate": 0.5157537385821342,
      "val_max_prob": 0.7249703705310822,
      "val_conf_over_90": 0.09131712466478348,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014640467660176365,
      "epoch_time": 30.5555100440979,
      "val_boundary_f1": 0.3041237113402062,
      "val_boundary_precision": 0.2391891891891892,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.14108644931540493,
      "val_avg_segment_overlap": 0.5916159896709601,
      "val_verse_to_chorus_acc": 0.3230088495575221,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.5251524892836884,
      "val_pk_metric": 0.3692708923568866,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.5980328395962715,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 6,
      "train_loss": 0.4911099448800087,
      "train_chorus_rate": 0.4108559098094702,
      "train_max_prob": 0.6981045417487621,
      "train_conf_over_90": 0.013722263596719131,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47882799059152603,
      "val_macro_f1": 0.7509445414793068,
      "val_verse_f1": 0.8145539906103286,
      "val_chorus_f1": 0.6873350923482849,
      "val_chorus_rate": 0.4587515518069267,
      "val_max_prob": 0.7228545695543289,
      "val_conf_over_90": 0.09150861576199532,
      "val_conf_over_95": 0.0010309278732165694,
      "learning_rate": 0.00012789146182220126,
      "epoch_time": 28.73249101638794,
      "val_boundary_f1": 0.3585526315789474,
      "val_boundary_precision": 0.27525252525252525,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.20402007736231348,
      "val_avg_segment_overlap": 0.6358747117720935,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.5288615157779588,
      "val_pk_metric": 0.36257407781271034,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.9926206581294537,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 7,
      "train_loss": 0.4827397018671036,
      "train_chorus_rate": 0.3892923519015312,
      "train_max_prob": 0.7071611173450947,
      "train_conf_over_90": 0.01874514456721954,
      "train_conf_over_95": 0.00010962011401716154,
      "val_loss": 0.5011144503951073,
      "val_macro_f1": 0.742669743487872,
      "val_verse_f1": 0.8066863323500492,
      "val_chorus_f1": 0.6786531546256946,
      "val_chorus_rate": 0.4649116173386574,
      "val_max_prob": 0.7813564240932465,
      "val_conf_over_90": 0.25305699557065964,
      "val_conf_over_95": 0.002823563088895753,
      "learning_rate": 0.00010806906933258409,
      "epoch_time": 27.92856764793396,
      "val_boundary_f1": 0.4065934065934066,
      "val_boundary_precision": 0.3323353293413174,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.2805519739669675,
      "val_avg_segment_overlap": 0.6385545185304677,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4662545962730469,
      "val_pk_metric": 0.3102875610659388,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.3129122480750084,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 8,
      "train_loss": 0.473870811983943,
      "train_chorus_rate": 0.3722242098301649,
      "train_max_prob": 0.7085878737270832,
      "train_conf_over_90": 0.013727494748309255,
      "train_conf_over_95": 3.1533803849015385e-05,
      "val_loss": 0.48189812153577805,
      "val_macro_f1": 0.7493451907921163,
      "val_verse_f1": 0.81194733739438,
      "val_chorus_f1": 0.6867430441898527,
      "val_chorus_rate": 0.4583384469151497,
      "val_max_prob": 0.7467869222164154,
      "val_conf_over_90": 0.13776088505983353,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.78038328031008e-05,
      "epoch_time": 32.39607810974121,
      "val_boundary_f1": 0.38634321653189574,
      "val_boundary_precision": 0.31204644412191584,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.27360625038374164,
      "val_avg_segment_overlap": 0.6431011928096276,
      "val_verse_to_chorus_acc": 0.4557522123893805,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.49683824710724944,
      "val_pk_metric": 0.35070038889066835,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.286242336034775,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 9,
      "train_loss": 0.4775068461894989,
      "train_chorus_rate": 0.3849917147308588,
      "train_max_prob": 0.7171402983367443,
      "train_conf_over_90": 0.02001220273086801,
      "train_conf_over_95": 0.00017853849567472935,
      "val_loss": 0.470972903072834,
      "val_macro_f1": 0.7759750865080002,
      "val_verse_f1": 0.8498614958448754,
      "val_chorus_f1": 0.702088677171125,
      "val_chorus_rate": 0.3728734850883484,
      "val_max_prob": 0.7478316873311996,
      "val_conf_over_90": 0.12352745421230793,
      "val_conf_over_95": 0.002667847365955822,
      "learning_rate": 6.798144031348362e-05,
      "epoch_time": 28.171751260757446,
      "val_boundary_f1": 0.4354838709677419,
      "val_boundary_precision": 0.3511560693641618,
      "val_boundary_recall": 0.5731132075471698,
      "val_complete_segments": 0.3084499907902008,
      "val_avg_segment_overlap": 0.6796412232461452,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.5808080808080808,
      "val_window_diff": 0.4821459697841649,
      "val_pk_metric": 0.29137514381394036,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.39384688436985,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 10,
      "train_loss": 0.48332108929753304,
      "train_chorus_rate": 0.41845861822366714,
      "train_max_prob": 0.7107998393476009,
      "train_conf_over_90": 0.020248427928891033,
      "train_conf_over_95": 0.0003217394041712396,
      "val_loss": 0.47990697622299194,
      "val_macro_f1": 0.7429008436258,
      "val_verse_f1": 0.8023139836425295,
      "val_chorus_f1": 0.6834877036090705,
      "val_chorus_rate": 0.48177626729011536,
      "val_max_prob": 0.7403360903263092,
      "val_conf_over_90": 0.13352093286812305,
      "val_conf_over_95": 0.0037313691718736663,
      "learning_rate": 4.946822553392124e-05,
      "epoch_time": 33.771748065948486,
      "val_boundary_f1": 0.35387323943661975,
      "val_boundary_precision": 0.28230337078651685,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.23576165039602137,
      "val_avg_segment_overlap": 0.6279644850232955,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4899446392524826,
      "val_pk_metric": 0.3525310432729236,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.5953513868153095,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 11,
      "train_loss": 0.4746565166860819,
      "train_chorus_rate": 0.37675674352794886,
      "train_max_prob": 0.7137730717658997,
      "train_conf_over_90": 0.018908457830548286,
      "train_conf_over_95": 0.00017590809875400737,
      "val_loss": 0.48854921758174896,
      "val_macro_f1": 0.7290851589273064,
      "val_verse_f1": 0.7845056065239552,
      "val_chorus_f1": 0.6736647113306575,
      "val_chorus_rate": 0.520733617246151,
      "val_max_prob": 0.74551060795784,
      "val_conf_over_90": 0.12929083593189716,
      "val_conf_over_95": 0.004943352483678609,
      "learning_rate": 3.307330478654127e-05,
      "epoch_time": 28.63062071800232,
      "val_boundary_f1": 0.35188509874326745,
      "val_boundary_precision": 0.28405797101449276,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.22452569533984157,
      "val_avg_segment_overlap": 0.6122937523540198,
      "val_verse_to_chorus_acc": 0.42035398230088494,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4972922439741499,
      "val_pk_metric": 0.34330775567125127,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.1362199746072292,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 12,
      "train_loss": 0.4811571892350912,
      "train_chorus_rate": 0.3922529015690088,
      "train_max_prob": 0.7139877863228321,
      "train_conf_over_90": 0.021760567207820714,
      "train_conf_over_95": 0.0002073139876301866,
      "val_loss": 0.4831051677465439,
      "val_macro_f1": 0.7343278663198711,
      "val_verse_f1": 0.7907636216325703,
      "val_chorus_f1": 0.6778921110071718,
      "val_chorus_rate": 0.5091973096132278,
      "val_max_prob": 0.7424541115760803,
      "val_conf_over_90": 0.1245136484503746,
      "val_conf_over_95": 0.006082893116399646,
      "learning_rate": 1.9513214779562395e-05,
      "epoch_time": 29.76013684272766,
      "val_boundary_f1": 0.3536693191865606,
      "val_boundary_precision": 0.2828854314002829,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.24126450543378153,
      "val_avg_segment_overlap": 0.6151701057772738,
      "val_verse_to_chorus_acc": 0.4336283185840708,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.49917029048282846,
      "val_pk_metric": 0.3462782346936223,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.2626946046948433,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 13,
      "train_loss": 0.48030089773237705,
      "train_chorus_rate": 0.37949360348284245,
      "train_max_prob": 0.704304825514555,
      "train_conf_over_90": 0.014971821976359934,
      "train_conf_over_95": 0.0001752149619278498,
      "val_loss": 0.47313814610242844,
      "val_macro_f1": 0.7552087637657933,
      "val_verse_f1": 0.8166470357283078,
      "val_chorus_f1": 0.6937704918032788,
      "val_chorus_rate": 0.4519663080573082,
      "val_max_prob": 0.7413686215877533,
      "val_conf_over_90": 0.12492247857153416,
      "val_conf_over_95": 0.0045417761721182615,
      "learning_rate": 9.380596514820724e-06,
      "epoch_time": 28.558240175247192,
      "val_boundary_f1": 0.3921217547000896,
      "val_boundary_precision": 0.31601731601731603,
      "val_boundary_recall": 0.5165094339622641,
      "val_complete_segments": 0.27087400994658317,
      "val_avg_segment_overlap": 0.6525819486114588,
      "val_verse_to_chorus_acc": 0.47345132743362833,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.49882685722615516,
      "val_pk_metric": 0.33880692815788804,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.9004340097308159,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 14,
      "train_loss": 0.47099567763507366,
      "train_chorus_rate": 0.39625391736626625,
      "train_max_prob": 0.7136906571686268,
      "train_conf_over_90": 0.019613576296251267,
      "train_conf_over_95": 7.548309076810256e-05,
      "val_loss": 0.4768304228782654,
      "val_macro_f1": 0.7486409323515903,
      "val_verse_f1": 0.8077152515410619,
      "val_chorus_f1": 0.6895666131621188,
      "val_chorus_rate": 0.46800124645233154,
      "val_max_prob": 0.7425001859664917,
      "val_conf_over_90": 0.13188243843615055,
      "val_conf_over_95": 0.00607563869562,
      "learning_rate": 3.1182940321824016e-06,
      "epoch_time": 27.90856909751892,
      "val_boundary_f1": 0.3642857142857142,
      "val_boundary_precision": 0.29310344827586204,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.24282249646957693,
      "val_avg_segment_overlap": 0.6391888026219735,
      "val_verse_to_chorus_acc": 0.43805309734513276,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.5079679867493098,
      "val_pk_metric": 0.3570960513946755,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.8703640699386597,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 15,
      "train_loss": 0.47058036364614964,
      "train_chorus_rate": 0.3744944669306278,
      "train_max_prob": 0.7126518674194813,
      "train_conf_over_90": 0.018986604147357866,
      "train_conf_over_95": 0.00020957264132448472,
      "val_loss": 0.47569365054368973,
      "val_macro_f1": 0.751958459768138,
      "val_verse_f1": 0.8114104595879555,
      "val_chorus_f1": 0.6925064599483205,
      "val_chorus_rate": 0.46446148306131363,
      "val_max_prob": 0.741617813706398,
      "val_conf_over_90": 0.1302761323750019,
      "val_conf_over_95": 0.00607563869562,
      "learning_rate": 1e-06,
      "epoch_time": 32.58587384223938,
      "val_boundary_f1": 0.3708961845607809,
      "val_boundary_precision": 0.2972972972972973,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2526539571437343,
      "val_avg_segment_overlap": 0.6438620220708127,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.5049126052091478,
      "val_pk_metric": 0.3522802121249189,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.712987620383501,
      "cnn_effective_layers": 3
    }
  ]
}