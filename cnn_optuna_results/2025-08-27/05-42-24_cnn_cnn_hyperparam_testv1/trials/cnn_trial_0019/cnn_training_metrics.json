{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.28604547333091457,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        5,
        7,
        9
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 134528,
      "cnn_params": 129534,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00026415416485417616,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "boundary_f1",
      "total_epochs": 14,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09312770017999095,
        "ece_after": 0.007690192937616767,
        "improvement": 0.08543750724237417,
        "params": {
          "temperature": 0.6041498605737561
        }
      },
      "platt": {
        "ece_before": 0.09312770017999095,
        "ece_after": 0.009912414465297193,
        "improvement": 0.08321528571469375,
        "params": {
          "A": 1.5744686179492005,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5548784583806992,
      "train_chorus_rate": 0.5013910215348005,
      "train_max_prob": 0.5908265560865402,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5427101254463196,
      "val_macro_f1": 0.7183800045221601,
      "val_verse_f1": 0.8014413047600987,
      "val_chorus_f1": 0.6353187042842215,
      "val_chorus_rate": 0.4043327122926712,
      "val_max_prob": 0.6532518565654755,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00026127888991469845,
      "epoch_time": 136.62450408935547,
      "val_boundary_f1": 0.35369774919614144,
      "val_boundary_precision": 0.2682926829268293,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.2819190699078967,
      "val_avg_segment_overlap": 0.6378544997343096,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.4760955775139539,
      "val_pk_metric": 0.33378913513819364,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 10.153571739792824,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5257232934236526,
      "train_chorus_rate": 0.4678654074668884,
      "train_max_prob": 0.6563135087490082,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5117622911930084,
      "val_macro_f1": 0.7525441180373111,
      "val_verse_f1": 0.8271698113207546,
      "val_chorus_f1": 0.6779184247538678,
      "val_chorus_rate": 0.39940211176872253,
      "val_max_prob": 0.6742104589939117,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025277872840822046,
      "epoch_time": 3717.3668801784515,
      "val_boundary_f1": 0.3863447127393838,
      "val_boundary_precision": 0.2985842985842986,
      "val_boundary_recall": 0.5471698113207547,
      "val_complete_segments": 0.34967537369772006,
      "val_avg_segment_overlap": 0.6802234496943356,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.4558450749175731,
      "val_pk_metric": 0.31199926327691074,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8559200763702393,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5050874575972557,
      "train_chorus_rate": 0.38275808468461037,
      "train_max_prob": 0.6731393337249756,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.506242573261261,
      "val_macro_f1": 0.7344803844604385,
      "val_verse_f1": 0.8103151862464184,
      "val_chorus_f1": 0.6586455826744586,
      "val_chorus_rate": 0.4124252647161484,
      "val_max_prob": 0.6934234201908112,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023902517818087557,
      "epoch_time": 850.7702820301056,
      "val_boundary_f1": 0.3778337531486146,
      "val_boundary_precision": 0.29335071707953064,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.2996678242488299,
      "val_avg_segment_overlap": 0.6703979286549718,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4706040277358623,
      "val_pk_metric": 0.33063003284137027,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 3.296549826860428,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.4933962821960449,
      "train_chorus_rate": 0.38284918293356895,
      "train_max_prob": 0.7005357518792152,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5124746561050415,
      "val_macro_f1": 0.7863410398165944,
      "val_verse_f1": 0.868299609513667,
      "val_chorus_f1": 0.7043824701195219,
      "val_chorus_rate": 0.31822794675827026,
      "val_max_prob": 0.7232223153114319,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022061933537445498,
      "epoch_time": 1387.1425478458405,
      "val_boundary_f1": 0.4452901998097051,
      "val_boundary_precision": 0.37320574162679426,
      "val_boundary_recall": 0.5518867924528302,
      "val_complete_segments": 0.3573305148724143,
      "val_avg_segment_overlap": 0.702484397856422,
      "val_verse_to_chorus_acc": 0.5929203539823009,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.39711869565433533,
      "val_pk_metric": 0.2542925987525047,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.698566623032093,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5144790448248386,
      "train_chorus_rate": 0.334535863250494,
      "train_max_prob": 0.7109439373016357,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5038051307201385,
      "val_macro_f1": 0.7174276790408822,
      "val_verse_f1": 0.773081657775954,
      "val_chorus_f1": 0.6617737003058104,
      "val_chorus_rate": 0.5073711276054382,
      "val_max_prob": 0.6969837248325348,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00019836562364063213,
      "epoch_time": 110.36161828041077,
      "val_boundary_f1": 0.33059360730593607,
      "val_boundary_precision": 0.2697466467958271,
      "val_boundary_recall": 0.4268867924528302,
      "val_complete_segments": 0.19659519855050583,
      "val_avg_segment_overlap": 0.6248002807038715,
      "val_verse_to_chorus_acc": 0.3141592920353982,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.4677871740269773,
      "val_pk_metric": 0.3477448937553204,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 5.589185498654842,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.48684365302324295,
      "train_chorus_rate": 0.4385121501982212,
      "train_max_prob": 0.6693079024553299,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5011562556028366,
      "val_macro_f1": 0.7699172701368591,
      "val_verse_f1": 0.8472707222936959,
      "val_chorus_f1": 0.6925638179800222,
      "val_chorus_rate": 0.36558108031749725,
      "val_max_prob": 0.6815807819366455,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00017323663696733156,
      "epoch_time": 153.1308491230011,
      "val_boundary_f1": 0.43215211754537597,
      "val_boundary_precision": 0.34106412005457026,
      "val_boundary_recall": 0.589622641509434,
      "val_complete_segments": 0.3809376415521667,
      "val_avg_segment_overlap": 0.7031734045755248,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5606060606060606,
      "val_window_diff": 0.4379647027767406,
      "val_pk_metric": 0.28980469361644745,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.697426714003086,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.4834836795926094,
      "train_chorus_rate": 0.33575061336159706,
      "train_max_prob": 0.6935037523508072,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49110089242458344,
      "val_macro_f1": 0.7678600602234904,
      "val_verse_f1": 0.8359285985567794,
      "val_chorus_f1": 0.6997915218902016,
      "val_chorus_rate": 0.41118475794792175,
      "val_max_prob": 0.71915602684021,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014633063265443298,
      "epoch_time": 91.64373087882996,
      "val_boundary_f1": 0.43659420289855067,
      "val_boundary_precision": 0.35441176470588237,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.3837309376415522,
      "val_avg_segment_overlap": 0.6900412537999919,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4226038877613858,
      "val_pk_metric": 0.28213995090039484,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 251.1221143975854,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.5020713806152344,
      "train_chorus_rate": 0.4142726920545101,
      "train_max_prob": 0.7084393352270126,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4928719699382782,
      "val_macro_f1": 0.7549921185206925,
      "val_verse_f1": 0.8211177721910655,
      "val_chorus_f1": 0.6888664648503195,
      "val_chorus_rate": 0.43333812057971954,
      "val_max_prob": 0.7051990330219269,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011882353219974322,
      "epoch_time": 72.173171043396,
      "val_boundary_f1": 0.40937781785392247,
      "val_boundary_precision": 0.33138686131386863,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.3230937641552166,
      "val_avg_segment_overlap": 0.6833275136815582,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.4424937480006885,
      "val_pk_metric": 0.31039596313391327,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 122.94891721755266,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.4936900958418846,
      "train_chorus_rate": 0.3965173177421093,
      "train_max_prob": 0.6909396275877953,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49270597100257874,
      "val_macro_f1": 0.7652488571805409,
      "val_verse_f1": 0.831834704419361,
      "val_chorus_f1": 0.6986630099417209,
      "val_chorus_rate": 0.41907553374767303,
      "val_max_prob": 0.6967988312244415,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.191752788684462e-05,
      "epoch_time": 64.42594981193542,
      "val_boundary_f1": 0.4224598930481283,
      "val_boundary_precision": 0.33954154727793695,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.350392571342292,
      "val_avg_segment_overlap": 0.6917338055337158,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.4503450786818797,
      "val_pk_metric": 0.3011502095977622,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8321081213653088,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.48565251007676125,
      "train_chorus_rate": 0.37870680168271065,
      "train_max_prob": 0.6936314254999161,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48987358808517456,
      "val_macro_f1": 0.7661468836852423,
      "val_verse_f1": 0.8296639629200463,
      "val_chorus_f1": 0.7026298044504383,
      "val_chorus_rate": 0.4322520047426224,
      "val_max_prob": 0.7057887613773346,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.678854121354407e-05,
      "epoch_time": 120.17237186431885,
      "val_boundary_f1": 0.4275491949910554,
      "val_boundary_precision": 0.34438040345821325,
      "val_boundary_recall": 0.5636792452830188,
      "val_complete_segments": 0.36282651366450247,
      "val_avg_segment_overlap": 0.678670266020649,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.44215179782204295,
      "val_pk_metric": 0.2923225246593036,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.341192934662104,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 11,
      "train_loss": 0.4805292785167694,
      "train_chorus_rate": 0.3957591839134693,
      "train_max_prob": 0.6927793323993683,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49095696210861206,
      "val_macro_f1": 0.759591371014567,
      "val_verse_f1": 0.8274276958437081,
      "val_chorus_f1": 0.6917550461854259,
      "val_chorus_rate": 0.4192102402448654,
      "val_max_prob": 0.7026963531970978,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.45348294797212e-05,
      "epoch_time": 1181.0382747650146,
      "val_boundary_f1": 0.4227353463587922,
      "val_boundary_precision": 0.33903133903133903,
      "val_boundary_recall": 0.5613207547169812,
      "val_complete_segments": 0.3532764608183603,
      "val_avg_segment_overlap": 0.6917525448061133,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4413408880710864,
      "val_pk_metric": 0.30182477794120266,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7297914065420628,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 12,
      "train_loss": 0.4800303280353546,
      "train_chorus_rate": 0.35959476232528687,
      "train_max_prob": 0.6950997188687325,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4899214804172516,
      "val_macro_f1": 0.767291710690871,
      "val_verse_f1": 0.8380414312617703,
      "val_chorus_f1": 0.6965419901199718,
      "val_chorus_rate": 0.3966149687767029,
      "val_max_prob": 0.7064363658428192,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.6128986673300576e-05,
      "epoch_time": 439.75540590286255,
      "val_boundary_f1": 0.43617021276595747,
      "val_boundary_precision": 0.3494318181818182,
      "val_boundary_recall": 0.5801886792452831,
      "val_complete_segments": 0.3530046806583119,
      "val_avg_segment_overlap": 0.7001522696750538,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.43007788216197024,
      "val_pk_metric": 0.28788542006520673,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.490090761333704,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 13,
      "train_loss": 0.4819196127355099,
      "train_chorus_rate": 0.36001455411314964,
      "train_max_prob": 0.6997815370559692,
      "train_conf_over_90": 8.500752846885007e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48878543078899384,
      "val_macro_f1": 0.7689594972067038,
      "val_verse_f1": 0.8374999999999999,
      "val_chorus_f1": 0.7004189944134077,
      "val_chorus_rate": 0.4040153920650482,
      "val_max_prob": 0.7070311009883881,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.2375436445955668e-05,
      "epoch_time": 490.3187747001648,
      "val_boundary_f1": 0.43423423423423424,
      "val_boundary_precision": 0.35131195335276966,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.35868186622376563,
      "val_avg_segment_overlap": 0.6997608010322708,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.4298751167536366,
      "val_pk_metric": 0.2890265889117486,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.144441395998001,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 14,
      "train_loss": 0.4842206500470638,
      "train_chorus_rate": 0.36426007002592087,
      "train_max_prob": 0.6996820792555809,
      "train_conf_over_90": 0.0001007324390229769,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4883916974067688,
      "val_macro_f1": 0.767546662712218,
      "val_verse_f1": 0.8336520076481836,
      "val_chorus_f1": 0.7014413177762526,
      "val_chorus_rate": 0.41699010133743286,
      "val_max_prob": 0.7063449919223785,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.8752749394776874e-06,
      "epoch_time": 148.15766763687134,
      "val_boundary_f1": 0.43946188340807174,
      "val_boundary_precision": 0.3545586107091172,
      "val_boundary_recall": 0.5778301886792453,
      "val_complete_segments": 0.36678997433187377,
      "val_avg_segment_overlap": 0.6950027373449096,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4410471702607506,
      "val_pk_metric": 0.2888360383926414,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.760464821010828,
      "cnn_effective_layers": 1
    }
  ]
}