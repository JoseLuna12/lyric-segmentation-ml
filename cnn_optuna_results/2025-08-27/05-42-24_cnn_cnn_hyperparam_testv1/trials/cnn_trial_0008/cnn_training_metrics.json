{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.3096783398568613,
      "layer_dropout": 0.24542056499130532,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 4,
      "total_params": 1085953,
      "cnn_params": 785406,
      "attention_params": 296705
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0001126739544670391,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.032438736182064824,
        "ece_after": 0.014890395880682309,
        "improvement": 0.017548340301382515,
        "params": {
          "temperature": 0.7940123429514786
        }
      },
      "platt": {
        "ece_before": 0.032438736182064824,
        "ece_after": 0.015895473509148675,
        "improvement": 0.01654326267291615,
        "params": {
          "A": 1.1895673901135009,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5701145993338691,
      "train_chorus_rate": 0.4813086324267917,
      "train_max_prob": 0.6111011240217421,
      "train_conf_over_90": 0.00010553915247631569,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5832279324531555,
      "val_macro_f1": 0.6571919922826976,
      "val_verse_f1": 0.7981204316045946,
      "val_chorus_f1": 0.5162635529608007,
      "val_chorus_rate": 0.28803834319114685,
      "val_max_prob": 0.6826288104057312,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011077135560529082,
      "epoch_time": 61.190468072891235,
      "val_boundary_f1": 0.21841541755888652,
      "val_boundary_precision": 0.2,
      "val_boundary_recall": 0.24056603773584906,
      "val_complete_segments": 0.08401193980577182,
      "val_avg_segment_overlap": 0.4713518771128785,
      "val_verse_to_chorus_acc": 0.10176991150442478,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.41222778241307,
      "val_pk_metric": 0.3215657694891513,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 7.967272731992933,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.551917552947998,
      "train_chorus_rate": 0.4282456636428833,
      "train_max_prob": 0.6538632843229506,
      "train_conf_over_90": 0.002459264454147261,
      "train_conf_over_95": 0.0,
      "val_loss": 0.561279833316803,
      "val_macro_f1": 0.6873354550302535,
      "val_verse_f1": 0.8158719108945354,
      "val_chorus_f1": 0.5587989991659716,
      "val_chorus_rate": 0.28803834319114685,
      "val_max_prob": 0.6935965120792389,
      "val_conf_over_90": 0.008266278309747577,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010519321798828085,
      "epoch_time": 66.52485299110413,
      "val_boundary_f1": 0.26202661207778916,
      "val_boundary_precision": 0.2314647377938517,
      "val_boundary_recall": 0.3018867924528302,
      "val_complete_segments": 0.10383366805139069,
      "val_avg_segment_overlap": 0.5290929094969161,
      "val_verse_to_chorus_acc": 0.18584070796460178,
      "val_chorus_to_verse_acc": 0.3838383838383838,
      "val_window_diff": 0.4270222643179177,
      "val_pk_metric": 0.32436701282141644,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 5.19677213827769,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5209169122907851,
      "train_chorus_rate": 0.3737713081969155,
      "train_max_prob": 0.6545491417249044,
      "train_conf_over_90": 0.002929211361333728,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5430052578449249,
      "val_macro_f1": 0.7148697968887243,
      "val_verse_f1": 0.8002268002268003,
      "val_chorus_f1": 0.6295127935506485,
      "val_chorus_rate": 0.4005545824766159,
      "val_max_prob": 0.7238088846206665,
      "val_conf_over_90": 0.04383608512580395,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.63196824763001e-05,
      "epoch_time": 58.77765202522278,
      "val_boundary_f1": 0.25303643724696356,
      "val_boundary_precision": 0.22163120567375885,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.1058419763954992,
      "val_avg_segment_overlap": 0.5765479250676507,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.41414141414141414,
      "val_window_diff": 0.40143559494816855,
      "val_pk_metric": 0.3148057756626076,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.8294130033916898,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5188343988524543,
      "train_chorus_rate": 0.38948989907900494,
      "train_max_prob": 0.6686574286884732,
      "train_conf_over_90": 0.005231083137914538,
      "train_conf_over_95": 3.688948021994697e-05,
      "val_loss": 0.5128238499164581,
      "val_macro_f1": 0.7002029616807823,
      "val_verse_f1": 0.7543166215935095,
      "val_chorus_f1": 0.6460893017680551,
      "val_chorus_rate": 0.5183711051940918,
      "val_max_prob": 0.6798311173915863,
      "val_conf_over_90": 0.007762916851788759,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.475546585027933e-05,
      "epoch_time": 59.94170689582825,
      "val_boundary_f1": 0.22846441947565543,
      "val_boundary_precision": 0.18944099378881987,
      "val_boundary_recall": 0.28773584905660377,
      "val_complete_segments": 0.09451429200253103,
      "val_avg_segment_overlap": 0.5936360824659422,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.4662169328651426,
      "val_pk_metric": 0.3692665588150843,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.69618511862225,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4985962212085724,
      "train_chorus_rate": 0.40848932332462734,
      "train_max_prob": 0.67184360159768,
      "train_conf_over_90": 0.007721085510436549,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5001764595508575,
      "val_macro_f1": 0.7274307300367308,
      "val_verse_f1": 0.7869381173150575,
      "val_chorus_f1": 0.667923342758404,
      "val_chorus_rate": 0.48094457387924194,
      "val_max_prob": 0.7093349397182465,
      "val_conf_over_90": 0.03637454193085432,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.128865036251028e-05,
      "epoch_time": 46.54148983955383,
      "val_boundary_f1": 0.27911453320500484,
      "val_boundary_precision": 0.23577235772357724,
      "val_boundary_recall": 0.3419811320754717,
      "val_complete_segments": 0.13817436518198575,
      "val_avg_segment_overlap": 0.6082827944366466,
      "val_verse_to_chorus_acc": 0.2610619469026549,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.43655548364506924,
      "val_pk_metric": 0.3267755746935571,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.7102520200941296,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.5010049839814504,
      "train_chorus_rate": 0.40611936648686725,
      "train_max_prob": 0.6823189126120673,
      "train_conf_over_90": 0.00799024249944422,
      "train_conf_over_95": 0.00010366930574592616,
      "val_loss": 0.4904033690690994,
      "val_macro_f1": 0.7337139949109415,
      "val_verse_f1": 0.7944,
      "val_chorus_f1": 0.6730279898218829,
      "val_chorus_rate": 0.4721086770296097,
      "val_max_prob": 0.7055019736289978,
      "val_conf_over_90": 0.043634096160531044,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.683697723351955e-05,
      "epoch_time": 37.7511191368103,
      "val_boundary_f1": 0.30755064456721914,
      "val_boundary_precision": 0.25226586102719034,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.20153924454592975,
      "val_avg_segment_overlap": 0.6338644740145098,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.4301289880044806,
      "val_pk_metric": 0.32100272272112196,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.418470687336392,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.4871802594926622,
      "train_chorus_rate": 0.3711889949109819,
      "train_max_prob": 0.6923769646220737,
      "train_conf_over_90": 0.012763014321939813,
      "train_conf_over_95": 0.00026630670375501114,
      "val_loss": 0.4878731220960617,
      "val_macro_f1": 0.7515645903010034,
      "val_verse_f1": 0.8203846153846155,
      "val_chorus_f1": 0.6827445652173914,
      "val_chorus_rate": 0.42263463139533997,
      "val_max_prob": 0.7382419407367706,
      "val_conf_over_90": 0.09057923033833504,
      "val_conf_over_95": 0.0028634247137233615,
      "learning_rate": 4.238530410452884e-05,
      "epoch_time": 41.76961708068848,
      "val_boundary_f1": 0.35431654676258995,
      "val_boundary_precision": 0.2863372093023256,
      "val_boundary_recall": 0.46462264150943394,
      "val_complete_segments": 0.24590772786046383,
      "val_avg_segment_overlap": 0.6530768889343328,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.42412905472193685,
      "val_pk_metric": 0.3102085418374301,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.6809669865502253,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.479327787955602,
      "train_chorus_rate": 0.38950983352131313,
      "train_max_prob": 0.7035865518781874,
      "train_conf_over_90": 0.022414639902611572,
      "train_conf_over_95": 0.0006800303979414619,
      "val_loss": 0.48439136147499084,
      "val_macro_f1": 0.7542968508176026,
      "val_verse_f1": 0.8222393228164678,
      "val_chorus_f1": 0.6863543788187373,
      "val_chorus_rate": 0.4225110113620758,
      "val_max_prob": 0.7367322146892548,
      "val_conf_over_90": 0.08370102569460869,
      "val_conf_over_95": 0.002069196372758597,
      "learning_rate": 2.891848861675979e-05,
      "epoch_time": 26.24357795715332,
      "val_boundary_f1": 0.3418181818181818,
      "val_boundary_precision": 0.2781065088757396,
      "val_boundary_recall": 0.44339622641509435,
      "val_complete_segments": 0.24012352471869927,
      "val_avg_segment_overlap": 0.6531228875863571,
      "val_verse_to_chorus_acc": 0.36283185840707965,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4290348145055315,
      "val_pk_metric": 0.3114673444369228,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.189861045943366,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4786409272087945,
      "train_chorus_rate": 0.38831231660313076,
      "train_max_prob": 0.7054108315043979,
      "train_conf_over_90": 0.021015120152797963,
      "train_conf_over_95": 0.00033770933320435387,
      "val_loss": 0.4837556630373001,
      "val_macro_f1": 0.729082873673136,
      "val_verse_f1": 0.788562223117197,
      "val_chorus_f1": 0.6696035242290749,
      "val_chorus_rate": 0.4796469956636429,
      "val_max_prob": 0.7207916080951691,
      "val_conf_over_90": 0.07638572156429291,
      "val_conf_over_95": 0.006991310277953744,
      "learning_rate": 1.7354271990739014e-05,
      "epoch_time": 26.68390202522278,
      "val_boundary_f1": 0.28519527702089015,
      "val_boundary_precision": 0.23190546528803546,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.15941291369776334,
      "val_avg_segment_overlap": 0.6227960066810461,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.3939393939393939,
      "val_window_diff": 0.4502698902968636,
      "val_pk_metric": 0.34042628571624134,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.926845464441511,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.48015156719419694,
      "train_chorus_rate": 0.40018994609514874,
      "train_max_prob": 0.7028290430704752,
      "train_conf_over_90": 0.01936336254907979,
      "train_conf_over_95": 0.000585012994835981,
      "val_loss": 0.4803949147462845,
      "val_macro_f1": 0.7407523318605793,
      "val_verse_f1": 0.8023809523809523,
      "val_chorus_f1": 0.6791237113402062,
      "val_chorus_rate": 0.46211983263492584,
      "val_max_prob": 0.7176595628261566,
      "val_conf_over_90": 0.06721371412277222,
      "val_conf_over_95": 0.006275453954003751,
      "learning_rate": 8.480736478758272e-06,
      "epoch_time": 41.65563082695007,
      "val_boundary_f1": 0.30336058128973664,
      "val_boundary_precision": 0.2466765140324963,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.1864356653553055,
      "val_avg_segment_overlap": 0.6373532813321889,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.4466980610443371,
      "val_pk_metric": 0.33345800890154464,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.4292611678441365,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4680125282870399,
      "train_chorus_rate": 0.3838486141628689,
      "train_max_prob": 0.7004219028684828,
      "train_conf_over_90": 0.019029735484057002,
      "train_conf_over_95": 0.0005276951900062462,
      "val_loss": 0.4788106083869934,
      "val_macro_f1": 0.7549716935521603,
      "val_verse_f1": 0.8206816421378776,
      "val_chorus_f1": 0.689261744966443,
      "val_chorus_rate": 0.43122489750385284,
      "val_max_prob": 0.7338765561580658,
      "val_conf_over_90": 0.08309667184948921,
      "val_conf_over_95": 0.0077855384442955256,
      "learning_rate": 2.90259886174829e-06,
      "epoch_time": 27.755436658859253,
      "val_boundary_f1": 0.33979686057248387,
      "val_boundary_precision": 0.27921092564491656,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.23552229772483424,
      "val_avg_segment_overlap": 0.652999846722149,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4255253304773675,
      "val_pk_metric": 0.3120236973373165,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.4360715283287897,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.48465795980559456,
      "train_chorus_rate": 0.3686173657576243,
      "train_max_prob": 0.7091016968091329,
      "train_conf_over_90": 0.023763433305753603,
      "train_conf_over_95": 0.0004391555687309139,
      "val_loss": 0.4794352799654007,
      "val_macro_f1": 0.7487753155448513,
      "val_verse_f1": 0.8130621822448182,
      "val_chorus_f1": 0.6844884488448846,
      "val_chorus_rate": 0.443495437502861,
      "val_max_prob": 0.733402818441391,
      "val_conf_over_90": 0.08627358451485634,
      "val_conf_over_95": 0.009642239892855287,
      "learning_rate": 1e-06,
      "epoch_time": 31.697893857955933,
      "val_boundary_f1": 0.3254113345521024,
      "val_boundary_precision": 0.2656716417910448,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.21735123387163333,
      "val_avg_segment_overlap": 0.6452630285306227,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.43651737354135317,
      "val_pk_metric": 0.32038413543829664,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.8098071416219075,
      "cnn_effective_layers": 2
    }
  ]
}