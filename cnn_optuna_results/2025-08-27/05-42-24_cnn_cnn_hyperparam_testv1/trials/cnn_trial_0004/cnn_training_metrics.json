{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 1,
      "dropout": 0.30977571015960603,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        3,
        9
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 266754,
      "cnn_params": 262912,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0004398334129418028,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "cnn_composite",
      "total_epochs": 6,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06167858266701633,
        "ece_after": 0.01288836595761518,
        "improvement": 0.048790216709401146,
        "params": {
          "temperature": 0.6613513802817157
        }
      },
      "platt": {
        "ece_before": 0.06167858266701633,
        "ece_after": 0.06073504231123654,
        "improvement": 0.0009435403557797872,
        "params": {
          "A": 1.0068358782528823,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5687509461453086,
      "train_chorus_rate": 0.44863224186395345,
      "train_max_prob": 0.5517244370360124,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5746518522500992,
      "val_macro_f1": 0.6301661895362467,
      "val_verse_f1": 0.7551395007342143,
      "val_chorus_f1": 0.505192878338279,
      "val_chorus_rate": 0.3624936640262604,
      "val_max_prob": 0.5637239217758179,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.94561699264806e-05,
      "epoch_time": 74.80048513412476,
      "val_boundary_f1": 0.17829457364341084,
      "val_boundary_precision": 0.1513157894736842,
      "val_boundary_recall": 0.2169811320754717,
      "val_complete_segments": 0.06438936725444624,
      "val_avg_segment_overlap": 0.4427155889806946,
      "val_verse_to_chorus_acc": 0.1415929203539823,
      "val_chorus_to_verse_acc": 0.22727272727272727,
      "val_window_diff": 0.4692716056266555,
      "val_pk_metric": 0.4058275054478182,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 6.886007108186421,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5261416435241699,
      "train_chorus_rate": 0.3103405088186264,
      "train_max_prob": 0.5876208637890062,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5644440054893494,
      "val_macro_f1": 0.6431352071349139,
      "val_verse_f1": 0.7772224205640843,
      "val_chorus_f1": 0.5090479937057435,
      "val_chorus_rate": 0.32576049119234085,
      "val_max_prob": 0.5913123488426208,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.5011796453769223e-05,
      "epoch_time": 91.72326588630676,
      "val_boundary_f1": 0.21256038647342992,
      "val_boundary_precision": 0.18003273322422259,
      "val_boundary_recall": 0.25943396226415094,
      "val_complete_segments": 0.0785263606469603,
      "val_avg_segment_overlap": 0.4834208020042811,
      "val_verse_to_chorus_acc": 0.13274336283185842,
      "val_chorus_to_verse_acc": 0.3181818181818182,
      "val_window_diff": 0.44083303363197285,
      "val_pk_metric": 0.34658645311490055,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.124501899669045,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5253814113767523,
      "train_chorus_rate": 0.40159188446245697,
      "train_max_prob": 0.6106821486824437,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5506242364645004,
      "val_macro_f1": 0.6530788068679277,
      "val_verse_f1": 0.7548889310803115,
      "val_chorus_f1": 0.551268682655544,
      "val_chorus_rate": 0.4076607897877693,
      "val_max_prob": 0.6212721765041351,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.416217512920152e-05,
      "epoch_time": 78.15962386131287,
      "val_boundary_f1": 0.23856502242152464,
      "val_boundary_precision": 0.19247467438494936,
      "val_boundary_recall": 0.3136792452830189,
      "val_complete_segments": 0.0962861143291708,
      "val_avg_segment_overlap": 0.5246280221405543,
      "val_verse_to_chorus_acc": 0.1592920353982301,
      "val_chorus_to_verse_acc": 0.40404040404040403,
      "val_window_diff": 0.45204257944351894,
      "val_pk_metric": 0.35832474139671167,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.571686675674037,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.5170194914466456,
      "train_chorus_rate": 0.36924966542344345,
      "train_max_prob": 0.6352079824397439,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5381511151790619,
      "val_macro_f1": 0.6401517750340808,
      "val_verse_f1": 0.7020117351215424,
      "val_chorus_f1": 0.5782918149466193,
      "val_chorus_rate": 0.5288500934839249,
      "val_max_prob": 0.6178388595581055,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.674582785487439e-05,
      "epoch_time": 80.13649106025696,
      "val_boundary_f1": 0.20695364238410596,
      "val_boundary_precision": 0.15943877551020408,
      "val_boundary_recall": 0.294811320754717,
      "val_complete_segments": 0.07823675896772542,
      "val_avg_segment_overlap": 0.49625834288801557,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.50294219626926,
      "val_pk_metric": 0.4001914976332025,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 2.957833716743871,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5199052173840372,
      "train_chorus_rate": 0.4171011338108464,
      "train_max_prob": 0.6508907487517909,
      "train_conf_over_90": 3.3269014430085297e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5379881113767624,
      "val_macro_f1": 0.6941595232263859,
      "val_verse_f1": 0.7972079353416606,
      "val_chorus_f1": 0.5911111111111111,
      "val_chorus_rate": 0.3657000884413719,
      "val_max_prob": 0.6677433401346207,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.254068903340789e-05,
      "epoch_time": 76.01492023468018,
      "val_boundary_f1": 0.33502538071065985,
      "val_boundary_precision": 0.2612137203166227,
      "val_boundary_recall": 0.4669811320754717,
      "val_complete_segments": 0.19355588585088263,
      "val_avg_segment_overlap": 0.5940499958489192,
      "val_verse_to_chorus_acc": 0.3274336283185841,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.3932165480340298,
      "val_pk_metric": 0.29564048952844313,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.667538649157474,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.5088245131467518,
      "train_chorus_rate": 0.4296987809632954,
      "train_max_prob": 0.6613362211930124,
      "train_conf_over_90": 0.00017583717003856835,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5282817035913467,
      "val_macro_f1": 0.6312939996363489,
      "val_verse_f1": 0.6709534368070953,
      "val_chorus_f1": 0.5916345624656026,
      "val_chorus_rate": 0.5932121872901917,
      "val_max_prob": 0.6348182111978531,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.126802439267859e-05,
      "epoch_time": 76.59909987449646,
      "val_boundary_f1": 0.19672131147540986,
      "val_boundary_precision": 0.15510204081632653,
      "val_boundary_recall": 0.2688679245283019,
      "val_complete_segments": 0.05564578165682296,
      "val_avg_segment_overlap": 0.4919218990047891,
      "val_verse_to_chorus_acc": 0.13716814159292035,
      "val_chorus_to_verse_acc": 0.3787878787878788,
      "val_window_diff": 0.49061991685939665,
      "val_pk_metric": 0.3925482799424095,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 4.183713486320094,
      "cnn_effective_layers": 1
    }
  ]
}