{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.25113209789744395,
      "layer_dropout": 0.10269428134222293,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0003894706089427724,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08280543447243441,
        "ece_after": 0.01484570602478354,
        "improvement": 0.06795972844765087,
        "params": {
          "temperature": 0.627570264316035
        }
      },
      "platt": {
        "ece_before": 0.08280543447243441,
        "ece_after": 0.014907690668972613,
        "improvement": 0.0678977438034618,
        "params": {
          "A": 1.5695322180281612,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5416477620601654,
      "train_chorus_rate": 0.47167281359434127,
      "train_max_prob": 0.6292700648307801,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5107637047767639,
      "val_macro_f1": 0.71789936125543,
      "val_verse_f1": 0.7843371099185054,
      "val_chorus_f1": 0.6514616125923546,
      "val_chorus_rate": 0.46455715596675873,
      "val_max_prob": 0.7033872306346893,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00037468532676359793,
      "epoch_time": 109.05377626419067,
      "val_boundary_f1": 0.3744752308984047,
      "val_boundary_precision": 0.2907431551499348,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.3087284482758621,
      "val_avg_segment_overlap": 0.6362714022341133,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4607011929665812,
      "val_pk_metric": 0.3299258341499129,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.276223051548004,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49296008348464965,
      "train_chorus_rate": 0.4286268413066864,
      "train_max_prob": 0.6836191296577454,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49962691962718964,
      "val_macro_f1": 0.7445320780597294,
      "val_verse_f1": 0.8127906976744187,
      "val_chorus_f1": 0.6762734584450402,
      "val_chorus_rate": 0.43298545479774475,
      "val_max_prob": 0.738462507724762,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003325804054089371,
      "epoch_time": 87.14571905136108,
      "val_boundary_f1": 0.39510818438381934,
      "val_boundary_precision": 0.3286384976525822,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.2774185823754789,
      "val_avg_segment_overlap": 0.6616970025659212,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.4473550853286394,
      "val_pk_metric": 0.31598338353057653,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7576396077871322,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4945407509803772,
      "train_chorus_rate": 0.3960235834121704,
      "train_max_prob": 0.7115424335002899,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4936154633760452,
      "val_macro_f1": 0.7292930283607144,
      "val_verse_f1": 0.7871307163091866,
      "val_chorus_f1": 0.6714553404122423,
      "val_chorus_rate": 0.48651352524757385,
      "val_max_prob": 0.7073578834533691,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002695659374729746,
      "epoch_time": 76.790372133255,
      "val_boundary_f1": 0.37984496124031003,
      "val_boundary_precision": 0.3223684210526316,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2588002873563219,
      "val_avg_segment_overlap": 0.6407043559712899,
      "val_verse_to_chorus_acc": 0.3805309734513274,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4416661402378114,
      "val_pk_metric": 0.34190077585401313,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8723954200744629,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4843439877033234,
      "train_chorus_rate": 0.4255929946899414,
      "train_max_prob": 0.7037196040153504,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49081726372241974,
      "val_macro_f1": 0.7449800064263687,
      "val_verse_f1": 0.8054783644303294,
      "val_chorus_f1": 0.6844816484224082,
      "val_chorus_rate": 0.4628978371620178,
      "val_max_prob": 0.7433904111385345,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001952353044713862,
      "epoch_time": 89.42838215827942,
      "val_boundary_f1": 0.39413382218148485,
      "val_boundary_precision": 0.32233883058470764,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2896312260536399,
      "val_avg_segment_overlap": 0.6636361726753552,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.44713814895864235,
      "val_pk_metric": 0.32885485396213593,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7909538984298706,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4821204900741577,
      "train_chorus_rate": 0.44831955432891846,
      "train_max_prob": 0.7235306560993194,
      "train_conf_over_90": 0.00028580849757418034,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4820069372653961,
      "val_macro_f1": 0.7888917843226757,
      "val_verse_f1": 0.861836101478372,
      "val_chorus_f1": 0.7159474671669794,
      "val_chorus_rate": 0.354596346616745,
      "val_max_prob": 0.7366788387298584,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012090467146979787,
      "epoch_time": 69.5696976184845,
      "val_boundary_f1": 0.47910863509749296,
      "val_boundary_precision": 0.39509954058192953,
      "val_boundary_recall": 0.6084905660377359,
      "val_complete_segments": 0.4024784482758621,
      "val_avg_segment_overlap": 0.7112749171618582,
      "val_verse_to_chorus_acc": 0.6150442477876106,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.39510073265824314,
      "val_pk_metric": 0.2521586700396482,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.3412570834159852,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.47294747531414033,
      "train_chorus_rate": 0.3592293709516525,
      "train_max_prob": 0.7097793519496918,
      "train_conf_over_90": 6.288777804002166e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4789910465478897,
      "val_macro_f1": 0.7771470127711362,
      "val_verse_f1": 0.8439153439153438,
      "val_chorus_f1": 0.7103786816269285,
      "val_chorus_rate": 0.4004936069250107,
      "val_max_prob": 0.7205895483493805,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.7890203533835297e-05,
      "epoch_time": 70.40386199951172,
      "val_boundary_f1": 0.45096241979835017,
      "val_boundary_precision": 0.36881559220389803,
      "val_boundary_recall": 0.5801886792452831,
      "val_complete_segments": 0.3748204022988506,
      "val_avg_segment_overlap": 0.704967077367465,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4119493339892877,
      "val_pk_metric": 0.2756041045209934,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.1941149890422822,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.47092320024967194,
      "train_chorus_rate": 0.3575410574674606,
      "train_max_prob": 0.700077110528946,
      "train_conf_over_90": 6.416426040232182e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47856831550598145,
      "val_macro_f1": 0.7765897199932625,
      "val_verse_f1": 0.8431409649952696,
      "val_chorus_f1": 0.7100384749912556,
      "val_chorus_rate": 0.4022301286458969,
      "val_max_prob": 0.7258111238479614,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.578528217917448e-05,
      "epoch_time": 71.09239912033081,
      "val_boundary_f1": 0.44935543278084705,
      "val_boundary_precision": 0.3685800604229607,
      "val_boundary_recall": 0.5754716981132075,
      "val_complete_segments": 0.36907327586206895,
      "val_avg_segment_overlap": 0.7031722732444379,
      "val_verse_to_chorus_acc": 0.5707964601769911,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4118360111277309,
      "val_pk_metric": 0.27770463923885924,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8977928400039673,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4698069244623184,
      "train_chorus_rate": 0.38512445986270905,
      "train_max_prob": 0.7060703337192535,
      "train_conf_over_90": 6.573072460014373e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47846926748752594,
      "val_macro_f1": 0.7751498472582181,
      "val_verse_f1": 0.841025641025641,
      "val_chorus_f1": 0.7092740534907953,
      "val_chorus_rate": 0.4071343094110489,
      "val_max_prob": 0.7285421788692474,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 57.513325929641724,
      "val_boundary_f1": 0.43830570902394106,
      "val_boundary_precision": 0.3595166163141994,
      "val_boundary_recall": 0.5613207547169812,
      "val_complete_segments": 0.3551843869731801,
      "val_avg_segment_overlap": 0.6971415827095593,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.41679237996637625,
      "val_pk_metric": 0.2852196777027248,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7016174972057343,
      "cnn_effective_layers": 2
    }
  ]
}