{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.3467759185614175,
      "layer_dropout": 0.12615496435074872,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        3,
        9
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 1050368,
      "cnn_params": 1046526,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0007950932329069357,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.055474548346284326,
        "ece_after": 0.03196980029871515,
        "improvement": 0.023504748047569177,
        "params": {
          "temperature": 0.7358998262772065
        }
      },
      "platt": {
        "ece_before": 0.055474548346284326,
        "ece_after": 0.06468447537869508,
        "improvement": -0.009209927032410754,
        "params": {
          "A": 0.9999999715166875,
          "B": -0.08922500356198906
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5673348373836942,
      "train_chorus_rate": 0.39942607780297595,
      "train_max_prob": 0.5690212514665391,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5687969028949738,
      "val_macro_f1": 0.6072639812271978,
      "val_verse_f1": 0.7040977147360125,
      "val_chorus_f1": 0.5104302477183833,
      "val_chorus_rate": 0.4511783868074417,
      "val_max_prob": 0.571544349193573,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.4471273904894645e-05,
      "epoch_time": 29.425241947174072,
      "val_boundary_f1": 0.09846827133479213,
      "val_boundary_precision": 0.09183673469387756,
      "val_boundary_recall": 0.10613207547169812,
      "val_complete_segments": 0.041060276761396466,
      "val_avg_segment_overlap": 0.38467960826616865,
      "val_verse_to_chorus_acc": 0.06637168141592921,
      "val_chorus_to_verse_acc": 0.07575757575757576,
      "val_window_diff": 0.4667984999871895,
      "val_pk_metric": 0.4221164376263364,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 14.911701122919718,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.534993953175015,
      "train_chorus_rate": 0.44885509709517163,
      "train_max_prob": 0.6081507073508369,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.578684389591217,
      "val_macro_f1": 0.6359867626393587,
      "val_verse_f1": 0.7882251082251083,
      "val_chorus_f1": 0.48374841705360916,
      "val_chorus_rate": 0.2814057618379593,
      "val_max_prob": 0.6649925708770752,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.2436617525401445e-05,
      "epoch_time": 21.537325620651245,
      "val_boundary_f1": 0.20673076923076925,
      "val_boundary_precision": 0.2107843137254902,
      "val_boundary_recall": 0.2028301886792453,
      "val_complete_segments": 0.0869625024072189,
      "val_avg_segment_overlap": 0.4263883885822265,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.21717171717171718,
      "val_window_diff": 0.403522375482312,
      "val_pk_metric": 0.33636702549618075,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.5964934163623385,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5309577981630961,
      "train_chorus_rate": 0.4567142989900377,
      "train_max_prob": 0.6408186356226603,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5477695167064667,
      "val_macro_f1": 0.5719524631930087,
      "val_verse_f1": 0.5822541966426859,
      "val_chorus_f1": 0.5616507297433316,
      "val_chorus_rate": 0.6743420362472534,
      "val_max_prob": 0.6373822093009949,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.558841102824765e-05,
      "epoch_time": 17.247780084609985,
      "val_boundary_f1": 0.10786516853932583,
      "val_boundary_precision": 0.10300429184549356,
      "val_boundary_recall": 0.11320754716981132,
      "val_complete_segments": 0.03764202591543096,
      "val_avg_segment_overlap": 0.4059011609353951,
      "val_verse_to_chorus_acc": 0.084070796460177,
      "val_chorus_to_verse_acc": 0.1111111111111111,
      "val_window_diff": 0.46782819099774403,
      "val_pk_metric": 0.4054244963525652,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.014187587632073,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5096172591050466,
      "train_chorus_rate": 0.33539872202608323,
      "train_max_prob": 0.6471883654594421,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5260263085365295,
      "val_macro_f1": 0.6764231601988925,
      "val_verse_f1": 0.7379281881964508,
      "val_chorus_f1": 0.6149181322013342,
      "val_chorus_rate": 0.5097703039646149,
      "val_max_prob": 0.6512295007705688,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.374280283196054e-05,
      "epoch_time": 17.88373565673828,
      "val_boundary_f1": 0.215443279313632,
      "val_boundary_precision": 0.1808,
      "val_boundary_recall": 0.2665094339622642,
      "val_complete_segments": 0.0921552174750337,
      "val_avg_segment_overlap": 0.570921527072198,
      "val_verse_to_chorus_acc": 0.1902654867256637,
      "val_chorus_to_verse_acc": 0.2878787878787879,
      "val_window_diff": 0.47272874269743903,
      "val_pk_metric": 0.3915499224832901,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.450057042969598,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5124116109477149,
      "train_chorus_rate": 0.36364753047625226,
      "train_max_prob": 0.6737318966123793,
      "train_conf_over_90": 0.00033342176660274464,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5303818881511688,
      "val_macro_f1": 0.6275721188716561,
      "val_verse_f1": 0.6600406595888865,
      "val_chorus_f1": 0.5951035781544257,
      "val_chorus_rate": 0.6128341853618622,
      "val_max_prob": 0.6675389409065247,
      "val_conf_over_90": 0.00042498938273638487,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.664600902158907e-05,
      "epoch_time": 15.141304016113281,
      "val_boundary_f1": 0.18677859391395593,
      "val_boundary_precision": 0.16824196597353497,
      "val_boundary_recall": 0.2099056603773585,
      "val_complete_segments": 0.054396269498473135,
      "val_avg_segment_overlap": 0.5013306297348566,
      "val_verse_to_chorus_acc": 0.17256637168141592,
      "val_chorus_to_verse_acc": 0.20707070707070707,
      "val_window_diff": 0.4397707880341088,
      "val_pk_metric": 0.3596776415549466,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.813292682170868,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.5132877164416842,
      "train_chorus_rate": 0.44028261800607044,
      "train_max_prob": 0.6619808740086026,
      "train_conf_over_90": 0.0007603685630278455,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5292446315288544,
      "val_macro_f1": 0.7009739579204658,
      "val_verse_f1": 0.8095838587641866,
      "val_chorus_f1": 0.592364057076745,
      "val_chorus_rate": 0.33684177696704865,
      "val_max_prob": 0.6993528008460999,
      "val_conf_over_90": 0.0008499787654727697,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012397786104538045,
      "epoch_time": 15.939012050628662,
      "val_boundary_f1": 0.31763619575253926,
      "val_boundary_precision": 0.26100151745068284,
      "val_boundary_recall": 0.4056603773584906,
      "val_complete_segments": 0.22017799664364907,
      "val_avg_segment_overlap": 0.5922878023143137,
      "val_verse_to_chorus_acc": 0.3584070796460177,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.41563844334340594,
      "val_pk_metric": 0.3153658361948988,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.813612871699863,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.49900538722674054,
      "train_chorus_rate": 0.38717796239588,
      "train_max_prob": 0.6778606838650174,
      "train_conf_over_90": 0.0031902705474446216,
      "train_conf_over_95": 0.0,
      "val_loss": 0.505153700709343,
      "val_macro_f1": 0.6823164706414657,
      "val_verse_f1": 0.7357578305654825,
      "val_chorus_f1": 0.6288751107174491,
      "val_chorus_rate": 0.5293093025684357,
      "val_max_prob": 0.6930026113986969,
      "val_conf_over_90": 0.009260886581614614,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001553562814157239,
      "epoch_time": 24.728944778442383,
      "val_boundary_f1": 0.2963671128107075,
      "val_boundary_precision": 0.2491961414790997,
      "val_boundary_recall": 0.36556603773584906,
      "val_complete_segments": 0.14595999889955708,
      "val_avg_segment_overlap": 0.5930480640489648,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.36363636363636365,
      "val_window_diff": 0.42774050071689096,
      "val_pk_metric": 0.3423203070542401,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 3.4485449261135526,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4732717408074273,
      "train_chorus_rate": 0.39536768198013306,
      "train_max_prob": 0.6997508936458163,
      "train_conf_over_90": 0.008473100295911232,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4996587932109833,
      "val_macro_f1": 0.6718089290293662,
      "val_verse_f1": 0.718796992481203,
      "val_chorus_f1": 0.6248208655775294,
      "val_chorus_rate": 0.5558428466320038,
      "val_max_prob": 0.7145853936672211,
      "val_conf_over_90": 0.016386319417506456,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001903426248476282,
      "epoch_time": 15.328160047531128,
      "val_boundary_f1": 0.3044315992292871,
      "val_boundary_precision": 0.25732899022801303,
      "val_boundary_recall": 0.37264150943396224,
      "val_complete_segments": 0.1428925142369804,
      "val_avg_segment_overlap": 0.5793422767218626,
      "val_verse_to_chorus_acc": 0.3185840707964602,
      "val_chorus_to_verse_acc": 0.35353535353535354,
      "val_window_diff": 0.4371195811433039,
      "val_pk_metric": 0.34011505708776435,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.6712237861421375,
      "cnn_effective_layers": 2
    }
  ]
}