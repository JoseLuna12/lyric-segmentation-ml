{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.33242933234856037,
      "layer_dropout": 0.16622957520600656,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 199550,
      "cnn_params": 194556,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00023476975517779388,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06267813767337613,
        "ece_after": 0.032897584301315286,
        "improvement": 0.029780553372060842,
        "params": {
          "temperature": 0.7676520622943227
        }
      },
      "platt": {
        "ece_before": 0.06267813767337613,
        "ece_after": 0.04552977641930984,
        "improvement": 0.01714836125406629,
        "params": {
          "A": 1.1087708309905466,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.587518060207367,
      "train_chorus_rate": 0.5691524982452393,
      "train_max_prob": 0.5267547647158305,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.6014344493548075,
      "val_macro_f1": 0.6331892033542977,
      "val_verse_f1": 0.6944444444444445,
      "val_chorus_f1": 0.5719339622641509,
      "val_chorus_rate": 0.5352235635121664,
      "val_max_prob": 0.5163231094678243,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.1574185698066388e-05,
      "epoch_time": 105.0996470451355,
      "val_boundary_f1": 0.19972640218878251,
      "val_boundary_precision": 0.14065510597302505,
      "val_boundary_recall": 0.3443396226415094,
      "val_complete_segments": 0.09872508301890205,
      "val_avg_segment_overlap": 0.4629960166081493,
      "val_verse_to_chorus_acc": 0.23893805309734514,
      "val_chorus_to_verse_acc": 0.3383838383838384,
      "val_window_diff": 0.5129633948000345,
      "val_pk_metric": 0.38397286069777775,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3.7302080392837524,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.571315614382426,
      "train_chorus_rate": 0.4701569358507792,
      "train_max_prob": 0.5323615829149883,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.590682586034139,
      "val_macro_f1": 0.6555532665198001,
      "val_verse_f1": 0.7548608463591308,
      "val_chorus_f1": 0.5562456866804694,
      "val_chorus_rate": 0.41531360149383545,
      "val_max_prob": 0.5375332434972128,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.8039764170879483e-05,
      "epoch_time": 106.15400981903076,
      "val_boundary_f1": 0.2778761061946903,
      "val_boundary_precision": 0.22237960339943344,
      "val_boundary_recall": 0.37028301886792453,
      "val_complete_segments": 0.13000171919252243,
      "val_avg_segment_overlap": 0.49322775679533687,
      "val_verse_to_chorus_acc": 0.2743362831858407,
      "val_chorus_to_verse_acc": 0.3888888888888889,
      "val_window_diff": 0.4385263661311525,
      "val_pk_metric": 0.3543511273091818,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.055431079864502,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5631245493888855,
      "train_chorus_rate": 0.43454312682151797,
      "train_max_prob": 0.5517589370409648,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5725635687510172,
      "val_macro_f1": 0.6309176152730596,
      "val_verse_f1": 0.6932773109243697,
      "val_chorus_f1": 0.5685579196217494,
      "val_chorus_rate": 0.5340156356493632,
      "val_max_prob": 0.5678233504295349,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.8536980240611703e-05,
      "epoch_time": 89.1732804775238,
      "val_boundary_f1": 0.20881226053639848,
      "val_boundary_precision": 0.17580645161290323,
      "val_boundary_recall": 0.25707547169811323,
      "val_complete_segments": 0.0873506640004102,
      "val_avg_segment_overlap": 0.45422931710884495,
      "val_verse_to_chorus_acc": 0.14601769911504425,
      "val_chorus_to_verse_acc": 0.32323232323232326,
      "val_window_diff": 0.45012774772415853,
      "val_pk_metric": 0.3767567676759637,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.5820851524670918,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.542017928759257,
      "train_chorus_rate": 0.3899238437414169,
      "train_max_prob": 0.592158842086792,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5586219429969788,
      "val_macro_f1": 0.6729592324389644,
      "val_verse_f1": 0.780018501387604,
      "val_chorus_f1": 0.5658999634903249,
      "val_chorus_rate": 0.37535356481870014,
      "val_max_prob": 0.6291256546974182,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.265905993459509e-05,
      "epoch_time": 96.27753520011902,
      "val_boundary_f1": 0.2949852507374631,
      "val_boundary_precision": 0.25295109612141653,
      "val_boundary_recall": 0.35377358490566035,
      "val_complete_segments": 0.1404254549073898,
      "val_avg_segment_overlap": 0.5262625176263795,
      "val_verse_to_chorus_acc": 0.20353982300884957,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.4134867617907209,
      "val_pk_metric": 0.32056824845481263,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.6710052450497945,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.5290966192881267,
      "train_chorus_rate": 0.41398169795672096,
      "train_max_prob": 0.6331093231836955,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5422410567601522,
      "val_macro_f1": 0.6830283348537306,
      "val_verse_f1": 0.7637502446662751,
      "val_chorus_f1": 0.6023064250411861,
      "val_chorus_rate": 0.4487280547618866,
      "val_max_prob": 0.6546842257181803,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.985876344931452e-05,
      "epoch_time": 88.60829424858093,
      "val_boundary_f1": 0.2782101167315175,
      "val_boundary_precision": 0.2367549668874172,
      "val_boundary_recall": 0.33726415094339623,
      "val_complete_segments": 0.11241950710448771,
      "val_avg_segment_overlap": 0.5589545503796299,
      "val_verse_to_chorus_acc": 0.168141592920354,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.39952188614894063,
      "val_pk_metric": 0.3167226075668001,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.7680360118548075,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.5190863728523254,
      "train_chorus_rate": 0.37810380856196085,
      "train_max_prob": 0.6494734764099122,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5288938085238138,
      "val_macro_f1": 0.6869196373154819,
      "val_verse_f1": 0.7475828018926147,
      "val_chorus_f1": 0.6262564727383491,
      "val_chorus_rate": 0.5086888372898102,
      "val_max_prob": 0.6702589392662048,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.946959104989591e-05,
      "epoch_time": 104.14115881919861,
      "val_boundary_f1": 0.2851782363977486,
      "val_boundary_precision": 0.2367601246105919,
      "val_boundary_recall": 0.3584905660377358,
      "val_complete_segments": 0.13164792143591786,
      "val_avg_segment_overlap": 0.5663976854071674,
      "val_verse_to_chorus_acc": 0.2168141592920354,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.42102062766717435,
      "val_pk_metric": 0.3160159544026429,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.1749315659205117,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.5124351402123769,
      "train_chorus_rate": 0.41513161063194276,
      "train_max_prob": 0.6582817514737447,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5169742306073507,
      "val_macro_f1": 0.7176934339724603,
      "val_verse_f1": 0.7814065317571629,
      "val_chorus_f1": 0.6539803361877577,
      "val_chorus_rate": 0.4767601490020752,
      "val_max_prob": 0.6777761578559875,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001007316103697571,
      "epoch_time": 96.69741415977478,
      "val_boundary_f1": 0.36595744680851067,
      "val_boundary_precision": 0.2862849533954727,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2586841843336319,
      "val_avg_segment_overlap": 0.6275607391939552,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.4404231646735357,
      "val_pk_metric": 0.3295812286089035,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.9058461467425027,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.49969120025634767,
      "train_chorus_rate": 0.4029515067736308,
      "train_max_prob": 0.6796280423800151,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5322540203730265,
      "val_macro_f1": 0.6241526897098952,
      "val_verse_f1": 0.6465816917728853,
      "val_chorus_f1": 0.6017236876469053,
      "val_chorus_rate": 0.6420897642771403,
      "val_max_prob": 0.6797045667966207,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012282090428570761,
      "epoch_time": 85.59326601028442,
      "val_boundary_f1": 0.22490706319702605,
      "val_boundary_precision": 0.18558282208588958,
      "val_boundary_recall": 0.28537735849056606,
      "val_complete_segments": 0.10328546739415656,
      "val_avg_segment_overlap": 0.5013331079988718,
      "val_verse_to_chorus_acc": 0.21238938053097345,
      "val_chorus_to_verse_acc": 0.3333333333333333,
      "val_window_diff": 0.4623209987343726,
      "val_pk_metric": 0.36714300040845066,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 3.1666472713152567,
      "cnn_effective_layers": 2
    }
  ]
}