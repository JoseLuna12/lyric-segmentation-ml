{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.2515522658453645,
      "layer_dropout": 0.13799317863749408,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00033015657998638136,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "line_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06767194012586164,
        "ece_after": 0.020242184517659925,
        "improvement": 0.047429755608201715,
        "params": {
          "temperature": 0.6743522752166811
        }
      },
      "platt": {
        "ece_before": 0.06767194012586164,
        "ece_after": 0.0197967213884084,
        "improvement": 0.04787521873745324,
        "params": {
          "A": 1.4615275036492281,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5392276611593034,
      "train_chorus_rate": 0.469370037317276,
      "train_max_prob": 0.6146096189816793,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5165099799633026,
      "val_macro_f1": 0.7036592685250039,
      "val_verse_f1": 0.7661731900223079,
      "val_chorus_f1": 0.6411453470277,
      "val_chorus_rate": 0.4889657646417618,
      "val_max_prob": 0.7192896604537964,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003176288036136067,
      "epoch_time": 140.56638431549072,
      "val_boundary_f1": 0.36003445305770887,
      "val_boundary_precision": 0.2835820895522388,
      "val_boundary_recall": 0.49292452830188677,
      "val_complete_segments": 0.2878438395415473,
      "val_avg_segment_overlap": 0.6299584712818718,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.4597997594954565,
      "val_pk_metric": 0.33591427922553213,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 16.82154432932536,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.4974971479839749,
      "train_chorus_rate": 0.423496769534217,
      "train_max_prob": 0.6968515117963155,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5095790922641754,
      "val_macro_f1": 0.7370158088111369,
      "val_verse_f1": 0.8223952539859103,
      "val_chorus_f1": 0.6516363636363636,
      "val_chorus_rate": 0.3741951286792755,
      "val_max_prob": 0.7012136876583099,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002819527148834619,
      "epoch_time": 97.71986103057861,
      "val_boundary_f1": 0.35968722849695917,
      "val_boundary_precision": 0.28473177441540576,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.25174785100286534,
      "val_avg_segment_overlap": 0.6664396679118201,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4613045823840004,
      "val_pk_metric": 0.3367207085182425,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.2652997506989374,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4985559152232276,
      "train_chorus_rate": 0.4202277726597256,
      "train_max_prob": 0.6919431289037069,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4933922737836838,
      "val_macro_f1": 0.7500386650377435,
      "val_verse_f1": 0.8150458000389788,
      "val_chorus_f1": 0.6850315300365084,
      "val_chorus_rate": 0.44167260825634,
      "val_max_prob": 0.7136879563331604,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000228559674900562,
      "epoch_time": 85.48622608184814,
      "val_boundary_f1": 0.4057971014492754,
      "val_boundary_precision": 0.3436988543371522,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.29363180515759313,
      "val_avg_segment_overlap": 0.6687069237810901,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4249245550705396,
      "val_pk_metric": 0.3114421089818218,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 8.91794937186771,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5017036894957224,
      "train_chorus_rate": 0.4390634530120426,
      "train_max_prob": 0.6970688700675964,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49327389895915985,
      "val_macro_f1": 0.7404724319517697,
      "val_verse_f1": 0.8006379585326954,
      "val_chorus_f1": 0.6803069053708439,
      "val_chorus_rate": 0.47055037319660187,
      "val_max_prob": 0.7380847036838531,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016557828999319067,
      "epoch_time": 81.39175486564636,
      "val_boundary_f1": 0.3868613138686131,
      "val_boundary_precision": 0.31547619047619047,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.2967765042979943,
      "val_avg_segment_overlap": 0.6633316401271852,
      "val_verse_to_chorus_acc": 0.45132743362831856,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.44256483110470624,
      "val_pk_metric": 0.32223031795926804,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.773178842332628,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.49024273620711434,
      "train_chorus_rate": 0.458921406004164,
      "train_max_prob": 0.7124421795209249,
      "train_conf_over_90": 0.00012353532171497741,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48754437267780304,
      "val_macro_f1": 0.7832072473130693,
      "val_verse_f1": 0.8560926300312443,
      "val_chorus_f1": 0.7103218645948945,
      "val_chorus_rate": 0.36368170380592346,
      "val_max_prob": 0.7391145825386047,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00010259690508581937,
      "epoch_time": 80.91120100021362,
      "val_boundary_f1": 0.45167118337850054,
      "val_boundary_precision": 0.36603221083455345,
      "val_boundary_recall": 0.589622641509434,
      "val_complete_segments": 0.3865830945558739,
      "val_avg_segment_overlap": 0.7076141601411947,
      "val_verse_to_chorus_acc": 0.6017699115044248,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.4015900483438933,
      "val_pk_metric": 0.26579378252104324,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 10.684251599841648,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.47577975193659466,
      "train_chorus_rate": 0.3547930485672421,
      "train_max_prob": 0.7125000622537401,
      "train_conf_over_90": 0.0003893789689755067,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4837235063314438,
      "val_macro_f1": 0.7701322698317289,
      "val_verse_f1": 0.8390022675736961,
      "val_chorus_f1": 0.7012622720897617,
      "val_chorus_rate": 0.40144874155521393,
      "val_max_prob": 0.7283570766448975,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.920386510291944e-05,
      "epoch_time": 78.6840078830719,
      "val_boundary_f1": 0.4352517985611511,
      "val_boundary_precision": 0.35174418604651164,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.35441977077363895,
      "val_avg_segment_overlap": 0.7031417646043324,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.4328763334178719,
      "val_pk_metric": 0.2846294536848079,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 172.44105883770519,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.479759994480345,
      "train_chorus_rate": 0.39802151918411255,
      "train_max_prob": 0.7005140781402588,
      "train_conf_over_90": 3.0804299361382924e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.483558788895607,
      "val_macro_f1": 0.763452751438441,
      "val_verse_f1": 0.8282244071717756,
      "val_chorus_f1": 0.6986810957051066,
      "val_chorus_rate": 0.4284012168645859,
      "val_max_prob": 0.726818859577179,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.3527776372774696e-05,
      "epoch_time": 68.88167691230774,
      "val_boundary_f1": 0.43169398907103823,
      "val_boundary_precision": 0.3516320474777448,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.339756446991404,
      "val_avg_segment_overlap": 0.6941376502723977,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4290729682845231,
      "val_pk_metric": 0.29725155858318775,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 168.18597110774783,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4849824342462752,
      "train_chorus_rate": 0.4103095796373155,
      "train_max_prob": 0.6998792952961392,
      "train_conf_over_90": 6.0731351065138974e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48236559331417084,
      "val_macro_f1": 0.7687258533958476,
      "val_verse_f1": 0.8351774132010682,
      "val_chorus_f1": 0.7022742935906271,
      "val_chorus_rate": 0.41502946615219116,
      "val_max_prob": 0.7285305261611938,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 68.83526396751404,
      "val_boundary_f1": 0.4361313868613139,
      "val_boundary_precision": 0.3556547619047619,
      "val_boundary_recall": 0.5636792452830188,
      "val_complete_segments": 0.349756446991404,
      "val_avg_segment_overlap": 0.7022346970918485,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5505050505050505,
      "val_window_diff": 0.4239716077838919,
      "val_pk_metric": 0.29283794835378113,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7348006500138177,
      "cnn_effective_layers": 2
    }
  ]
}