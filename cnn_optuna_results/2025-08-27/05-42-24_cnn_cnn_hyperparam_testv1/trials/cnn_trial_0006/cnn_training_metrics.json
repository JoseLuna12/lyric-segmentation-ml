{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 3,
      "dropout": 0.3733805864384754,
      "layer_dropout": 0.2424699869937886,
      "kernel_sizes": [
        5,
        7,
        9
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": true,
      "attention_type": "boundary_aware",
      "attention_heads": 4,
      "total_params": 1870336,
      "cnn_params": 1569789,
      "attention_params": 296705
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.000999350129974347,
      "scheduler": "onecycle",
      "scheduler_type": "step",
      "validation_strategy": "boundary_f1",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.02567624003573343,
        "ece_after": 0.024464302862791255,
        "improvement": 0.0012119371729421742,
        "params": {
          "temperature": 0.962185985996034
        }
      },
      "platt": {
        "ece_before": 0.02567624003573343,
        "ece_after": 0.032711443225972074,
        "improvement": -0.007035203190238645,
        "params": {
          "A": 0.9999999140386676,
          "B": -0.1505666960987709
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5785525838534037,
      "train_chorus_rate": 0.4578819751739502,
      "train_max_prob": 0.6299194693565369,
      "train_conf_over_90": 0.00048773480812087656,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5430107911427816,
      "val_macro_f1": 0.7025175947513413,
      "val_verse_f1": 0.7672448567970956,
      "val_chorus_f1": 0.6377903327055869,
      "val_chorus_rate": 0.48344719409942627,
      "val_max_prob": 0.7359704971313477,
      "val_conf_over_90": 0.08243376513322194,
      "val_conf_over_95": 0.0038043096040685973,
      "learning_rate": 4.9268117918129135e-05,
      "epoch_time": 88.86959409713745,
      "val_boundary_f1": 0.31854199683042794,
      "val_boundary_precision": 0.2398568019093079,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.22071540880503146,
      "val_avg_segment_overlap": 0.6180417176835561,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4924887603560187,
      "val_pk_metric": 0.362156482226128,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 9.92714467048645,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 2,
      "train_loss": 0.5375132540861766,
      "train_chorus_rate": 0.4089049438635508,
      "train_max_prob": 0.6704778830210368,
      "train_conf_over_90": 0.00584586679469794,
      "train_conf_over_95": 0.0,
      "val_loss": 0.546995997428894,
      "val_macro_f1": 0.6955783420910812,
      "val_verse_f1": 0.7513491075134912,
      "val_chorus_f1": 0.6398075766686712,
      "val_chorus_rate": 0.5179802974065145,
      "val_max_prob": 0.7497259775797526,
      "val_conf_over_90": 0.15611220399538675,
      "val_conf_over_95": 0.024845023949940998,
      "learning_rate": 7.679030314284793e-05,
      "epoch_time": 48.81562328338623,
      "val_boundary_f1": 0.30809399477806787,
      "val_boundary_precision": 0.24413793103448275,
      "val_boundary_recall": 0.41745283018867924,
      "val_complete_segments": 0.19259616606314722,
      "val_avg_segment_overlap": 0.5998177750708263,
      "val_verse_to_chorus_acc": 0.3495575221238938,
      "val_chorus_to_verse_acc": 0.43434343434343436,
      "val_window_diff": 0.48960099051810674,
      "val_pk_metric": 0.3756520966311314,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.306220022837321,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 3,
      "train_loss": 0.5335946321487427,
      "train_chorus_rate": 0.39177308479944867,
      "train_max_prob": 0.6683420141537985,
      "train_conf_over_90": 0.006759163302679856,
      "train_conf_over_95": 0.00013927257580993076,
      "val_loss": 0.5445746978123983,
      "val_macro_f1": 0.687337892620332,
      "val_verse_f1": 0.7385524372230428,
      "val_chorus_f1": 0.6361233480176212,
      "val_chorus_rate": 0.5378557840983073,
      "val_max_prob": 0.7398237983385721,
      "val_conf_over_90": 0.1102726732691129,
      "val_conf_over_95": 0.015859072096645832,
      "learning_rate": 0.00012147405823605063,
      "epoch_time": 44.287729263305664,
      "val_boundary_f1": 0.30685920577617326,
      "val_boundary_precision": 0.24853801169590642,
      "val_boundary_recall": 0.4009433962264151,
      "val_complete_segments": 0.18660166920780127,
      "val_avg_segment_overlap": 0.5942659653853076,
      "val_verse_to_chorus_acc": 0.34513274336283184,
      "val_chorus_to_verse_acc": 0.4090909090909091,
      "val_window_diff": 0.49580811357388255,
      "val_pk_metric": 0.37624921957405094,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.7711357990900676,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 4,
      "train_loss": 0.5280164321263631,
      "train_chorus_rate": 0.41597745021184285,
      "train_max_prob": 0.6664926886558533,
      "train_conf_over_90": 0.006083519873209297,
      "train_conf_over_95": 6.419235335973402e-05,
      "val_loss": 0.5488550066947937,
      "val_macro_f1": 0.7136984823271469,
      "val_verse_f1": 0.7757820383451061,
      "val_chorus_f1": 0.6516149263091878,
      "val_chorus_rate": 0.48472754160563153,
      "val_max_prob": 0.7666753133138021,
      "val_conf_over_90": 0.17103350162506104,
      "val_conf_over_95": 0.029358130569259327,
      "learning_rate": 0.00018158785852945942,
      "epoch_time": 56.69662594795227,
      "val_boundary_f1": 0.3279524214103653,
      "val_boundary_precision": 0.25630810092961487,
      "val_boundary_recall": 0.455188679245283,
      "val_complete_segments": 0.21230881932532877,
      "val_avg_segment_overlap": 0.6209299326238449,
      "val_verse_to_chorus_acc": 0.3893805309734513,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.4810051429745676,
      "val_pk_metric": 0.35903769025596133,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.4129031300544739,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 5,
      "train_loss": 0.5181803544362386,
      "train_chorus_rate": 0.42271397908528646,
      "train_max_prob": 0.6784438331921895,
      "train_conf_over_90": 0.010785317358871302,
      "train_conf_over_95": 0.00019832370259488622,
      "val_loss": 0.5336038172245026,
      "val_macro_f1": 0.7196030431196543,
      "val_verse_f1": 0.7815768302493967,
      "val_chorus_f1": 0.6576292559899117,
      "val_chorus_rate": 0.4807516137758891,
      "val_max_prob": 0.7493070761362711,
      "val_conf_over_90": 0.11970355361700058,
      "val_conf_over_95": 0.02367533432940642,
      "learning_rate": 0.0002548022550344012,
      "epoch_time": 56.95446300506592,
      "val_boundary_f1": 0.32252085264133457,
      "val_boundary_precision": 0.26564885496183205,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.193716846134299,
      "val_avg_segment_overlap": 0.6110778563233783,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.46678204277720176,
      "val_pk_metric": 0.34505228297949603,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.3402866125106812,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 6,
      "train_loss": 0.5093817591667176,
      "train_chorus_rate": 0.37682887514432273,
      "train_max_prob": 0.6787715514500936,
      "train_conf_over_90": 0.007500898372381925,
      "train_conf_over_95": 0.0001201398205012083,
      "val_loss": 0.5520955920219421,
      "val_macro_f1": 0.7186235626691397,
      "val_verse_f1": 0.7828868452618952,
      "val_chorus_f1": 0.6543602800763844,
      "val_chorus_rate": 0.47337621450424194,
      "val_max_prob": 0.7859294017155966,
      "val_conf_over_90": 0.21975483993689218,
      "val_conf_over_95": 0.029429538796345394,
      "learning_rate": 0.000338280142110203,
      "epoch_time": 42.197771072387695,
      "val_boundary_f1": 0.33917050691244244,
      "val_boundary_precision": 0.2783661119515885,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.20026126040276981,
      "val_avg_segment_overlap": 0.6084207463823956,
      "val_verse_to_chorus_acc": 0.37168141592920356,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.44071570399442944,
      "val_pk_metric": 0.3371039054985758,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.2026814301808675,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 7,
      "train_loss": 0.516061810652415,
      "train_chorus_rate": 0.38935790260632835,
      "train_max_prob": 0.688351054986318,
      "train_conf_over_90": 0.013121311304469903,
      "train_conf_over_95": 0.0003294888127129525,
      "val_loss": 0.5378459294637045,
      "val_macro_f1": 0.7650674971740703,
      "val_verse_f1": 0.8491862567811935,
      "val_chorus_f1": 0.6809487375669472,
      "val_chorus_rate": 0.34409745534261066,
      "val_max_prob": 0.7657493154207865,
      "val_conf_over_90": 0.11061017215251923,
      "val_conf_over_95": 0.00346245135491093,
      "learning_rate": 0.00042878669715912254,
      "epoch_time": 46.24961304664612,
      "val_boundary_f1": 0.4035259549461312,
      "val_boundary_precision": 0.34505862646566166,
      "val_boundary_recall": 0.4858490566037736,
      "val_complete_segments": 0.2932687726319802,
      "val_avg_segment_overlap": 0.6463301807756657,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.42424242424242425,
      "val_window_diff": 0.38196480349189343,
      "val_pk_metric": 0.2687435099835641,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.48213126262029,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 8,
      "train_loss": 0.48766231735547383,
      "train_chorus_rate": 0.3465124507745107,
      "train_max_prob": 0.6952537933985392,
      "train_conf_over_90": 0.015742108753571907,
      "train_conf_over_95": 0.0005929625437905391,
      "val_loss": 0.5830385684967041,
      "val_macro_f1": 0.760741643454039,
      "val_verse_f1": 0.858983286908078,
      "val_chorus_f1": 0.6625,
      "val_chorus_rate": 0.29170146584510803,
      "val_max_prob": 0.7932196855545044,
      "val_conf_over_90": 0.23056506117184958,
      "val_conf_over_95": 0.010213596435884634,
      "learning_rate": 0.000522814732112897,
      "epoch_time": 46.06928610801697,
      "val_boundary_f1": 0.40816326530612246,
      "val_boundary_precision": 0.3597122302158273,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.29250841750841755,
      "val_avg_segment_overlap": 0.6487446782775441,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.4292929292929293,
      "val_window_diff": 0.3623129810905037,
      "val_pk_metric": 0.25078803546595485,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.1267062346140544,
      "cnn_effective_layers": 3
    }
  ]
}