{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.29432574839839803,
      "layer_dropout": 0.1402754913432947,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005957386072095597,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.11084157623687287,
        "ece_after": 0.010301695371774876,
        "improvement": 0.10053988086509799,
        "params": {
          "temperature": 0.5470468498412377
        }
      },
      "platt": {
        "ece_before": 0.11084157623687287,
        "ece_after": 0.03353200466436115,
        "improvement": 0.07730957157251173,
        "params": {
          "A": 1.5613440880155525,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5357162157694498,
      "train_chorus_rate": 0.48147649897469413,
      "train_max_prob": 0.6392765376302931,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.507202535867691,
      "val_macro_f1": 0.7078363661678913,
      "val_verse_f1": 0.7650924024640657,
      "val_chorus_f1": 0.6505803298717167,
      "val_chorus_rate": 0.50441974401474,
      "val_max_prob": 0.6828454732894897,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000589240374457678,
      "epoch_time": 170.24946808815002,
      "val_boundary_f1": 0.34737747205503006,
      "val_boundary_precision": 0.2733423545331529,
      "val_boundary_recall": 0.47641509433962265,
      "val_complete_segments": 0.24046106041095122,
      "val_avg_segment_overlap": 0.6260753111886215,
      "val_verse_to_chorus_acc": 0.40707964601769914,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.47118616481863523,
      "val_pk_metric": 0.34189674764265054,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.0427347819010415,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.4921843409538269,
      "train_chorus_rate": 0.4325399233235253,
      "train_max_prob": 0.686420758565267,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4994659274816513,
      "val_macro_f1": 0.7454191230357154,
      "val_verse_f1": 0.8128155339805826,
      "val_chorus_f1": 0.6780227120908483,
      "val_chorus_rate": 0.4351961016654968,
      "val_max_prob": 0.7483555972576141,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00057002968015527,
      "epoch_time": 94.60262298583984,
      "val_boundary_f1": 0.3861566484517304,
      "val_boundary_precision": 0.314540059347181,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.2844745534964448,
      "val_avg_segment_overlap": 0.6606507127224417,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.45145064669484636,
      "val_pk_metric": 0.3144904533144337,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8224593864546882,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4924924406740401,
      "train_chorus_rate": 0.4128721621301439,
      "train_max_prob": 0.6946584781010946,
      "train_conf_over_90": 9.662776008351809e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5016056448221207,
      "val_macro_f1": 0.7193760015165163,
      "val_verse_f1": 0.7716828813910164,
      "val_chorus_f1": 0.6670691216420163,
      "val_chorus_rate": 0.5149194598197937,
      "val_max_prob": 0.7172897756099701,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005389461238264901,
      "epoch_time": 99.9490659236908,
      "val_boundary_f1": 0.35959595959595964,
      "val_boundary_precision": 0.31448763250883394,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.20728822574323946,
      "val_avg_segment_overlap": 0.6209056686507094,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.432871506082853,
      "val_pk_metric": 0.35569679877098204,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7765412098831601,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4846599068906572,
      "train_chorus_rate": 0.41846293873257107,
      "train_max_prob": 0.7144719097349379,
      "train_conf_over_90": 0.0001323946117837396,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49870167672634125,
      "val_macro_f1": 0.7245869071003967,
      "val_verse_f1": 0.7806570087737197,
      "val_chorus_f1": 0.6685168054270737,
      "val_chorus_rate": 0.49608205258846283,
      "val_max_prob": 0.7372767925262451,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004973482060383576,
      "epoch_time": 106.18743991851807,
      "val_boundary_f1": 0.3465959328028294,
      "val_boundary_precision": 0.27722772277227725,
      "val_boundary_recall": 0.46226415094339623,
      "val_complete_segments": 0.2423996416773977,
      "val_avg_segment_overlap": 0.6426837338441598,
      "val_verse_to_chorus_acc": 0.3938053097345133,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4825931205011015,
      "val_pk_metric": 0.34528838928647493,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8106250829166837,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48104649782180786,
      "train_chorus_rate": 0.42164167430665755,
      "train_max_prob": 0.7031573388311598,
      "train_conf_over_90": 0.00034230133234005835,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48284900188446045,
      "val_macro_f1": 0.7829468404009172,
      "val_verse_f1": 0.8517620734663435,
      "val_chorus_f1": 0.7141316073354909,
      "val_chorus_rate": 0.38280345499515533,
      "val_max_prob": 0.7500084340572357,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00044705395540716976,
      "epoch_time": 78.30873012542725,
      "val_boundary_f1": 0.46022727272727276,
      "val_boundary_precision": 0.38449367088607594,
      "val_boundary_recall": 0.5731132075471698,
      "val_complete_segments": 0.37432814512065393,
      "val_avg_segment_overlap": 0.7053669183004724,
      "val_verse_to_chorus_acc": 0.584070796460177,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4093523559921728,
      "val_pk_metric": 0.2707707528870808,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9912945727507273,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4711053669452667,
      "train_chorus_rate": 0.37623707784546745,
      "train_max_prob": 0.7032813827196757,
      "train_conf_over_90": 0.0014038373418669733,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5000308454036713,
      "val_macro_f1": 0.792121359009544,
      "val_verse_f1": 0.8746704165934259,
      "val_chorus_f1": 0.7095723014256619,
      "val_chorus_rate": 0.30101366341114044,
      "val_max_prob": 0.7141615450382233,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003902614720241002,
      "epoch_time": 73.69232296943665,
      "val_boundary_f1": 0.5040650406504066,
      "val_boundary_precision": 0.44285714285714284,
      "val_boundary_recall": 0.5849056603773585,
      "val_complete_segments": 0.39772409159621525,
      "val_avg_segment_overlap": 0.7171946448448423,
      "val_verse_to_chorus_acc": 0.5707964601769911,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.3516815441025925,
      "val_pk_metric": 0.2504904363776577,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8468756344583299,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.4679242405626509,
      "train_chorus_rate": 0.34002551270855796,
      "train_max_prob": 0.7114425566461351,
      "train_conf_over_90": 0.0016507855648847504,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4857010990381241,
      "val_macro_f1": 0.7530147907435141,
      "val_verse_f1": 0.8156709108716943,
      "val_chorus_f1": 0.690358670615334,
      "val_chorus_rate": 0.446806862950325,
      "val_max_prob": 0.7111024558544159,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032945285993355984,
      "epoch_time": 82.47711515426636,
      "val_boundary_f1": 0.3889908256880734,
      "val_boundary_precision": 0.3183183183183183,
      "val_boundary_recall": 0.5,
      "val_complete_segments": 0.2802894574771849,
      "val_avg_segment_overlap": 0.6723103495932845,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4371059971911834,
      "val_pk_metric": 0.31895355197579306,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8580754896004995,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.46370578474468654,
      "train_chorus_rate": 0.36179007093111676,
      "train_max_prob": 0.7048259642389085,
      "train_conf_over_90": 0.0020298551793934572,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47974035143852234,
      "val_macro_f1": 0.7757905690364858,
      "val_verse_f1": 0.843791219144526,
      "val_chorus_f1": 0.7077899189284456,
      "val_chorus_rate": 0.3958958834409714,
      "val_max_prob": 0.7409014105796814,
      "val_conf_over_90": 0.002269527845783159,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00026728574727600006,
      "epoch_time": 91.402841091156,
      "val_boundary_f1": 0.449820788530466,
      "val_boundary_precision": 0.3627167630057804,
      "val_boundary_recall": 0.5919811320754716,
      "val_complete_segments": 0.3737192766362466,
      "val_avg_segment_overlap": 0.7001507497205426,
      "val_verse_to_chorus_acc": 0.5929203539823009,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.39634598089452133,
      "val_pk_metric": 0.2704902483569038,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6264839073022207,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4686216645770603,
      "train_chorus_rate": 0.37963830762439305,
      "train_max_prob": 0.7148830890655518,
      "train_conf_over_90": 0.004185990689115392,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48240403831005096,
      "val_macro_f1": 0.7640039991446166,
      "val_verse_f1": 0.8267701260911736,
      "val_chorus_f1": 0.7012378721980594,
      "val_chorus_rate": 0.43364331126213074,
      "val_max_prob": 0.7339071929454803,
      "val_conf_over_90": 0.007907775929197669,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020647713518545964,
      "epoch_time": 82.95947909355164,
      "val_boundary_f1": 0.3949730700179533,
      "val_boundary_precision": 0.3188405797101449,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.29094115671015064,
      "val_avg_segment_overlap": 0.6704672621646753,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.439767668838493,
      "val_pk_metric": 0.3000021723281958,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7504178881645203,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.46337806516223484,
      "train_chorus_rate": 0.3734731905990177,
      "train_max_prob": 0.7175784971978929,
      "train_conf_over_90": 0.008431612177648477,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4805539697408676,
      "val_macro_f1": 0.7731939925307345,
      "val_verse_f1": 0.8438202247191011,
      "val_chorus_f1": 0.7025677603423679,
      "val_chorus_rate": 0.387581929564476,
      "val_max_prob": 0.742878645658493,
      "val_conf_over_90": 0.019148699939250946,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014968465180239003,
      "epoch_time": 82.03791165351868,
      "val_boundary_f1": 0.4134705332086062,
      "val_boundary_precision": 0.3426356589147287,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.2924248362353732,
      "val_avg_segment_overlap": 0.6729151871774366,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.39647382122856656,
      "val_pk_metric": 0.2798796210425272,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6768059266938103,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.45745473437839085,
      "train_chorus_rate": 0.37779880232281154,
      "train_max_prob": 0.7234185271792941,
      "train_conf_over_90": 0.016245111409160826,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48085547983646393,
      "val_macro_f1": 0.7735296681472319,
      "val_verse_f1": 0.8415486307837583,
      "val_chorus_f1": 0.7055107055107056,
      "val_chorus_rate": 0.39854787290096283,
      "val_max_prob": 0.7285305559635162,
      "val_conf_over_90": 0.016389240976423025,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.939040117120221e-05,
      "epoch_time": 73.72572493553162,
      "val_boundary_f1": 0.4347826086956523,
      "val_boundary_precision": 0.3627760252365931,
      "val_boundary_recall": 0.5424528301886793,
      "val_complete_segments": 0.3284880465819383,
      "val_avg_segment_overlap": 0.6810042436684347,
      "val_verse_to_chorus_acc": 0.5309734513274337,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.3889096905075584,
      "val_pk_metric": 0.27493381980901604,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7524857454829745,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.4462939467695024,
      "train_chorus_rate": 0.32622706558969283,
      "train_max_prob": 0.716177503267924,
      "train_conf_over_90": 0.01075591415994697,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48145462572574615,
      "val_macro_f1": 0.7768630136359218,
      "val_verse_f1": 0.8488674340883772,
      "val_chorus_f1": 0.7048585931834663,
      "val_chorus_rate": 0.3755531311035156,
      "val_max_prob": 0.7429619431495667,
      "val_conf_over_90": 0.0247031906619668,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.779248338306966e-05,
      "epoch_time": 78.34725666046143,
      "val_boundary_f1": 0.44801512287334594,
      "val_boundary_precision": 0.37381703470031546,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.33293908515760595,
      "val_avg_segment_overlap": 0.6822741114532616,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.37690518803445444,
      "val_pk_metric": 0.26767391537182283,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.5604965653684404,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.45246296789911056,
      "train_chorus_rate": 0.33518483572536045,
      "train_max_prob": 0.7326305177476671,
      "train_conf_over_90": 0.016849488744305238,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48211465775966644,
      "val_macro_f1": 0.7673340056462927,
      "val_verse_f1": 0.8359567608571972,
      "val_chorus_f1": 0.6987112504353884,
      "val_chorus_rate": 0.4039830267429352,
      "val_max_prob": 0.7427314519882202,
      "val_conf_over_90": 0.028919829986989498,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.670892705428969e-05,
      "epoch_time": 64.89633202552795,
      "val_boundary_f1": 0.409683426443203,
      "val_boundary_precision": 0.3384615384615385,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.2920819103073736,
      "val_avg_segment_overlap": 0.6681918916455968,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4050359531946025,
      "val_pk_metric": 0.28399964594386606,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9276872740851508,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.4516402681668599,
      "train_chorus_rate": 0.3519509732723236,
      "train_max_prob": 0.7221747173203362,
      "train_conf_over_90": 0.017780912212199636,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48106223344802856,
      "val_macro_f1": 0.771173208276748,
      "val_verse_f1": 0.8429906542056074,
      "val_chorus_f1": 0.6993557623478884,
      "val_chorus_rate": 0.38458381593227386,
      "val_max_prob": 0.7344554364681244,
      "val_conf_over_90": 0.022457377053797245,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.498232751881805e-06,
      "epoch_time": 73.98569893836975,
      "val_boundary_f1": 0.43268337975858867,
      "val_boundary_precision": 0.3568147013782542,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.3178363473489726,
      "val_avg_segment_overlap": 0.6763267037615415,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.38816740648401143,
      "val_pk_metric": 0.27310840364884326,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7360781795448728,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.447369032435947,
      "train_chorus_rate": 0.3215382860766517,
      "train_max_prob": 0.7164881361855401,
      "train_conf_over_90": 0.01253088858599464,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48093241453170776,
      "val_macro_f1": 0.7717923958864883,
      "val_verse_f1": 0.8440880268556509,
      "val_chorus_f1": 0.6994967649173257,
      "val_chorus_rate": 0.3815019279718399,
      "val_max_prob": 0.7344827353954315,
      "val_conf_over_90": 0.021740644238889217,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 65.27055191993713,
      "val_boundary_f1": 0.4376163873370577,
      "val_boundary_precision": 0.36153846153846153,
      "val_boundary_recall": 0.5542452830188679,
      "val_complete_segments": 0.3216785174402329,
      "val_avg_segment_overlap": 0.6785869312089784,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.3804368129889325,
      "val_pk_metric": 0.2699992071095818,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.5890654656622145,
      "cnn_effective_layers": 2
    }
  ]
}