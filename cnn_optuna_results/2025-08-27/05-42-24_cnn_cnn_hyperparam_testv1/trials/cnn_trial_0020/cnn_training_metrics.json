{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.30325820023494315,
      "layer_dropout": 0.12391040715187031,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0006633504878681281,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08359428306342577,
        "ece_after": 0.022525317527807513,
        "improvement": 0.06106896553561826,
        "params": {
          "temperature": 0.6427256749223325
        }
      },
      "platt": {
        "ece_before": 0.08359428306342577,
        "ece_after": 0.0835943080206751,
        "improvement": -2.495724933659904e-08,
        "params": {
          "A": 0.9999999712470747,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5403621733188629,
      "train_chorus_rate": 0.45537747293710706,
      "train_max_prob": 0.6391693532466889,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5169662535190582,
      "val_macro_f1": 0.6862575737787963,
      "val_verse_f1": 0.7355687606112056,
      "val_chorus_f1": 0.6369463869463869,
      "val_chorus_rate": 0.5426998436450958,
      "val_max_prob": 0.6819458603858948,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006561135142106017,
      "epoch_time": 339.0176959037781,
      "val_boundary_f1": 0.30446672743846853,
      "val_boundary_precision": 0.24814264487369986,
      "val_boundary_recall": 0.3938679245283019,
      "val_complete_segments": 0.17559747583243823,
      "val_avg_segment_overlap": 0.5987454707404823,
      "val_verse_to_chorus_acc": 0.3008849557522124,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4876282977675804,
      "val_pk_metric": 0.3766968027270613,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.0429383873939515,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.4998518109321594,
      "train_chorus_rate": 0.44127167761325836,
      "train_max_prob": 0.6823576509952545,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.505562424659729,
      "val_macro_f1": 0.7415348393949488,
      "val_verse_f1": 0.8069762884577699,
      "val_chorus_f1": 0.6760933903321277,
      "val_chorus_rate": 0.447266086935997,
      "val_max_prob": 0.7367021143436432,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006347188837137086,
      "epoch_time": 170.47637605667114,
      "val_boundary_f1": 0.3815439219165927,
      "val_boundary_precision": 0.3058321479374111,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2713614393125671,
      "val_avg_segment_overlap": 0.6647264420824395,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.45804297042832665,
      "val_pk_metric": 0.32350323826169236,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.87956562936306,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4991468995809555,
      "train_chorus_rate": 0.41223196089267733,
      "train_max_prob": 0.6893369376659393,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4994939863681793,
      "val_macro_f1": 0.7303385172585549,
      "val_verse_f1": 0.7861648016276704,
      "val_chorus_f1": 0.6745122328894394,
      "val_chorus_rate": 0.4935253858566284,
      "val_max_prob": 0.7197064757347107,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0006001016443929907,
      "epoch_time": 231.32333087921143,
      "val_boundary_f1": 0.36947791164658633,
      "val_boundary_precision": 0.32167832167832167,
      "val_boundary_recall": 0.4339622641509434,
      "val_complete_segments": 0.24470998925886145,
      "val_avg_segment_overlap": 0.6301497804024657,
      "val_verse_to_chorus_acc": 0.3672566371681416,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.43233908403984067,
      "val_pk_metric": 0.3334616568566845,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6638598501682281,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4896937757730484,
      "train_chorus_rate": 0.42007996439933776,
      "train_max_prob": 0.7096310198307038,
      "train_conf_over_90": 7.114056206773967e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.503571555018425,
      "val_macro_f1": 0.721914279767415,
      "val_verse_f1": 0.7769577695776958,
      "val_chorus_f1": 0.6668707899571341,
      "val_chorus_rate": 0.5019536316394806,
      "val_max_prob": 0.7332240641117096,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005537747357187072,
      "epoch_time": 209.04391193389893,
      "val_boundary_f1": 0.3581020590868397,
      "val_boundary_precision": 0.2886002886002886,
      "val_boundary_recall": 0.4716981132075472,
      "val_complete_segments": 0.24839554242749728,
      "val_avg_segment_overlap": 0.6398026205826367,
      "val_verse_to_chorus_acc": 0.39823008849557523,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4715879581526563,
      "val_pk_metric": 0.3400369746049743,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.5551686495542526,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48626922369003295,
      "train_chorus_rate": 0.4274946957826614,
      "train_max_prob": 0.708211362361908,
      "train_conf_over_90": 0.0007173189427703619,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4870990067720413,
      "val_macro_f1": 0.7872220111361623,
      "val_verse_f1": 0.8567197334320622,
      "val_chorus_f1": 0.7177242888402625,
      "val_chorus_rate": 0.37313637137413025,
      "val_max_prob": 0.7265794277191162,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004977628659010962,
      "epoch_time": 164.2899408340454,
      "val_boundary_f1": 0.47134935304990755,
      "val_boundary_precision": 0.38753799392097266,
      "val_boundary_recall": 0.6014150943396226,
      "val_complete_segments": 0.3950859291084855,
      "val_avg_segment_overlap": 0.7146301097544282,
      "val_verse_to_chorus_acc": 0.5929203539823009,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.4011887841822426,
      "val_pk_metric": 0.2674038782320168,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.912074065208435,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4725011646747589,
      "train_chorus_rate": 0.3692323714494705,
      "train_max_prob": 0.6961163759231568,
      "train_conf_over_90": 0.0005937415640801192,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49431055784225464,
      "val_macro_f1": 0.7882350920617975,
      "val_verse_f1": 0.8622383985441311,
      "val_chorus_f1": 0.7142317855794639,
      "val_chorus_rate": 0.35044679045677185,
      "val_max_prob": 0.743325263261795,
      "val_conf_over_90": 0.001065530115738511,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00043451402242595865,
      "epoch_time": 113.12375998497009,
      "val_boundary_f1": 0.47609756097560973,
      "val_boundary_precision": 0.4059900166389351,
      "val_boundary_recall": 0.5754716981132075,
      "val_complete_segments": 0.3561291621911923,
      "val_avg_segment_overlap": 0.6982545796258095,
      "val_verse_to_chorus_acc": 0.6061946902654868,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3787792939233714,
      "val_pk_metric": 0.26066088693585787,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7686906367540359,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.4729993283748627,
      "train_chorus_rate": 0.3464769542217255,
      "train_max_prob": 0.710306978225708,
      "train_conf_over_90": 0.003396590007469058,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49148014187812805,
      "val_macro_f1": 0.7620362497333719,
      "val_verse_f1": 0.8341500188465888,
      "val_chorus_f1": 0.689922480620155,
      "val_chorus_rate": 0.3970496505498886,
      "val_max_prob": 0.7000082731246948,
      "val_conf_over_90": 0.00026638252893462777,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003667924832547822,
      "epoch_time": 76.33927702903748,
      "val_boundary_f1": 0.41016652059596853,
      "val_boundary_precision": 0.3263598326359833,
      "val_boundary_recall": 0.5518867924528302,
      "val_complete_segments": 0.31473549946294305,
      "val_avg_segment_overlap": 0.6793814092995706,
      "val_verse_to_chorus_acc": 0.5442477876106194,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.42002430899487697,
      "val_pk_metric": 0.2953625793247911,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7776813924312591,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.47158258259296415,
      "train_chorus_rate": 0.35562770664691923,
      "train_max_prob": 0.7075248122215271,
      "train_conf_over_90": 0.003770707902731374,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49018383026123047,
      "val_macro_f1": 0.7806829461779077,
      "val_verse_f1": 0.8540938362465501,
      "val_chorus_f1": 0.7072720561092654,
      "val_chorus_rate": 0.3651562035083771,
      "val_max_prob": 0.723310112953186,
      "val_conf_over_90": 0.0012933205434819683,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00029755800461334623,
      "epoch_time": 93.13793992996216,
      "val_boundary_f1": 0.46691176470588236,
      "val_boundary_precision": 0.3825301204819277,
      "val_boundary_recall": 0.5990566037735849,
      "val_complete_segments": 0.36724624060150374,
      "val_avg_segment_overlap": 0.698189645727648,
      "val_verse_to_chorus_acc": 0.6150442477876106,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.39883748655084755,
      "val_pk_metric": 0.27450847820784696,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7024727404117584,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.47635585963726046,
      "train_chorus_rate": 0.37036961913108823,
      "train_max_prob": 0.7046316742897034,
      "train_conf_over_90": 0.004660085227806121,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4929177612066269,
      "val_macro_f1": 0.7528100064655443,
      "val_verse_f1": 0.8139397519196693,
      "val_chorus_f1": 0.6916802610114192,
      "val_chorus_rate": 0.45234712958335876,
      "val_max_prob": 0.735485166311264,
      "val_conf_over_90": 0.024982554838061333,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022983646544216964,
      "epoch_time": 134.01117491722107,
      "val_boundary_f1": 0.3758020164986251,
      "val_boundary_precision": 0.3073463268365817,
      "val_boundary_recall": 0.4834905660377358,
      "val_complete_segments": 0.25134935553168636,
      "val_avg_segment_overlap": 0.6604871010876235,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4461429293388197,
      "val_pk_metric": 0.32826692709577304,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.5720413148403167,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.46915502548217775,
      "train_chorus_rate": 0.370559623837471,
      "train_max_prob": 0.7132521569728851,
      "train_conf_over_90": 0.012037014123052359,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48570020496845245,
      "val_macro_f1": 0.7731954125544318,
      "val_verse_f1": 0.8405906853464596,
      "val_chorus_f1": 0.7058001397624039,
      "val_chorus_rate": 0.4026709794998169,
      "val_max_prob": 0.733458548784256,
      "val_conf_over_90": 0.017531368415802717,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00016658762196703215,
      "epoch_time": 92.14451909065247,
      "val_boundary_f1": 0.42366412213740456,
      "val_boundary_precision": 0.3557692307692308,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.30821697099892587,
      "val_avg_segment_overlap": 0.6805079897006032,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.40182291377630663,
      "val_pk_metric": 0.28728969888931666,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6712684512138367,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4627998828887939,
      "train_chorus_rate": 0.3885106086730957,
      "train_max_prob": 0.7169733941555023,
      "train_conf_over_90": 0.018747774604707956,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48589469492435455,
      "val_macro_f1": 0.7771712567998346,
      "val_verse_f1": 0.8474892663804368,
      "val_chorus_f1": 0.7068532472192323,
      "val_chorus_rate": 0.3843517601490021,
      "val_max_prob": 0.7279516756534576,
      "val_conf_over_90": 0.018330515827983618,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011057575214942112,
      "epoch_time": 103.72126913070679,
      "val_boundary_f1": 0.43166823751178135,
      "val_boundary_precision": 0.35949764521193095,
      "val_boundary_recall": 0.5400943396226415,
      "val_complete_segments": 0.30459183673469387,
      "val_avg_segment_overlap": 0.683614220925142,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.4494949494949495,
      "val_window_diff": 0.39218826728484557,
      "val_pk_metric": 0.2802908816820668,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6293737888336182,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.4527730315923691,
      "train_chorus_rate": 0.32242240458726884,
      "train_max_prob": 0.7180513679981232,
      "train_conf_over_90": 0.01426574201323092,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48796452581882477,
      "val_macro_f1": 0.7769320064171961,
      "val_verse_f1": 0.8468872686483455,
      "val_chorus_f1": 0.7069767441860465,
      "val_chorus_rate": 0.3860583007335663,
      "val_max_prob": 0.7419394552707672,
      "val_conf_over_90": 0.030306442640721798,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.424884347513755e-05,
      "epoch_time": 78.43892502784729,
      "val_boundary_f1": 0.44254510921177587,
      "val_boundary_precision": 0.37042925278219396,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.3217105263157895,
      "val_avg_segment_overlap": 0.6872418558458069,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.38148203126001534,
      "val_pk_metric": 0.27886912059278796,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6632462948560714,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.4558310031890869,
      "train_chorus_rate": 0.3445621609687805,
      "train_max_prob": 0.7281475067138672,
      "train_conf_over_90": 0.02038886034861207,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48831649124622345,
      "val_macro_f1": 0.7697613931923556,
      "val_verse_f1": 0.8368200836820084,
      "val_chorus_f1": 0.7027027027027027,
      "val_chorus_rate": 0.40844668447971344,
      "val_max_prob": 0.7361928820610046,
      "val_conf_over_90": 0.028518949635326862,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.9631604154419504e-05,
      "epoch_time": 131.02312874794006,
      "val_boundary_f1": 0.43158861340679516,
      "val_boundary_precision": 0.3533834586466165,
      "val_boundary_recall": 0.5542452830188679,
      "val_complete_segments": 0.3164406552094522,
      "val_avg_segment_overlap": 0.6810020134432508,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.40071111195447406,
      "val_pk_metric": 0.2902809450093864,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8342074543237686,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.4584100157022476,
      "train_chorus_rate": 0.354633429646492,
      "train_max_prob": 0.7146595597267151,
      "train_conf_over_90": 0.017804702371358873,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4870426505804062,
      "val_macro_f1": 0.7746760311891137,
      "val_verse_f1": 0.8454494487011774,
      "val_chorus_f1": 0.7039026136770499,
      "val_chorus_rate": 0.385834276676178,
      "val_max_prob": 0.7283903658390045,
      "val_conf_over_90": 0.022017516661435366,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.236973657526466e-06,
      "epoch_time": 1085.952763080597,
      "val_boundary_f1": 0.44033302497687327,
      "val_boundary_precision": 0.3622526636225266,
      "val_boundary_recall": 0.5613207547169812,
      "val_complete_segments": 0.32335526315789476,
      "val_avg_segment_overlap": 0.6863553408791974,
      "val_verse_to_chorus_acc": 0.5619469026548672,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.39614287050444297,
      "val_pk_metric": 0.2866601685764246,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6769650727510452,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.4556186020374298,
      "train_chorus_rate": 0.31714549362659455,
      "train_max_prob": 0.7106391251087188,
      "train_conf_over_90": 0.013747508078813553,
      "train_conf_over_95": 0.0,
      "val_loss": 0.486965611577034,
      "val_macro_f1": 0.7738979286369561,
      "val_verse_f1": 0.8456375838926173,
      "val_chorus_f1": 0.7021582733812949,
      "val_chorus_rate": 0.38260285556316376,
      "val_max_prob": 0.7291916012763977,
      "val_conf_over_90": 0.022283899132162333,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 84.36251711845398,
      "val_boundary_f1": 0.43825441039925717,
      "val_boundary_precision": 0.3614088820826952,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.3172328141783029,
      "val_avg_segment_overlap": 0.6816582425849925,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.3960655588621762,
      "val_pk_metric": 0.28605469825619206,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.5949586182832718,
      "cnn_effective_layers": 2
    }
  ]
}