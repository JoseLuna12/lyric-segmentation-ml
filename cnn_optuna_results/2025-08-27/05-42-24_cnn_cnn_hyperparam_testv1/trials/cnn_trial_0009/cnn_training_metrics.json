{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 2,
      "dropout": 0.3354834527306975,
      "layer_dropout": 0.21436880286110357,
      "kernel_sizes": [
        3,
        5,
        7
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 792320,
      "cnn_params": 785406,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.0002216644223806641,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.05369744114650959,
        "ece_after": 0.015510234476775239,
        "improvement": 0.03818720666973435,
        "params": {
          "temperature": 0.7653649599001164
        }
      },
      "platt": {
        "ece_before": 0.05369744114650959,
        "ece_after": 0.01869381083018185,
        "improvement": 0.035003630316327736,
        "params": {
          "A": 1.254855222964355,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5307496739061255,
      "train_chorus_rate": 0.452518072567488,
      "train_max_prob": 0.653841401401319,
      "train_conf_over_90": 0.0002977632470183859,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5076980963349342,
      "val_macro_f1": 0.7194419599412356,
      "val_verse_f1": 0.7823470411233702,
      "val_chorus_f1": 0.6565368787591009,
      "val_chorus_rate": 0.475800096988678,
      "val_max_prob": 0.7255292534828186,
      "val_conf_over_90": 0.0020012640161439776,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00021326588288579258,
      "epoch_time": 111.58302903175354,
      "val_boundary_f1": 0.3397260273972603,
      "val_boundary_precision": 0.27719821162444114,
      "val_boundary_recall": 0.4386792452830189,
      "val_complete_segments": 0.22333335998597478,
      "val_avg_segment_overlap": 0.6296146612247326,
      "val_verse_to_chorus_acc": 0.38495575221238937,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.46732145112994145,
      "val_pk_metric": 0.3501911278530142,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 2.341752450717123,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.5018845012313441,
      "train_chorus_rate": 0.41190501420121445,
      "train_max_prob": 0.6706622148814955,
      "train_conf_over_90": 0.00017411748596810197,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5121274068951607,
      "val_macro_f1": 0.7472279735632796,
      "val_verse_f1": 0.8204151590173301,
      "val_chorus_f1": 0.6740407881092292,
      "val_chorus_rate": 0.4096875265240669,
      "val_max_prob": 0.7266281098127365,
      "val_conf_over_90": 0.004345668072346598,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001893488659063221,
      "epoch_time": 107.95106101036072,
      "val_boundary_f1": 0.3938294010889293,
      "val_boundary_precision": 0.3200589970501475,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.31484182545718165,
      "val_avg_segment_overlap": 0.6785155406152896,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4535419687863012,
      "val_pk_metric": 0.32407666825971876,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.9108705552000749,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.5051465552104147,
      "train_chorus_rate": 0.36996338398833023,
      "train_max_prob": 0.6777206847542211,
      "train_conf_over_90": 0.001193160074763,
      "train_conf_over_95": 0.0,
      "val_loss": 0.504142127931118,
      "val_macro_f1": 0.7403836743916634,
      "val_verse_f1": 0.8072642062097246,
      "val_chorus_f1": 0.6735031425736023,
      "val_chorus_rate": 0.44152946025133133,
      "val_max_prob": 0.7265098989009857,
      "val_conf_over_90": 0.02435453049838543,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001535545204690783,
      "epoch_time": 84.24311900138855,
      "val_boundary_f1": 0.3575920934411501,
      "val_boundary_precision": 0.2888243831640058,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.24051225192313613,
      "val_avg_segment_overlap": 0.6517072566348777,
      "val_verse_to_chorus_acc": 0.42920353982300885,
      "val_chorus_to_verse_acc": 0.4696969696969697,
      "val_window_diff": 0.4644361817836466,
      "val_pk_metric": 0.3420296174200843,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.8824524801028403,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.5018958653274336,
      "train_chorus_rate": 0.38581505888386775,
      "train_max_prob": 0.676014310435245,
      "train_conf_over_90": 0.001962152413876825,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49820972979068756,
      "val_macro_f1": 0.7327151614771517,
      "val_verse_f1": 0.7940882764130219,
      "val_chorus_f1": 0.6713420465412815,
      "val_chorus_rate": 0.4694525822997093,
      "val_max_prob": 0.7151550352573395,
      "val_conf_over_90": 0.022680294467136264,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011133221119033204,
      "epoch_time": 86.39632368087769,
      "val_boundary_f1": 0.3575920934411501,
      "val_boundary_precision": 0.2888243831640058,
      "val_boundary_recall": 0.4693396226415094,
      "val_complete_segments": 0.24724616912700162,
      "val_avg_segment_overlap": 0.6522625627962437,
      "val_verse_to_chorus_acc": 0.4424778761061947,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4679875645012819,
      "val_pk_metric": 0.3401570797986381,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.1127120397592847,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48818144829649673,
      "train_chorus_rate": 0.39602210019764145,
      "train_max_prob": 0.686008378079063,
      "train_conf_over_90": 0.002144022814096197,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49556921422481537,
      "val_macro_f1": 0.7602904179231195,
      "val_verse_f1": 0.8351113606588059,
      "val_chorus_f1": 0.6854694751874331,
      "val_chorus_rate": 0.3871268257498741,
      "val_max_prob": 0.7166606932878494,
      "val_conf_over_90": 0.009308937995228916,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.910990191158581e-05,
      "epoch_time": 92.08244299888611,
      "val_boundary_f1": 0.3996383363471971,
      "val_boundary_precision": 0.32404692082111436,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.2929763389694786,
      "val_avg_segment_overlap": 0.6786951014749124,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.44850688030362357,
      "val_pk_metric": 0.3136350597350042,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 1.0123994444545947,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4837065041065216,
      "train_chorus_rate": 0.4017783168115114,
      "train_max_prob": 0.6930864327832272,
      "train_conf_over_90": 0.005236341348408084,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49272865802049637,
      "val_macro_f1": 0.7582318164268607,
      "val_verse_f1": 0.8269267546375979,
      "val_chorus_f1": 0.6895368782161234,
      "val_chorus_rate": 0.41523415595293045,
      "val_max_prob": 0.7246122807264328,
      "val_conf_over_90": 0.022925379686057568,
      "val_conf_over_95": 0.0,
      "learning_rate": 3.331555647434198e-05,
      "epoch_time": 79.57821202278137,
      "val_boundary_f1": 0.4230055658627087,
      "val_boundary_precision": 0.3486238532110092,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.3236250168800062,
      "val_avg_segment_overlap": 0.6827917434901492,
      "val_verse_to_chorus_acc": 0.5265486725663717,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.44705795495159917,
      "val_pk_metric": 0.3143703727642932,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.8729147911071777,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.48817829552449676,
      "train_chorus_rate": 0.38131623832803024,
      "train_max_prob": 0.6853697456811604,
      "train_conf_over_90": 0.0064690968934691655,
      "train_conf_over_95": 0.0,
      "val_loss": 0.492659792304039,
      "val_macro_f1": 0.7540413587638681,
      "val_verse_f1": 0.824651784010685,
      "val_chorus_f1": 0.6834309335170513,
      "val_chorus_rate": 0.4113629311323166,
      "val_max_prob": 0.7112866193056107,
      "val_conf_over_90": 0.02152654668316245,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.398539494871517e-06,
      "epoch_time": 87.72405409812927,
      "val_boundary_f1": 0.41312056737588654,
      "val_boundary_precision": 0.3309659090909091,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.3109217134923963,
      "val_avg_segment_overlap": 0.6775108919319539,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.4466827401926385,
      "val_pk_metric": 0.31855993181512576,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.7707158107506601,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4726022199580544,
      "train_chorus_rate": 0.3719314258349569,
      "train_max_prob": 0.6836883833533839,
      "train_conf_over_90": 0.004977569636570192,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4919636696577072,
      "val_macro_f1": 0.7608817661834979,
      "val_verse_f1": 0.8326407253494521,
      "val_chorus_f1": 0.6891228070175438,
      "val_chorus_rate": 0.3982696682214737,
      "val_max_prob": 0.7220079898834229,
      "val_conf_over_90": 0.025446666404604912,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 76.56307983398438,
      "val_boundary_f1": 0.4179372197309417,
      "val_boundary_precision": 0.33719247467438496,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.32801805035335485,
      "val_avg_segment_overlap": 0.6825820934305752,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.44426165119107575,
      "val_pk_metric": 0.308829549847057,
      "cnn_receptive_field_usage": 0.5,
      "cnn_gradient_norm": 0.7204072459747917,
      "cnn_effective_layers": 2
    }
  ]
}