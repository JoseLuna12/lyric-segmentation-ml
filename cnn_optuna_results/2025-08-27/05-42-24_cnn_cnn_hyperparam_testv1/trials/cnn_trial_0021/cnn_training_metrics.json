{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.28098494851746336,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        5,
        7,
        9
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 134528,
      "cnn_params": 129534,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00025003308878196587,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "boundary_f1",
      "total_epochs": 13,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.09285643320596522,
        "ece_after": 0.013061014748743835,
        "improvement": 0.07979541845722138,
        "params": {
          "temperature": 0.610731278151665
        }
      },
      "platt": {
        "ece_before": 0.09285643320596522,
        "ece_after": 0.01834264817722653,
        "improvement": 0.07451378502873869,
        "params": {
          "A": 1.4999985137679142,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5536548048257828,
      "train_chorus_rate": 0.49362286273390055,
      "train_max_prob": 0.5866539776325226,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5411926805973053,
      "val_macro_f1": 0.7194494557197865,
      "val_verse_f1": 0.801368561110055,
      "val_chorus_f1": 0.6375303503295179,
      "val_chorus_rate": 0.40613970160484314,
      "val_max_prob": 0.6495831608772278,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002473121035386873,
      "epoch_time": 30.315627098083496,
      "val_boundary_f1": 0.3551251008878128,
      "val_boundary_precision": 0.26993865030674846,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.2833610146459309,
      "val_avg_segment_overlap": 0.6379620729399718,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.41919191919191917,
      "val_window_diff": 0.4738057139825986,
      "val_pk_metric": 0.3299306828734969,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 11.110305048525333,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5247164517641068,
      "train_chorus_rate": 0.46753718703985214,
      "train_max_prob": 0.6562714651226997,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5105344653129578,
      "val_macro_f1": 0.7502033588454335,
      "val_verse_f1": 0.8262097533421201,
      "val_chorus_f1": 0.6741969643487469,
      "val_chorus_rate": 0.3960479646921158,
      "val_max_prob": 0.6761064231395721,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023926806792071864,
      "epoch_time": 20.12932777404785,
      "val_boundary_f1": 0.39144736842105265,
      "val_boundary_precision": 0.3005050505050505,
      "val_boundary_recall": 0.5613207547169812,
      "val_complete_segments": 0.35093613166238863,
      "val_avg_segment_overlap": 0.680100816913493,
      "val_verse_to_chorus_acc": 0.5265486725663717,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.46061818017458234,
      "val_pk_metric": 0.31626878701779987,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8459605723619461,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.5039439685642719,
      "train_chorus_rate": 0.3835669457912445,
      "train_max_prob": 0.672310397028923,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5046641230583191,
      "val_macro_f1": 0.7336825810726013,
      "val_verse_f1": 0.8084372003835091,
      "val_chorus_f1": 0.6589279617616934,
      "val_chorus_rate": 0.416846364736557,
      "val_max_prob": 0.6899770796298981,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022625254488413066,
      "epoch_time": 21.80028796195984,
      "val_boundary_f1": 0.38023450586264657,
      "val_boundary_precision": 0.2948051948051948,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.30516382304091805,
      "val_avg_segment_overlap": 0.6727975023648003,
      "val_verse_to_chorus_acc": 0.48672566371681414,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4695426712609355,
      "val_pk_metric": 0.3274931362588731,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 3.0825468003749847,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.4922550767660141,
      "train_chorus_rate": 0.38314832746982574,
      "train_max_prob": 0.6990083828568459,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5110054612159729,
      "val_macro_f1": 0.787975002348765,
      "val_verse_f1": 0.8694109297374024,
      "val_chorus_f1": 0.7065390749601276,
      "val_chorus_rate": 0.31747831404209137,
      "val_max_prob": 0.7249782979488373,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000208834375241031,
      "epoch_time": 22.61277198791504,
      "val_boundary_f1": 0.44656488549618323,
      "val_boundary_precision": 0.375,
      "val_boundary_recall": 0.5518867924528302,
      "val_complete_segments": 0.3615657556998339,
      "val_avg_segment_overlap": 0.703918130029556,
      "val_verse_to_chorus_acc": 0.5973451327433629,
      "val_chorus_to_verse_acc": 0.4393939393939394,
      "val_window_diff": 0.3999620266289916,
      "val_pk_metric": 0.2524156690395001,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.699826814234257,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.5138042159378529,
      "train_chorus_rate": 0.33416852727532387,
      "train_max_prob": 0.7147872224450111,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5024417042732239,
      "val_macro_f1": 0.7191872296166775,
      "val_verse_f1": 0.7751842751842752,
      "val_chorus_f1": 0.6631901840490798,
      "val_chorus_rate": 0.5045839846134186,
      "val_max_prob": 0.7021160125732422,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001877748165864744,
      "epoch_time": 22.13522505760193,
      "val_boundary_f1": 0.33577981651376143,
      "val_boundary_precision": 0.2747747747747748,
      "val_boundary_recall": 0.43160377358490565,
      "val_complete_segments": 0.21038049222406763,
      "val_avg_segment_overlap": 0.6287598698427439,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.5202020202020202,
      "val_window_diff": 0.46517858875585594,
      "val_pk_metric": 0.34555954374877984,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 8.34879207611084,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.4856080003082752,
      "train_chorus_rate": 0.4427138566970825,
      "train_max_prob": 0.6725102812051773,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4998568296432495,
      "val_macro_f1": 0.7696202952915475,
      "val_verse_f1": 0.8467341306347747,
      "val_chorus_f1": 0.6925064599483204,
      "val_chorus_rate": 0.3668689727783203,
      "val_max_prob": 0.6803567409515381,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001639942726886392,
      "epoch_time": 22.811172246932983,
      "val_boundary_f1": 0.43712055507372066,
      "val_boundary_precision": 0.345679012345679,
      "val_boundary_recall": 0.5943396226415094,
      "val_complete_segments": 0.38499169560622076,
      "val_avg_segment_overlap": 0.7033616192379426,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5707070707070707,
      "val_window_diff": 0.4366889043261846,
      "val_pk_metric": 0.2872461002142846,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.722867205739021,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.48241399601101875,
      "train_chorus_rate": 0.3265613913536072,
      "train_max_prob": 0.6903616189956665,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4898969680070877,
      "val_macro_f1": 0.7706066648472475,
      "val_verse_f1": 0.8398415393322015,
      "val_chorus_f1": 0.7013717903622935,
      "val_chorus_rate": 0.4011414647102356,
      "val_max_prob": 0.7144391536712646,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00013853206742757095,
      "epoch_time": 27.148499011993408,
      "val_boundary_f1": 0.4360360360360361,
      "val_boundary_precision": 0.35276967930029157,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.38643364034425487,
      "val_avg_segment_overlap": 0.6954603042066341,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.42704556690784723,
      "val_pk_metric": 0.285383633885094,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 237.2871375977993,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.5003208629786968,
      "train_chorus_rate": 0.4185910224914551,
      "train_max_prob": 0.7069082111120224,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49229827523231506,
      "val_macro_f1": 0.750217407194183,
      "val_verse_f1": 0.8143806174286831,
      "val_chorus_f1": 0.6860541969596827,
      "val_chorus_rate": 0.44839824736118317,
      "val_max_prob": 0.7076635956764221,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011250102135439496,
      "epoch_time": 24.82402205467224,
      "val_boundary_f1": 0.40398550724637683,
      "val_boundary_precision": 0.32794117647058824,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.3246263022799336,
      "val_avg_segment_overlap": 0.6795192668058203,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.4458031216512788,
      "val_pk_metric": 0.321806131059322,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 115.4974143281579,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.4930705651640892,
      "train_chorus_rate": 0.3988547623157501,
      "train_max_prob": 0.6927946135401726,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49206189811229706,
      "val_macro_f1": 0.7664414936983848,
      "val_verse_f1": 0.837507060817172,
      "val_chorus_f1": 0.6953759265795976,
      "val_chorus_rate": 0.3973933458328247,
      "val_max_prob": 0.6961168050765991,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.70388160933267e-05,
      "epoch_time": 20.19044303894043,
      "val_boundary_f1": 0.4286979627989372,
      "val_boundary_precision": 0.3432624113475177,
      "val_boundary_recall": 0.5707547169811321,
      "val_complete_segments": 0.36282651366450247,
      "val_avg_segment_overlap": 0.69668229682313,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.44215141215609655,
      "val_pk_metric": 0.29273242232926744,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9235578924417496,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.484878808259964,
      "train_chorus_rate": 0.3732571266591549,
      "train_max_prob": 0.6929529458284378,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48887690901756287,
      "val_macro_f1": 0.7606074991576468,
      "val_verse_f1": 0.8232775398987933,
      "val_chorus_f1": 0.6979374584165002,
      "val_chorus_rate": 0.4434005618095398,
      "val_max_prob": 0.7054339051246643,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.32582721954915e-05,
      "epoch_time": 22.629029035568237,
      "val_boundary_f1": 0.4293478260869565,
      "val_boundary_precision": 0.34852941176470587,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.3713875887060245,
      "val_avg_segment_overlap": 0.6782723901586569,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.43382279997402295,
      "val_pk_metric": 0.29916360018104127,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.3246953301131725,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 11,
      "train_loss": 0.4797181114554405,
      "train_chorus_rate": 0.4031190946698189,
      "train_max_prob": 0.6929099708795547,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4893098920583725,
      "val_macro_f1": 0.7649504820759063,
      "val_verse_f1": 0.8342185128983307,
      "val_chorus_f1": 0.6956824512534818,
      "val_chorus_rate": 0.4070138931274414,
      "val_max_prob": 0.7030459642410278,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 4.219871354093487e-05,
      "epoch_time": 20.177565097808838,
      "val_boundary_f1": 0.4383318544809228,
      "val_boundary_precision": 0.35135135135135137,
      "val_boundary_recall": 0.5825471698113207,
      "val_complete_segments": 0.3738185112486788,
      "val_avg_segment_overlap": 0.7004840739257152,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.5707070707070707,
      "val_window_diff": 0.4345700596959914,
      "val_pk_metric": 0.288285539593383,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7436055652797222,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 12,
      "train_loss": 0.47926484048366547,
      "train_chorus_rate": 0.34890227392315865,
      "train_max_prob": 0.6955451965332031,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4889485388994217,
      "val_macro_f1": 0.7670614429778859,
      "val_verse_f1": 0.8386248356190118,
      "val_chorus_f1": 0.69549805033676,
      "val_chorus_rate": 0.39308778941631317,
      "val_max_prob": 0.7058709859848022,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.478054389783521e-05,
      "epoch_time": 21.942124843597412,
      "val_boundary_f1": 0.43424536628420124,
      "val_boundary_precision": 0.3469675599435825,
      "val_boundary_recall": 0.5801886792452831,
      "val_complete_segments": 0.3629171070511853,
      "val_avg_segment_overlap": 0.702893103438727,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4305386355607717,
      "val_pk_metric": 0.28705651803331045,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 3.2996475026011467,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 13,
      "train_loss": 0.4812075197696686,
      "train_chorus_rate": 0.36275042593479156,
      "train_max_prob": 0.6991035863757133,
      "train_conf_over_90": 2.75694746960653e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48768067359924316,
      "val_macro_f1": 0.7650649558348479,
      "val_verse_f1": 0.8328568705927195,
      "val_chorus_f1": 0.6972730410769762,
      "val_chorus_rate": 0.41311685740947723,
      "val_max_prob": 0.7060292661190033,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.176502086124719e-05,
      "epoch_time": 22.69338583946228,
      "val_boundary_f1": 0.440251572327044,
      "val_boundary_precision": 0.3555878084179971,
      "val_boundary_recall": 0.5778301886792453,
      "val_complete_segments": 0.36282651366450247,
      "val_avg_segment_overlap": 0.6992845697481911,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4343318774293491,
      "val_pk_metric": 0.2948454453450652,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 4.1546213291585445,
      "cnn_effective_layers": 1
    }
  ]
}