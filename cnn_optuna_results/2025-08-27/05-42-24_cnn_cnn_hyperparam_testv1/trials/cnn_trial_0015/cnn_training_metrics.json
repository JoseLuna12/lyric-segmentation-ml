{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.2907305918349628,
      "layer_dropout": 0.13213801995376015,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005143177369180814,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08977258865573318,
        "ece_after": 0.009686415696659359,
        "improvement": 0.08008617295907382,
        "params": {
          "temperature": 0.6029764231908565
        }
      },
      "platt": {
        "ece_before": 0.08977258865573318,
        "ece_after": 0.007266138473522004,
        "improvement": 0.08250645018221117,
        "params": {
          "A": 1.6737002287591363,
          "B": -0.048132598768678696
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5340900480747223,
      "train_chorus_rate": 0.45765776336193087,
      "train_max_prob": 0.6389757394790649,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5032261312007904,
      "val_macro_f1": 0.7224804764798993,
      "val_verse_f1": 0.784840585522358,
      "val_chorus_f1": 0.6601203674374406,
      "val_chorus_rate": 0.47539547085762024,
      "val_max_prob": 0.706415444612503,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005087091248493048,
      "epoch_time": 27.327006816864014,
      "val_boundary_f1": 0.3737821080602303,
      "val_boundary_precision": 0.29929078014184396,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.2820565806313993,
      "val_avg_segment_overlap": 0.6406943552517728,
      "val_verse_to_chorus_acc": 0.4469026548672566,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4537300765180582,
      "val_pk_metric": 0.32859488567469386,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.3028615206480025,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49561154246330263,
      "train_chorus_rate": 0.45324647128582,
      "train_max_prob": 0.6801716327667237,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49765972793102264,
      "val_macro_f1": 0.7498347569381268,
      "val_verse_f1": 0.8206698564593301,
      "val_chorus_f1": 0.6789996574169236,
      "val_chorus_rate": 0.4172411262989044,
      "val_max_prob": 0.7383977472782135,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004921284119034871,
      "epoch_time": 21.00789999961853,
      "val_boundary_f1": 0.3795233892321271,
      "val_boundary_precision": 0.3032440056417489,
      "val_boundary_recall": 0.5070754716981132,
      "val_complete_segments": 0.2837630652730375,
      "val_avg_segment_overlap": 0.6680200205803697,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4526021926992798,
      "val_pk_metric": 0.3117761826365862,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.1084419190883636,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.4914542675018311,
      "train_chorus_rate": 0.39773876070976255,
      "train_max_prob": 0.6969338178634643,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4917084574699402,
      "val_macro_f1": 0.7292930283607144,
      "val_verse_f1": 0.7871307163091866,
      "val_chorus_f1": 0.6714553404122423,
      "val_chorus_rate": 0.4869880974292755,
      "val_max_prob": 0.6957213282585144,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004653002547994488,
      "epoch_time": 21.426223278045654,
      "val_boundary_f1": 0.3431952662721893,
      "val_boundary_precision": 0.29491525423728815,
      "val_boundary_recall": 0.41037735849056606,
      "val_complete_segments": 0.22837563993174062,
      "val_avg_segment_overlap": 0.6305973920197774,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.45479588036017676,
      "val_pk_metric": 0.359903305973558,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7314524233341217,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.48194451034069063,
      "train_chorus_rate": 0.42817160189151765,
      "train_max_prob": 0.7125338315963745,
      "train_conf_over_90": 0.0002555570041295141,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48752300441265106,
      "val_macro_f1": 0.7512767163281291,
      "val_verse_f1": 0.8141905135241082,
      "val_chorus_f1": 0.6883629191321499,
      "val_chorus_rate": 0.44727347791194916,
      "val_max_prob": 0.7575389444828033,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042939717273841703,
      "epoch_time": 20.714340925216675,
      "val_boundary_f1": 0.39788732394366194,
      "val_boundary_precision": 0.31741573033707865,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.3140265038395904,
      "val_avg_segment_overlap": 0.6845820158765784,
      "val_verse_to_chorus_acc": 0.4778761061946903,
      "val_chorus_to_verse_acc": 0.5606060606060606,
      "val_window_diff": 0.45484196808119237,
      "val_pk_metric": 0.31738392321363657,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7995891511440277,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.47911583483219145,
      "train_chorus_rate": 0.42931655049324036,
      "train_max_prob": 0.7168726444244384,
      "train_conf_over_90": 0.0009447776712477208,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48205748200416565,
      "val_macro_f1": 0.7960759368299763,
      "val_verse_f1": 0.8710951526032316,
      "val_chorus_f1": 0.721056721056721,
      "val_chorus_rate": 0.3323979824781418,
      "val_max_prob": 0.7358973026275635,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00038598830268856104,
      "epoch_time": 21.352049112319946,
      "val_boundary_f1": 0.49713193116634796,
      "val_boundary_precision": 0.4180064308681672,
      "val_boundary_recall": 0.6132075471698113,
      "val_complete_segments": 0.4084564313139932,
      "val_avg_segment_overlap": 0.7115512321854478,
      "val_verse_to_chorus_acc": 0.6371681415929203,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.3682753952924831,
      "val_pk_metric": 0.24639278668994818,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.071562686562538,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.46783673465251924,
      "train_chorus_rate": 0.3711774438619614,
      "train_max_prob": 0.7032393515110016,
      "train_conf_over_90": 0.000581398670328781,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4835503548383713,
      "val_macro_f1": 0.7804872722905509,
      "val_verse_f1": 0.8553113553113554,
      "val_chorus_f1": 0.7056631892697466,
      "val_chorus_rate": 0.3593379408121109,
      "val_max_prob": 0.7235417366027832,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003369708205699285,
      "epoch_time": 25.69876194000244,
      "val_boundary_f1": 0.4575163398692811,
      "val_boundary_precision": 0.3786707882534776,
      "val_boundary_recall": 0.5778301886792453,
      "val_complete_segments": 0.3469429927474403,
      "val_avg_segment_overlap": 0.706236484395697,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.5606060606060606,
      "val_window_diff": 0.4067323165362411,
      "val_pk_metric": 0.27407803638906636,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9743419885635376,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.46295001804828645,
      "train_chorus_rate": 0.33956491351127627,
      "train_max_prob": 0.7191952526569366,
      "train_conf_over_90": 0.0022237072931602596,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48055218160152435,
      "val_macro_f1": 0.7574992941840768,
      "val_verse_f1": 0.8218167701863354,
      "val_chorus_f1": 0.6931818181818181,
      "val_chorus_rate": 0.43512867391109467,
      "val_max_prob": 0.7267038822174072,
      "val_conf_over_90": 0.0007473928126273677,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0002844870255630791,
      "epoch_time": 25.22772192955017,
      "val_boundary_f1": 0.4003673094582186,
      "val_boundary_precision": 0.32781954887218046,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.28890251706484643,
      "val_avg_segment_overlap": 0.6678771855969192,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4253187801578032,
      "val_pk_metric": 0.31283528981573616,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.896255150437355,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.45852410793304443,
      "train_chorus_rate": 0.3579608857631683,
      "train_max_prob": 0.7115388154983521,
      "train_conf_over_90": 0.0030457070330157875,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4783964902162552,
      "val_macro_f1": 0.7831234297580684,
      "val_verse_f1": 0.8527881040892193,
      "val_chorus_f1": 0.7134587554269174,
      "val_chorus_rate": 0.37922388315200806,
      "val_max_prob": 0.7413853108882904,
      "val_conf_over_90": 0.0030277442128863186,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00023083071135500242,
      "epoch_time": 21.228522062301636,
      "val_boundary_f1": 0.4595588235294118,
      "val_boundary_precision": 0.37650602409638556,
      "val_boundary_recall": 0.589622641509434,
      "val_complete_segments": 0.3642744773890785,
      "val_avg_segment_overlap": 0.7000490062103684,
      "val_verse_to_chorus_acc": 0.6017699115044248,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.39040294880282206,
      "val_pk_metric": 0.2695519213247401,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.632079404592514,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 9,
      "train_loss": 0.4643260508775711,
      "train_chorus_rate": 0.3737135946750641,
      "train_max_prob": 0.7128540933132171,
      "train_conf_over_90": 0.004992928728461266,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48231375217437744,
      "val_macro_f1": 0.7534989207692729,
      "val_verse_f1": 0.8146399055489966,
      "val_chorus_f1": 0.6923579359895493,
      "val_chorus_rate": 0.4519634246826172,
      "val_max_prob": 0.7358919084072113,
      "val_conf_over_90": 0.014436870347708464,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000178346916348153,
      "epoch_time": 81.34087705612183,
      "val_boundary_f1": 0.3860589812332439,
      "val_boundary_precision": 0.3107913669064748,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.2744907209897611,
      "val_avg_segment_overlap": 0.6673886532831546,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.4480760666607557,
      "val_pk_metric": 0.32379548589318685,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6907064557075501,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 10,
      "train_loss": 0.46043576300144196,
      "train_chorus_rate": 0.3796737164258957,
      "train_max_prob": 0.7207053005695343,
      "train_conf_over_90": 0.010043508606031537,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47502996027469635,
      "val_macro_f1": 0.7792516010358363,
      "val_verse_f1": 0.8478831022855001,
      "val_chorus_f1": 0.7106200997861725,
      "val_chorus_rate": 0.3893629014492035,
      "val_max_prob": 0.7416296303272247,
      "val_conf_over_90": 0.0169154554605484,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012932943422952042,
      "epoch_time": 67.82960891723633,
      "val_boundary_f1": 0.4374420759962928,
      "val_boundary_precision": 0.3603053435114504,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.3064606441979522,
      "val_avg_segment_overlap": 0.6920117333611087,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.40399623856613487,
      "val_pk_metric": 0.28541260510763616,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6785367131233215,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 11,
      "train_loss": 0.4516231596469879,
      "train_chorus_rate": 0.37344319820404054,
      "train_max_prob": 0.7200199723243713,
      "train_conf_over_90": 0.013621378876268863,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47662805020809174,
      "val_macro_f1": 0.7714428464817416,
      "val_verse_f1": 0.8378995433789955,
      "val_chorus_f1": 0.7049861495844876,
      "val_chorus_rate": 0.4094735383987427,
      "val_max_prob": 0.7372530400753021,
      "val_conf_over_90": 0.01945129968225956,
      "val_conf_over_95": 0.0,
      "learning_rate": 8.592056417966444e-05,
      "epoch_time": 74.65395617485046,
      "val_boundary_f1": 0.4230055658627087,
      "val_boundary_precision": 0.3486238532110092,
      "val_boundary_recall": 0.5377358490566038,
      "val_complete_segments": 0.310613534556314,
      "val_avg_segment_overlap": 0.678061195741394,
      "val_verse_to_chorus_acc": 0.5530973451327433,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4085021239945247,
      "val_pk_metric": 0.2940465686843601,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6126852035522461,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 12,
      "train_loss": 0.44214958548545835,
      "train_chorus_rate": 0.33262732326984407,
      "train_max_prob": 0.724410742521286,
      "train_conf_over_90": 0.012274274742230773,
      "train_conf_over_95": 0.0,
      "val_loss": 0.477729007601738,
      "val_macro_f1": 0.7828995564373027,
      "val_verse_f1": 0.8551952837140752,
      "val_chorus_f1": 0.7106038291605301,
      "val_chorus_rate": 0.36724650859832764,
      "val_max_prob": 0.7504189014434814,
      "val_conf_over_90": 0.026848881505429745,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.001748211863261e-05,
      "epoch_time": 69.49273300170898,
      "val_boundary_f1": 0.45904761904761904,
      "val_boundary_precision": 0.38498402555910544,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.3308647077645051,
      "val_avg_segment_overlap": 0.6942852814046564,
      "val_verse_to_chorus_acc": 0.5752212389380531,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.37190105065445367,
      "val_pk_metric": 0.2636863987189576,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6308583408594132,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 13,
      "train_loss": 0.4496575891971588,
      "train_chorus_rate": 0.32982508540153505,
      "train_max_prob": 0.7368624389171601,
      "train_conf_over_90": 0.01659213677048683,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4788627624511719,
      "val_macro_f1": 0.7707459301640123,
      "val_verse_f1": 0.8393194706994329,
      "val_chorus_f1": 0.7021723896285915,
      "val_chorus_rate": 0.4011494219303131,
      "val_max_prob": 0.748091459274292,
      "val_conf_over_90": 0.032828024588525295,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.318932501459424e-05,
      "epoch_time": 63.92409896850586,
      "val_boundary_f1": 0.433425160697888,
      "val_boundary_precision": 0.3548872180451128,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.2996147077645051,
      "val_avg_segment_overlap": 0.6790749984923797,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4041155931062787,
      "val_pk_metric": 0.28551962706245504,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0614526510238647,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 14,
      "train_loss": 0.44853810369968417,
      "train_chorus_rate": 0.35344146490097045,
      "train_max_prob": 0.7262503385543824,
      "train_conf_over_90": 0.019107453990727663,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47756437957286835,
      "val_macro_f1": 0.7731170787513117,
      "val_verse_f1": 0.8438786971171846,
      "val_chorus_f1": 0.7023554603854388,
      "val_chorus_rate": 0.3883027583360672,
      "val_max_prob": 0.7400573790073395,
      "val_conf_over_90": 0.025845997035503387,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.608612068776604e-06,
      "epoch_time": 71.71754002571106,
      "val_boundary_f1": 0.4442429737080689,
      "val_boundary_precision": 0.36082474226804123,
      "val_boundary_recall": 0.5778301886792453,
      "val_complete_segments": 0.32401877133105805,
      "val_avg_segment_overlap": 0.6837440296196422,
      "val_verse_to_chorus_acc": 0.584070796460177,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.4009329399473959,
      "val_pk_metric": 0.28251458079252745,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8016205608844758,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 15,
      "train_loss": 0.44198198020458224,
      "train_chorus_rate": 0.3258757501840591,
      "train_max_prob": 0.7196948647499084,
      "train_conf_over_90": 0.014295285940170288,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4772089123725891,
      "val_macro_f1": 0.7742059350219338,
      "val_verse_f1": 0.8465687186163288,
      "val_chorus_f1": 0.7018431514275388,
      "val_chorus_rate": 0.37976132333278656,
      "val_max_prob": 0.739903599023819,
      "val_conf_over_90": 0.024095716886222363,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 70.8789119720459,
      "val_boundary_f1": 0.45013723696248864,
      "val_boundary_precision": 0.36771300448430494,
      "val_boundary_recall": 0.5801886792452831,
      "val_complete_segments": 0.3262185366894198,
      "val_avg_segment_overlap": 0.6855140869774641,
      "val_verse_to_chorus_acc": 0.5752212389380531,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.38492604931422303,
      "val_pk_metric": 0.27623190516063534,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6224341481924057,
      "cnn_effective_layers": 2
    }
  ]
}