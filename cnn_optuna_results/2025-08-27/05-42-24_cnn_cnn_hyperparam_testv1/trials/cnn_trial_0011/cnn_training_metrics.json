{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.2603275071986575,
      "layer_dropout": 0.10068662910594324,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0004046268582328232,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08668005151750999,
        "ece_after": 0.019658634537915106,
        "improvement": 0.06702141697959488,
        "params": {
          "temperature": 0.6134156653875926
        }
      },
      "platt": {
        "ece_before": 0.08668005151750999,
        "ece_after": 0.023620649074407335,
        "improvement": 0.06305940244310265,
        "params": {
          "A": 1.4999974370219256,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5426602125167846,
      "train_chorus_rate": 0.4731972336769104,
      "train_max_prob": 0.6311950206756591,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5130927562713623,
      "val_macro_f1": 0.7198059265264749,
      "val_verse_f1": 0.7871708572559889,
      "val_chorus_f1": 0.6524409957969608,
      "val_chorus_rate": 0.4595210701227188,
      "val_max_prob": 0.7055875360965729,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00038926472566298164,
      "epoch_time": 114.98077416419983,
      "val_boundary_f1": 0.3754152823920266,
      "val_boundary_precision": 0.28974358974358977,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.3120733788395904,
      "val_avg_segment_overlap": 0.6393207433931432,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4608422104229647,
      "val_pk_metric": 0.3284448191466897,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.3256161510944366,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49431425929069517,
      "train_chorus_rate": 0.4295251727104187,
      "train_max_prob": 0.6830508351325989,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4995715916156769,
      "val_macro_f1": 0.7478257763203423,
      "val_verse_f1": 0.8168145005784805,
      "val_chorus_f1": 0.6788370520622041,
      "val_chorus_rate": 0.4269190728664398,
      "val_max_prob": 0.7364912927150726,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034551707337913685,
      "epoch_time": 86.43524384498596,
      "val_boundary_f1": 0.409048067860509,
      "val_boundary_precision": 0.34065934065934067,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3142731441979522,
      "val_avg_segment_overlap": 0.668766013803271,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.43310182400983643,
      "val_pk_metric": 0.30679695112972516,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.719712296128273,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.494165825843811,
      "train_chorus_rate": 0.39890552759170533,
      "train_max_prob": 0.707294499874115,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4926692843437195,
      "val_macro_f1": 0.7366749908271613,
      "val_verse_f1": 0.7959101844426624,
      "val_chorus_f1": 0.6774397972116603,
      "val_chorus_rate": 0.4755789637565613,
      "val_max_prob": 0.7036608159542084,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00028004408486804875,
      "epoch_time": 80.49177408218384,
      "val_boundary_f1": 0.3872832369942196,
      "val_boundary_precision": 0.3273615635179153,
      "val_boundary_recall": 0.4740566037735849,
      "val_complete_segments": 0.2742440806313993,
      "val_avg_segment_overlap": 0.6495766290322048,
      "val_verse_to_chorus_acc": 0.415929203539823,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4386478512873881,
      "val_pk_metric": 0.33742843366640995,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8192579686641693,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4838566094636917,
      "train_chorus_rate": 0.4230517327785492,
      "train_max_prob": 0.705492091178894,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4916600435972214,
      "val_macro_f1": 0.7446862522954896,
      "val_verse_f1": 0.8037495013960909,
      "val_chorus_f1": 0.6856230031948881,
      "val_chorus_rate": 0.46895523369312286,
      "val_max_prob": 0.7506822943687439,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020281342911641158,
      "epoch_time": 76.78489112854004,
      "val_boundary_f1": 0.38391224862888484,
      "val_boundary_precision": 0.31343283582089554,
      "val_boundary_recall": 0.49528301886792453,
      "val_complete_segments": 0.28182993813993173,
      "val_avg_segment_overlap": 0.659139016917812,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.44745722246915065,
      "val_pk_metric": 0.32613598831371404,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6651970893144608,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.4829250395298004,
      "train_chorus_rate": 0.4417219549417496,
      "train_max_prob": 0.728943657875061,
      "train_conf_over_90": 0.00034565675887279215,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4855978786945343,
      "val_macro_f1": 0.7916035495556121,
      "val_verse_f1": 0.866835077589318,
      "val_chorus_f1": 0.7163720215219062,
      "val_chorus_rate": 0.33938001096248627,
      "val_max_prob": 0.738378494977951,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00012558277336477446,
      "epoch_time": 71.6315131187439,
      "val_boundary_f1": 0.48608534322820035,
      "val_boundary_precision": 0.40061162079510704,
      "val_boundary_recall": 0.6179245283018868,
      "val_complete_segments": 0.4099162755972696,
      "val_avg_segment_overlap": 0.710044281751998,
      "val_verse_to_chorus_acc": 0.6283185840707964,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.38680222026456745,
      "val_pk_metric": 0.24323569592338234,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.3929298400878907,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.47405642867088316,
      "train_chorus_rate": 0.3417315810918808,
      "train_max_prob": 0.7099880337715149,
      "train_conf_over_90": 6.204648234415799e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47993290424346924,
      "val_macro_f1": 0.7775878759582013,
      "val_verse_f1": 0.8455896182057552,
      "val_chorus_f1": 0.7095861337106474,
      "val_chorus_rate": 0.39442287385463715,
      "val_max_prob": 0.7215175032615662,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.010978485368633e-05,
      "epoch_time": 80.05176591873169,
      "val_boundary_f1": 0.44919786096256686,
      "val_boundary_precision": 0.36103151862464183,
      "val_boundary_recall": 0.5943396226415094,
      "val_complete_segments": 0.3740401023890785,
      "val_avg_segment_overlap": 0.7103544280888029,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5757575757575758,
      "val_window_diff": 0.4169717307369787,
      "val_pk_metric": 0.2791579165990705,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.176513734459877,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.4687848061323166,
      "train_chorus_rate": 0.3605888783931732,
      "train_max_prob": 0.7023367702960968,
      "train_conf_over_90": 9.459931461606175e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47986483573913574,
      "val_macro_f1": 0.7718909365314761,
      "val_verse_f1": 0.8366488140780414,
      "val_chorus_f1": 0.7071330589849109,
      "val_chorus_rate": 0.4164173901081085,
      "val_max_prob": 0.728023499250412,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.636213256984155e-05,
      "epoch_time": 70.55234098434448,
      "val_boundary_f1": 0.42513863216266173,
      "val_boundary_precision": 0.3495440729483283,
      "val_boundary_recall": 0.5424528301886793,
      "val_complete_segments": 0.34209017704778155,
      "val_avg_segment_overlap": 0.6934222364354528,
      "val_verse_to_chorus_acc": 0.5398230088495575,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.42258459990745234,
      "val_pk_metric": 0.2941988018068613,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8103463083505631,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.4697409212589264,
      "train_chorus_rate": 0.39343230724334716,
      "train_max_prob": 0.7086193978786468,
      "train_conf_over_90": 0.00026702048198785634,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4796068072319031,
      "val_macro_f1": 0.7729153106626205,
      "val_verse_f1": 0.8378842848959327,
      "val_chorus_f1": 0.7079463364293085,
      "val_chorus_rate": 0.4141943007707596,
      "val_max_prob": 0.7302514910697937,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 75.2018210887909,
      "val_boundary_f1": 0.42936802973977695,
      "val_boundary_precision": 0.35429447852760737,
      "val_boundary_recall": 0.5448113207547169,
      "val_complete_segments": 0.34038369240614336,
      "val_avg_segment_overlap": 0.6930216569317147,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4212631686231392,
      "val_pk_metric": 0.29413273881728486,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6607022136449814,
      "cnn_effective_layers": 2
    }
  ]
}