{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 256,
      "num_layers": 3,
      "dropout": 0.3210942460394309,
      "layer_dropout": 0.2001336607781541,
      "kernel_sizes": [
        3,
        5
      ],
      "dilation_rates": [
        1,
        2,
        4
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 795650,
      "cnn_params": 788736,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 32,
      "learning_rate": 0.00012071438661569677,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 12,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.06943473600451276,
        "ece_after": 0.009243041086641894,
        "improvement": 0.06019169491787087,
        "params": {
          "temperature": 0.6735662256145774
        }
      },
      "platt": {
        "ece_before": 0.06943473600451276,
        "ece_after": 0.010501073201302235,
        "improvement": 0.058933662803210524,
        "params": {
          "A": 1.499999724688666,
          "B": -4.405530441609595e-06
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5337925814092159,
      "train_chorus_rate": 0.4472113158553839,
      "train_max_prob": 0.6297723278403282,
      "train_conf_over_90": 3.625289900810458e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5054125487804413,
      "val_macro_f1": 0.7543631385321214,
      "val_verse_f1": 0.8423146473779384,
      "val_chorus_f1": 0.6664116296863045,
      "val_chorus_rate": 0.33864255994558334,
      "val_max_prob": 0.6852146834135056,
      "val_conf_over_90": 0.000754689157474786,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011867480221307632,
      "epoch_time": 139.36732816696167,
      "val_boundary_f1": 0.36150627615062764,
      "val_boundary_precision": 0.2801556420233463,
      "val_boundary_recall": 0.5094339622641509,
      "val_complete_segments": 0.28478756314568315,
      "val_avg_segment_overlap": 0.6685479429882715,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.45454545454545453,
      "val_window_diff": 0.4816248640783338,
      "val_pk_metric": 0.3116600998358515,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 3.4999991171061993,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 2,
      "train_loss": 0.5119163803756237,
      "train_chorus_rate": 0.43214479088783264,
      "train_max_prob": 0.6549059860408306,
      "train_conf_over_90": 0.00014217324496712536,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4988998845219612,
      "val_macro_f1": 0.7554813368098798,
      "val_verse_f1": 0.8343854437430375,
      "val_chorus_f1": 0.6765772298767223,
      "val_chorus_rate": 0.3673475608229637,
      "val_max_prob": 0.6908163577318192,
      "val_conf_over_90": 0.002152912667952478,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00011269504331168099,
      "epoch_time": 131.96452593803406,
      "val_boundary_f1": 0.3853530950305144,
      "val_boundary_precision": 0.30567081604426005,
      "val_boundary_recall": 0.5212264150943396,
      "val_complete_segments": 0.3162233750463566,
      "val_avg_segment_overlap": 0.6950011633892632,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.4595959595959596,
      "val_window_diff": 0.4729996640315133,
      "val_pk_metric": 0.31250397906245886,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.9115113690495491,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 3,
      "train_loss": 0.4944190625101328,
      "train_chorus_rate": 0.4057357907295227,
      "train_max_prob": 0.6669120192527771,
      "train_conf_over_90": 0.0008744263868720736,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48767220973968506,
      "val_macro_f1": 0.7415864867004871,
      "val_verse_f1": 0.8106956016275916,
      "val_chorus_f1": 0.6724773717733826,
      "val_chorus_rate": 0.4241950437426567,
      "val_max_prob": 0.7289363592863083,
      "val_conf_over_90": 0.031013767002150416,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000103182620598622,
      "epoch_time": 117.63994026184082,
      "val_boundary_f1": 0.39314697926059516,
      "val_boundary_precision": 0.3182481751824818,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.3060061939074248,
      "val_avg_segment_overlap": 0.6859865168575967,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.4797979797979798,
      "val_window_diff": 0.47460435155099867,
      "val_pk_metric": 0.3285494750689646,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8433468192815781,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 4,
      "train_loss": 0.4953196533024311,
      "train_chorus_rate": 0.422326372936368,
      "train_max_prob": 0.6771255061030388,
      "train_conf_over_90": 0.0020211991686664987,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48354093730449677,
      "val_macro_f1": 0.7597814702877392,
      "val_verse_f1": 0.8289799809342231,
      "val_chorus_f1": 0.6905829596412555,
      "val_chorus_rate": 0.4059899374842644,
      "val_max_prob": 0.7228180319070816,
      "val_conf_over_90": 0.02348191663622856,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.078578996177258e-05,
      "epoch_time": 117.23242807388306,
      "val_boundary_f1": 0.4083865086599818,
      "val_boundary_precision": 0.3328380386329866,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.3011855444052267,
      "val_avg_segment_overlap": 0.6943376830775405,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.45945915478883104,
      "val_pk_metric": 0.3068442187184921,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8386325500905514,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 5,
      "train_loss": 0.48822907730937004,
      "train_chorus_rate": 0.38545177690684795,
      "train_max_prob": 0.6811793074011803,
      "train_conf_over_90": 0.0018186616180173587,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48641209304332733,
      "val_macro_f1": 0.7350404262092481,
      "val_verse_f1": 0.7953590718143628,
      "val_chorus_f1": 0.6747217806041335,
      "val_chorus_rate": 0.4679219424724579,
      "val_max_prob": 0.7181849479675293,
      "val_conf_over_90": 0.029714874923229218,
      "val_conf_over_95": 0.0002012882468989119,
      "learning_rate": 7.63493749223027e-05,
      "epoch_time": 108.01436305046082,
      "val_boundary_f1": 0.38691588785046727,
      "val_boundary_precision": 0.3204334365325077,
      "val_boundary_recall": 0.4882075471698113,
      "val_complete_segments": 0.2530317105876668,
      "val_avg_segment_overlap": 0.6708033539139787,
      "val_verse_to_chorus_acc": 0.4646017699115044,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.47050154309366976,
      "val_pk_metric": 0.32723999581151847,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.0562965907156467,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 6,
      "train_loss": 0.47816144675016403,
      "train_chorus_rate": 0.414109556004405,
      "train_max_prob": 0.688130546361208,
      "train_conf_over_90": 0.006900448468513787,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4806850552558899,
      "val_macro_f1": 0.7614950390741702,
      "val_verse_f1": 0.8287356321839081,
      "val_chorus_f1": 0.6942544459644323,
      "val_chorus_rate": 0.41310831159353256,
      "val_max_prob": 0.7436311841011047,
      "val_conf_over_90": 0.055908242240548134,
      "val_conf_over_95": 0.0016247436287812889,
      "learning_rate": 6.085719330784838e-05,
      "epoch_time": 109.66309809684753,
      "val_boundary_f1": 0.43355325164938735,
      "val_boundary_precision": 0.36106750392464676,
      "val_boundary_recall": 0.5424528301886793,
      "val_complete_segments": 0.3338372105844463,
      "val_avg_segment_overlap": 0.7094987392928009,
      "val_verse_to_chorus_acc": 0.5176991150442478,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.44636955659014077,
      "val_pk_metric": 0.2911192425761295,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.046627752482891,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 7,
      "train_loss": 0.4815980866551399,
      "train_chorus_rate": 0.40931442379951477,
      "train_max_prob": 0.691278513520956,
      "train_conf_over_90": 0.006579681241419166,
      "train_conf_over_95": 3.5310735256643966e-05,
      "val_loss": 0.4788162261247635,
      "val_macro_f1": 0.7645153828359935,
      "val_verse_f1": 0.8320610687022901,
      "val_chorus_f1": 0.6969696969696969,
      "val_chorus_rate": 0.4041539505124092,
      "val_max_prob": 0.7273916453123093,
      "val_conf_over_90": 0.03465577680617571,
      "val_conf_over_95": 0.0006110835820436478,
      "learning_rate": 4.536501169339407e-05,
      "epoch_time": 106.25695395469666,
      "val_boundary_f1": 0.4235074626865672,
      "val_boundary_precision": 0.35030864197530864,
      "val_boundary_recall": 0.535377358490566,
      "val_complete_segments": 0.3059754282465366,
      "val_avg_segment_overlap": 0.7134696209825926,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.4237065863444921,
      "val_pk_metric": 0.27857525083775686,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.9771916083991528,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 8,
      "train_loss": 0.48619734682142735,
      "train_chorus_rate": 0.40124194137752056,
      "train_max_prob": 0.6771542802453041,
      "train_conf_over_90": 0.004122868733247742,
      "train_conf_over_95": 0.0,
      "val_loss": 0.474016435444355,
      "val_macro_f1": 0.7628757326113502,
      "val_verse_f1": 0.8283294842186298,
      "val_chorus_f1": 0.6974219810040705,
      "val_chorus_rate": 0.4197622239589691,
      "val_max_prob": 0.7289489358663559,
      "val_conf_over_90": 0.03397257253527641,
      "val_conf_over_95": 0.0014234553673304617,
      "learning_rate": 3.0928596653924204e-05,
      "epoch_time": 113.50090980529785,
      "val_boundary_f1": 0.4196843082636954,
      "val_boundary_precision": 0.3460949464012251,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.3121068559293159,
      "val_avg_segment_overlap": 0.7107097122355992,
      "val_verse_to_chorus_acc": 0.504424778761062,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.44568536097217604,
      "val_pk_metric": 0.30520616177619103,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.9700134173035622,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 9,
      "train_loss": 0.47324467450380325,
      "train_chorus_rate": 0.35532729513943195,
      "train_max_prob": 0.689560953527689,
      "train_conf_over_90": 0.004883044901362155,
      "train_conf_over_95": 6.360829320328776e-05,
      "val_loss": 0.47654537856578827,
      "val_macro_f1": 0.7714006694463569,
      "val_verse_f1": 0.8439888164026095,
      "val_chorus_f1": 0.6988125224901043,
      "val_chorus_rate": 0.3795043081045151,
      "val_max_prob": 0.7228340059518814,
      "val_conf_over_90": 0.02743506245315075,
      "val_conf_over_95": 0.0014234553673304617,
      "learning_rate": 1.8531766017074763e-05,
      "epoch_time": 111.01050114631653,
      "val_boundary_f1": 0.4301470588235294,
      "val_boundary_precision": 0.35240963855421686,
      "val_boundary_recall": 0.5518867924528302,
      "val_complete_segments": 0.3432863077920897,
      "val_avg_segment_overlap": 0.7189582258774192,
      "val_verse_to_chorus_acc": 0.5309734513274337,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.41642658833013946,
      "val_pk_metric": 0.2744437561353576,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.060300275683403,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 10,
      "train_loss": 0.47445004619657993,
      "train_chorus_rate": 0.35995277762413025,
      "train_max_prob": 0.6788596846163273,
      "train_conf_over_90": 0.004403888051456306,
      "train_conf_over_95": 4.0115533920470625e-05,
      "val_loss": 0.47699209302663803,
      "val_macro_f1": 0.7507152619689901,
      "val_verse_f1": 0.8143220504793582,
      "val_chorus_f1": 0.6871084734586218,
      "val_chorus_rate": 0.4461126774549484,
      "val_max_prob": 0.7221682369709015,
      "val_conf_over_90": 0.03446761961095035,
      "val_conf_over_95": 0.002027320151682943,
      "learning_rate": 9.019343304015784e-06,
      "epoch_time": 107.03267908096313,
      "val_boundary_f1": 0.40185185185185185,
      "val_boundary_precision": 0.3307926829268293,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.2856935978713465,
      "val_avg_segment_overlap": 0.6926645535971756,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.46819855370039604,
      "val_pk_metric": 0.31312326890012415,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.9895117878913879,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 11,
      "train_loss": 0.4634533245116472,
      "train_chorus_rate": 0.4189317226409912,
      "train_max_prob": 0.6909702233970165,
      "train_conf_over_90": 0.010613843624014407,
      "train_conf_over_95": 7.433949940605089e-05,
      "val_loss": 0.4760555177927017,
      "val_macro_f1": 0.7518324576940973,
      "val_verse_f1": 0.8150322959483264,
      "val_chorus_f1": 0.6886326194398682,
      "val_chorus_rate": 0.44447968155145645,
      "val_max_prob": 0.7380827963352203,
      "val_conf_over_90": 0.052013448905199766,
      "val_conf_over_95": 0.002814460007357411,
      "learning_rate": 3.0395844026204496e-06,
      "epoch_time": 105.60342502593994,
      "val_boundary_f1": 0.4093896713615024,
      "val_boundary_precision": 0.34009360374414976,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.2887592605389822,
      "val_avg_segment_overlap": 0.6907873137377396,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.47474747474747475,
      "val_window_diff": 0.4538808952306522,
      "val_pk_metric": 0.3099223326912966,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 0.8735249936580658,
      "cnn_effective_layers": 3
    },
    {
      "epoch": 12,
      "train_loss": 0.48168780840933323,
      "train_chorus_rate": 0.41749234311282635,
      "train_max_prob": 0.6958031095564365,
      "train_conf_over_90": 0.01009308872744441,
      "train_conf_over_95": 0.000149929470353527,
      "val_loss": 0.47498370707035065,
      "val_macro_f1": 0.7560917961534565,
      "val_verse_f1": 0.8200038918077448,
      "val_chorus_f1": 0.6921797004991681,
      "val_chorus_rate": 0.4337034448981285,
      "val_max_prob": 0.7379624992609024,
      "val_conf_over_90": 0.05184461222961545,
      "val_conf_over_95": 0.0026059528900077567,
      "learning_rate": 1e-06,
      "epoch_time": 122.67984390258789,
      "val_boundary_f1": 0.414703110273327,
      "val_boundary_precision": 0.3453689167974882,
      "val_boundary_recall": 0.5188679245283019,
      "val_complete_segments": 0.3080106766736874,
      "val_avg_segment_overlap": 0.69590786352221,
      "val_verse_to_chorus_acc": 0.5,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4538978719640099,
      "val_pk_metric": 0.2916931956618592,
      "cnn_receptive_field_usage": 0.4,
      "cnn_gradient_norm": 1.2213537953794003,
      "cnn_effective_layers": 3
    }
  ]
}