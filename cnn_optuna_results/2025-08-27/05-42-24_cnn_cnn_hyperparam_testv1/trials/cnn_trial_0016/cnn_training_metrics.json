{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 1,
      "dropout": 0.29191320565902174,
      "layer_dropout": 0.0,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 134528,
      "cnn_params": 129534,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005829350976742147,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 15,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.10675046540255162,
        "ece_after": 0.01688841421501105,
        "improvement": 0.08986205118754056,
        "params": {
          "temperature": 0.559535454394914
        }
      },
      "platt": {
        "ece_before": 0.10675046540255162,
        "ece_after": 0.038921952071967435,
        "improvement": 0.06782851333058418,
        "params": {
          "A": 1.4999986296022874,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5311042240687779,
      "train_chorus_rate": 0.42524359055927824,
      "train_max_prob": 0.6282661557197571,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5073892027139664,
      "val_macro_f1": 0.7309390547263682,
      "val_verse_f1": 0.8160447761194031,
      "val_chorus_f1": 0.6458333333333334,
      "val_chorus_rate": 0.38953930139541626,
      "val_max_prob": 0.6708909571170807,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005765767586235203,
      "epoch_time": 100.40317225456238,
      "val_boundary_f1": 0.3508488278092159,
      "val_boundary_precision": 0.26691266912669126,
      "val_boundary_recall": 0.5117924528301887,
      "val_complete_segments": 0.3032029394299287,
      "val_avg_segment_overlap": 0.680590381658559,
      "val_verse_to_chorus_acc": 0.46017699115044247,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4805145632107539,
      "val_pk_metric": 0.3269726064805218,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 57.139192453452516,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 2,
      "train_loss": 0.5101679520947593,
      "train_chorus_rate": 0.4540199637413025,
      "train_max_prob": 0.6744004998888288,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4983152151107788,
      "val_macro_f1": 0.7659602023271808,
      "val_verse_f1": 0.8490121442813123,
      "val_chorus_f1": 0.6829082603730491,
      "val_chorus_rate": 0.3507564663887024,
      "val_max_prob": 0.7084439694881439,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005577796313986483,
      "epoch_time": 94.83328223228455,
      "val_boundary_f1": 0.40891472868217055,
      "val_boundary_precision": 0.3470394736842105,
      "val_boundary_recall": 0.49764150943396224,
      "val_complete_segments": 0.3065803147268409,
      "val_avg_segment_overlap": 0.7002533479893223,
      "val_verse_to_chorus_acc": 0.4823008849557522,
      "val_chorus_to_verse_acc": 0.46464646464646464,
      "val_window_diff": 0.4210753456931426,
      "val_pk_metric": 0.2877808430539725,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.235106770481382,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 3,
      "train_loss": 0.49492980752672466,
      "train_chorus_rate": 0.3468574711254665,
      "train_max_prob": 0.6951123816626412,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4838549941778183,
      "val_macro_f1": 0.7381385038805175,
      "val_verse_f1": 0.8039254170755643,
      "val_chorus_f1": 0.6723515906854706,
      "val_chorus_rate": 0.4542413353919983,
      "val_max_prob": 0.6994586288928986,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0005273652406579496,
      "epoch_time": 164.0517339706421,
      "val_boundary_f1": 0.3791304347826087,
      "val_boundary_precision": 0.3002754820936639,
      "val_boundary_recall": 0.5141509433962265,
      "val_complete_segments": 0.2787355255344418,
      "val_avg_segment_overlap": 0.6872044035327802,
      "val_verse_to_chorus_acc": 0.4690265486725664,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.45880789605389516,
      "val_pk_metric": 0.3311163877553793,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.303680190018245,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 4,
      "train_loss": 0.48035184826169697,
      "train_chorus_rate": 0.3642956827368055,
      "train_max_prob": 0.7073011228016445,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48122023046016693,
      "val_macro_f1": 0.7781874582879623,
      "val_verse_f1": 0.8553206997084547,
      "val_chorus_f1": 0.7010542168674699,
      "val_chorus_rate": 0.36075228452682495,
      "val_max_prob": 0.7247347235679626,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0004866628412212316,
      "epoch_time": 63.40539598464966,
      "val_boundary_f1": 0.4288354898336414,
      "val_boundary_precision": 0.3525835866261398,
      "val_boundary_recall": 0.5471698113207547,
      "val_complete_segments": 0.34902019002375295,
      "val_avg_segment_overlap": 0.7139094326486874,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.4444444444444444,
      "val_window_diff": 0.42392439991343944,
      "val_pk_metric": 0.25974303391709075,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 5.082517236471176,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 5,
      "train_loss": 0.4897072911262512,
      "train_chorus_rate": 0.381588556936809,
      "train_max_prob": 0.7010032790047782,
      "train_conf_over_90": 2.8182509205570178e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4793463200330734,
      "val_macro_f1": 0.7598171495981714,
      "val_verse_f1": 0.8222222222222222,
      "val_chorus_f1": 0.6974120769741207,
      "val_chorus_rate": 0.4514405131340027,
      "val_max_prob": 0.7011343836784363,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000437451323255661,
      "epoch_time": 54.837404012680054,
      "val_boundary_f1": 0.43268337975858867,
      "val_boundary_precision": 0.3568147013782542,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.360052330760095,
      "val_avg_segment_overlap": 0.7075511615456217,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.5555555555555556,
      "val_window_diff": 0.4347153786021981,
      "val_pk_metric": 0.3060772343686765,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 9.904581419059209,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 6,
      "train_loss": 0.46509850876671927,
      "train_chorus_rate": 0.3997015058994293,
      "train_max_prob": 0.7073179994310651,
      "train_conf_over_90": 0.0001875009495831494,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46768540143966675,
      "val_macro_f1": 0.78114921084234,
      "val_verse_f1": 0.8503731343283583,
      "val_chorus_f1": 0.7119252873563218,
      "val_chorus_rate": 0.38953930139541626,
      "val_max_prob": 0.7270604074001312,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000381881466239396,
      "epoch_time": 59.31979298591614,
      "val_boundary_f1": 0.45562671546203115,
      "val_boundary_precision": 0.3721973094170404,
      "val_boundary_recall": 0.5872641509433962,
      "val_complete_segments": 0.38618059679334915,
      "val_avg_segment_overlap": 0.7273212828684086,
      "val_verse_to_chorus_acc": 0.588495575221239,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.42653122614382144,
      "val_pk_metric": 0.2744363368902134,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 21.464526661804744,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 7,
      "train_loss": 0.466164516551154,
      "train_chorus_rate": 0.359055404152189,
      "train_max_prob": 0.7191505857876369,
      "train_conf_over_90": 0.0006874503887956962,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4713706076145172,
      "val_macro_f1": 0.7654545509912666,
      "val_verse_f1": 0.8271436904530429,
      "val_chorus_f1": 0.7037654115294902,
      "val_chorus_rate": 0.4426034092903137,
      "val_max_prob": 0.7207123637199402,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00032238193957780613,
      "epoch_time": 74.90784621238708,
      "val_boundary_f1": 0.42857142857142855,
      "val_boundary_precision": 0.3448275862068966,
      "val_boundary_recall": 0.5660377358490566,
      "val_complete_segments": 0.355301736935867,
      "val_avg_segment_overlap": 0.7108112629365386,
      "val_verse_to_chorus_acc": 0.5486725663716814,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.4429512950637464,
      "val_pk_metric": 0.2963938577457838,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 104.90886912175587,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 8,
      "train_loss": 0.4880629565034594,
      "train_chorus_rate": 0.3931055111544473,
      "train_max_prob": 0.7022304279463631,
      "train_conf_over_90": 0.00034178555610456636,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46874305605888367,
      "val_macro_f1": 0.7850867354920917,
      "val_verse_f1": 0.8544374303750465,
      "val_chorus_f1": 0.715736040609137,
      "val_chorus_rate": 0.38428522646427155,
      "val_max_prob": 0.701349526643753,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00026155315809640867,
      "epoch_time": 64.38676619529724,
      "val_boundary_f1": 0.4564619615032081,
      "val_boundary_precision": 0.3733133433283358,
      "val_boundary_recall": 0.5872641509433962,
      "val_complete_segments": 0.39671169833729214,
      "val_avg_segment_overlap": 0.7273381532643545,
      "val_verse_to_chorus_acc": 0.588495575221239,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.42051701957609744,
      "val_pk_metric": 0.259179011235806,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 111.41687842777797,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 9,
      "train_loss": 0.478713367666517,
      "train_chorus_rate": 0.3976516383034842,
      "train_max_prob": 0.6987913761820111,
      "train_conf_over_90": 0.0009453370834567717,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4717869460582733,
      "val_macro_f1": 0.7695271880162258,
      "val_verse_f1": 0.8317865429234339,
      "val_chorus_f1": 0.7072678331090175,
      "val_chorus_rate": 0.4393499493598938,
      "val_max_prob": 0.7176074385643005,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00020205363143481874,
      "epoch_time": 62.91073703765869,
      "val_boundary_f1": 0.4177449168207024,
      "val_boundary_precision": 0.3434650455927052,
      "val_boundary_recall": 0.5330188679245284,
      "val_complete_segments": 0.34392629156769594,
      "val_avg_segment_overlap": 0.70954963779068,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.5252525252525253,
      "val_window_diff": 0.4430177657821216,
      "val_pk_metric": 0.3023033531146787,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7275772435324532,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 10,
      "train_loss": 0.47173007896968294,
      "train_chorus_rate": 0.3804766833782196,
      "train_max_prob": 0.7189727681023734,
      "train_conf_over_90": 0.0016385628592355975,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47069352865219116,
      "val_macro_f1": 0.7726770164070113,
      "val_verse_f1": 0.8345879173904652,
      "val_chorus_f1": 0.7107661154235573,
      "val_chorus_rate": 0.4371900111436844,
      "val_max_prob": 0.7171986997127533,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00014648377441855374,
      "epoch_time": 86.11433696746826,
      "val_boundary_f1": 0.4394785847299814,
      "val_boundary_precision": 0.3630769230769231,
      "val_boundary_recall": 0.5566037735849056,
      "val_complete_segments": 0.38467747921615203,
      "val_avg_segment_overlap": 0.7136722740355987,
      "val_verse_to_chorus_acc": 0.584070796460177,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.4317066419559734,
      "val_pk_metric": 0.2878150707152235,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 9.440865367650986,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 11,
      "train_loss": 0.46588280371257235,
      "train_chorus_rate": 0.40390034658568247,
      "train_max_prob": 0.7010682225227356,
      "train_conf_over_90": 0.0013235137905992036,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46972714364528656,
      "val_macro_f1": 0.781308017509446,
      "val_verse_f1": 0.8482797518330513,
      "val_chorus_f1": 0.7143362831858407,
      "val_chorus_rate": 0.40004928410053253,
      "val_max_prob": 0.7114840447902679,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 9.72722564529831e-05,
      "epoch_time": 198.70955109596252,
      "val_boundary_f1": 0.4469964664310954,
      "val_boundary_precision": 0.3573446327683616,
      "val_boundary_recall": 0.5966981132075472,
      "val_complete_segments": 0.3727731591448931,
      "val_avg_segment_overlap": 0.7248951454962227,
      "val_verse_to_chorus_acc": 0.6150442477876106,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.42713645612830015,
      "val_pk_metric": 0.27563895666223265,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0266033411026,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 12,
      "train_loss": 0.4640607791287558,
      "train_chorus_rate": 0.33137685486248564,
      "train_max_prob": 0.7079922812325614,
      "train_conf_over_90": 0.001752162551773446,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46921978890895844,
      "val_macro_f1": 0.7820805803954318,
      "val_verse_f1": 0.8508493559828263,
      "val_chorus_f1": 0.7133118048080374,
      "val_chorus_rate": 0.39073243737220764,
      "val_max_prob": 0.7138864099979401,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 5.656985701626505e-05,
      "epoch_time": 107.97928094863892,
      "val_boundary_f1": 0.45065502183406114,
      "val_boundary_precision": 0.3578363384188627,
      "val_boundary_recall": 0.6084905660377359,
      "val_complete_segments": 0.3797413153206651,
      "val_avg_segment_overlap": 0.725123421952339,
      "val_verse_to_chorus_acc": 0.6150442477876106,
      "val_chorus_to_verse_acc": 0.5404040404040404,
      "val_window_diff": 0.42609359145288217,
      "val_pk_metric": 0.26804888880428723,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 34.27744314074516,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 13,
      "train_loss": 0.46463334560394287,
      "train_chorus_rate": 0.3540269987923758,
      "train_max_prob": 0.706369868346623,
      "train_conf_over_90": 0.0027222981277321067,
      "train_conf_over_95": 0.0,
      "val_loss": 0.46876683831214905,
      "val_macro_f1": 0.7737671064148728,
      "val_verse_f1": 0.8375478927203065,
      "val_chorus_f1": 0.7099863201094392,
      "val_chorus_rate": 0.42522798478603363,
      "val_max_prob": 0.7133716344833374,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.6155466275566266e-05,
      "epoch_time": 53.85405611991882,
      "val_boundary_f1": 0.4348623853211009,
      "val_boundary_precision": 0.35585585585585583,
      "val_boundary_recall": 0.5589622641509434,
      "val_complete_segments": 0.354958432304038,
      "val_avg_segment_overlap": 0.7148071432202927,
      "val_verse_to_chorus_acc": 0.5707964601769911,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.43455935417892766,
      "val_pk_metric": 0.29508057431265966,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 7.0377620203154425,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 14,
      "train_loss": 0.46634818826402935,
      "train_chorus_rate": 0.3714826149599893,
      "train_max_prob": 0.7071327141353062,
      "train_conf_over_90": 0.0029438857953729375,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4676595628261566,
      "val_macro_f1": 0.777263001264396,
      "val_verse_f1": 0.8408787010506208,
      "val_chorus_f1": 0.7136473014781712,
      "val_chorus_rate": 0.4217463880777359,
      "val_max_prob": 0.7150716483592987,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.358339050694362e-06,
      "epoch_time": 47.400662899017334,
      "val_boundary_f1": 0.4409881061299177,
      "val_boundary_precision": 0.3602391629297459,
      "val_boundary_recall": 0.5683962264150944,
      "val_complete_segments": 0.363958580760095,
      "val_avg_segment_overlap": 0.7204956734493049,
      "val_verse_to_chorus_acc": 0.588495575221239,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4274814128240803,
      "val_pk_metric": 0.28444568262778297,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6312465369701385,
      "cnn_effective_layers": 1
    },
    {
      "epoch": 15,
      "train_loss": 0.4708449755396162,
      "train_chorus_rate": 0.3823435391698565,
      "train_max_prob": 0.7082294055393764,
      "train_conf_over_90": 0.0035389478684269954,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4676676094532013,
      "val_macro_f1": 0.7757271045605921,
      "val_verse_f1": 0.8396713166443722,
      "val_chorus_f1": 0.711782892476812,
      "val_chorus_rate": 0.42242351174354553,
      "val_max_prob": 0.7147258222103119,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 77.25306510925293,
      "val_boundary_f1": 0.4383561643835616,
      "val_boundary_precision": 0.35767511177347244,
      "val_boundary_recall": 0.5660377358490566,
      "val_complete_segments": 0.362770932304038,
      "val_avg_segment_overlap": 0.7191468441313544,
      "val_verse_to_chorus_acc": 0.584070796460177,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4283967446318606,
      "val_pk_metric": 0.28651373153793713,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7344063690730503,
      "cnn_effective_layers": 1
    }
  ]
}