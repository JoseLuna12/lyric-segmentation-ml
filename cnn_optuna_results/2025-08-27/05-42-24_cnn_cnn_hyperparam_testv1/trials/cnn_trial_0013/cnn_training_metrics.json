{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.28164363801146797,
      "layer_dropout": 0.10117569191754766,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.0005005224366991192,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08663291590972592,
        "ece_after": 0.012867650020801726,
        "improvement": 0.0737652658889242,
        "params": {
          "temperature": 0.606489138671772
        }
      },
      "platt": {
        "ece_before": 0.08663291590972592,
        "ece_after": 0.027328901797942885,
        "improvement": 0.05930401411178304,
        "params": {
          "A": 1.4426504143291785,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5428206443786621,
      "train_chorus_rate": 0.47206700444221494,
      "train_max_prob": 0.6364194989204407,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5138998925685883,
      "val_macro_f1": 0.7346966690327292,
      "val_verse_f1": 0.8042801556420233,
      "val_chorus_f1": 0.6651131824234353,
      "val_chorus_rate": 0.43792738020420074,
      "val_max_prob": 0.7002576887607574,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00048151049599780017,
      "epoch_time": 26.47503113746643,
      "val_boundary_f1": 0.3941480206540448,
      "val_boundary_precision": 0.31029810298102983,
      "val_boundary_recall": 0.5400943396226415,
      "val_complete_segments": 0.32475869240614336,
      "val_avg_segment_overlap": 0.6530904482195011,
      "val_verse_to_chorus_acc": 0.5088495575221239,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4456020185468697,
      "val_pk_metric": 0.3139749203520214,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.3066008627414702,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49349633753299715,
      "train_chorus_rate": 0.4243188977241516,
      "train_max_prob": 0.686351728439331,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.501735657453537,
      "val_macro_f1": 0.7487634308040817,
      "val_verse_f1": 0.8158914728682171,
      "val_chorus_f1": 0.6816353887399463,
      "val_chorus_rate": 0.43325650691986084,
      "val_max_prob": 0.7436516582965851,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042736906952194715,
      "epoch_time": 20.964235067367554,
      "val_boundary_f1": 0.4077134986225896,
      "val_boundary_precision": 0.33383458646616543,
      "val_boundary_recall": 0.5235849056603774,
      "val_complete_segments": 0.31281329991467577,
      "val_avg_segment_overlap": 0.6681228716667289,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.4401233586053179,
      "val_pk_metric": 0.30761874604721895,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7110025137662888,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.49439833164215086,
      "train_chorus_rate": 0.4023502379655838,
      "train_max_prob": 0.700467449426651,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49691085517406464,
      "val_macro_f1": 0.7305989133666028,
      "val_verse_f1": 0.7886868686868687,
      "val_chorus_f1": 0.6725109580463369,
      "val_chorus_rate": 0.4848105311393738,
      "val_max_prob": 0.7043968439102173,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00034634069865925577,
      "epoch_time": 21.282722234725952,
      "val_boundary_f1": 0.3469785575048733,
      "val_boundary_precision": 0.2956810631229236,
      "val_boundary_recall": 0.419811320754717,
      "val_complete_segments": 0.22812899957337884,
      "val_avg_segment_overlap": 0.6357325044608635,
      "val_verse_to_chorus_acc": 0.336283185840708,
      "val_chorus_to_verse_acc": 0.48484848484848486,
      "val_window_diff": 0.45540698519567335,
      "val_pk_metric": 0.35257279644282025,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.8195081174373626,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.48495295345783235,
      "train_chorus_rate": 0.4242292195558548,
      "train_max_prob": 0.7109726309776306,
      "train_conf_over_90": 9.564482315909118e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.49123503267765045,
      "val_macro_f1": 0.7504514963342214,
      "val_verse_f1": 0.8116742259909289,
      "val_chorus_f1": 0.6892287666775139,
      "val_chorus_rate": 0.4549265503883362,
      "val_max_prob": 0.7488558888435364,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00025076121834955963,
      "epoch_time": 20.424407958984375,
      "val_boundary_f1": 0.3982222222222222,
      "val_boundary_precision": 0.3195435092724679,
      "val_boundary_recall": 0.5283018867924528,
      "val_complete_segments": 0.30890704991467577,
      "val_avg_segment_overlap": 0.6710046533457756,
      "val_verse_to_chorus_acc": 0.49557522123893805,
      "val_chorus_to_verse_acc": 0.5353535353535354,
      "val_window_diff": 0.45506950619098535,
      "val_pk_metric": 0.3166253428584551,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.697692084312439,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48188682198524474,
      "train_chorus_rate": 0.4264580488204956,
      "train_max_prob": 0.7220813691616058,
      "train_conf_over_90": 0.000977765442803502,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48707039654254913,
      "val_macro_f1": 0.7943434343434344,
      "val_verse_f1": 0.8686868686868686,
      "val_chorus_f1": 0.72,
      "val_chorus_rate": 0.338697224855423,
      "val_max_prob": 0.7346587777137756,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0001551817380398635,
      "epoch_time": 21.720874071121216,
      "val_boundary_f1": 0.4850746268656716,
      "val_boundary_precision": 0.4012345679012346,
      "val_boundary_recall": 0.6132075471698113,
      "val_complete_segments": 0.408703071672355,
      "val_avg_segment_overlap": 0.7136971002207115,
      "val_verse_to_chorus_acc": 0.6371681415929203,
      "val_chorus_to_verse_acc": 0.5303030303030303,
      "val_window_diff": 0.3789493481511853,
      "val_pk_metric": 0.24165490360096248,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.1860655099153519,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.4719988226890564,
      "train_chorus_rate": 0.35005550682544706,
      "train_max_prob": 0.7092023313045501,
      "train_conf_over_90": 0.0007273566705407574,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48313677310943604,
      "val_macro_f1": 0.779486167604674,
      "val_verse_f1": 0.848098894924143,
      "val_chorus_f1": 0.710873440285205,
      "val_chorus_rate": 0.3891264945268631,
      "val_max_prob": 0.7232424020767212,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 7.415336717717206e-05,
      "epoch_time": 25.57658290863037,
      "val_boundary_f1": 0.44684684684684683,
      "val_boundary_precision": 0.36151603498542273,
      "val_boundary_recall": 0.5849056603773585,
      "val_complete_segments": 0.3662276023890785,
      "val_avg_segment_overlap": 0.7069663789212425,
      "val_verse_to_chorus_acc": 0.5575221238938053,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.4182179662159483,
      "val_pk_metric": 0.2760235954207124,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0393210500478745,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.46767430305480956,
      "train_chorus_rate": 0.34247292280197145,
      "train_max_prob": 0.7060632586479187,
      "train_conf_over_90": 0.0007299567892914638,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4824398010969162,
      "val_macro_f1": 0.7711200184289335,
      "val_verse_f1": 0.8373333333333334,
      "val_chorus_f1": 0.7049067035245336,
      "val_chorus_rate": 0.4109683185815811,
      "val_max_prob": 0.7312202155590057,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 2.001194070131907e-05,
      "epoch_time": 25.713412761688232,
      "val_boundary_f1": 0.4152700186219739,
      "val_boundary_precision": 0.34307692307692306,
      "val_boundary_recall": 0.5259433962264151,
      "val_complete_segments": 0.3113534556313993,
      "val_avg_segment_overlap": 0.6884779988592042,
      "val_verse_to_chorus_acc": 0.5132743362831859,
      "val_chorus_to_verse_acc": 0.5,
      "val_window_diff": 0.4248264055996399,
      "val_pk_metric": 0.29098597880380933,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7823808014392852,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.46838452517986295,
      "train_chorus_rate": 0.383998903632164,
      "train_max_prob": 0.712153148651123,
      "train_conf_over_90": 0.001869413035456091,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4820201247930527,
      "val_macro_f1": 0.773984168587144,
      "val_verse_f1": 0.8399239543726236,
      "val_chorus_f1": 0.7080443828016644,
      "val_chorus_rate": 0.408508837223053,
      "val_max_prob": 0.732244998216629,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 20.723834991455078,
      "val_boundary_f1": 0.42446709916589437,
      "val_boundary_precision": 0.34961832061068704,
      "val_boundary_recall": 0.5400943396226415,
      "val_complete_segments": 0.3259918941979522,
      "val_avg_segment_overlap": 0.6923152030156878,
      "val_verse_to_chorus_acc": 0.5353982300884956,
      "val_chorus_to_verse_acc": 0.494949494949495,
      "val_window_diff": 0.41961508559229543,
      "val_pk_metric": 0.28551100844880695,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6336016803979874,
      "cnn_effective_layers": 2
    }
  ]
}