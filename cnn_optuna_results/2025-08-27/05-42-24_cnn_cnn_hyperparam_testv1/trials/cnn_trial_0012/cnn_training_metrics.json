{
  "metadata": {
    "model_info": {
      "architecture": "CNN",
      "hidden_dim": 128,
      "num_layers": 2,
      "dropout": 0.25533263132235867,
      "layer_dropout": 0.10037518382920467,
      "kernel_sizes": [
        3,
        7,
        11
      ],
      "dilation_rates": [
        1,
        2,
        4,
        8
      ],
      "use_residual": true,
      "attention_enabled": false,
      "attention_type": "self",
      "attention_heads": 4,
      "total_params": 264062,
      "cnn_params": 259068,
      "attention_params": 0
    },
    "training_info": {
      "batch_size": 64,
      "learning_rate": 0.00044613549870196976,
      "scheduler": "cosine",
      "scheduler_type": "epoch",
      "validation_strategy": "cnn_composite",
      "total_epochs": 8,
      "early_stopping_mode": "cnn_calibration",
      "convergence_window": 5
    },
    "calibration_info": {
      "temperature": {
        "ece_before": 0.08227657693601075,
        "ece_after": 0.013047957833131753,
        "improvement": 0.06922861910287899,
        "params": {
          "temperature": 0.6224842535602281
        }
      },
      "platt": {
        "ece_before": 0.08227657693601075,
        "ece_after": 0.014484053320289828,
        "improvement": 0.06779252361572091,
        "params": {
          "A": 1.4999970802556917,
          "B": 0.0
        }
      }
    }
  },
  "metrics": [
    {
      "epoch": 1,
      "train_loss": 0.5407825529575347,
      "train_chorus_rate": 0.4669577062129974,
      "train_max_prob": 0.6350169956684113,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.511115089058876,
      "val_macro_f1": 0.7304526366643129,
      "val_verse_f1": 0.7992957746478873,
      "val_chorus_f1": 0.6616094986807387,
      "val_chorus_rate": 0.4447006583213806,
      "val_max_prob": 0.7036402225494385,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00042919353757346206,
      "epoch_time": 28.157613277435303,
      "val_boundary_f1": 0.3882657463330457,
      "val_boundary_precision": 0.30612244897959184,
      "val_boundary_recall": 0.5306603773584906,
      "val_complete_segments": 0.31411637931034486,
      "val_avg_segment_overlap": 0.6441034183888318,
      "val_verse_to_chorus_acc": 0.4911504424778761,
      "val_chorus_to_verse_acc": 0.51010101010101,
      "val_window_diff": 0.44800093159733423,
      "val_pk_metric": 0.31664042836304074,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 2.2444316923618315,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 2,
      "train_loss": 0.49261429011821745,
      "train_chorus_rate": 0.4214592486619949,
      "train_max_prob": 0.6852745652198792,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.5024894177913666,
      "val_macro_f1": 0.7373364205424809,
      "val_verse_f1": 0.803840877914952,
      "val_chorus_f1": 0.6708319631700099,
      "val_chorus_rate": 0.4469553977251053,
      "val_max_prob": 0.7422985136508942,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003809469141904941,
      "epoch_time": 21.371392011642456,
      "val_boundary_f1": 0.37603686635944705,
      "val_boundary_precision": 0.3086232980332829,
      "val_boundary_recall": 0.4811320754716981,
      "val_complete_segments": 0.2502993295019157,
      "val_avg_segment_overlap": 0.6486613366980455,
      "val_verse_to_chorus_acc": 0.4247787610619469,
      "val_chorus_to_verse_acc": 0.4898989898989899,
      "val_window_diff": 0.4572602110987214,
      "val_pk_metric": 0.32467407710460816,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.7955613523721695,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 3,
      "train_loss": 0.49666612446308134,
      "train_chorus_rate": 0.39274446964263915,
      "train_max_prob": 0.7040281116962432,
      "train_conf_over_90": 4.060089413542301e-05,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4969061464071274,
      "val_macro_f1": 0.7293525068526685,
      "val_verse_f1": 0.7893043827905106,
      "val_chorus_f1": 0.6694006309148265,
      "val_chorus_rate": 0.47870852053165436,
      "val_max_prob": 0.6894732117652893,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.0003087407396063928,
      "epoch_time": 21.836134910583496,
      "val_boundary_f1": 0.345489443378119,
      "val_boundary_precision": 0.2912621359223301,
      "val_boundary_recall": 0.42452830188679247,
      "val_complete_segments": 0.2207255747126437,
      "val_avg_segment_overlap": 0.6397587015074673,
      "val_verse_to_chorus_acc": 0.33185840707964603,
      "val_chorus_to_verse_acc": 0.5050505050505051,
      "val_window_diff": 0.4573301865764456,
      "val_pk_metric": 0.3505267460475308,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9815399706363678,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 4,
      "train_loss": 0.4875171214342117,
      "train_chorus_rate": 0.4270988702774048,
      "train_max_prob": 0.7023864030838013,
      "train_conf_over_90": 0.0,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4878424257040024,
      "val_macro_f1": 0.7609589818449365,
      "val_verse_f1": 0.8265895953757226,
      "val_chorus_f1": 0.6953283683141502,
      "val_chorus_rate": 0.42560988664627075,
      "val_max_prob": 0.7479936480522156,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.00022356774935098486,
      "epoch_time": 21.00942587852478,
      "val_boundary_f1": 0.4342963653308481,
      "val_boundary_precision": 0.35901386748844377,
      "val_boundary_recall": 0.5495283018867925,
      "val_complete_segments": 0.34021791187739464,
      "val_avg_segment_overlap": 0.682611971342099,
      "val_verse_to_chorus_acc": 0.5221238938053098,
      "val_chorus_to_verse_acc": 0.5454545454545454,
      "val_window_diff": 0.4252819566728452,
      "val_pk_metric": 0.30546878550736634,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9084834456443787,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 5,
      "train_loss": 0.48097931146621703,
      "train_chorus_rate": 0.435246479511261,
      "train_max_prob": 0.7216991603374481,
      "train_conf_over_90": 0.0006684231193503365,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4808371365070343,
      "val_macro_f1": 0.7894576428007729,
      "val_verse_f1": 0.8603967670830271,
      "val_chorus_f1": 0.7185185185185186,
      "val_chorus_rate": 0.3631979525089264,
      "val_max_prob": 0.731099396944046,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 0.000138394759095577,
      "epoch_time": 21.92104721069336,
      "val_boundary_f1": 0.4903225806451612,
      "val_boundary_precision": 0.40242057488653554,
      "val_boundary_recall": 0.6273584905660378,
      "val_complete_segments": 0.413433908045977,
      "val_avg_segment_overlap": 0.7180585202167489,
      "val_verse_to_chorus_acc": 0.6238938053097345,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.39310092431698335,
      "val_pk_metric": 0.2552124079862155,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 1.0698388665914536,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 6,
      "train_loss": 0.47133461236953733,
      "train_chorus_rate": 0.36737031638622286,
      "train_max_prob": 0.7067988991737366,
      "train_conf_over_90": 0.0003701386071043089,
      "train_conf_over_95": 0.0,
      "val_loss": 0.48012861609458923,
      "val_macro_f1": 0.7762067259891381,
      "val_verse_f1": 0.8450704225352113,
      "val_chorus_f1": 0.707343029443065,
      "val_chorus_rate": 0.3923909068107605,
      "val_max_prob": 0.7215213775634766,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 6.618858451147566e-05,
      "epoch_time": 25.955939292907715,
      "val_boundary_f1": 0.44524236983842014,
      "val_boundary_precision": 0.35942028985507246,
      "val_boundary_recall": 0.5849056603773585,
      "val_complete_segments": 0.36542145593869735,
      "val_avg_segment_overlap": 0.7032729908520088,
      "val_verse_to_chorus_acc": 0.5619469026548672,
      "val_chorus_to_verse_acc": 0.5656565656565656,
      "val_window_diff": 0.41763250448444206,
      "val_pk_metric": 0.27969501074615966,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.9853830248117447,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 7,
      "train_loss": 0.47006232738494874,
      "train_chorus_rate": 0.3469888955354691,
      "train_max_prob": 0.7031133472919464,
      "train_conf_over_90": 0.00042157809366472065,
      "train_conf_over_95": 0.0,
      "val_loss": 0.47947958111763,
      "val_macro_f1": 0.7748788366885082,
      "val_verse_f1": 0.843708858378785,
      "val_chorus_f1": 0.7060488149982315,
      "val_chorus_rate": 0.3943749666213989,
      "val_max_prob": 0.7301108241081238,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1.7941961128507728e-05,
      "epoch_time": 25.860076189041138,
      "val_boundary_f1": 0.4440333024976873,
      "val_boundary_precision": 0.365296803652968,
      "val_boundary_recall": 0.5660377358490566,
      "val_complete_segments": 0.3423132183908046,
      "val_avg_segment_overlap": 0.6971098979683634,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.41404826056711963,
      "val_pk_metric": 0.2763471572575278,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.829414826631546,
      "cnn_effective_layers": 2
    },
    {
      "epoch": 8,
      "train_loss": 0.46895327270030973,
      "train_chorus_rate": 0.37625336050987246,
      "train_max_prob": 0.7100463449954987,
      "train_conf_over_90": 0.0004339205275755376,
      "train_conf_over_95": 0.0,
      "val_loss": 0.4794624298810959,
      "val_macro_f1": 0.7737492380014828,
      "val_verse_f1": 0.8413688788050672,
      "val_chorus_f1": 0.7061295971978984,
      "val_chorus_rate": 0.40126706659793854,
      "val_max_prob": 0.7319898903369904,
      "val_conf_over_90": 0.0,
      "val_conf_over_95": 0.0,
      "learning_rate": 1e-06,
      "epoch_time": 21.011375904083252,
      "val_boundary_f1": 0.4413665743305632,
      "val_boundary_precision": 0.3626707132018209,
      "val_boundary_recall": 0.5636792452830188,
      "val_complete_segments": 0.3463242337164751,
      "val_avg_segment_overlap": 0.6960449891772621,
      "val_verse_to_chorus_acc": 0.5663716814159292,
      "val_chorus_to_verse_acc": 0.5151515151515151,
      "val_window_diff": 0.41494142561838476,
      "val_pk_metric": 0.2805521521609954,
      "cnn_receptive_field_usage": 0.7000000000000001,
      "cnn_gradient_norm": 0.6698005557060241,
      "cnn_effective_layers": 2
    }
  ]
}